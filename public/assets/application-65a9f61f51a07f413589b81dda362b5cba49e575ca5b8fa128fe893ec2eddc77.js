function OpenSeadragon(t){return new OpenSeadragon.Viewer(t)}function URLify(t,e){return t=downcode(t),t=t.replace(/[^-\w\s]/g," "),t=t.replace(/^\s+|\s+$/g,""),t=t.replace(/[-\s]+/g,"-"),(t=t.toLowerCase()).substring(0,e)}function addRestoreDefaultBehavior(){$("[data-behavior='restore-default']").each(function(){var t=$("[data-default-value]",$(this)),e=$($("[data-in-place-edit-target]",$(this)).data("in-place-edit-target"),$(this)),n=$("[data-restore-default]",$(this));t.on("blur",function(){$(this).val()==$(this).data("default-value")?n.addClass("hidden"):n.removeClass("hidden")}),n.on("click",function(i){i.preventDefault(),t.val(t.data("default-value")),e.text(t.data("default-value")),n.hide()})})}function addCheckboxToggleBehavior(){function t(t){return $("input[type='checkbox']",t).length==$("input[type='checkbox']:checked",t).length}function e(e,n){t(n)?e.text(e.data("deselect-text")):e.text(e.data("select-text"))}$("[data-behavior='metadata-select']").each(function(){var n=$(this),i=n.parents("th"),r=i.closest("table"),o=$("tr td:nth-child("+(i.index()+1)+")",r),a=$("input[type='checkbox']",o);e(n,o),n.on("click",function(i){i.preventDefault();var r=t(o);o.each(function(){$("input[type='checkbox']",$(this)).prop("checked",!r),e(n,o)})}),a.each(function(){$(this).on("change",function(){e(n,o)})})})}function addEnableToggleBehavior(){$("[data-behavior='enable-feature']").each(function(){var t=$(this),e=$($(this).data("target"));t.on("change",function(){$(this).is(":checked")?e.find("input:checkbox").not("[data-behavior='enable-feature']").prop("checked",!0).attr("disabled",!1):e.find("input:checkbox").not("[data-behavior='enable-feature']").prop("checked",!1).attr("disabled",!0)})})}function observedForms(){return $("[data-form-observer]")}function serializeObservedForms(t){t.each(function(){serializeFormStatus($(this)),unbindObservedFormSubmit()})}function unbindObservedFormSubmit(){observedForms().each(function(){$(this).on("submit",function(){$(this).data("being-submitted",!0)})})}function serializeFormStatus(t){t.data("serialized-form",formSerialization(t))}function formSerialization(t){var e=[],n=0;return $("[contenteditable='true']",t).each(function(){e.push("&contenteditable_"+n+"="+$(this).text())}),t.serialize()+e.join()}function serializedFormStatus(t){return t.data("serialized-form")}function observedFormsStatusHasChanged(){var t=!1;return observedForms().each(function(){$(this).data("being-submitted")||serializedFormStatus($(this))!=formSerialization($(this))&&(t=!0)}),t}function itemsBloodhound(){var t=new Bloodhound({datumTokenizer:function(t){return Bloodhound.tokenizers.whitespace(t.title)},queryTokenizer:Bloodhound.tokenizers.whitespace,limit:100,remote:{url:$("form[data-autocomplete-exhibit-catalog-path]").data("autocomplete-exhibit-catalog-path").replace("%25QUERY","%QUERY"),filter:function(t){return $.map(t.docs,function(t){return t})}}});return t.initialize(),t}function itemsTemplate(){return'<div class="autocomplete-item{{#if private}} blacklight-private{{/if}}">{{#if thumbnail}}<div class="document-thumbnail thumbnail"><img src="{{thumbnail}}" /></div>{{/if}}<span class="autocomplete-title">{{title}}</span><br/><small>&nbsp;&nbsp;{{description}}</small></div>'}function addAutocompletetoFeaturedImage(){$("[data-featured-image-typeahead]").length>0&&$("[data-featured-image-typeahead]").spotlightSearchTypeAhead({bloodhound:itemsBloodhound(),template:itemsTemplate()}).on("click",function(){$(this).select()}).on("typeahead:selected typeahead:autocompleted",function(t,e){var n=$($(this).data("target-panel"));addImageSelector($(this),n,e.iiif_manifest,!0),$($(this).data("id-field")).val(e.global_id),$(this).attr("type","text")})}function addImageSelector(t,e,n,i){if(n){var r=t.data("iiifCropper");$.ajax(n).success(function(o){var a=new(require("spotlight/iiif"))(n,o).imagesArray();hideNonIiifAlert(t),i&&(r.setIiifFields(a[0]),e.multiImageSelector()),a.length>1&&(e.show(),e.multiImageSelector(a,function(t){r.setIiifFields(t)},r.iiifImageField.val()))})}else showNonIiifAlert(t)}function showNonIiifAlert(t){t.parent().prev('[data-behavior="non-iiif-alert"]').show()}function hideNonIiifAlert(t){t.parent().prev('[data-behavior="non-iiif-alert"]').hide()}!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function n(t){var e=!!t&&"length"in t&&t.length,n=pt.type(t);return"function"!==n&&!pt.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}function i(t,e,n){if(pt.isFunction(e))return pt.grep(t,function(t,i){return!!e.call(t,i,t)!==n});if(e.nodeType)return pt.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(kt.test(e))return pt.filter(e,t,n);e=pt.filter(e,t)}return pt.grep(t,function(t){return pt.inArray(t,e)>-1!==n})}function r(t,e){do{t=t[e]}while(t&&1!==t.nodeType);return t}function o(t){var e={};return pt.each(t.match(Pt)||[],function(t,n){e[n]=!0}),e}function a(){rt.addEventListener?(rt.removeEventListener("DOMContentLoaded",s),t.removeEventListener("load",s)):(rt.detachEvent("onreadystatechange",s),t.detachEvent("onload",s))}function s(){(rt.addEventListener||"load"===t.event.type||"complete"===rt.readyState)&&(a(),pt.ready())}function c(t,e,n){if(n===undefined&&1===t.nodeType){var i="data-"+e.replace(Dt,"-$1").toLowerCase();if("string"==typeof(n=t.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:It.test(n)?pt.parseJSON(n):n)}catch(r){}pt.data(t,e,n)}else n=undefined}return n}function u(t){var e;for(e in t)if(("data"!==e||!pt.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function l(t,e,n,i){if(Rt(t)){var r,o,a=pt.expando,s=t.nodeType,c=s?pt.cache:t,u=s?t[a]:t[a]&&a;if(u&&c[u]&&(i||c[u].data)||n!==undefined||"string"!=typeof e)return u||(u=s?t[a]=it.pop()||pt.guid++:a),c[u]||(c[u]=s?{}:{toJSON:pt.noop}),"object"!=typeof e&&"function"!=typeof e||(i?c[u]=pt.extend(c[u],e):c[u].data=pt.extend(c[u].data,e)),o=c[u],i||(o.data||(o.data={}),o=o.data),n!==undefined&&(o[pt.camelCase(e)]=n),"string"==typeof e?null==(r=o[e])&&(r=o[pt.camelCase(e)]):r=o,r}}function h(t,e,n){if(Rt(t)){var i,r,o=t.nodeType,a=o?pt.cache:t,s=o?t[pt.expando]:pt.expando;if(a[s]){if(e&&(i=n?a[s]:a[s].data)){r=(e=pt.isArray(e)?e.concat(pt.map(e,pt.camelCase)):e in i?[e]:(e=pt.camelCase(e))in i?[e]:e.split(" ")).length;for(;r--;)delete i[e[r]];if(n?!u(i):!pt.isEmptyObject(i))return}(n||(delete a[s].data,u(a[s])))&&(o?pt.cleanData([t],!0):dt.deleteExpando||a!=a.window?delete a[s]:a[s]=undefined)}}}function d(t,e,n,i){var r,o=1,a=20,s=i?function(){return i.cur()}:function(){return pt.css(t,e,"")},c=s(),u=n&&n[3]||(pt.cssNumber[e]?"":"px"),l=(pt.cssNumber[e]||"px"!==u&&+c)&&Bt.exec(pt.css(t,e));if(l&&l[3]!==u){u=u||l[3],n=n||[],l=+c||1;do{l/=o=o||".5",pt.style(t,e,l+u)}while(o!==(o=s()/c)&&1!==o&&--a)}return n&&(l=+l||+c||0,r=n[1]?l+(n[1]+1)*n[2]:+n[2],i&&(i.unit=u,i.start=l,i.end=r)),r}function f(t){var e=qt.split("|"),n=t.createDocumentFragment();if(n.createElement)for(;e.length;)n.createElement(e.pop());return n}function p(t,e){var n,i,r=0,o="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll(e||"*"):undefined;if(!o)for(o=[],n=t.childNodes||t;null!=(i=n[r]);r++)!e||pt.nodeName(i,e)?o.push(i):pt.merge(o,p(i,e));return e===undefined||e&&pt.nodeName(t,e)?pt.merge([t],o):o}function m(t,e){for(var n,i=0;null!=(n=t[i]);i++)pt._data(n,"globalEval",!e||pt._data(e[i],"globalEval"))}function g(t){jt.test(t.type)&&(t.defaultChecked=t.checked)}function v(t,e,n,i,r){for(var o,a,s,c,u,l,h,d=t.length,v=f(e),y=[],b=0;b<d;b++)if((a=t[b])||0===a)if("object"===pt.type(a))pt.merge(y,a.nodeType?[a]:a);else if(Vt.test(a)){for(c=c||v.appendChild(e.createElement("div")),u=(Ht.exec(a)||["",""])[1].toLowerCase(),h=Wt[u]||Wt._default,c.innerHTML=h[1]+pt.htmlPrefilter(a)+h[2],o=h[0];o--;)c=c.lastChild;if(!dt.leadingWhitespace&&Ut.test(a)&&y.push(e.createTextNode(Ut.exec(a)[0])),!dt.tbody)for(o=(a="table"!==u||Zt.test(a)?"<table>"!==h[1]||Zt.test(a)?0:c:c.firstChild)&&a.childNodes.length;o--;)pt.nodeName(l=a.childNodes[o],"tbody")&&!l.childNodes.length&&a.removeChild(l);for(pt.merge(y,c.childNodes),c.textContent="";c.firstChild;)c.removeChild(c.firstChild);c=v.lastChild}else y.push(e.createTextNode(a));for(c&&v.removeChild(c),dt.appendChecked||pt.grep(p(y,"input"),g),b=0;a=y[b++];)if(i&&pt.inArray(a,i)>-1)r&&r.push(a);else if(s=pt.contains(a.ownerDocument,a),c=p(v.appendChild(a),"script"),s&&m(c),n)for(o=0;a=c[o++];)$t.test(a.type||"")&&n.push(a);return c=null,v}function y(){return!0}function b(){return!1}function x(){try{return rt.activeElement}catch(t){}}function w(t,e,n,i,r,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=undefined);for(s in e)w(t,s,n,i,e[s],o);return t}if(null==i&&null==r?(r=n,i=n=undefined):null==r&&("string"==typeof n?(r=i,i=undefined):(r=i,i=n,n=undefined)),!1===r)r=b;else if(!r)return t;return 1===o&&(a=r,(r=function(t){return pt().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=pt.guid++)),t.each(function(){pt.event.add(this,e,r,i,n)})}function S(t,e){return pt.nodeName(t,"table")&&pt.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function k(t){return t.type=(null!==pt.find.attr(t,"type"))+"/"+t.type,t}function E(t){var e=re.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function T(t,e){if(1===e.nodeType&&pt.hasData(t)){var n,i,r,o=pt._data(t),a=pt._data(e,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(i=0,r=s[n].length;i<r;i++)pt.event.add(e,n,s[n][i])}a.data&&(a.data=pt.extend({},a.data))}}function C(t,e){var n,i,r;if(1===e.nodeType){if(n=e.nodeName.toLowerCase(),!dt.noCloneEvent&&e[pt.expando]){r=pt._data(e);for(i in r.events)pt.removeEvent(e,i,r.handle);e.removeAttribute(pt.expando)}"script"===n&&e.text!==t.text?(k(e).text=t.text,E(e)):"object"===n?(e.parentNode&&(e.outerHTML=t.outerHTML),dt.html5Clone&&t.innerHTML&&!pt.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===n&&jt.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}}function L(t,e,n,i){e=at.apply([],e);var r,o,a,s,c,u,l=0,h=t.length,d=h-1,f=e[0],m=pt.isFunction(f);if(m||h>1&&"string"==typeof f&&!dt.checkClone&&ie.test(f))return t.each(function(r){var o=t.eq(r);m&&(e[0]=f.call(this,r,o.html())),L(o,e,n,i)});if(h&&(u=v(e,t[0].ownerDocument,!1,t,i),r=u.firstChild,1===u.childNodes.length&&(u=r),r||i)){for(a=(s=pt.map(p(u,"script"),k)).length;l<h;l++)o=u,l!==d&&(o=pt.clone(o,!0,!0),a&&pt.merge(s,p(o,"script"))),n.call(t[l],o,l);if(a)for(c=s[s.length-1].ownerDocument,pt.map(s,E),l=0;l<a;l++)o=s[l],$t.test(o.type||"")&&!pt._data(o,"globalEval")&&pt.contains(c,o)&&(o.src?pt._evalUrl&&pt._evalUrl(o.src):pt.globalEval((o.text||o.textContent||o.innerHTML||"").replace(oe,"")));u=r=null}return t}function P(t,e,n){for(var i,r=e?pt.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||pt.cleanData(p(i)),i.parentNode&&(n&&pt.contains(i.ownerDocument,i)&&m(p(i,"script")),i.parentNode.removeChild(i));return t}function A(t,e){var n=pt(e.createElement(t)).appendTo(e.body),i=pt.css(n[0],"display");return n.detach(),i}function N(t){var e=rt,n=ce[t];return n||("none"!==(n=A(t,e))&&n||((e=((se=(se||pt("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentWindow||se[0].contentDocument).document).write(),e.close(),n=A(t,e),se.detach()),ce[t]=n),n}function R(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}function I(t){if(t in Se)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=we.length;n--;)if((t=we[n]+e)in Se)return t}function D(t,e){for(var n,i,r,o=[],a=0,s=t.length;a<s;a++)(i=t[a]).style&&(o[a]=pt._data(i,"olddisplay"),n=i.style.display,e?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&Ft(i)&&(o[a]=pt._data(i,"olddisplay",N(i.nodeName)))):(r=Ft(i),(n&&"none"!==n||!r)&&pt._data(i,"olddisplay",r?n:pt.css(i,"display"))));for(a=0;a<s;a++)(i=t[a]).style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?o[a]||"":"none"));return t}function O(t,e,n){var i=be.exec(e);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):e}function B(t,e,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===e?1:0,a=0;o<4;o+=2)"margin"===n&&(a+=pt.css(t,n+Mt[o],!0,r)),i?("content"===n&&(a-=pt.css(t,"padding"+Mt[o],!0,r)),"margin"!==n&&(a-=pt.css(t,"border"+Mt[o]+"Width",!0,r))):(a+=pt.css(t,"padding"+Mt[o],!0,r),"padding"!==n&&(a+=pt.css(t,"border"+Mt[o]+"Width",!0,r)));return a}function M(t,e,n){var i=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=fe(t),a=dt.boxSizing&&"border-box"===pt.css(t,"boxSizing",!1,o);if(r<=0||null==r){if(((r=pe(t,e,o))<0||null==r)&&(r=t.style[e]),le.test(r))return r;i=a&&(dt.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+B(t,e,n||(a?"border":"content"),i,o)+"px"}function F(t,e,n,i,r){return new F.prototype.init(t,e,n,i,r)}function z(){return t.setTimeout(function(){ke=undefined}),ke=pt.now()}function j(t,e){var n,i={height:t},r=0;for(e=e?1:0;r<4;r+=2-e)i["margin"+(n=Mt[r])]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function H(t,e,n){for(var i,r=(q.tweeners[e]||[]).concat(q.tweeners["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,e,t))return i}function $(t,e,n){var i,r,o,a,s,c,u,l=this,h={},d=t.style,f=t.nodeType&&Ft(t),p=pt._data(t,"fxshow");n.queue||(null==(s=pt._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,c=s.empty.fire,s.empty.fire=function(){s.unqueued||c()}),s.unqueued++,l.always(function(){l.always(function(){s.unqueued--,pt.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===("none"===(u=pt.css(t,"display"))?pt._data(t,"olddisplay")||N(t.nodeName):u)&&"none"===pt.css(t,"float")&&(dt.inlineBlockNeedsLayout&&"inline"!==N(t.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",dt.shrinkWrapBlocks()||l.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(i in e)if(r=e[i],Te.exec(r)){if(delete e[i],o=o||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!p||p[i]===undefined)continue;f=!0}h[i]=p&&p[i]||pt.style(t,i)}else u=undefined;if(pt.isEmptyObject(h))"inline"===("none"===u?N(t.nodeName):u)&&(d.display=u);else{p?"hidden"in p&&(f=p.hidden):p=pt._data(t,"fxshow",{}),o&&(p.hidden=!f),f?pt(t).show():l.done(function(){pt(t).hide()}),l.done(function(){var e;pt._removeData(t,"fxshow");for(e in h)pt.style(t,e,h[e])});for(i in h)a=H(f?p[i]:0,i,l),i in p||(p[i]=a.start,f&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function U(t,e){var n,i,r,o,a;for(n in t)if(i=pt.camelCase(n),r=e[i],o=t[n],pt.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(a=pt.cssHooks[i])&&"expand"in a){o=a.expand(o),delete t[i];for(n in o)n in t||(t[n]=o[n],e[n]=r)}else e[i]=r}function q(t,e,n){var i,r,o=0,a=q.prefilters.length,s=pt.Deferred().always(function(){delete c.elem}),c=function(){if(r)return!1;for(var e=ke||z(),n=Math.max(0,u.startTime+u.duration-e),i=1-(n/u.duration||0),o=0,a=u.tweens.length;o<a;o++)u.tweens[o].run(i);return s.notifyWith(t,[u,i,n]),i<1&&a?n:(s.resolveWith(t,[u]),!1)},u=s.promise({elem:t,props:pt.extend({},e),opts:pt.extend(!0,{specialEasing:{},easing:pt.easing._default},n),originalProperties:e,originalOptions:n,startTime:ke||z(),duration:n.duration,tweens:[],createTween:function(e,n){var i=pt.Tween(t,u.opts,e,n,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(i),i},stop:function(e){var n=0,i=e?u.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)u.tweens[n].run(1);return e?(s.notifyWith(t,[u,1,0]),s.resolveWith(t,[u,e])):s.rejectWith(t,[u,e]),this}}),l=u.props;for(U(l,u.opts.specialEasing);o<a;o++)if(i=q.prefilters[o].call(u,t,l,u.opts))return pt.isFunction(i.stop)&&(pt._queueHooks(u.elem,u.opts.queue).stop=pt.proxy(i.stop,i)),i;return pt.map(l,H,u),pt.isFunction(u.opts.start)&&u.opts.start.call(t,u),pt.fx.timer(pt.extend(c,{elem:t,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function W(t){return pt.attr(t,"class")||""}function V(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(Pt)||[];if(pt.isFunction(n))for(;i=o[r++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function Z(t,e,n,i){function r(s){var c;return o[s]=!0,pt.each(t[s]||[],function(t,s){var u=s(e,n,i);return"string"!=typeof u||a||o[u]?a?!(c=u):void 0:(e.dataTypes.unshift(u),r(u),!1)}),c}var o={},a=t===Ye;return r(e.dataTypes[0])||!o["*"]&&r("*")}function G(t,e){var n,i,r=pt.ajaxSettings.flatOptions||{};for(i in e)e[i]!==undefined&&((r[i]?t:n||(n={}))[i]=e[i]);return n&&pt.extend(!0,t,n),t}function K(t,e,n){for(var i,r,o,a,s=t.contents,c=t.dataTypes;"*"===c[0];)c.shift(),r===undefined&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){c.unshift(a);break}if(c[0]in n)o=c[0];else{for(a in n){if(!c[0]||t.converters[a+" "+c[0]]){o=a;break}i||(i=a)}o=o||i}if(o)return o!==c[0]&&c.unshift(o),n[o]}function X(t,e,n,i){var r,o,a,s,c,u={},l=t.dataTypes.slice();if(l[1])for(a in t.converters)u[a.toLowerCase()]=t.converters[a];for(o=l.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!c&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),c=o,o=l.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(!(a=u[c+" "+o]||u["* "+o]))for(r in u)if((s=r.split(" "))[1]===o&&(a=u[c+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[r]:!0!==u[r]&&(o=s[0],l.unshift(s[1]));break}if(!0!==a)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(h){return{state:"parsererror",error:a?h:"No conversion from "+c+" to "+o}}}return{state:"success",data:e}}function Y(t){return t.style&&t.style.display||pt.css(t,"display")}function Q(t){if(!pt.contains(t.ownerDocument||rt,t))return!0;for(;t&&1===t.nodeType;){if("none"===Y(t)||"hidden"===t.type)return!0;t=t.parentNode}return!1}function J(t,e,n,i){var r;if(pt.isArray(e))pt.each(e,function(e,r){n||nn.test(t)?i(t,r):J(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)});else if(n||"object"!==pt.type(e))i(t,e);else for(r in e)J(t+"["+r+"]",e[r],n,i)}function tt(){try{return new t.XMLHttpRequest}catch(e){}}function et(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function nt(t){return pt.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}var it=[],rt=t.document,ot=it.slice,at=it.concat,st=it.push,ct=it.indexOf,ut={},lt=ut.toString,ht=ut.hasOwnProperty,dt={},ft="1.12.4",pt=function(t,e){return new pt.fn.init(t,e)},mt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,gt=/^-ms-/,vt=/-([\da-z])/gi,yt=function(t,e){return e.toUpperCase()};pt.fn=pt.prototype={jquery:ft,constructor:pt,selector:"",length:0,toArray:function(){return ot.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:ot.call(this)},pushStack:function(t){var e=pt.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return pt.each(this,t)},map:function(t){return this.pushStack(pt.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(ot.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:st,sort:it.sort,splice:it.splice},pt.extend=pt.fn.extend=function(){var t,e,n,i,r,o,a=arguments[0]||{},s=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||pt.isFunction(a)||(a={}),s===c&&(a=this,s--);s<c;s++)if(null!=(r=arguments[s]))for(i in r)t=a[i],a!==(n=r[i])&&(u&&n&&(pt.isPlainObject(n)||(e=pt.isArray(n)))?(e?(e=!1,o=t&&pt.isArray(t)?t:[]):o=t&&pt.isPlainObject(t)?t:{},a[i]=pt.extend(u,o,n)):n!==undefined&&(a[i]=n));return a},pt.extend({expando:"jQuery"+(ft+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===pt.type(t)},isArray:Array.isArray||function(t){return"array"===pt.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){var e=t&&t.toString();return!pt.isArray(t)&&e-parseFloat(e)+1>=0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){var e;if(!t||"object"!==pt.type(t)||t.nodeType||pt.isWindow(t))return!1;try{if(t.constructor&&!ht.call(t,"constructor")&&!ht.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(!dt.ownFirst)for(e in t)return ht.call(t,e);for(e in t);return e===undefined||ht.call(t,e)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?ut[lt.call(t)]||"object":typeof t},globalEval:function(e){e&&pt.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(gt,"ms-").replace(vt,yt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,r=0;if(n(t))for(i=t.length;r<i&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(mt,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(n(Object(t))?pt.merge(i,"string"==typeof t?[t]:t):st.call(i,t)),i},inArray:function(t,e,n){var i;if(e){if(ct)return ct.call(e,t,n);for(i=e.length,n=n?n<0?Math.max(0,i+n):n:0;n<i;n++)if(n in e&&e[n]===t)return n}return-1},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;)t[r++]=e[i++];if(n!=n)for(;e[i]!==undefined;)t[r++]=e[i++];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,a=!n;r<o;r++)!e(t[r],r)!==a&&i.push(t[r]);return i},map:function(t,e,i){var r,o,a=0,s=[];if(n(t))for(r=t.length;a<r;a++)null!=(o=e(t[a],a,i))&&s.push(o);else for(a in t)null!=(o=e(t[a],a,i))&&s.push(o);return at.apply([],s)},guid:1,proxy:function(t,e){var n,i,r;return"string"==typeof e&&(r=t[e],e=t,t=r),pt.isFunction(t)?(n=ot.call(arguments,2),i=function(){return t.apply(e||this,n.concat(ot.call(arguments)))},i.guid=t.guid=t.guid||pt.guid++,i):undefined},now:function(){return+new Date},support:dt}),"function"==typeof Symbol&&(pt.fn[Symbol.iterator]=it[Symbol.iterator]),pt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){ut["[object "+e+"]"]=e.toLowerCase()});var bt=function(t){function e(t,e,n,i){var r,o,a,s,c,u,h,f,p=e&&e.ownerDocument,m=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==m&&9!==m&&11!==m)return n;if(!i&&((e?e.ownerDocument||e:j)!==R&&N(e),e=e||R,D)){if(11!==m&&(u=vt.exec(t)))if(r=u[1]){if(9===m){if(!(a=e.getElementById(r)))return n;if(a.id===r)return n.push(a),n}else if(p&&(a=p.getElementById(r))&&F(e,a)&&a.id===r)return n.push(a),n}else{if(u[2])return Q.apply(n,e.getElementsByTagName(t)),n;if((r=u[3])&&x.getElementsByClassName&&e.getElementsByClassName)return Q.apply(n,e.getElementsByClassName(r)),n}if(x.qsa&&!W[t+" "]&&(!O||!O.test(t))){if(1!==m)p=e,f=t;else if("object"!==e.nodeName.toLowerCase()){for((s=e.getAttribute("id"))?s=s.replace(bt,"\\$&"):e.setAttribute("id",s=z),o=(h=E(t)).length,c=dt.test(s)?"#"+s:"[id='"+s+"']";o--;)h[o]=c+" "+d(h[o]);f=h.join(","),p=yt.test(t)&&l(e.parentNode)||e}if(f)try{return Q.apply(n,p.querySelectorAll(f)),n}catch(g){}finally{s===z&&e.removeAttribute("id")}}}return C(t.replace(st,"$1"),e,n,i)}function n(){function t(n,i){return e.push(n+" ")>w.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function i(t){return t[z]=!0,t}function r(t){var e=R.createElement("div");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var n=t.split("|"),i=n.length;i--;)w.attrHandle[n[i]]=e}function a(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||Z)-(~t.sourceIndex||Z);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function s(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function c(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function u(t){return i(function(e){return e=+e,i(function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function l(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function h(){}function d(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function f(t,e,n){var i=e.dir,r=n&&"parentNode"===i,o=$++;return e.first?function(e,n,o){for(;e=e[i];)if(1===e.nodeType||r)return t(e,n,o)}:function(e,n,a){var s,c,u,l=[H,o];if(a){for(;e=e[i];)if((1===e.nodeType||r)&&t(e,n,a))return!0}else for(;e=e[i];)if(1===e.nodeType||r){if(u=e[z]||(e[z]={}),c=u[e.uniqueID]||(u[e.uniqueID]={}),(s=c[i])&&s[0]===H&&s[1]===o)return l[2]=s[2];if(c[i]=l,l[2]=t(e,n,a))return!0}}}function p(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function m(t,n,i){for(var r=0,o=n.length;r<o;r++)e(t,n[r],i);return i}function g(t,e,n,i,r){for(var o,a=[],s=0,c=t.length,u=null!=e;s<c;s++)(o=t[s])&&(n&&!n(o,i,r)||(a.push(o),u&&e.push(s)));return a}function v(t,e,n,r,o,a){return r&&!r[z]&&(r=v(r)),o&&!o[z]&&(o=v(o,a)),i(function(i,a,s,c){var u,l,h,d=[],f=[],p=a.length,v=i||m(e||"*",s.nodeType?[s]:s,[]),y=!t||!i&&e?v:g(v,d,t,s,c),b=n?o||(i?t:p||r)?[]:a:y;if(n&&n(y,b,s,c),r)for(u=g(b,f),r(u,[],s,c),l=u.length;l--;)(h=u[l])&&(b[f[l]]=!(y[f[l]]=h));if(i){if(o||t){if(o){for(u=[],l=b.length;l--;)(h=b[l])&&u.push(y[l]=h);o(null,b=[],u,c)}for(l=b.length;l--;)(h=b[l])&&(u=o?tt(i,h):d[l])>-1&&(i[u]=!(a[u]=h))}}else b=g(b===a?b.splice(p,b.length):b),o?o(null,a,b,c):Q.apply(a,b)})}function y(t){for(var e,n,i,r=t.length,o=w.relative[t[0].type],a=o||w.relative[" "],s=o?1:0,c=f(function(t){return t===e},a,!0),u=f(function(t){return tt(e,t)>-1},a,!0),l=[function(t,n,i){var r=!o&&(i||n!==L)||((e=n).nodeType?c(t,n,i):u(t,n,i));return e=null,r}];s<r;s++)if(n=w.relative[t[s].type])l=[f(p(l),n)];else{if((n=w.filter[t[s].type].apply(null,t[s].matches))[z]){for(i=++s;i<r&&!w.relative[t[i].type];i++);return v(s>1&&p(l),s>1&&d(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(st,"$1"),n,s<i&&y(t.slice(s,i)),i<r&&y(t=t.slice(i)),i<r&&d(t))}l.push(n)}return p(l)}function b(t,n){var r=n.length>0,o=t.length>0,a=function(i,a,s,c,u){var l,h,d,f=0,p="0",m=i&&[],v=[],y=L,b=i||o&&w.find.TAG("*",u),_=H+=null==y?1:Math.random()||.1,x=b.length;for(u&&(L=a===R||a||u);p!==x&&null!=(l=b[p]);p++){if(o&&l){for(h=0,a||l.ownerDocument===R||(N(l),s=!D);d=t[h++];)if(d(l,a||R,s)){c.push(l);break}u&&(H=_)}r&&((l=!d&&l)&&f--,i&&m.push(l))}if(f+=p,r&&p!==f){for(h=0;d=n[h++];)d(m,v,a,s);if(i){if(f>0)for(;p--;)m[p]||v[p]||(v[p]=X.call(c));v=g(v)}Q.apply(c,v),u&&!i&&v.length>0&&f+n.length>1&&e.uniqueSort(c)}return u&&(H=_,L=y),m};return r?i(a):a}var _,x,w,S,k,E,T,C,L,P,A,N,R,I,D,O,B,M,F,z="sizzle"+1*new Date,j=t.document,H=0,$=0,U=n(),q=n(),W=n(),V=function(t,e){return t===e&&(A=!0),0},Z=1<<31,G={}.hasOwnProperty,K=[],X=K.pop,Y=K.push,Q=K.push,J=K.slice,tt=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",rt="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+it+"))|)"+nt+"*\\]",ot=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+rt+")*)|.*)\\)|)",at=new RegExp(nt+"+","g"),st=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ct=new RegExp("^"+nt+"*,"+nt+"*"),ut=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),lt=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),ht=new RegExp(ot),dt=new RegExp("^"+it+"$"),ft={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it+"|[*])"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+ot),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},pt=/^(?:input|select|textarea|button)$/i,mt=/^h\d$/i,gt=/^[^{]+\{\s*\[native \w/,vt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,bt=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),xt=function(t,e,n){var i="0x"+e-65536;return i!=i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},wt=function(){N()};try{Q.apply(K=J.call(j.childNodes),j.childNodes),K[j.childNodes.length].nodeType}catch(St){Q={apply:K.length?function(t,e){Y.apply(t,J.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}x=e.support={},k=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},N=e.setDocument=function(t){var e,n,i=t?t.ownerDocument||t:j;return i!==R&&9===i.nodeType&&i.documentElement?(R=i,I=R.documentElement,D=!k(R),(n=R.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",wt,!1):n.attachEvent&&n.attachEvent("onunload",wt)),x.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),x.getElementsByTagName=r(function(t){return t.appendChild(R.createComment("")),!t.getElementsByTagName("*").length}),x.getElementsByClassName=gt.test(R.getElementsByClassName),x.getById=r(function(t){return I.appendChild(t).id=z,!R.getElementsByName||!R.getElementsByName(z).length}),x.getById?(w.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&D){var n=e.getElementById(t);return n?[n]:[]}},w.filter.ID=function(t){var e=t.replace(_t,xt);return function(t){return t.getAttribute("id")===e}}):(delete w.find.ID,w.filter.ID=function(t){var e=t.replace(_t,xt);return function(t){var n="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),w.find.TAG=x.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):x.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},w.find.CLASS=x.getElementsByClassName&&function(t,e){if("undefined"!=typeof e.getElementsByClassName&&D)return e.getElementsByClassName(t)},B=[],O=[],(x.qsa=gt.test(R.querySelectorAll))&&(r(function(t){I.appendChild(t).innerHTML="<a id='"+z+"'></a><select id='"+z+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]="+nt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||O.push("\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+z+"-]").length||O.push("~="),t.querySelectorAll(":checked").length||O.push(":checked"),t.querySelectorAll("a#"+z+"+*").length||O.push(".#.+[+~]")}),r(function(t){var e=R.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&O.push("name"+nt+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),O.push(",.*:")})),(x.matchesSelector=gt.test(M=I.matches||I.webkitMatchesSelector||I.mozMatchesSelector||I.oMatchesSelector||I.msMatchesSelector))&&r(function(t){x.disconnectedMatch=M.call(t,"div"),M.call(t,"[s!='']:x"),B.push("!=",ot)}),O=O.length&&new RegExp(O.join("|")),B=B.length&&new RegExp(B.join("|")),e=gt.test(I.compareDocumentPosition),F=e||gt.test(I.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},V=e?function(t,e){if(t===e)return A=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!x.sortDetached&&e.compareDocumentPosition(t)===n?t===R||t.ownerDocument===j&&F(j,t)?-1:e===R||e.ownerDocument===j&&F(j,e)?1:P?tt(P,t)-tt(P,e):0:4&n?-1:1)}:function(t,e){if(t===e)return A=!0,0
;var n,i=0,r=t.parentNode,o=e.parentNode,s=[t],c=[e];if(!r||!o)return t===R?-1:e===R?1:r?-1:o?1:P?tt(P,t)-tt(P,e):0;if(r===o)return a(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)c.unshift(n);for(;s[i]===c[i];)i++;return i?a(s[i],c[i]):s[i]===j?-1:c[i]===j?1:0},R):R},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==R&&N(t),n=n.replace(lt,"='$1']"),x.matchesSelector&&D&&!W[n+" "]&&(!B||!B.test(n))&&(!O||!O.test(n)))try{var i=M.call(t,n);if(i||x.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(St){}return e(n,R,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==R&&N(t),F(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==R&&N(t);var n=w.attrHandle[e.toLowerCase()],i=n&&G.call(w.attrHandle,e.toLowerCase())?n(t,e,!D):undefined;return i!==undefined?i:x.attributes||!D?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],i=0,r=0;if(A=!x.detectDuplicates,P=!x.sortStable&&t.slice(0),t.sort(V),A){for(;e=t[r++];)e===t[r]&&(i=n.push(r));for(;i--;)t.splice(n[i],1)}return P=null,t},S=e.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=S(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i++];)n+=S(e);return n},(w=e.selectors={cacheLength:50,createPseudo:i,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(_t,xt),t[3]=(t[3]||t[4]||t[5]||"").replace(_t,xt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return ft.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&ht.test(n)&&(e=E(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(_t,xt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=U[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&U(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,n,i){return function(r){var o=e.attr(r,t);return null==o?"!="===n:!n||(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o.replace(at," ")+" ").indexOf(i)>-1:"|="===n&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,c){var u,l,h,d,f,p,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!c&&!s,b=!1;if(g){if(o){for(;m;){for(d=e;d=d[m];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?g.firstChild:g.lastChild],a&&y){for(b=(f=(u=(l=(h=(d=g)[z]||(d[z]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===H&&u[1])&&u[2],d=f&&g.childNodes[f];d=++f&&d&&d[m]||(b=f=0)||p.pop();)if(1===d.nodeType&&++b&&d===e){l[t]=[H,f,b];break}}else if(y&&(b=f=(u=(l=(h=(d=e)[z]||(d[z]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===H&&u[1]),!1===b)for(;(d=++f&&d&&d[m]||(b=f=0)||p.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++b||(y&&((l=(h=d[z]||(d[z]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[H,b]),d!==e)););return(b-=r)===i||b%i==0&&b/i>=0}}},PSEUDO:function(t,n){var r,o=w.pseudos[t]||w.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[z]?o(n):o.length>1?(r=[t,t,"",n],w.setFilters.hasOwnProperty(t.toLowerCase())?i(function(t,e){for(var i,r=o(t,n),a=r.length;a--;)t[i=tt(t,r[a])]=!(e[i]=r[a])}):function(t){return o(t,0,r)}):o}},pseudos:{not:i(function(t){var e=[],n=[],r=T(t.replace(st,"$1"));return r[z]?i(function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}}),has:i(function(t){return function(n){return e(t,n).length>0}}),contains:i(function(t){return t=t.replace(_t,xt),function(e){return(e.textContent||e.innerText||S(e)).indexOf(t)>-1}}),lang:i(function(t){return dt.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(_t,xt).toLowerCase(),function(e){var n;do{if(n=D?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===I},focus:function(t){return t===R.activeElement&&(!R.hasFocus||R.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!w.pseudos.empty(t)},header:function(t){return mt.test(t.nodeName)},input:function(t){return pt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:u(function(){return[0]}),last:u(function(t,e){return[e-1]}),eq:u(function(t,e,n){return[n<0?n+e:n]}),even:u(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:u(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:u(function(t,e,n){for(var i=n<0?n+e:n;--i>=0;)t.push(i);return t}),gt:u(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}}).pseudos.nth=w.pseudos.eq;for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[_]=s(_);for(_ in{submit:!0,reset:!0})w.pseudos[_]=c(_);return h.prototype=w.filters=w.pseudos,w.setFilters=new h,E=e.tokenize=function(t,n){var i,r,o,a,s,c,u,l=q[t+" "];if(l)return n?0:l.slice(0);for(s=t,c=[],u=w.preFilter;s;){i&&!(r=ct.exec(s))||(r&&(s=s.slice(r[0].length)||s),c.push(o=[])),i=!1,(r=ut.exec(s))&&(i=r.shift(),o.push({value:i,type:r[0].replace(st," ")}),s=s.slice(i.length));for(a in w.filter)!(r=ft[a].exec(s))||u[a]&&!(r=u[a](r))||(i=r.shift(),o.push({value:i,type:a,matches:r}),s=s.slice(i.length));if(!i)break}return n?s.length:s?e.error(t):q(t,c).slice(0)},T=e.compile=function(t,e){var n,i=[],r=[],o=W[t+" "];if(!o){for(e||(e=E(t)),n=e.length;n--;)(o=y(e[n]))[z]?i.push(o):r.push(o);(o=W(t,b(r,i))).selector=t}return o},C=e.select=function(t,e,n,i){var r,o,a,s,c,u="function"==typeof t&&t,h=!i&&E(t=u.selector||t);if(n=n||[],1===h.length){if((o=h[0]=h[0].slice(0)).length>2&&"ID"===(a=o[0]).type&&x.getById&&9===e.nodeType&&D&&w.relative[o[1].type]){if(!(e=(w.find.ID(a.matches[0].replace(_t,xt),e)||[])[0]))return n;u&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=ft.needsContext.test(t)?0:o.length;r--&&(a=o[r],!w.relative[s=a.type]);)if((c=w.find[s])&&(i=c(a.matches[0].replace(_t,xt),yt.test(o[0].type)&&l(e.parentNode)||e))){if(o.splice(r,1),!(t=i.length&&d(o)))return Q.apply(n,i),n;break}}return(u||T(t,h))(i,e,!D,n,!e||yt.test(t)&&l(e.parentNode)||e),n},x.sortStable=z.split("").sort(V).join("")===z,x.detectDuplicates=!!A,N(),x.sortDetached=r(function(t){return 1&t.compareDocumentPosition(R.createElement("div"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),x.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(et,function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),e}(t);pt.find=bt,pt.expr=bt.selectors,pt.expr[":"]=pt.expr.pseudos,pt.uniqueSort=pt.unique=bt.uniqueSort,pt.text=bt.getText,pt.isXMLDoc=bt.isXML,pt.contains=bt.contains;var _t=function(t,e,n){for(var i=[],r=n!==undefined;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&pt(t).is(n))break;i.push(t)}return i},xt=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},wt=pt.expr.match.needsContext,St=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,kt=/^.[^:#\[\.,]*$/;pt.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?pt.find.matchesSelector(i,t)?[i]:[]:pt.find.matches(t,pt.grep(e,function(t){return 1===t.nodeType}))},pt.fn.extend({find:function(t){var e,n=[],i=this,r=i.length;if("string"!=typeof t)return this.pushStack(pt(t).filter(function(){for(e=0;e<r;e++)if(pt.contains(i[e],this))return!0}));for(e=0;e<r;e++)pt.find(t,i[e],n);return n=this.pushStack(r>1?pt.unique(n):n),n.selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(i(this,t||[],!1))},not:function(t){return this.pushStack(i(this,t||[],!0))},is:function(t){return!!i(this,"string"==typeof t&&wt.test(t)?pt(t):t||[],!1).length}});var Et,Tt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(pt.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||Et,"string"==typeof t){if(!(i="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:Tt.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof pt?e[0]:e,pt.merge(this,pt.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:rt,!0)),St.test(i[1])&&pt.isPlainObject(e))for(i in e)pt.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}if((r=rt.getElementById(i[2]))&&r.parentNode){if(r.id!==i[2])return Et.find(t);this.length=1,this[0]=r}return this.context=rt,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):pt.isFunction(t)?"undefined"!=typeof n.ready?n.ready(t):t(pt):(t.selector!==undefined&&(this.selector=t.selector,this.context=t.context),pt.makeArray(t,this))}).prototype=pt.fn,Et=pt(rt);var Ct=/^(?:parents|prev(?:Until|All))/,Lt={children:!0,contents:!0,next:!0,prev:!0};pt.fn.extend({has:function(t){var e,n=pt(t,this),i=n.length;return this.filter(function(){for(e=0;e<i;e++)if(pt.contains(this,n[e]))return!0})},closest:function(t,e){for(var n,i=0,r=this.length,o=[],a=wt.test(t)||"string"!=typeof t?pt(t,e||this.context):0;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&pt.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?pt.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?pt.inArray(this[0],pt(t)):pt.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(pt.uniqueSort(pt.merge(this.get(),pt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),pt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return _t(t,"parentNode")},parentsUntil:function(t,e,n){return _t(t,"parentNode",n)},next:function(t){return r(t,"nextSibling")},prev:function(t){return r(t,"previousSibling")},nextAll:function(t){return _t(t,"nextSibling")},prevAll:function(t){return _t(t,"previousSibling")},nextUntil:function(t,e,n){return _t(t,"nextSibling",n)},prevUntil:function(t,e,n){return _t(t,"previousSibling",n)},siblings:function(t){return xt((t.parentNode||{}).firstChild,t)},children:function(t){return xt(t.firstChild)},contents:function(t){return pt.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:pt.merge([],t.childNodes)}},function(t,e){pt.fn[t]=function(n,i){var r=pt.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=pt.filter(i,r)),this.length>1&&(Lt[t]||(r=pt.uniqueSort(r)),Ct.test(t)&&(r=r.reverse())),this.pushStack(r)}});var Pt=/\S+/g;pt.Callbacks=function(t){t="string"==typeof t?o(t):pt.extend({},t);var e,n,i,r,a=[],s=[],c=-1,u=function(){for(r=t.once,i=e=!0;s.length;c=-1)for(n=s.shift();++c<a.length;)!1===a[c].apply(n[0],n[1])&&t.stopOnFalse&&(c=a.length,n=!1);t.memory||(n=!1),e=!1,r&&(a=n?[]:"")},l={add:function(){return a&&(n&&!e&&(c=a.length-1,s.push(n)),function i(e){pt.each(e,function(e,n){pt.isFunction(n)?t.unique&&l.has(n)||a.push(n):n&&n.length&&"string"!==pt.type(n)&&i(n)})}(arguments),n&&!e&&u()),this},remove:function(){return pt.each(arguments,function(t,e){for(var n;(n=pt.inArray(e,a,n))>-1;)a.splice(n,1),n<=c&&c--}),this},has:function(t){return t?pt.inArray(t,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return r=s=[],a=n="",this},disabled:function(){return!a},lock:function(){return r=!0,n||l.disable(),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],s.push(n),e||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!i}};return l},pt.extend({Deferred:function(t){var e=[["resolve","done",pt.Callbacks("once memory"),"resolved"],["reject","fail",pt.Callbacks("once memory"),"rejected"],["notify","progress",pt.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return pt.Deferred(function(n){pt.each(e,function(e,o){var a=pt.isFunction(t[e])&&t[e];r[o[1]](function(){var t=a&&a.apply(this,arguments);t&&pt.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[o[0]+"With"](this===i?n.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?pt.extend(t,i):i}},r={};return i.pipe=i.then,pt.each(e,function(t,o){var a=o[2],s=o[3];i[o[1]]=a.add,s&&a.add(function(){n=s},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),t&&t.call(r,r),r},when:function(t){var e,n,i,r=0,o=ot.call(arguments),a=o.length,s=1!==a||t&&pt.isFunction(t.promise)?a:0,c=1===s?t:pt.Deferred(),u=function(t,n,i){return function(r){n[t]=this,i[t]=arguments.length>1?ot.call(arguments):r,i===e?c.notifyWith(n,i):--s||c.resolveWith(n,i)}};if(a>1)for(e=new Array(a),n=new Array(a),i=new Array(a);r<a;r++)o[r]&&pt.isFunction(o[r].promise)?o[r].promise().progress(u(r,n,e)).done(u(r,i,o)).fail(c.reject):--s;return s||c.resolveWith(i,o),c.promise()}});var At;pt.fn.ready=function(t){return pt.ready.promise().done(t),this},pt.extend({isReady:!1,readyWait:1,holdReady:function(t){t?pt.readyWait++:pt.ready(!0)},ready:function(t){(!0===t?--pt.readyWait:pt.isReady)||(pt.isReady=!0,!0!==t&&--pt.readyWait>0||(At.resolveWith(rt,[pt]),pt.fn.triggerHandler&&(pt(rt).triggerHandler("ready"),pt(rt).off("ready"))))}}),pt.ready.promise=function(e){if(!At)if(At=pt.Deferred(),"complete"===rt.readyState||"loading"!==rt.readyState&&!rt.documentElement.doScroll)t.setTimeout(pt.ready);else if(rt.addEventListener)rt.addEventListener("DOMContentLoaded",s),t.addEventListener("load",s);else{rt.attachEvent("onreadystatechange",s),t.attachEvent("onload",s);var n=!1;try{n=null==t.frameElement&&rt.documentElement}catch(i){}n&&n.doScroll&&function r(){if(!pt.isReady){try{n.doScroll("left")}catch(i){return t.setTimeout(r,50)}a(),pt.ready()}}()}return At.promise(e)},pt.ready.promise();var Nt;for(Nt in pt(dt))break;dt.ownFirst="0"===Nt,dt.inlineBlockNeedsLayout=!1,pt(function(){var t,e,n,i;(n=rt.getElementsByTagName("body")[0])&&n.style&&(e=rt.createElement("div"),(i=rt.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(e),"undefined"!=typeof e.style.zoom&&(e.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",dt.inlineBlockNeedsLayout=t=3===e.offsetWidth,t&&(n.style.zoom=1)),n.removeChild(i))}),function(){var t=rt.createElement("div");dt.deleteExpando=!0;try{delete t.test}catch(e){dt.deleteExpando=!1}t=null}();var Rt=function(t){var e=pt.noData[(t.nodeName+" ").toLowerCase()],n=+t.nodeType||1;return(1===n||9===n)&&(!e||!0!==e&&t.getAttribute("classid")===e)},It=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Dt=/([A-Z])/g;pt.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return!!(t=t.nodeType?pt.cache[t[pt.expando]]:t[pt.expando])&&!u(t)},data:function(t,e,n){return l(t,e,n)},removeData:function(t,e){return h(t,e)},_data:function(t,e,n){return l(t,e,n,!0)},_removeData:function(t,e){return h(t,e,!0)}}),pt.fn.extend({data:function(t,e){var n,i,r,o=this[0],a=o&&o.attributes;if(t===undefined){if(this.length&&(r=pt.data(o),1===o.nodeType&&!pt._data(o,"parsedAttrs"))){for(n=a.length;n--;)a[n]&&0===(i=a[n].name).indexOf("data-")&&c(o,i=pt.camelCase(i.slice(5)),r[i]);pt._data(o,"parsedAttrs",!0)}return r}return"object"==typeof t?this.each(function(){pt.data(this,t)}):arguments.length>1?this.each(function(){pt.data(this,t,e)}):o?c(o,t,pt.data(o,t)):undefined},removeData:function(t){return this.each(function(){pt.removeData(this,t)})}}),pt.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=pt._data(t,e),n&&(!i||pt.isArray(n)?i=pt._data(t,e,pt.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=pt.queue(t,e),i=n.length,r=n.shift(),o=pt._queueHooks(t,e),a=function(){pt.dequeue(t,e)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,a,o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return pt._data(t,n)||pt._data(t,n,{empty:pt.Callbacks("once memory").add(function(){pt._removeData(t,e+"queue"),pt._removeData(t,n)})})}}),pt.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?pt.queue(this[0],t):e===undefined?this:this.each(function(){var n=pt.queue(this,t,e);pt._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&pt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){pt.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=pt.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=undefined),t=t||"fx";a--;)(n=pt._data(o[a],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(e)}}),function(){var t;dt.shrinkWrapBlocks=function(){if(null!=t)return t;t=!1;var e,n,i;return(n=rt.getElementsByTagName("body")[0])&&n.style?(e=rt.createElement("div"),i=rt.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(e),"undefined"!=typeof e.style.zoom&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(rt.createElement("div")).style.width="5px",t=3!==e.offsetWidth),n.removeChild(i),t):void 0}}();var Ot=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Bt=new RegExp("^(?:([+-])=|)("+Ot+")([a-z%]*)$","i"),Mt=["Top","Right","Bottom","Left"],Ft=function(t,e){return t=e||t,"none"===pt.css(t,"display")||!pt.contains(t.ownerDocument,t)},zt=function(t,e,n,i,r,o,a){var s=0,c=t.length,u=null==n;if("object"===pt.type(n)){r=!0;for(s in n)zt(t,e,s,n[s],!0,o,a)}else if(i!==undefined&&(r=!0,pt.isFunction(i)||(a=!0),u&&(a?(e.call(t,i),e=null):(u=e,e=function(t,e,n){return u.call(pt(t),n)})),e))for(;s<c;s++)e(t[s],n,a?i:i.call(t[s],s,e(t[s],n)));return r?t:u?e.call(t):c?e(t[0],n):o},jt=/^(?:checkbox|radio)$/i,Ht=/<([\w:-]+)/,$t=/^$|\/(?:java|ecma)script/i,Ut=/^\s+/,qt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";!function(){var t=rt.createElement("div"),e=rt.createDocumentFragment(),n=rt.createElement("input");t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",dt.leadingWhitespace=3===t.firstChild.nodeType,dt.tbody=!t.getElementsByTagName("tbody").length,dt.htmlSerialize=!!t.getElementsByTagName("link").length,dt.html5Clone="<:nav></:nav>"!==rt.createElement("nav").cloneNode(!0).outerHTML,n.type="checkbox",n.checked=!0,e.appendChild(n),dt.appendChecked=n.checked,t.innerHTML="<textarea>x</textarea>",dt.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),(n=rt.createElement("input")).setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),dt.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,dt.noCloneEvent=!!t.addEventListener,t[pt.expando]=1,dt.attributes=!t.getAttribute(pt.expando)}();var Wt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:dt.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};Wt.optgroup=Wt.option,Wt.tbody=Wt.tfoot=Wt.colgroup=Wt.caption=Wt.thead,Wt.th=Wt.td;var Vt=/<|&#?\w+;/,Zt=/<tbody/i;!function(){var e,n,i=rt.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})n="on"+e,(dt[e]=n in t)||(i.setAttribute(n,"t"),dt[e]=!1===i.attributes[n].expando);i=null}();var Gt=/^(?:input|select|textarea)$/i,Kt=/^key/,Xt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Yt=/^(?:focusinfocus|focusoutblur)$/,Qt=/^([^.]*)(?:\.(.+)|)/;pt.event={global:{},add:function(t,e,n,i,r){var o,a,s,c,u,l,h,d,f,p,m,g=pt._data(t);if(g){for(n.handler&&(n=(c=n).handler,r=c.selector),n.guid||(n.guid=pt.guid++),(a=g.events)||(a=g.events={}),(l=g.handle)||((l=g.handle=function(t){return void 0===pt||t&&pt.event.triggered===t.type?undefined:pt.event.dispatch.apply(l.elem,arguments)}).elem=t),s=(e=(e||"").match(Pt)||[""]).length;s--;)f=m=(o=Qt.exec(e[s])||[])[1],p=(o[2]||"").split(".").sort(),f&&(u=pt.event.special[f]||{},f=(r?u.delegateType:u.bindType)||f,u=pt.event.special[f]||{},h=pt.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&pt.expr.match.needsContext.test(r),namespace:p.join(".")},c),(d=a[f])||((d=a[f]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(t,i,p,l)||(t.addEventListener?t.addEventListener(f,l,!1):t.attachEvent&&t.attachEvent("on"+f,l))),u.add&&(u.add.call(t,h),h.handler.guid||(h.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,h):d.push(h),pt.event.global[f]=!0);t=null}},remove:function(t,e,n,i,r){var o,a,s,c,u,l,h,d,f,p,m,g=pt.hasData(t)&&pt._data(t);if(g&&(l=g.events)){for(u=(e=(e||"").match(Pt)||[""]).length;u--;)if(s=Qt.exec(e[u])||[],f=m=s[1],p=(s[2]||"").split(".").sort(),f){for(h=pt.event.special[f]||{},d=l[f=(i?h.delegateType:h.bindType)||f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),c=o=d.length;o--;)a=d[o],!r&&m!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(d.splice(o,1),a.selector&&d.delegateCount--,h.remove&&h.remove.call(t,a));c&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,p,g.handle)||pt.removeEvent(t,f,g.handle),delete l[f])}else for(f in l)pt.event.remove(t,f+e[u],n,i,!0);pt.isEmptyObject(l)&&(delete g.handle,pt._removeData(t,"events"))}},trigger:function(e,n,i,r){var o,a,s,c,u,l,h,d=[i||rt],f=ht.call(e,"type")?e.type:e,p=ht.call(e,"namespace")?e.namespace.split("."):[];if(s=l=i=i||rt,3!==i.nodeType&&8!==i.nodeType&&!Yt.test(f+pt.event.triggered)&&(f.indexOf(".")>-1&&(f=(p=f.split(".")).shift(),p.sort()),a=f.indexOf(":")<0&&"on"+f,e=e[pt.expando]?e:new pt.Event(f,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=undefined,e.target||(e.target=i),n=null==n?[e]:pt.makeArray(n,[e]),u=pt.event.special[f]||{},r||!u.trigger||!1!==u.trigger.apply(i,n))){if(!r&&!u.noBubble&&!pt.isWindow(i)){for(c=u.delegateType||f,Yt.test(c+f)||(s=s.parentNode);s;s=s.parentNode)d.push(s),l=s;l===(i.ownerDocument||rt)&&d.push(l.defaultView||l.parentWindow||t)}for(h=0;(s=d[h++])&&!e.isPropagationStopped();)e.type=h>1?c:u.bindType||f,(o=(pt._data(s,"events")||{})[e.type]&&pt._data(s,"handle"))&&o.apply(s,n),(o=a&&s[a])&&o.apply&&Rt(s)&&(e.result=o.apply(s,n),!1===e.result&&e.preventDefault());if(e.type=f,!r&&!e.isDefaultPrevented()&&(!u._default||!1===u._default.apply(d.pop(),n))&&Rt(i)&&a&&i[f]&&!pt.isWindow(i)){(l=i[a])&&(i[a]=null),pt.event.triggered=f;try{i[f]()}catch(m){}pt.event.triggered=undefined,l&&(i[a]=l)}return e.result}},dispatch:function(t){t=pt.event.fix(t);var e,n,i,r,o,a=[],s=ot.call(arguments),c=(pt._data(this,"events")||{})[t.type]||[],u=pt.event.special[t.type]||{};if(s[0]=t,t.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,t)){for(a=pt.event.handlers.call(this,t,c),e=0;(r=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(o.namespace)||(t.handleObj=o,t.data=o.data,(i=((pt.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s))!==undefined&&!1===(t.result=i)&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,i,r,o,a=[],s=e.delegateCount,c=t.target;if(s&&c.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(!0!==c.disabled||"click"!==t.type)){for(i=[],n=0;n<s;n++)i[r=(o=e[n]).selector+" "]===undefined&&(i[r]=o.needsContext?pt(r,this).index(c)>-1:pt.find(r,this,null,[c]).length),i[r]&&i.push(o);i.length&&a.push({elem:c,handlers:i})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},fix:function(t){if(t[pt.expando])return t;var e,n,i,r=t.type,o=t,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=Xt.test(r)?this.mouseHooks:Kt.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,t=new pt.Event(o),e=i.length;e--;)t[n=i[e]]=o[n];return t.target||(t.target=o.srcElement||rt),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,a.filter?a.filter(t,o):t},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,r,o=e.button,a=e.fromElement;return null==t.pageX&&null!=e.clientX&&(r=(i=t.target.ownerDocument||rt).documentElement,n=i.body,t.pageX=e.clientX+(r&&r.scrollLeft||n&&n.scrollLeft||0)-(r&&r.clientLeft||n&&n.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||n&&n.scrollTop||0)-(r&&r.clientTop||n&&n.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?e.toElement:a),t.which||o===undefined||(t.which=1&o?1:2&o?3:4&o?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==x()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){if(this===x()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(pt.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(t){return pt.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==undefined&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n){var i=pt.extend(new pt.Event,n,{type:t,isSimulated:!0});pt.event.trigger(i,null,e),i.isDefaultPrevented()&&n.preventDefault()}},pt.removeEvent=rt.removeEventListener?function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)}:function(t,e,n){var i="on"+e;t.detachEvent&&("undefined"==typeof t[i]&&(t[i]=null),t.detachEvent(i,n))},pt.Event=function(t,e){if(!(this instanceof pt.Event))return new pt.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.defaultPrevented===undefined&&!1===t.returnValue?y:b):this.type=t,e&&pt.extend(this,e),this.timeStamp=t&&t.timeStamp||pt.now(),this[pt.expando]=!0},pt.Event.prototype={constructor:pt.Event,isDefaultPrevented:b,isPropagationStopped:b,isImmediatePropagationStopped:b,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=y,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=y,t&&!this.isSimulated&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=y,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},pt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){pt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===i||pt.contains(i,r))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),dt.submit||(pt.event.special.submit={setup:function(){if(pt.nodeName(this,"form"))return!1;pt.event.add(this,"click._submit keypress._submit",function(t){var e=t.target,n=pt.nodeName(e,"input")||pt.nodeName(e,"button")?pt.prop(e,"form"):undefined;n&&!pt._data(n,"submit")&&(pt.event.add(n,"submit._submit",function(t){t._submitBubble=!0}),pt._data(n,"submit",!0))})},postDispatch:function(t){t._submitBubble&&(delete t._submitBubble,this.parentNode&&!t.isTrigger&&pt.event.simulate("submit",this.parentNode,t))},teardown:function(){if(pt.nodeName(this,"form"))return!1;pt.event.remove(this,"._submit")}}),dt.change||(pt.event.special.change={setup:function(){if(Gt.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(pt.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._justChanged=!0)}),pt.event.add(this,"click._change",function(t){this._justChanged&&!t.isTrigger&&(this._justChanged=!1),pt.event.simulate("change",this,t)})),!1;pt.event.add(this,"beforeactivate._change",function(t){var e=t.target;Gt.test(e.nodeName)&&!pt._data(e,"change")&&(pt.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||pt.event.simulate("change",this.parentNode,t)}),pt._data(e,"change",!0))})},handle:function(t){var e=t.target;if(this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type)return t.handleObj.handler.apply(this,arguments)},teardown:function(){return pt.event.remove(this,"._change"),!Gt.test(this.nodeName)}}),dt.focusin||pt.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){pt.event.simulate(e,t.target,pt.event.fix(t))};pt.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=pt._data(i,e);r||i.addEventListener(t,n,!0),pt._data(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=pt._data(i,e)-1;r?pt._data(i,e,r):(i.removeEventListener(t,n,!0),pt._removeData(i,e))}}}),pt.fn.extend({on:function(t,e,n,i){return w(this,t,e,n,i)},one:function(t,e,n,i){return w(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,pt(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=undefined),!1===n&&(n=b),this.each(function(){pt.event.remove(this,t,n,e)})},trigger:function(t,e){return this.each(function(){pt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return pt.event.trigger(t,e,n,!0)}})
;var Jt=/ jQuery\d+="(?:null|\d+)"/g,te=new RegExp("<(?:"+qt+")[\\s/>]","i"),ee=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ne=/<script|<style|<link/i,ie=/checked\s*(?:[^=]|=\s*.checked.)/i,re=/^true\/(.*)/,oe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ae=f(rt).appendChild(rt.createElement("div"));pt.extend({htmlPrefilter:function(t){return t.replace(ee,"<$1></$2>")},clone:function(t,e,n){var i,r,o,a,s,c=pt.contains(t.ownerDocument,t);if(dt.html5Clone||pt.isXMLDoc(t)||!te.test("<"+t.nodeName+">")?o=t.cloneNode(!0):(ae.innerHTML=t.outerHTML,ae.removeChild(o=ae.firstChild)),!(dt.noCloneEvent&&dt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||pt.isXMLDoc(t)))for(i=p(o),s=p(t),a=0;null!=(r=s[a]);++a)i[a]&&C(r,i[a]);if(e)if(n)for(s=s||p(t),i=i||p(o),a=0;null!=(r=s[a]);a++)T(r,i[a]);else T(t,o);return(i=p(o,"script")).length>0&&m(i,!c&&p(t,"script")),i=s=r=null,o},cleanData:function(t,e){for(var n,i,r,o,a=0,s=pt.expando,c=pt.cache,u=dt.attributes,l=pt.event.special;null!=(n=t[a]);a++)if((e||Rt(n))&&(r=n[s],o=r&&c[r])){if(o.events)for(i in o.events)l[i]?pt.event.remove(n,i):pt.removeEvent(n,i,o.handle);c[r]&&(delete c[r],u||"undefined"==typeof n.removeAttribute?n[s]=undefined:n.removeAttribute(s),it.push(r))}}}),pt.fn.extend({domManip:L,detach:function(t){return P(this,t,!0)},remove:function(t){return P(this,t)},text:function(t){return zt(this,function(t){return t===undefined?pt.text(this):this.empty().append((this[0]&&this[0].ownerDocument||rt).createTextNode(t))},null,t,arguments.length)},append:function(){return L(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){S(this,t).appendChild(t)}})},prepend:function(){return L(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=S(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return L(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return L(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&pt.cleanData(p(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&pt.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return pt.clone(this,t,e)})},html:function(t){return zt(this,function(t){var e=this[0]||{},n=0,i=this.length;if(t===undefined)return 1===e.nodeType?e.innerHTML.replace(Jt,""):undefined;if("string"==typeof t&&!ne.test(t)&&(dt.htmlSerialize||!te.test(t))&&(dt.leadingWhitespace||!Ut.test(t))&&!Wt[(Ht.exec(t)||["",""])[1].toLowerCase()]){t=pt.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(pt.cleanData(p(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return L(this,arguments,function(e){var n=this.parentNode;pt.inArray(this,t)<0&&(pt.cleanData(p(this)),n&&n.replaceChild(e,this))},t)}}),pt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){pt.fn[t]=function(t){for(var n,i=0,r=[],o=pt(t),a=o.length-1;i<=a;i++)n=i===a?this:this.clone(!0),pt(o[i])[e](n),st.apply(r,n.get());return this.pushStack(r)}});var se,ce={HTML:"block",BODY:"block"},ue=/^margin/,le=new RegExp("^("+Ot+")(?!px)[a-z%]+$","i"),he=function(t,e,n,i){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];r=n.apply(t,i||[]);for(o in e)t.style[o]=a[o];return r},de=rt.documentElement;!function(){function e(){var e,l,h=rt.documentElement;h.appendChild(c),u.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",n=r=s=!1,i=a=!0,t.getComputedStyle&&(l=t.getComputedStyle(u),n="1%"!==(l||{}).top,s="2px"===(l||{}).marginLeft,r="4px"===(l||{width:"4px"}).width,u.style.marginRight="50%",i="4px"===(l||{marginRight:"4px"}).marginRight,(e=u.appendChild(rt.createElement("div"))).style.cssText=u.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",u.style.width="1px",a=!parseFloat((t.getComputedStyle(e)||{}).marginRight),u.removeChild(e)),u.style.display="none",(o=0===u.getClientRects().length)&&(u.style.display="",u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",u.childNodes[0].style.borderCollapse="separate",(e=u.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",(o=0===e[0].offsetHeight)&&(e[0].style.display="",e[1].style.display="none",o=0===e[0].offsetHeight)),h.removeChild(c)}var n,i,r,o,a,s,c=rt.createElement("div"),u=rt.createElement("div");u.style&&(u.style.cssText="float:left;opacity:.5",dt.opacity="0.5"===u.style.opacity,dt.cssFloat=!!u.style.cssFloat,u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",dt.clearCloneStyle="content-box"===u.style.backgroundClip,(c=rt.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",u.innerHTML="",c.appendChild(u),dt.boxSizing=""===u.style.boxSizing||""===u.style.MozBoxSizing||""===u.style.WebkitBoxSizing,pt.extend(dt,{reliableHiddenOffsets:function(){return null==n&&e(),o},boxSizingReliable:function(){return null==n&&e(),r},pixelMarginRight:function(){return null==n&&e(),i},pixelPosition:function(){return null==n&&e(),n},reliableMarginRight:function(){return null==n&&e(),a},reliableMarginLeft:function(){return null==n&&e(),s}}))}();var fe,pe,me=/^(top|right|bottom|left)$/;t.getComputedStyle?(fe=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},pe=function(t,e,n){var i,r,o,a,s=t.style;return n=n||fe(t),""!==(a=n?n.getPropertyValue(e)||n[e]:undefined)&&a!==undefined||pt.contains(t.ownerDocument,t)||(a=pt.style(t,e)),n&&!dt.pixelMarginRight()&&le.test(a)&&ue.test(e)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o),a===undefined?a:a+""}):de.currentStyle&&(fe=function(t){return t.currentStyle},pe=function(t,e,n){var i,r,o,a,s=t.style;return n=n||fe(t),null==(a=n?n[e]:undefined)&&s&&s[e]&&(a=s[e]),le.test(a)&&!me.test(e)&&(i=s.left,(o=(r=t.runtimeStyle)&&r.left)&&(r.left=t.currentStyle.left),s.left="fontSize"===e?"1em":a,a=s.pixelLeft+"px",s.left=i,o&&(r.left=o)),a===undefined?a:a+""||"auto"});var ge=/alpha\([^)]*\)/i,ve=/opacity\s*=\s*([^)]*)/i,ye=/^(none|table(?!-c[ea]).+)/,be=new RegExp("^("+Ot+")(.*)$","i"),_e={position:"absolute",visibility:"hidden",display:"block"},xe={letterSpacing:"0",fontWeight:"400"},we=["Webkit","O","Moz","ms"],Se=rt.createElement("div").style;pt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=pe(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":dt.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=pt.camelCase(e),c=t.style;if(e=pt.cssProps[s]||(pt.cssProps[s]=I(s)||s),a=pt.cssHooks[e]||pt.cssHooks[s],n===undefined)return a&&"get"in a&&(r=a.get(t,!1,i))!==undefined?r:c[e];if("string"==(o=typeof n)&&(r=Bt.exec(n))&&r[1]&&(n=d(t,e,r),o="number"),null!=n&&n==n&&("number"===o&&(n+=r&&r[3]||(pt.cssNumber[s]?"":"px")),dt.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),!(a&&"set"in a&&(n=a.set(t,n,i))===undefined)))try{c[e]=n}catch(u){}}},css:function(t,e,n,i){var r,o,a,s=pt.camelCase(e);return e=pt.cssProps[s]||(pt.cssProps[s]=I(s)||s),(a=pt.cssHooks[e]||pt.cssHooks[s])&&"get"in a&&(o=a.get(t,!0,n)),o===undefined&&(o=pe(t,e,i)),"normal"===o&&e in xe&&(o=xe[e]),""===n||n?(r=parseFloat(o),!0===n||isFinite(r)?r||0:o):o}}),pt.each(["height","width"],function(t,e){pt.cssHooks[e]={get:function(t,n,i){if(n)return ye.test(pt.css(t,"display"))&&0===t.offsetWidth?he(t,_e,function(){return M(t,e,i)}):M(t,e,i)},set:function(t,n,i){var r=i&&fe(t);return O(t,n,i?B(t,e,i,dt.boxSizing&&"border-box"===pt.css(t,"boxSizing",!1,r),r):0)}}}),dt.opacity||(pt.cssHooks.opacity={get:function(t,e){return ve.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var n=t.style,i=t.currentStyle,r=pt.isNumeric(e)?"alpha(opacity="+100*e+")":"",o=i&&i.filter||n.filter||"";n.zoom=1,(e>=1||""===e)&&""===pt.trim(o.replace(ge,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===e||i&&!i.filter)||(n.filter=ge.test(o)?o.replace(ge,r):o+" "+r)}}),pt.cssHooks.marginRight=R(dt.reliableMarginRight,function(t,e){if(e)return he(t,{display:"inline-block"},pe,[t,"marginRight"])}),pt.cssHooks.marginLeft=R(dt.reliableMarginLeft,function(t,e){if(e)return(parseFloat(pe(t,"marginLeft"))||(pt.contains(t.ownerDocument,t)?t.getBoundingClientRect().left-he(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}):0))+"px"}),pt.each({margin:"",padding:"",border:"Width"},function(t,e){pt.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+Mt[i]+e]=o[i]||o[i-2]||o[0];return r}},ue.test(t)||(pt.cssHooks[t+e].set=O)}),pt.fn.extend({css:function(t,e){return zt(this,function(t,e,n){var i,r,o={},a=0;if(pt.isArray(e)){for(i=fe(t),r=e.length;a<r;a++)o[e[a]]=pt.css(t,e[a],!1,i);return o}return n!==undefined?pt.style(t,e,n):pt.css(t,e)},t,e,arguments.length>1)},show:function(){return D(this,!0)},hide:function(){return D(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Ft(this)?pt(this).show():pt(this).hide()})}}),pt.Tween=F,F.prototype={constructor:F,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||pt.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(pt.cssNumber[n]?"":"px")},cur:function(){var t=F.propHooks[this.prop];return t&&t.get?t.get(this):F.propHooks._default.get(this)},run:function(t){var e,n=F.propHooks[this.prop];return this.options.duration?this.pos=e=pt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):F.propHooks._default.set(this),this}},F.prototype.init.prototype=F.prototype,F.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=pt.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){pt.fx.step[t.prop]?pt.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[pt.cssProps[t.prop]]&&!pt.cssHooks[t.prop]?t.elem[t.prop]=t.now:pt.style(t.elem,t.prop,t.now+t.unit)}}},F.propHooks.scrollTop=F.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},pt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},pt.fx=F.prototype.init,pt.fx.step={};var ke,Ee,Te=/^(?:toggle|show|hide)$/,Ce=/queueHooks$/;pt.Animation=pt.extend(q,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return d(n.elem,t,Bt.exec(e),n),n}]},tweener:function(t,e){pt.isFunction(t)?(e=t,t=["*"]):t=t.match(Pt);for(var n,i=0,r=t.length;i<r;i++)n=t[i],q.tweeners[n]=q.tweeners[n]||[],q.tweeners[n].unshift(e)},prefilters:[$],prefilter:function(t,e){e?q.prefilters.unshift(t):q.prefilters.push(t)}}),pt.speed=function(t,e,n){var i=t&&"object"==typeof t?pt.extend({},t):{complete:n||!n&&e||pt.isFunction(t)&&t,duration:t,easing:n&&e||e&&!pt.isFunction(e)&&e};return i.duration=pt.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in pt.fx.speeds?pt.fx.speeds[i.duration]:pt.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){pt.isFunction(i.old)&&i.old.call(this),i.queue&&pt.dequeue(this,i.queue)},i},pt.fn.extend({fadeTo:function(t,e,n,i){return this.filter(Ft).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=pt.isEmptyObject(t),o=pt.speed(e,n,i),a=function(){var e=q(this,pt.extend({},t),o);(r||pt._data(this,"finish"))&&e.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=undefined),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=pt.timers,a=pt._data(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&Ce.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||pt.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,n=pt._data(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=pt.timers,a=i?i.length:0;for(n.finish=!0,pt.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<a;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),pt.each(["toggle","show","hide"],function(t,e){var n=pt.fn[e];pt.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(j(e,!0),t,i,r)}}),pt.each({slideDown:j("show"),slideUp:j("hide"),slideToggle:j("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){pt.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),pt.timers=[],pt.fx.tick=function(){var t,e=pt.timers,n=0;for(ke=pt.now();n<e.length;n++)(t=e[n])()||e[n]!==t||e.splice(n--,1);e.length||pt.fx.stop(),ke=undefined},pt.fx.timer=function(t){pt.timers.push(t),t()?pt.fx.start():pt.timers.pop()},pt.fx.interval=13,pt.fx.start=function(){Ee||(Ee=t.setInterval(pt.fx.tick,pt.fx.interval))},pt.fx.stop=function(){t.clearInterval(Ee),Ee=null},pt.fx.speeds={slow:600,fast:200,_default:400},pt.fn.delay=function(e,n){return e=pt.fx?pt.fx.speeds[e]||e:e,n=n||"fx",this.queue(n,function(n,i){var r=t.setTimeout(n,e);i.stop=function(){t.clearTimeout(r)}})},function(){var t,e=rt.createElement("input"),n=rt.createElement("div"),i=rt.createElement("select"),r=i.appendChild(rt.createElement("option"));(n=rt.createElement("div")).setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=n.getElementsByTagName("a")[0],e.setAttribute("type","checkbox"),n.appendChild(e),(t=n.getElementsByTagName("a")[0]).style.cssText="top:1px",dt.getSetAttribute="t"!==n.className,dt.style=/top/.test(t.getAttribute("style")),dt.hrefNormalized="/a"===t.getAttribute("href"),dt.checkOn=!!e.value,dt.optSelected=r.selected,dt.enctype=!!rt.createElement("form").enctype,i.disabled=!0,dt.optDisabled=!r.disabled,(e=rt.createElement("input")).setAttribute("value",""),dt.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),dt.radioValue="t"===e.value}();var Le=/\r/g,Pe=/[\x20\t\r\n\f]+/g;pt.fn.extend({val:function(t){var e,n,i,r=this[0];{if(arguments.length)return i=pt.isFunction(t),this.each(function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,pt(this).val()):t)?r="":"number"==typeof r?r+="":pt.isArray(r)&&(r=pt.map(r,function(t){return null==t?"":t+""})),(e=pt.valHooks[this.type]||pt.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&e.set(this,r,"value")!==undefined||(this.value=r))});if(r)return(e=pt.valHooks[r.type]||pt.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&(n=e.get(r,"value"))!==undefined?n:"string"==typeof(n=r.value)?n.replace(Le,""):null==n?"":n}}}),pt.extend({valHooks:{option:{get:function(t){var e=pt.find.attr(t,"value");return null!=e?e:pt.trim(pt.text(t)).replace(Pe," ")}},select:{get:function(t){for(var e,n,i=t.options,r=t.selectedIndex,o="select-one"===t.type||r<0,a=o?null:[],s=o?r+1:i.length,c=r<0?s:o?r:0;c<s;c++)if(((n=i[c]).selected||c===r)&&(dt.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!pt.nodeName(n.parentNode,"optgroup"))){if(e=pt(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,o=pt.makeArray(e),a=r.length;a--;)if(i=r[a],pt.inArray(pt.valHooks.option.get(i),o)>-1)try{i.selected=n=!0}catch(_){i.scrollHeight}else i.selected=!1;return n||(t.selectedIndex=-1),r}}}}),pt.each(["radio","checkbox"],function(){pt.valHooks[this]={set:function(t,e){if(pt.isArray(e))return t.checked=pt.inArray(pt(t).val(),e)>-1}},dt.checkOn||(pt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Ae,Ne,Re=pt.expr.attrHandle,Ie=/^(?:checked|selected)$/i,De=dt.getSetAttribute,Oe=dt.input;pt.fn.extend({attr:function(t,e){return zt(this,pt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){pt.removeAttr(this,t)})}}),pt.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof t.getAttribute?pt.prop(t,e,n):(1===o&&pt.isXMLDoc(t)||(e=e.toLowerCase(),r=pt.attrHooks[e]||(pt.expr.match.bool.test(e)?Ne:Ae)),n!==undefined?null===n?void pt.removeAttr(t,e):r&&"set"in r&&(i=r.set(t,n,e))!==undefined?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=pt.find.attr(t,e))?undefined:i)},attrHooks:{type:{set:function(t,e){if(!dt.radioValue&&"radio"===e&&pt.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i,r=0,o=e&&e.match(Pt);if(o&&1===t.nodeType)for(;n=o[r++];)i=pt.propFix[n]||n,pt.expr.match.bool.test(n)?Oe&&De||!Ie.test(n)?t[i]=!1:t[pt.camelCase("default-"+n)]=t[i]=!1:pt.attr(t,n,""),t.removeAttribute(De?n:i)}}),Ne={set:function(t,e,n){return!1===e?pt.removeAttr(t,n):Oe&&De||!Ie.test(n)?t.setAttribute(!De&&pt.propFix[n]||n,n):t[pt.camelCase("default-"+n)]=t[n]=!0,n}},pt.each(pt.expr.match.bool.source.match(/\w+/g),function(t,e){var n=Re[e]||pt.find.attr;Oe&&De||!Ie.test(e)?Re[e]=function(t,e,i){var r,o;return i||(o=Re[e],Re[e]=r,r=null!=n(t,e,i)?e.toLowerCase():null,Re[e]=o),r}:Re[e]=function(t,e,n){if(!n)return t[pt.camelCase("default-"+e)]?e.toLowerCase():null}}),Oe&&De||(pt.attrHooks.value={set:function(t,e,n){if(!pt.nodeName(t,"input"))return Ae&&Ae.set(t,e,n);t.defaultValue=e}}),De||(Ae={set:function(t,e,n){var i=t.getAttributeNode(n);if(i||t.setAttributeNode(i=t.ownerDocument.createAttribute(n)),i.value=e+="","value"===n||e===t.getAttribute(n))return e}},Re.id=Re.name=Re.coords=function(t,e,n){var i;if(!n)return(i=t.getAttributeNode(e))&&""!==i.value?i.value:null},pt.valHooks.button={get:function(t,e){var n=t.getAttributeNode(e);if(n&&n.specified)return n.value},set:Ae.set},pt.attrHooks.contenteditable={set:function(t,e,n){Ae.set(t,""!==e&&e,n)}},pt.each(["width","height"],function(t,e){pt.attrHooks[e]={set:function(t,n){if(""===n)return t.setAttribute(e,"auto"),n}}})),dt.style||(pt.attrHooks.style={get:function(t){return t.style.cssText||undefined},set:function(t,e){return t.style.cssText=e+""}});var Be=/^(?:input|select|textarea|button|object)$/i,Me=/^(?:a|area)$/i;pt.fn.extend({prop:function(t,e){return zt(this,pt.prop,t,e,arguments.length>1)},removeProp:function(t){return t=pt.propFix[t]||t,this.each(function(){try{this[t]=undefined,delete this[t]}catch(e){}})}}),pt.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&pt.isXMLDoc(t)||(e=pt.propFix[e]||e,r=pt.propHooks[e]),n!==undefined?r&&"set"in r&&(i=r.set(t,n,e))!==undefined?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=pt.find.attr(t,"tabindex");return e?parseInt(e,10):Be.test(t.nodeName)||Me.test(t.nodeName)&&t.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),dt.hrefNormalized||pt.each(["href","src"],function(t,e){pt.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),dt.optSelected||(pt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),pt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){pt.propFix[this.toLowerCase()]=this}),dt.enctype||(pt.propFix.enctype="encoding");var Fe=/[\t\r\n\f]/g;pt.fn.extend({addClass:function(t){var e,n,i,r,o,a,s,c=0;if(pt.isFunction(t))return this.each(function(e){pt(this).addClass(t.call(this,e,W(this)))});if("string"==typeof t&&t)for(e=t.match(Pt)||[];n=this[c++];)if(r=W(n),i=1===n.nodeType&&(" "+r+" ").replace(Fe," ")){for(a=0;o=e[a++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(s=pt.trim(i))&&pt.attr(n,"class",s)}return this},removeClass:function(t){var e,n,i,r,o,a,s,c=0;if(pt.isFunction(t))return this.each(function(e){pt(this).removeClass(t.call(this,e,W(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(Pt)||[];n=this[c++];)if(r=W(n),i=1===n.nodeType&&(" "+r+" ").replace(Fe," ")){for(a=0;o=e[a++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");r!==(s=pt.trim(i))&&pt.attr(n,"class",s)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):pt.isFunction(t)?this.each(function(n){pt(this).toggleClass(t.call(this,n,W(this),e),e)}):this.each(function(){var e,i,r,o;if("string"===n)for(i=0,r=pt(this),o=t.match(Pt)||[];e=o[i++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else t!==undefined&&"boolean"!==n||((e=W(this))&&pt._data(this,"__className__",e),pt.attr(this,"class",e||!1===t?"":pt._data(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+W(n)+" ").replace(Fe," ").indexOf(e)>-1)return!0;return!1}}),pt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){pt.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),pt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}});var ze=t.location,je=pt.now(),He=/\?/,$e=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;pt.parseJSON=function(e){if(t.JSON&&t.JSON.parse)return t.JSON.parse(e+"");var n,i=null,r=pt.trim(e+"");return r&&!pt.trim(r.replace($e,function(t,e,r,o){return n&&e&&(i=0),0===i?t:(n=r||e,i+=!o-!r,"")}))?Function("return "+r)():pt.error("Invalid JSON: "+e)},pt.parseXML=function(e){var n,i;if(!e||"string"!=typeof e)return null;try{t.DOMParser?(i=new t.DOMParser,n=i.parseFromString(e,"text/xml")):((n=new t.ActiveXObject("Microsoft.XMLDOM")).async="false",n.loadXML(e))}catch(r){n=undefined}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||pt.error("Invalid XML: "+e),n};var Ue=/#.*$/,qe=/([?&])_=[^&]*/,We=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ve=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ze=/^(?:GET|HEAD)$/,Ge=/^\/\//,Ke=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Xe={},Ye={},Qe="*/".concat("*"),Je=ze.href,tn=Ke.exec(Je.toLowerCase())||[];pt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Je,type:"GET",isLocal:Ve.test(tn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Qe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":pt.parseJSON,"text xml":pt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?G(G(t,pt.ajaxSettings),e):G(pt.ajaxSettings,t)},ajaxPrefilter:V(Xe),ajaxTransport:V(Ye),ajax:function(e,n){function i(e,n,i,r){var o,h,y,b,x,S=n;2!==_&&(_=2,c&&t.clearTimeout(c),l=undefined,s=r||"",w.readyState=e>0?4:0,o=e>=200&&e<300||304===e,i&&(b=K(d,w,i)),b=X(d,b,w,o),o?(d.ifModified&&((x=w.getResponseHeader("Last-Modified"))&&(pt.lastModified[a]=x),(x=w.getResponseHeader("etag"))&&(pt.etag[a]=x)),204===e||"HEAD"===d.type?S="nocontent":304===e?S="notmodified":(S=b.state,h=b.data,o=!(y=b.error))):(y=S,!e&&S||(S="error",e<0&&(e=0))),w.status=e,w.statusText=(n||S)+"",o?m.resolveWith(f,[h,S,w]):m.rejectWith(f,[w,S,y]),w.statusCode(v),v=undefined,u&&p.trigger(o?"ajaxSuccess":"ajaxError",[w,d,o?h:y]),g.fireWith(f,[w,S]),u&&(p.trigger("ajaxComplete",[w,d]),--pt.active||pt.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=undefined),n=n||{};var r,o,a,s,c,u,l,h,d=pt.ajaxSetup({},n),f=d.context||d,p=d.context&&(f.nodeType||f.jquery)?pt(f):pt.event,m=pt.Deferred(),g=pt.Callbacks("once memory"),v=d.statusCode||{},y={},b={},_=0,x="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===_){if(!h)for(h={};e=We.exec(s);)h[e[1].toLowerCase()]=e[2];e=h[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===_?s:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return _||(t=b[n]=b[n]||t,y[t]=e),this},overrideMimeType:function(t){return _||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(_<2)for(e in t)v[e]=[v[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||x;return l&&l.abort(e),i(0,e),this}};if(m.promise(w).complete=g.add,w.success=w.done,w.error=w.fail,d.url=((e||d.url||Je)+"").replace(Ue,"").replace(Ge,tn[1]+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=pt.trim(d.dataType||"*").toLowerCase().match(Pt)||[""],null==d.crossDomain&&(r=Ke.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]===tn[1]&&r[2]===tn[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(tn[3]||("http:"===tn[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=pt.param(d.data,d.traditional)),Z(Xe,d,n,w),2===_)return w;(u=pt.event&&d.global)&&0==pt.active++&&pt.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Ze.test(d.type),a=d.url,d.hasContent||(d.data&&(a=d.url+=(He.test(a)?"&":"?")+d.data,delete d.data),!1===d.cache&&(d.url=qe.test(a)?a.replace(qe,"$1_="+je++):a+(He.test(a)?"&":"?")+"_="+je++)),d.ifModified&&(pt.lastModified[a]&&w.setRequestHeader("If-Modified-Since",pt.lastModified[a]),pt.etag[a]&&w.setRequestHeader("If-None-Match",pt.etag[a])),(d.data&&d.hasContent&&!1!==d.contentType||n.contentType)&&w.setRequestHeader("Content-Type",d.contentType),w.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Qe+"; q=0.01":""):d.accepts["*"]);for(o in d.headers)w.setRequestHeader(o,d.headers[o]);if(d.beforeSend&&(!1===d.beforeSend.call(f,w,d)||2===_))return w.abort();x="abort";for(o in{success:1,error:1,complete:1})w[o](d[o]);if(l=Z(Ye,d,n,w)){if(w.readyState=1,u&&p.trigger("ajaxSend",[w,d]),2===_)return w;d.async&&d.timeout>0&&(c=t.setTimeout(function(){w.abort("timeout")},d.timeout));try{_=1,l.send(y,i)}catch(S){if(!(_<2))throw S;i(-1,S)}}else i(-1,"No Transport");return w},getJSON:function(t,e,n){return pt.get(t,e,n,"json")},getScript:function(t,e){return pt.get(t,undefined,e,"script")}}),pt.each(["get","post"],function(t,e){pt[e]=function(t,n,i,r){return pt.isFunction(n)&&(r=r||i,i=n,n=undefined),pt.ajax(pt.extend({url:t,type:e,dataType:r,data:n,success:i},pt.isPlainObject(t)&&t))}}),pt._evalUrl=function(t){return pt.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},pt.fn.extend({wrapAll:function(t){if(pt.isFunction(t))return this.each(function(e){pt(this).wrapAll(t.call(this,e))});if(this[0]){var e=pt(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return pt.isFunction(t)?this.each(function(e){pt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=pt(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=pt.isFunction(t);return this.each(function(n){pt(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){pt.nodeName(this,"body")||pt(this).replaceWith(this.childNodes)}).end()}}),pt.expr.filters.hidden=function(t){return dt.reliableHiddenOffsets()?t.offsetWidth<=0&&t.offsetHeight<=0&&!t.getClientRects().length:Q(t)},pt.expr.filters.visible=function(t){return!pt.expr.filters.hidden(t)};var en=/%20/g,nn=/\[\]$/,rn=/\r?\n/g,on=/^(?:submit|button|image|reset|file)$/i,an=/^(?:input|select|textarea|keygen)/i;pt.param=function(t,e){var n,i=[],r=function(t,e){e=pt.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(e===undefined&&(e=pt.ajaxSettings&&pt.ajaxSettings.traditional),pt.isArray(t)||t.jquery&&!pt.isPlainObject(t))pt.each(t,function(){r(this.name,this.value)});else for(n in t)J(n,t[n],e,r);return i.join("&").replace(en,"+")},pt.fn.extend({serialize:function(){return pt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=pt.prop(this,"elements");return t?pt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!pt(this).is(":disabled")&&an.test(this.nodeName)&&!on.test(t)&&(this.checked||!jt.test(t))}).map(function(t,e){var n=pt(this).val();return null==n?null:pt.isArray(n)?pt.map(n,function(t){return{name:e.name,value:t.replace(rn,"\r\n")}}):{name:e.name,value:n.replace(rn,"\r\n")}}).get()}}),pt.ajaxSettings.xhr=t.ActiveXObject!==undefined?function(){return this.isLocal?et():rt.documentMode>8?tt():/^(get|post|head|put|delete|options)$/i.test(this.type)&&tt()||et()}:tt;var sn=0,cn={},un=pt.ajaxSettings.xhr();t.attachEvent&&t.attachEvent("onunload",function(){for(var t in cn)cn[t](undefined,!0)}),dt.cors=!!un&&"withCredentials"in un,(un=dt.ajax=!!un)&&pt.ajaxTransport(function(e){if(!e.crossDomain||dt.cors){var n;return{send:function(i,r){var o,a=e.xhr(),s=++sn;if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(o in i)i[o]!==undefined&&a.setRequestHeader(o,i[o]+"");a.send(e.hasContent&&e.data||null),n=function(t,i){var o,c,u;if(n&&(i||4===a.readyState))if(delete cn[s],n=undefined,a.onreadystatechange=pt.noop,i)4!==a.readyState&&a.abort();else{u={},o=a.status,"string"==typeof a.responseText&&(u.text=a.responseText);try{c=a.statusText}catch(l){c=""}o||!e.isLocal||e.crossDomain?1223===o&&(o=204):o=u.text?200:404}u&&r(o,c,u,a.getAllResponseHeaders())},e.async?4===a.readyState?t.setTimeout(n):a.onreadystatechange=cn[s]=n:n()},abort:function(){n&&n(undefined,!0)}}}}),pt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return pt.globalEval(t),t}}}),pt.ajaxPrefilter("script",function(t){t.cache===undefined&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),pt.ajaxTransport("script",function(t){if(t.crossDomain){var e,n=rt.head||pt("head")[0]||rt.documentElement;return{send:function(i,r){(e=rt.createElement("script")).async=!0,t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,n){(n||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,n||r(200,"success"))},n.insertBefore(e,n.firstChild)},abort:function(){e&&e.onload(undefined,!0)}}}});var ln=[],hn=/(=)\?(?=&|$)|\?\?/;pt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ln.pop()||pt.expando+"_"+je++;return this[t]=!0,t}}),pt.ajaxPrefilter("json jsonp",function(e,n,i){var r,o,a,s=!1!==e.jsonp&&(hn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&hn.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=pt.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(hn,"$1"+r):!1!==e.jsonp&&(e.url+=(He.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return a||pt.error(r+" was not called"),a[0]},e.dataTypes[0]="json",o=t[r],t[r]=function(){a=arguments},i.always(function(){o===undefined?pt(t).removeProp(r):t[r]=o,e[r]&&(e.jsonpCallback=n.jsonpCallback,ln.push(r)),
a&&pt.isFunction(o)&&o(a[0]),a=o=undefined}),"script"}),pt.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||rt;var i=St.exec(t),r=!n&&[];return i?[e.createElement(i[1])]:(i=v([t],e,r),r&&r.length&&pt(r).remove(),pt.merge([],i.childNodes))};var dn=pt.fn.load;pt.fn.load=function(t,e,n){if("string"!=typeof t&&dn)return dn.apply(this,arguments);var i,r,o,a=this,s=t.indexOf(" ");return s>-1&&(i=pt.trim(t.slice(s,t.length)),t=t.slice(0,s)),pt.isFunction(e)?(n=e,e=undefined):e&&"object"==typeof e&&(r="POST"),a.length>0&&pt.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,a.html(i?pt("<div>").append(pt.parseHTML(t)).find(i):t)}).always(n&&function(t,e){a.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},pt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){pt.fn[e]=function(t){return this.on(e,t)}}),pt.expr.filters.animated=function(t){return pt.grep(pt.timers,function(e){return t===e.elem}).length},pt.offset={setOffset:function(t,e,n){var i,r,o,a,s,c,u=pt.css(t,"position"),l=pt(t),h={};"static"===u&&(t.style.position="relative"),s=l.offset(),o=pt.css(t,"top"),c=pt.css(t,"left"),("absolute"===u||"fixed"===u)&&pt.inArray("auto",[o,c])>-1?(a=(i=l.position()).top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(c)||0),pt.isFunction(e)&&(e=e.call(t,n,pt.extend({},s))),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+r),"using"in e?e.using.call(t,h):l.css(h)}},pt.fn.extend({offset:function(t){if(arguments.length)return t===undefined?this:this.each(function(e){pt.offset.setOffset(this,t,e)});var e,n,i={top:0,left:0},r=this[0],o=r&&r.ownerDocument;if(o)return e=o.documentElement,pt.contains(e,r)?("undefined"!=typeof r.getBoundingClientRect&&(i=r.getBoundingClientRect()),n=nt(o),{top:i.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:i.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):i},position:function(){if(this[0]){var t,e,n={top:0,left:0},i=this[0];return"fixed"===pt.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),pt.nodeName(t[0],"html")||(n=t.offset()),n.top+=pt.css(t[0],"borderTopWidth",!0),n.left+=pt.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-pt.css(i,"marginTop",!0),left:e.left-n.left-pt.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&!pt.nodeName(t,"html")&&"static"===pt.css(t,"position");)t=t.offsetParent;return t||de})}}),pt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n=/Y/.test(e);pt.fn[t]=function(i){return zt(this,function(t,i,r){var o=nt(t);if(r===undefined)return o?e in o?o[e]:o.document.documentElement[i]:t[i];o?o.scrollTo(n?pt(o).scrollLeft():r,n?r:pt(o).scrollTop()):t[i]=r},t,i,arguments.length,null)}}),pt.each(["top","left"],function(t,e){pt.cssHooks[e]=R(dt.pixelPosition,function(t,n){if(n)return n=pe(t,e),le.test(n)?pt(t).position()[e]+"px":n})}),pt.each({Height:"height",Width:"width"},function(t,e){pt.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){pt.fn[i]=function(i,r){var o=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===r?"margin":"border");return zt(this,function(e,n,i){var r;return pt.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):i===undefined?pt.css(e,n,a):pt.style(e,n,i,a)},e,o?i:undefined,o,null)}})}),pt.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),pt.fn.size=function(){return this.length},pt.fn.andSelf=pt.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return pt});var fn=t.jQuery,pn=t.$;return pt.noConflict=function(e){return t.$===pt&&(t.$=pn),e&&t.jQuery===pt&&(t.jQuery=fn),pt},e||(t.jQuery=t.$=pt),pt}),window.TinyMCERails={configuration:{"default":{}},initialize:function(t,e){if("undefined"!=typeof tinyMCE){var n=TinyMCERails.configuration[t||"default"];n=TinyMCERails._merge(n,e),tinyMCE.init(n)}else setTimeout(function(){TinyMCERails.initialize(t,e)},50)},setupTurbolinks:function(){document.addEventListener("turbolinks:before-render",function(){tinymce.remove()})},_merge:function(){for(var t={},e=0;e<arguments.length;++e){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&("[object Object]"===Object.prototype.toString.call(n[i])?t[i]=TinyMCERails._merge(t[i],n[i]):t[i]=n[i])}return t}},"undefined"!=typeof Turbolinks&&Turbolinks.supported&&TinyMCERails.setupTurbolinks(),window.tinymce=window.tinymce||{base:"/assets/tinymce",suffix:""},function(){var t={},e=function(e){for(var n=t[e],r=n.deps,o=n.defn,a=r.length,s=new Array(a),c=0;c<a;++c)s[c]=i(r[c]);var u=o.apply(null,s);if(u===undefined)throw"module ["+e+"] returned undefined";n.instance=u},n=function(e,n,i){if("string"!=typeof e)throw"module id must be a string";if(n===undefined)throw"no dependencies for "+e;if(i===undefined)throw"no definition function for "+e;t[e]={deps:n,defn:i,instance:undefined}},i=function(n){var i=t[n];if(i===undefined)throw"module ["+n+"] was undefined";return i.instance===undefined&&e(n),i.instance},r=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;++o)r[o]=i(t[o]);e.apply(null,r)};({}).bolt={module:{api:{define:n,require:r,demand:i}}};var o=n,a=function(t,e){o(t,[],function(){return e})};a("global!Array",Array),a("global!Error",Error),o("ephox.katamari.api.Fun",["global!Array","global!Error"],function(t,e){var n=function(t){return function(){return t}};return{noop:function(){},compose:function(t,e){return function(){return t(e.apply(null,arguments))}},constant:n,identity:function(t){return t},tripleEquals:function(t,e){return t===e},curry:function(e){for(var n=new t(arguments.length-1),i=1;i<arguments.length;i++)n[i-1]=arguments[i];return function(){for(var i=new t(arguments.length),r=0;r<i.length;r++)i[r]=arguments[r];var o=n.concat(i);return e.apply(null,o)}},not:function(t){return function(){return!t.apply(null,arguments)}},die:function(t){return function(){throw new e(t)}},apply:function(t){return t()},call:function(t){t()},never:n(!1),always:n(!0)}}),a("global!window",window),a("global!Object",Object),o("ephox.katamari.api.Option",["ephox.katamari.api.Fun","global!Object"],function(t,e){var n=t.never,i=t.always,r=function(){return o},o=function(){var o=function(t){return t.isNone()},a=function(t){return t()},s=function(t){return t},c={fold:function(t){return t()},is:n,isSome:n,isNone:i,getOr:s,getOrThunk:a,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},or:s,orThunk:a,map:r,ap:r,each:function(){},bind:r,flatten:r,exists:n,forall:i,filter:r,equals:o,equals_:o,toArray:function(){return[]},toString:t.constant("none()")};return e.freeze&&e.freeze(c),c}(),a=function(t){var e=function(){return t},s=function(){return u},c=function(e){return e(t)},u={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:i,isNone:n,getOr:e,getOrThunk:e,getOrDie:e,or:s,orThunk:s,map:function(e){return a(e(t))},ap:function(e){return e.fold(r,function(e){return a(e(t))})},each:function(e){e(t)},bind:c,flatten:e,exists:c,forall:c,filter:function(e){return e(t)?u:o},equals:function(e){return e.is(t)},equals_:function(e,i){return e.fold(n,function(e){return i(t,e)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return u};return{some:a,none:r,from:function(t){return null===t||t===undefined?o:a(t)}}}),a("global!String",String),o("ephox.katamari.api.Arr",["ephox.katamari.api.Option","global!Array","global!Error","global!String"],function(t,e,n,i){var r=function(){var t=e.prototype.indexOf,n=function(e,n){return t.call(e,n)},i=function(t,e){return _(t,e)};return t===undefined?i:n}(),o=function(e,n){var i=r(e,n);return-1===i?t.none():t.some(i)},a=function(t,e){return r(t,e)>-1},s=function(t,e){return b(t,e).isSome()},c=function(t,e){for(var n=[],i=0;i<t;i++)n.push(e(i));return n},u=function(t,e){for(var n=[],i=0;i<t.length;i+=e){var r=t.slice(i,i+e);n.push(r)}return n},l=function(t,n){for(var i=t.length,r=new e(i),o=0;o<i;o++){var a=t[o];r[o]=n(a,o,t)}return r},h=function(t,e){for(var n=0,i=t.length;n<i;n++){e(t[n],n,t)}},d=function(t,e){for(var n=t.length-1;n>=0;n--){e(t[n],n,t)}},f=function(t,e){for(var n=[],i=[],r=0,o=t.length;r<o;r++){var a=t[r];(e(a,r,t)?n:i).push(a)}return{pass:n,fail:i}},p=function(t,e){for(var n=[],i=0,r=t.length;i<r;i++){var o=t[i];e(o,i,t)&&n.push(o)}return n},m=function(t,e){if(0===t.length)return[];for(var n=e(t[0]),i=[],r=[],o=0,a=t.length;o<a;o++){var s=t[o],c=e(s);c!==n&&(i.push(r),r=[]),n=c,r.push(s)}return 0!==r.length&&i.push(r),i},g=function(t,e,n){return d(t,function(t){n=e(n,t)}),n},v=function(t,e,n){return h(t,function(t){n=e(n,t)}),n},y=function(e,n){for(var i=0,r=e.length;i<r;i++){var o=e[i];if(n(o,i,e))return t.some(o)}return t.none()},b=function(e,n){for(var i=0,r=e.length;i<r;i++){if(n(e[i],i,e))return t.some(i)}return t.none()},_=function(t,e){for(var n=0,i=t.length;n<i;++n)if(t[n]===e)return n;return-1},x=e.prototype.push,w=function(t){for(var i=[],r=0,o=t.length;r<o;++r){if(!e.prototype.isPrototypeOf(t[r]))throw new n("Arr.flatten item "+r+" was not an array, input: "+t);x.apply(i,t[r])}return i},S=function(t,e){var n=l(t,e);return w(n)},k=function(t,e){for(var n=0,i=t.length;n<i;++n){if(!0!==e(t[n],n,t))return!1}return!0},E=function(t,e){return t.length===e.length&&k(t,function(t,n){return t===e[n]})},T=e.prototype.slice;return{map:l,each:h,eachr:d,partition:f,filter:p,groupBy:m,indexOf:o,foldr:g,foldl:v,find:y,findIndex:b,flatten:w,bind:S,forall:k,exists:s,contains:a,equal:E,reverse:function(t){var e=T.call(t,0);return e.reverse(),e},chunk:u,difference:function(t,e){return p(t,function(t){return!a(e,t)})},mapToObject:function(t,e){for(var n={},r=0,o=t.length;r<o;r++){var a=t[r];n[i(a)]=e(a,r)}return n},pure:function(t){return[t]},sort:function(t,e){var n=T.call(t,0);return n.sort(e),n},range:c,head:function(e){return 0===e.length?t.none():t.some(e[0])},last:function(e){return 0===e.length?t.none():t.some(e[e.length-1])}}}),a("global!document",document),o("ephox.katamari.api.Global",[],function(){return"undefined"!=typeof window?window:Function("return this;")()}),o("ephox.katamari.api.Resolve",["ephox.katamari.api.Global"],function(t){var e=function(e,n){for(var i=n!==undefined?n:t,r=0;r<e.length&&i!==undefined&&null!==i;++r)i=i[e[r]];return i},n=function(t,e){return t[e]!==undefined&&null!==t[e]||(t[e]={}),t[e]},i=function(e,i){for(var r=i!==undefined?i:t,o=0;o<e.length;++o)r=n(r,e[o]);return r};return{path:e,resolve:function(t,n){var i=t.split(".");return e(i,n)},forge:i,namespace:function(t,e){var n=t.split(".");return i(n,e)}}}),o("ephox.sand.util.Global",["ephox.katamari.api.Resolve"],function(t){var e=function(e,n){return t.resolve(e,n)};return{getOrDie:function(t,n){var i=e(t,n);if(i===undefined)throw t+" not available on this browser";return i}}}),o("ephox.sand.api.URL",["ephox.sand.util.Global"],function(t){var e=function(){return t.getOrDie("URL")};return{createObjectURL:function(t){return e().createObjectURL(t)},revokeObjectURL:function(t){e().revokeObjectURL(t)}}}),a("global!matchMedia",matchMedia),a("global!navigator",navigator),o("tinymce.core.Env",["ephox.sand.api.URL","global!document","global!matchMedia","global!navigator","global!window"],function(t,e,n,i,r){var o,a,s,c,u,l,h,d,f,p,m,g,v,y=i,b=y.userAgent,_=function(t){return"matchMedia"in r&&n(t).matches};o=r.opera&&r.opera.buildNumber,f=/Android/.test(b),s=(s=!(a=/WebKit/.test(b))&&!o&&/MSIE/gi.test(b)&&/Explorer/gi.test(y.appName))&&/MSIE (\w+)\./.exec(b)[1],c=-1!=b.indexOf("Trident/")&&(-1!=b.indexOf("rv:")||-1!=y.appName.indexOf("Netscape"))&&11,u=-1!=b.indexOf("Edge/")&&!s&&!c&&12,s=s||c||u,l=!a&&!c&&/Gecko/.test(b),h=-1!=b.indexOf("Mac"),d=/(iPad|iPhone)/.test(b),p="FormData"in r&&"FileReader"in r&&"URL"in r&&!!t.createObjectURL,m=_("only screen and (max-device-width: 480px)")&&(f||d),g=_("only screen and (min-width: 800px)")&&(f||d),v=-1!=b.indexOf("Windows Phone"),u&&(a=!1);return{opera:o,webkit:a,ie:s,gecko:l,mac:h,iOS:d,android:f,contentEditable:!d||p||b.match(/AppleWebKit\/(\d*)/)[1]>=534,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:8!=s,range:r.getSelection&&"Range"in r,documentMode:s&&!u?e.documentMode||7:10,fileApi:p,ceFalse:!1===s||s>8,canHaveCSP:!1===s||s>11,desktop:!m&&!g,windowsPhone:v}}),a("global!clearInterval",clearInterval),a("global!clearTimeout",clearTimeout),a("global!setInterval",setInterval),a("global!setTimeout",setTimeout),o("tinymce.core.util.Promise",[],function(){function t(t,e){return function(){t.apply(e,arguments)}}function e(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],s(e,t(i,this),t(r,this))}function n(t){var e=this;null!==this._state?c(function(){var n=e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(r){return void t.reject(r)}t.resolve(i)}else(e._state?t.resolve:t.reject)(e._value)}):this._deferreds.push(t)}function i(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void s(t(n,e),t(i,this),t(r,this))}this._state=!0,this._value=e,o.call(this)}catch(a){r.call(this,a)}}function r(t){this._state=!1,this._value=t,o.call(this)}function o(){for(var t=0,e=this._deferreds.length;t<e;t++)n.call(this,this._deferreds[t]);this._deferreds=null}function a(t,e,n,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=i}function s(t,e,n){var i=!1;try{t(function(t){i||(i=!0,e(t))},function(t){i||(i=!0,n(t))})}catch(r){if(i)return;i=!0,n(r)}}if(window.Promise)return window.Promise;var c=e.immediateFn||"function"==typeof setImmediate&&setImmediate||function(t){setTimeout(t,1)},u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};return e.prototype["catch"]=function(t){return this.then(null,t)},e.prototype.then=function(t,i){var r=this;return new e(function(e,o){n.call(r,new a(t,i,e,o))})},e.all=function(){var t=Array.prototype.slice.call(1===arguments.length&&u(arguments[0])?arguments[0]:arguments);return new e(function(e,n){function i(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){i(o,t)},n)}t[o]=a,0==--r&&e(t)}catch(c){n(c)}}if(0===t.length)return e([]);for(var r=t.length,o=0;o<t.length;o++)i(o,t[o])})},e.resolve=function(t){return t&&"object"==typeof t&&t.constructor===e?t:new e(function(e){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=0,r=t.length;i<r;i++)t[i].then(e,n)})},e}),o("tinymce.core.util.Delay",["global!clearInterval","global!clearTimeout","global!document","global!setInterval","global!setTimeout","global!window","tinymce.core.util.Promise"],function(t,e,n,i,r,o,a){var s,c=function(t,e){var n,i=o.requestAnimationFrame,r=["ms","moz","webkit"],a=function(t){o.setTimeout(t,0)};for(n=0;n<r.length&&!i;n++)i=o[r[n]+"RequestAnimationFrame"];i||(i=a),i(t,e)},u=function(t,e){return"number"!=typeof e&&(e=0),r(t,e)},l=function(t,e){return"number"!=typeof e&&(e=1),i(t,e)},h=function(t,n){var i,r;return r=function(){var r=arguments;e(i),i=u(function(){t.apply(this,r)},n)},r.stop=function(){e(i)},r};return{requestAnimationFrame:function(t,e){s?s.then(t):s=new a(function(t){e||(e=n.body),c(t,e)}).then(t)},setTimeout:u,setInterval:l,setEditorTimeout:function(t,e,n){return u(function(){t.removed||e()},n)},setEditorInterval:function(e,n,i){var r;return r=l(function(){e.removed?t(r):n()},i)},debounce:h,throttle:h,clearInterval:function(e){return t(e)},clearTimeout:function(t){return e(t)}}}),o("tinymce.core.dom.EventUtils",["global!document","global!window","tinymce.core.Env","tinymce.core.util.Delay"],function(t,e,n,i){"use strict";var r="mce-data-",o=/^(?:mouse|contextmenu)|click/,a={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1},s=function(t){return t.isDefaultPrevented===u||t.isDefaultPrevented===c},c=function(){return!1},u=function(){return!0},l=function(t,e,n,i){t.addEventListener?t.addEventListener(e,n,i||!1):t.attachEvent&&t.attachEvent("on"+e,n)},h=function(t,e,n,i){t.removeEventListener?t.removeEventListener(e,n,i||!1):t.detachEvent&&t.detachEvent("on"+e,n)},d=function(t,e){var n,i=e;return(n=t.path)&&n.length>0&&(i=n[0]),t.deepPath&&(n=t.deepPath())&&n.length>0&&(i=n[0]),i},f=function(e,i){var r,l,h=i||{};for(r in e)a[r]||(h[r]=e[r]);if(h.target||(h.target=h.srcElement||t),n.experimentalShadowDom&&(h.target=d(e,h.target)),e&&o.test(e.type)&&e.pageX===l&&e.clientX!==l){var f=h.target.ownerDocument||t,p=f.documentElement,m=f.body;h.pageX=e.clientX+(p&&p.scrollLeft||m&&m.scrollLeft||0)-(p&&p.clientLeft||m&&m.clientLeft||0),h.pageY=e.clientY+(p&&p.scrollTop||m&&m.scrollTop||0)-(p&&p.clientTop||m&&m.clientTop||0)}return h.preventDefault=function(){h.isDefaultPrevented=u,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},h.stopPropagation=function(){h.isPropagationStopped=u,e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},h.stopImmediatePropagation=function(){h.isImmediatePropagationStopped=u,h.stopPropagation()},!1===s(h)&&(h.isDefaultPrevented=c,h.isPropagationStopped=c,h.isImmediatePropagationStopped=c),"undefined"==typeof h.metaKey&&(h.metaKey=!1),h},p=function(t,e,r){var o=t.document,a={type:"ready"};if(r.domLoaded)e(a);else{var s=function(){return"complete"===o.readyState||"interactive"===o.readyState&&o.body},c=function(){r.domLoaded||(r.domLoaded=!0,e(a))},u=function(){s()&&(h(o,"readystatechange",u),c())},d=function(){try{o.documentElement.doScroll("left")}catch(t){return void i.setTimeout(d)}c()};!o.addEventListener||n.ie&&n.ie<11?(l(o,"readystatechange",u),o.documentElement.doScroll&&t.self===t.top&&d()):s()?c():l(t,"DOMContentLoaded",c),l(t,"load",c)}},m=function(){var n,i,o,a,s,c=this,u={};i=r+(+new Date).toString(32),a="onmouseenter"in t.documentElement,o="onfocusin"in t.documentElement,s={mouseenter:"mouseover",mouseleave:"mouseout"},n=1,c.domLoaded=!1,c.events=u;var d=function(t,e){var n,i,r,o,a=u[e];if(n=a&&a[t.type])for(i=0,r=n.length;i<r;i++)if((o=n[i])&&!1===o.func.call(o.scope,t)&&t.preventDefault(),t.isImmediatePropagationStopped())return};c.bind=function(t,r,h,m){var g,v,y,b,_,x,w,S=e,k=function(t){d(f(t||S.event),g)};if(t&&3!==t.nodeType&&8!==t.nodeType){for(t[i]?g=t[i]:(g=n++,t[i]=g,u[g]={}),m=m||t,y=(r=r.split(" ")).length;y--;)x=k,_=w=!1,"DOMContentLoaded"===(b=r[y])&&(b="ready"),c.domLoaded&&"ready"===b&&"complete"==t.readyState?h.call(m,f({type:b})):(a||(_=s[b])&&(x=function(t){var e,n;if(e=t.currentTarget,(n=t.relatedTarget)&&e.contains)n=e.contains(n);else for(;n&&n!==e;)n=n.parentNode;n||((t=f(t||S.event)).type="mouseout"===t.type?"mouseleave":"mouseenter",t.target=e,d(t,g))}),o||"focusin"!==b&&"focusout"!==b||(w=!0,_="focusin"===b?"focus":"blur",x=function(t){(t=f(t||S.event)).type="focus"===t.type?"focusin":"focusout",d(t,g)}),(v=u[g][b])?"ready"===b&&c.domLoaded?h({type:b}):v.push({func:h,scope:m}):(u[g][b]=v=[{func:h,scope:m}],v.fakeName=_,v.capture=w,v.nativeHandler=x,"ready"===b?p(t,x,c):l(t,_||b,x,w)));return t=v=0,h}},c.unbind=function(t,e,n){var r,o,a,s,l,d;if(!t||3===t.nodeType||8===t.nodeType)return c;if(r=t[i]){if(d=u[r],e){for(a=(e=e.split(" ")).length;a--;)if(l=e[a],o=d[l]){if(n)for(s=o.length;s--;)if(o[s].func===n){var f=o.nativeHandler,p=o.fakeName,m=o.capture;(o=o.slice(0,s).concat(o.slice(s+1))).nativeHandler=f,o.fakeName=p,o.capture=m,d[l]=o}n&&0!==o.length||(delete d[l],h(t,o.fakeName||l,o.nativeHandler,o.capture))}}else{for(l in d)o=d[l],h(t,o.fakeName||l,o.nativeHandler,o.capture);d={}}for(l in d)return c;delete u[r];try{delete t[i]}catch(g){t[i]=null}}return c},c.fire=function(t,e,n){var r;if(!t||3===t.nodeType||8===t.nodeType)return c;(n=f(null,n)).type=e,n.target=t;do{(r=t[i])&&d(n,r),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!n.isPropagationStopped());return c},c.clean=function(t){var e,n,r=c.unbind;if(!t||3===t.nodeType||8===t.nodeType)return c;if(t[i]&&r(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName)for(r(t),e=(n=t.getElementsByTagName("*")).length;e--;)(t=n[e])[i]&&r(t);return c},c.destroy=function(){u={}},c.cancel=function(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}};return m.Event=new m,m.Event.bind(e,"ready",function(){}),m}),o("tinymce.core.dom.Sizzle",[],function(){function t(t,e,n,i){var r,o,a,c,l,h,d,f,p,m;if((e?e.ownerDocument||e:M)!==P&&L(e),e=e||P,n=n||[],!t||"string"!=typeof t)return n;if(1!==(c=e.nodeType)&&9!==c)return[];if(N&&!i){if(r=pt.exec(t))if(a=r[1]){if(9===c){if(!(o=e.getElementById(a))||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(a))&&O(e,o)&&o.id===a)return n.push(o),n}else{if(r[2])return X.apply(n,e.getElementsByTagName(t)),n;if((a=r[3])&&y.getElementsByClassName)return X.apply(n,e.getElementsByClassName(a)),n}if(y.qsa&&(!R||!R.test(t))){if(f=d=B,p=e,m=9===c&&t,1===c&&"object"!==e.nodeName.toLowerCase()){for(h=w(t),(d=e.getAttribute("id"))?f=d.replace(gt,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",l=h.length;l--;)h[l]=f+u(h[l]);p=mt.test(t)&&s(e.parentNode)||e,m=h.join(",")}if(m)try{return X.apply(n,p.querySelectorAll(m)),n}catch(g){}finally{d||e.removeAttribute("id")}}}return k(t.replace(rt,"$1"),e,n,i)}function e(){function t(n,i){return e.push(n+" ")>b.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function n(t){return t[B]=!0,t}function i(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||W)-(~t.sourceIndex||W);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function r(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function o(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function a(t){return n(function(e){return e=+e,n(function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function s(t){return t&&typeof t.getElementsByTagName!==q&&t}function c(){}function u(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function l(t,e,n){var i=e.dir,r=n&&"parentNode"===i,o=z++;return e.first?function(e,n,o){for(;e=e[i];)if(1===e.nodeType||r)return t(e,n,o)}:function(e,n,a){var s,c,u=[F,o];if(a){for(;e=e[i];)if((1===e.nodeType||r)&&t(e,n,a))return!0}else for(;e=e[i];)if(1===e.nodeType||r){if(c=e[B]||(e[B]={}),(s=c[i])&&s[0]===F&&s[1]===o)return u[2]=s[2];if(c[i]=u,u[2]=t(e,n,a))return!0}}}function h(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function d(e,n,i){for(var r=0,o=n.length;r<o;r++)t(e,n[r],i);return i}function f(t,e,n,i,r){for(var o,a=[],s=0,c=t.length,u=null!=e;s<c;s++)(o=t[s])&&(n&&!n(o,i,r)||(a.push(o),u&&e.push(s)));return a}function p(t,e,i,r,o,a){return r&&!r[B]&&(r=p(r)),o&&!o[B]&&(o=p(o,a)),n(function(n,a,s,c){var u,l,h,p=[],m=[],g=a.length,v=n||d(e||"*",s.nodeType?[s]:s,[]),y=!t||!n&&e?v:f(v,p,t,s,c),b=i?o||(n?t:g||r)?[]:a:y;if(i&&i(y,b,s,c),r)for(u=f(b,m),r(u,[],s,c),l=u.length;l--;)(h=u[l])&&(b[m[l]]=!(y[m[l]]=h));if(n){if(o||t){if(o){for(u=[],l=b.length;l--;)(h=b[l])&&u.push(y[l]=h);o(null,b=[],u,c)}for(l=b.length;l--;)(h=b[l])&&(u=o?Q.call(n,h):p[l])>-1&&(n[u]=!(a[u]=h))}}else b=f(b===a?b.splice(g,b.length):b),o?o(null,a,b,c):X.apply(a,b)})}function m(t){for(var e,n,i,r=t.length,o=b.relative[t[0].type],a=o||b.relative[" "],s=o?1:0,c=l(function(t){return t===e},a,!0),d=l(function(t){return Q.call(e,t)>-1},a,!0),f=[function(t,n,i){return!o&&(i||n!==E)||((e=n).nodeType?c(t,n,i):d(t,n,i))}];s<r;s++)if(n=b.relative[t[s].type])f=[l(h(f),n)];else{if((n=b.filter[t[s].type].apply(null,t[s].matches))[B]){for(i=++s;i<r&&!b.relative[t[i].type];i++);return p(s>1&&h(f),s>1&&u(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(rt,"$1"),n,s<i&&m(t.slice(s,i)),i<r&&m(t=t.slice(i)),i<r&&u(t))}f.push(n)}return h(f)}function g(e,i){var r=i.length>0,o=e.length>0,a=function(n,a,s,c,u){var l,h,d,p=0,m="0",g=n&&[],v=[],y=E,_=n||o&&b.find.TAG("*",u),x=F+=null==y?1:Math.random()||.1,w=_.length;for(u&&(E=a!==P&&a);m!==w&&null!=(l=_[m]);m++){if(o&&l){for(h=0;d=e[h++];)if(d(l,a,s)){c.push(l);break}u&&(F=x)}r&&((l=!d&&l)&&p--,n&&g.push(l))}if(p+=m,r&&m!==p){for(h=0;d=i[h++];)d(g,v,a,s);if(n){if(p>0)for(;m--;)g[m]||v[m]||(v[m]=G.call(c));v=f(v)}X.apply(c,v),u&&!n&&v.length>0&&p+i.length>1&&t.uniqueSort(c)}return u&&(F=x,E=y),g};return r?n(a):a}var v,y,b,_,x,w,S,k,E,T,C,L,P,A,N,R,I,D,O,B="sizzle"+-new Date,M=window.document,F=0,z=0,j=e(),H=e(),$=e(),U=function(t,e){return t===e&&(C=!0),0},q=typeof undefined,W=1<<31,V={}.hasOwnProperty,Z=[],G=Z.pop,K=Z.push,X=Z.push,Y=Z.slice,Q=Z.indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(this[e]===t)return e;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",nt="\\["+tt+"*("+et+")(?:"+tt+"*([*^$|!~]?=)"+tt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+et+"))|)"+tt+"*\\]",it=":("+et+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+nt+")*)|.*)\\)|)",rt=new RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),ot=new RegExp("^"+tt+"*,"+tt+"*"),at=new RegExp("^"+tt+"*([>+~]|"+tt+")"+tt+"*"),st=new RegExp("="+tt+"*([^\\]'\"]*?)"+tt+"*\\]","g"),ct=new RegExp(it),ut=new RegExp("^"+et+"$"),lt={ID:new RegExp("^#("+et+")"),CLASS:new RegExp("^\\.("+et+")"),TAG:new RegExp("^("+et+"|[*])"),ATTR:new RegExp("^"+nt),PSEUDO:new RegExp("^"+it),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},ht=/^(?:input|select|textarea|button)$/i,dt=/^h\d$/i,ft=/^[^{]+\{\s*\[native \w/,pt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,mt=/[+~]/,gt=/'|\\/g,vt=new RegExp("\\\\([\\da-f]{1,6}"+tt+"?|("+tt+")|.)","ig"),yt=function(t,e,n){var i="0x"+e-65536;return i!=i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{X.apply(Z=Y.call(M.childNodes),M.childNodes),Z[M.childNodes.length].nodeType}catch(bt){X={apply:Z.length?function(t,e){K.apply(t,Y.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}y=t.support={},x=t.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},L=t.setDocument=function(t){function e(t){try{return t.top}catch(e){}return null}var n,r=t?t.ownerDocument||t:M,o=r.defaultView;return r!==P&&9===r.nodeType&&r.documentElement?(P=r,A=r.documentElement,N=!x(r),o&&o!==e(o)&&(o.addEventListener?o.addEventListener("unload",function(){L()},!1):o.attachEvent&&o.attachEvent("onunload",function(){L()})),y.attributes=!0,y.getElementsByTagName=!0,y.getElementsByClassName=ft.test(r.getElementsByClassName),y.getById=!0,b.find.ID=function(t,e){if(typeof e.getElementById!==q&&N){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},b.filter.ID=function(t){var e=t.replace(vt,yt);return function(t){return t.getAttribute("id")===e}},b.find.TAG=y.getElementsByTagName?function(t,e){if(typeof e.getElementsByTagName!==q)return e.getElementsByTagName(t)}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},b.find.CLASS=y.getElementsByClassName&&function(t,e){if(N)return e.getElementsByClassName(t)},I=[],R=[],y.disconnectedMatch=!0,R=R.length&&new RegExp(R.join("|")),I=I.length&&new RegExp(I.join("|")),n=ft.test(A.compareDocumentPosition),O=n||ft.test(A.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},U=n?function(t,e){if(t===e)return C=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!y.sortDetached&&e.compareDocumentPosition(t)===n?t===r||t.ownerDocument===M&&O(M,t)?-1:e===r||e.ownerDocument===M&&O(M,e)?1:T?Q.call(T,t)-Q.call(T,e):0:4&n?-1:1)}:function(t,e){if(t===e)return C=!0,0;var n,o=0,a=t.parentNode,s=e.parentNode,c=[t],u=[e];if(!a||!s)return t===r?-1:e===r?1:a?-1:s?1:T?Q.call(T,t)-Q.call(T,e):0;if(a===s)return i(t,e);for(n=t;n=n.parentNode;)c.unshift(n);for(n=e;n=n.parentNode;)u.unshift(n);for(;c[o]===u[o];)o++;return o?i(c[o],u[o]):c[o]===M?-1:u[o]===M?1:0},r):P},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==P&&L(e),n=n.replace(st,"='$1']"),y.matchesSelector&&N&&(!I||!I.test(n))&&(!R||!R.test(n)))try{var i=D.call(e,n);if(i||y.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(bt){}return t(n,P,null,[e]).length>0},t.contains=function(t,e){return(t.ownerDocument||t)!==P&&L(t),O(t,e)},t.attr=function(t,e){(t.ownerDocument||t)!==P&&L(t);var n=b.attrHandle[e.toLowerCase()],i=n&&V.call(b.attrHandle,e.toLowerCase())?n(t,e,!N):undefined;return i!==undefined?i:y.attributes||!N?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},t.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},t.uniqueSort=function(t){var e,n=[],i=0,r=0;if(C=!y.detectDuplicates,T=!y.sortStable&&t.slice(0),t.sort(U),C){for(;e=t[r++];)e===t[r]&&(i=n.push(r));for(;i--;)t.splice(n[i],1)}return T=null,t},_=t.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=_(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i++];)n+=_(e);return n},(b=t.selectors={cacheLength:50,createPseudo:n,match:lt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(vt,yt),t[3]=(t[3]||t[4]||t[5]||"").replace(vt,yt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(t){var e,n=!t[6]&&t[2];return lt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&ct.test(n)&&(e=w(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(vt,yt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=j[t+" "];return e||(e=new RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&j(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==q&&t.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(r){var o=t.attr(r,e);return null==o?"!="===n:!n||(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o+" ").indexOf(i)>-1:"|="===n&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,c){var u,l,h,d,f,p,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!c&&!s;if(g){if(o){for(;m;){for(h=e;h=h[m];)if(s?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?g.firstChild:g.lastChild],a&&y){for(f=(u=(l=g[B]||(g[B]={}))[t]||[])[0]===F&&u[1],d=u[0]===F&&u[2],h=f&&g.childNodes[f];h=++f&&h&&h[m]||(d=f=0)||p.pop();)if(1===h.nodeType&&++d&&h===e){l[t]=[F,f,d];break}
}else if(y&&(u=(e[B]||(e[B]={}))[t])&&u[0]===F)d=u[1];else for(;(h=++f&&h&&h[m]||(d=f=0)||p.pop())&&((s?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(y&&((h[B]||(h[B]={}))[t]=[F,d]),h!==e)););return(d-=r)===i||d%i==0&&d/i>=0}}},PSEUDO:function(e,i){var r,o=b.pseudos[e]||b.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[B]?o(i):o.length>1?(r=[e,e,"",i],b.setFilters.hasOwnProperty(e.toLowerCase())?n(function(t,e){for(var n,r=o(t,i),a=r.length;a--;)t[n=Q.call(t,r[a])]=!(e[n]=r[a])}):function(t){return o(t,0,r)}):o}},pseudos:{not:n(function(t){var e=[],i=[],r=S(t.replace(rt,"$1"));return r[B]?n(function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,n,o){return e[0]=t,r(e,null,o,i),!i.pop()}}),has:n(function(e){return function(n){return t(e,n).length>0}}),contains:n(function(t){return t=t.replace(vt,yt),function(e){return(e.textContent||e.innerText||_(e)).indexOf(t)>-1}}),lang:n(function(e){return ut.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(vt,yt).toLowerCase(),function(t){var n;do{if(n=N?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=window.location&&window.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===A},focus:function(t){return t===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return dt.test(t.nodeName)},input:function(t){return ht.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:a(function(){return[0]}),last:a(function(t,e){return[e-1]}),eq:a(function(t,e,n){return[n<0?n+e:n]}),even:a(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:a(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:a(function(t,e,n){for(var i=n<0?n+e:n;--i>=0;)t.push(i);return t}),gt:a(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}}).pseudos.nth=b.pseudos.eq;for(v in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[v]=r(v);for(v in{submit:!0,reset:!0})b.pseudos[v]=o(v);return c.prototype=b.filters=b.pseudos,b.setFilters=new c,w=t.tokenize=function(e,n){var i,r,o,a,s,c,u,l=H[e+" "];if(l)return n?0:l.slice(0);for(s=e,c=[],u=b.preFilter;s;){i&&!(r=ot.exec(s))||(r&&(s=s.slice(r[0].length)||s),c.push(o=[])),i=!1,(r=at.exec(s))&&(i=r.shift(),o.push({value:i,type:r[0].replace(rt," ")}),s=s.slice(i.length));for(a in b.filter)!(r=lt[a].exec(s))||u[a]&&!(r=u[a](r))||(i=r.shift(),o.push({value:i,type:a,matches:r}),s=s.slice(i.length));if(!i)break}return n?s.length:s?t.error(e):H(e,c).slice(0)},S=t.compile=function(t,e){var n,i=[],r=[],o=$[t+" "];if(!o){for(e||(e=w(t)),n=e.length;n--;)(o=m(e[n]))[B]?i.push(o):r.push(o);(o=$(t,g(r,i))).selector=t}return o},k=t.select=function(t,e,n,i){var r,o,a,c,l,h="function"==typeof t&&t,d=!i&&w(t=h.selector||t);if(n=n||[],1===d.length){if((o=d[0]=d[0].slice(0)).length>2&&"ID"===(a=o[0]).type&&y.getById&&9===e.nodeType&&N&&b.relative[o[1].type]){if(!(e=(b.find.ID(a.matches[0].replace(vt,yt),e)||[])[0]))return n;h&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=lt.needsContext.test(t)?0:o.length;r--&&(a=o[r],!b.relative[c=a.type]);)if((l=b.find[c])&&(i=l(a.matches[0].replace(vt,yt),mt.test(o[0].type)&&s(e.parentNode)||e))){if(o.splice(r,1),!(t=i.length&&u(o)))return X.apply(n,i),n;break}}return(h||S(t,d))(i,e,!N,n,mt.test(t)&&s(e.parentNode)||e),n},y.sortStable=B.split("").sort(U).join("")===B,y.detectDuplicates=!!C,L(),y.sortDetached=!0,t}),o("tinymce.core.util.Arr",[],function(){var t=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},e=function(t,e,n){var i,r;if(!t)return 0;if(n=n||t,t.length!==undefined){for(i=0,r=t.length;i<r;i++)if(!1===e.call(n,t[i],i,t))return 0}else for(i in t)if(t.hasOwnProperty(i)&&!1===e.call(n,t[i],i,t))return 0;return 1},n=function(t,e,n){var i,r;for(i=0,r=t.length;i<r;i++)if(e.call(n,t[i],i,t))return i;return-1};return{isArray:t,toArray:function(e){var n,i,r=e;if(!t(e))for(r=[],n=0,i=e.length;n<i;n++)r[n]=e[n];return r},each:e,map:function(t,n){var i=[];return e(t,function(e,r){i.push(n(e,r,t))}),i},filter:function(t,n){var i=[];return e(t,function(e,r){n&&!n(e,r,t)||i.push(e)}),i},indexOf:function(t,e){var n,i;if(t)for(n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},reduce:function(t,e,n,i){var r=0;for(arguments.length<3&&(n=t[0]);r<t.length;r++)n=e.call(i,n,t[r],r);return n},findIndex:n,find:function(t,e,i){var r=n(t,e,i);return-1!==r?t[r]:undefined},last:function(t){return t[t.length-1]}}}),o("tinymce.core.util.Tools",["global!window","tinymce.core.Env","tinymce.core.util.Arr"],function(t,e,n){var i=/^\s*|\s*$/g,r=function(t){return null===t||t===undefined?"":(""+t).replace(i,"")},o=function(t,e){return e?!("array"!=e||!n.isArray(t))||typeof t==e:t!==undefined},a=function(t,e,n){var i;for(t=t||[],e=e||",","string"==typeof t&&(t=t.split(e)),n=n||{},i=t.length;i--;)n[t[i]]={};return n},s=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c=function(t,e,n){var i,r,o,a,s,c=this,u=0;if(t=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(t),o=t[3].match(/(^|\.)(\w+)$/i)[2],!(r=c.createNS(t[3].replace(/\.\w+$/,""),n))[o]){if("static"==t[2])return r[o]=e,void(this.onCreate&&this.onCreate(t[2],t[3],r[o]));e[o]||(e[o]=function(){},u=1),r[o]=e[o],c.extend(r[o].prototype,e),t[5]&&(i=c.resolve(t[5]).prototype,a=t[5].match(/\.(\w+)$/i)[1],s=r[o],r[o]=u?function(){return i[a].apply(this,arguments)}:function(){return this.parent=i[a],s.apply(this,arguments)},r[o].prototype[o]=r[o],c.each(i,function(t,e){r[o].prototype[e]=i[e]}),c.each(e,function(t,e){i[e]?r[o].prototype[e]=function(){return this.parent=i[e],t.apply(this,arguments)}:e!=o&&(r[o].prototype[e]=t)})),c.each(e["static"],function(t,e){r[o][e]=t})}},u=function(t,e){var n,i,r,o,a=arguments;for(n=1,i=a.length;n<i;n++){e=a[n];for(r in e)e.hasOwnProperty(r)&&(o=e[r])!==undefined&&(t[r]=o)}return t},l=function(t,e,i,r){r=r||this,t&&(i&&(t=t[i]),n.each(t,function(t,n){if(!1===e.call(r,t,n,i))return!1;l(t,e,i,r)}))},h=function(e,n){var i,r;for(n=n||t,e=e.split("."),i=0;i<e.length;i++)n[r=e[i]]||(n[r]={}),n=n[r];return n},d=function(e,n){var i,r;for(n=n||t,i=0,r=(e=e.split(".")).length;i<r&&(n=n[e[i]]);i++);return n},f=function(t,e){return!t||o(t,"array")?t:n.map(t.split(e||","),r)},p=function(t){var n=e.cacheSuffix;return n&&(t+=(-1===t.indexOf("?")?"?":"&")+n),t};return{trim:r,isArray:n.isArray,is:o,toArray:n.toArray,makeMap:a,each:n.each,map:n.map,grep:n.filter,inArray:n.indexOf,hasOwn:s,extend:u,create:c,walk:l,createNS:h,resolve:d,explode:f,_addCacheSuffix:p}}),o("tinymce.core.dom.DomQuery",["global!document","tinymce.core.dom.EventUtils","tinymce.core.dom.Sizzle","tinymce.core.Env","tinymce.core.util.Tools"],function(t,e,n,i,r){var o,a=t,s=Array.prototype.push,c=Array.prototype.slice,u=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,l=e.Event,h=r.makeMap("children,contents,next,prev"),d=function(t){return void 0!==t},f=function(t){return"string"==typeof t},p=function(t){return t&&t==t.window},m=function(t,e){var n,i,r;for(r=(e=e||a).createElement("div"),n=e.createDocumentFragment(),r.innerHTML=t;i=r.firstChild;)n.appendChild(i);return n},g=function(t,e,n,i){var r;if(f(e))e=m(e,N(t[0]));else if(e.length&&!e.nodeType){if(e=E.makeArray(e),i)for(r=e.length-1;r>=0;r--)g(t,e[r],n,i);else for(r=0;r<e.length;r++)g(t,e[r],n,i);return t}if(e.nodeType)for(r=t.length;r--;)n.call(t[r],e);return t},v=function(t,e){return t&&e&&-1!==(" "+t.className+" ").indexOf(" "+e+" ")},y=function(t,e,n){var i,r;return e=E(e)[0],t.each(function(){var t=this;n&&i==t.parentNode?r.appendChild(t):(i=t.parentNode,r=e.cloneNode(!1),t.parentNode.insertBefore(r,t),r.appendChild(t))}),t},b=r.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),_=r.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),x={"for":"htmlFor","class":"className",readonly:"readOnly"},w={"float":"cssFloat"},S={},k={},E=function(t,e){return new E.fn.init(t,e)},T=function(t,e){var n;if(e.indexOf)return e.indexOf(t);for(n=e.length;n--;)if(e[n]===t)return n;return-1},C=/^\s*|\s*$/g,L=function(t){return null===t||t===o?"":(""+t).replace(C,"")},P=function(t,e){var n,i,r,o,a;if(t)if((n=t.length)===o){for(i in t)if(t.hasOwnProperty(i)&&(a=t[i],!1===e.call(a,i,a)))break}else for(r=0;r<n&&(a=t[r],!1!==e.call(a,r,a));r++);return t},A=function(t,e){var n=[];return P(t,function(t,i){e(i,t)&&n.push(i)}),n},N=function(t){return t?9==t.nodeType?t:t.ownerDocument:a};E.fn=E.prototype={constructor:E,selector:"",context:null,length:0,init:function(e,n){var i,r,o=this;if(!e)return o;if(e.nodeType)return o.context=o[0]=e,o.length=1,o;if(n&&n.nodeType)o.context=n;else{if(n)return E(e).attr(n);o.context=n=t}if(f(e)){if(o.selector=e,!(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:u.exec(e)))return E(n).find(e);if(i[1])for(r=m(e,N(n)).firstChild;r;)s.call(o,r),r=r.nextSibling;else{if(!(r=N(n).getElementById(i[2])))return o;if(r.id!==i[2])return o.find(e);o.length=1,o[0]=r}}else this.add(e,!1);return o},toArray:function(){return r.toArray(this)},add:function(t,e){var n,i,r=this;if(f(t))return r.add(E(t));if(!1!==e)for(n=E.unique(r.toArray().concat(E.makeArray(t))),r.length=n.length,i=0;i<n.length;i++)r[i]=n[i];else s.apply(r,E.makeArray(t));return r},attr:function(t,e){var n,i=this;if("object"==typeof t)P(t,function(t,e){i.attr(t,e)});else{if(!d(e)){if(i[0]&&1===i[0].nodeType){if((n=S[t])&&n.get)return n.get(i[0],t);if(_[t])return i.prop(t)?t:o;null===(e=i[0].getAttribute(t,2))&&(e=o)}return e}this.each(function(){var n;if(1===this.nodeType){if((n=S[t])&&n.set)return void n.set(this,e);null===e?this.removeAttribute(t,2):this.setAttribute(t,e,2)}})}return i},removeAttr:function(t){return this.attr(t,null)},prop:function(t,e){var n=this;if("object"==typeof(t=x[t]||t))P(t,function(t,e){n.prop(t,e)});else{if(!d(e))return n[0]&&n[0].nodeType&&t in n[0]?n[0][t]:e;this.each(function(){1==this.nodeType&&(this[t]=e)})}return n},css:function(t,e){var n,i,r=this,a=function(t){return t.replace(/-(\D)/g,function(t,e){return e.toUpperCase()})},s=function(t){return t.replace(/[A-Z]/g,function(t){return"-"+t})};if("object"==typeof t)P(t,function(t,e){r.css(t,e)});else if(d(e))t=a(t),"number"!=typeof e||b[t]||(e+="px"),r.each(function(){var n=this.style;if((i=k[t])&&i.set)i.set(this,e);else{try{this.style[w[t]||t]=e}catch(r){}null!==e&&""!==e||(n.removeProperty?n.removeProperty(s(t)):n.removeAttribute(t))}});else{if(n=r[0],(i=k[t])&&i.get)return i.get(n);if(n.ownerDocument.defaultView)try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(s(t))}catch(c){return o}else if(n.currentStyle)return n.currentStyle[a(t)]}return r},remove:function(){for(var t,e=this,n=this.length;n--;)t=e[n],l.clean(t),t.parentNode&&t.parentNode.removeChild(t);return this},empty:function(){for(var t,e=this,n=this.length;n--;)for(t=e[n];t.firstChild;)t.removeChild(t.firstChild);return this},html:function(t){var e,n=this;if(d(t)){e=n.length;try{for(;e--;)n[e].innerHTML=t}catch(i){E(n[e]).empty().append(t)}return n}return n[0]?n[0].innerHTML:""},text:function(t){var e,n=this;if(d(t)){for(e=n.length;e--;)"innerText"in n[e]?n[e].innerText=t:n[0].textContent=t;return n}return n[0]?n[0].innerText||n[0].textContent:""},append:function(){return g(this,arguments,function(t){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(t)})},prepend:function(){return g(this,arguments,function(t){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(t,this.firstChild)},!0)},before:function(){var t=this;return t[0]&&t[0].parentNode?g(t,arguments,function(t){this.parentNode.insertBefore(t,this)}):t},after:function(){var t=this;return t[0]&&t[0].parentNode?g(t,arguments,function(t){this.parentNode.insertBefore(t,this.nextSibling)},!0):t},appendTo:function(t){return E(t).append(this),this},prependTo:function(t){return E(t).prepend(this),this},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){return y(this,t)},wrapAll:function(t){return y(this,t,!0)},wrapInner:function(t){return this.each(function(){E(this).contents().wrapAll(t)}),this},unwrap:function(){return this.parent().each(function(){E(this).replaceWith(this.childNodes)})},clone:function(){var t=[];return this.each(function(){t.push(this.cloneNode(!0))}),E(t)},addClass:function(t){return this.toggleClass(t,!0)},removeClass:function(t){return this.toggleClass(t,!1)},toggleClass:function(t,e){var n=this;return"string"!=typeof t?n:(-1!==t.indexOf(" ")?P(t.split(" "),function(){n.toggleClass(this,e)}):n.each(function(n,i){var r,o;(o=v(i,t))!==e&&(r=i.className,o?i.className=L((" "+r+" ").replace(" "+t+" "," ")):i.className+=r?" "+t:t)}),n)},hasClass:function(t){return v(this[0],t)},each:function(t){return P(this,t)},on:function(t,e){return this.each(function(){l.bind(this,t,e)})},off:function(t,e){return this.each(function(){l.unbind(this,t,e)})},trigger:function(t){return this.each(function(){"object"==typeof t?l.fire(this,t.type,t):l.fire(this,t)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new E(c.apply(this,arguments))},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(t){var e,n,i=[];for(e=0,n=this.length;e<n;e++)E.find(t,this[e],i);return E(i)},filter:function(t){return E("function"==typeof t?A(this.toArray(),function(e,n){return t(n,e)}):E.filter(t,this.toArray()))},closest:function(t){var e=[];return t instanceof E&&(t=t[0]),this.each(function(n,i){for(;i;){if("string"==typeof t&&E(i).is(t)){e.push(i);break}if(i==t){e.push(i);break}i=i.parentNode}}),E(e)},offset:function(t){var e,n,i,r,o=0,a=0;return t?this.css(t):((e=this[0])&&(i=(n=e.ownerDocument).documentElement,e.getBoundingClientRect&&(o=(r=e.getBoundingClientRect()).left+(i.scrollLeft||n.body.scrollLeft)-i.clientLeft,a=r.top+(i.scrollTop||n.body.scrollTop)-i.clientTop)),{left:o,top:a})},push:s,sort:[].sort,splice:[].splice},r.extend(E,{extend:r.extend,makeArray:function(t){return p(t)||t.nodeType?[t]:r.toArray(t)},inArray:T,isArray:r.isArray,each:P,trim:L,grep:A,find:n,expr:n.selectors,unique:n.uniqueSort,text:n.getText,contains:n.contains,filter:function(t,e,n){var i=e.length;for(n&&(t=":not("+t+")");i--;)1!=e[i].nodeType&&e.splice(i,1);return e=1===e.length?E.find.matchesSelector(e[0],t)?[e[0]]:[]:E.find.matches(t,e)}});var R=function(t,e,n){var i=[],r=t[e];for("string"!=typeof n&&n instanceof E&&(n=n[0]);r&&9!==r.nodeType;){if(n!==undefined){if(r===n)break;if("string"==typeof n&&E(r).is(n))break}1===r.nodeType&&i.push(r),r=r[e]}return i},I=function(t,e,n,i){var r=[];for(i instanceof E&&(i=i[0]);t;t=t[e])if(!n||t.nodeType===n){if(i!==undefined){if(t===i)break;if("string"==typeof i&&E(t).is(i))break}r.push(t)}return r},D=function(t,e,n){for(t=t[e];t;t=t[e])if(t.nodeType==n)return t;return null};P({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return R(t,"parentNode")},next:function(t){return D(t,"nextSibling",1)},prev:function(t){return D(t,"previousSibling",1)},children:function(t){return I(t.firstChild,"nextSibling",1)},contents:function(t){return r.toArray(("iframe"===t.nodeName?t.contentDocument||t.contentWindow.document:t).childNodes)}},function(t,e){E.fn[t]=function(n){var i=[];return this.each(function(){var t=e.call(i,this,n,i);t&&(E.isArray(t)?i.push.apply(i,t):i.push(t))}),this.length>1&&(h[t]||(i=E.unique(i)),0===t.indexOf("parents")&&(i=i.reverse())),i=E(i),n?i.filter(n):i}}),P({parentsUntil:function(t,e){return R(t,"parentNode",e)},nextUntil:function(t,e){return I(t,"nextSibling",1,e).slice(1)},prevUntil:function(t,e){return I(t,"previousSibling",1,e).slice(1)}},function(t,e){E.fn[t]=function(n,i){var r=[];return this.each(function(){var t=e.call(r,this,n,r);t&&(E.isArray(t)?r.push.apply(r,t):r.push(t))}),this.length>1&&(r=E.unique(r),0!==t.indexOf("parents")&&"prevUntil"!==t||(r=r.reverse())),r=E(r),i?r.filter(i):r}}),E.fn.is=function(t){return!!t&&this.filter(t).length>0},E.fn.init.prototype=E.fn,E.overrideDefaults=function(t){var e,n=function(i,r){return e=e||t(),0===arguments.length&&(i=e.element),r||(r=e.context),new n.fn.init(i,r)};return E.extend(n,this),n};var O=function(t,e,n){P(n,function(n,i){t[n]=t[n]||{},t[n][e]=i})};return i.ie&&i.ie<8&&(O(S,"get",{maxlength:function(t){var e=t.maxLength;return 2147483647===e?o:e},size:function(t){var e=t.size;return 20===e?o:e},"class":function(t){return t.className},style:function(t){var e=t.style.cssText;return 0===e.length?o:e}}),O(S,"set",{"class":function(t,e){t.className=e},style:function(t,e){t.style.cssText=e}})),i.ie&&i.ie<9&&(w["float"]="styleFloat",O(k,"set",{opacity:function(t,e){var n=t.style;null===e||""===e?n.removeAttribute("filter"):(n.zoom=1,n.filter="alpha(opacity="+100*e+")")}})),E.attrHooks=S,E.cssHooks=k,E}),o("ephox.katamari.api.Thunk",[],function(){return{cached:function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(null,arguments)),e}}}}),a("global!Number",Number),o("ephox.sand.detect.Version",["ephox.katamari.api.Arr","global!Number","global!String"],function(t,e,n){var i=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i.test(e))return i}return undefined},r=function(t,n){var r=i(t,n);if(!r)return{major:0,minor:0};var o=function(t){return e(n.replace(r,"$"+t))};return s(o(1),o(2))},o=function(t,e){var i=n(e).toLowerCase();return 0===t.length?a():r(t,i)},a=function(){return s(0,0)},s=function(t,e){return{major:t,minor:e}};return{nu:s,detect:o,unknown:a}}),o("ephox.sand.core.Browser",["ephox.katamari.api.Fun","ephox.sand.detect.Version"],function(t,e){var n="Edge",i="Chrome",r="IE",o="Opera",a="Firefox",s="Safari",c=function(t,e){return function(){return e===t}},u=function(){return l({current:undefined,version:e.unknown()})},l=function(t){var e=t.current;return{current:e,version:t.version,isEdge:c(n,e),isChrome:c(i,e),isIE:c(r,e),isOpera:c(o,e),isFirefox:c(a,e),isSafari:c(s,e)}};return{unknown:u,nu:l,edge:t.constant(n),chrome:t.constant(i),ie:t.constant(r),opera:t.constant(o),firefox:t.constant(a),safari:t.constant(s)}}),o("ephox.sand.core.OperatingSystem",["ephox.katamari.api.Fun","ephox.sand.detect.Version"],function(t,e){var n="Windows",i="iOS",r="Android",o="Linux",a="OSX",s="Solaris",c="FreeBSD",u=function(t,e){return function(){return e===t}},l=function(){return h({current:undefined,version:e.unknown()})},h=function(t){var e=t.current;return{current:e,version:t.version,isWindows:u(n,e),isiOS:u(i,e),isAndroid:u(r,e),isOSX:u(a,e),isLinux:u(o,e),isSolaris:u(s,e),isFreeBSD:u(c,e)}};return{unknown:l,nu:h,windows:t.constant(n),ios:t.constant(i),android:t.constant(r),linux:t.constant(o),osx:t.constant(a),solaris:t.constant(s),freebsd:t.constant(c)}}),o("ephox.sand.detect.DeviceType",["ephox.katamari.api.Fun"],function(t){return function(e,n,i){var r=e.isiOS()&&!0===/ipad/i.test(i),o=e.isiOS()&&!r,a=e.isAndroid()&&3===e.version.major,s=e.isAndroid()&&4===e.version.major,c=r||a||s&&!0===/mobile/i.test(i),u=e.isiOS()||e.isAndroid(),l=u&&!c,h=n.isSafari()&&e.isiOS()&&!1===/safari/i.test(i);return{isiPad:t.constant(r),isiPhone:t.constant(o),isTablet:t.constant(c),isPhone:t.constant(l),isTouch:t.constant(u),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:t.constant(h)}}}),o("ephox.sand.detect.UaString",["ephox.katamari.api.Arr","ephox.sand.detect.Version","global!String"],function(t,e,n){var i=function(e,i){var r=n(i).toLowerCase();return t.find(e,function(t){return t.search(r)})};return{detectBrowser:function(t,n){return i(t,n).map(function(t){var i=e.detect(t.versionRegexes,n);return{current:t.name,version:i}})},detectOs:function(t,n){return i(t,n).map(function(t){var i=e.detect(t.versionRegexes,n);return{current:t.name,version:i}})}}}),o("ephox.katamari.str.StrAppend",[],function(){return{addToStart:function(t,e){return e+t},addToEnd:function(t,e){return t+e},removeFromStart:function(t,e){return t.substring(e)},removeFromEnd:function(t,e){return t.substring(0,t.length-e)}}}),o("ephox.katamari.str.StringParts",["ephox.katamari.api.Option","global!Error"],function(t){return{first:function(t,e){return t.substr(0,e)},last:function(t,e){return t.substr(t.length-e,t.length)},head:function(e){return""===e?t.none():t.some(e.substr(0,1))},tail:function(e){return""===e?t.none():t.some(e.substring(1))}}}),o("ephox.katamari.api.Strings",["ephox.katamari.str.StrAppend","ephox.katamari.str.StringParts","global!Error"],function(t,e){var n=function(t,e,n){if(""===e)return!0;if(t.length<e.length)return!1;return t.substr(n,n+e.length)===e},i=function(e,n){return s(e,n)?t.removeFromStart(e,n.length):e},r=function(e,n){return c(e,n)?t.removeFromEnd(e,n.length):e},o=function(e,n){return s(e,n)?e:t.addToStart(e,n)},a=function(e,n){return c(e,n)?e:t.addToEnd(e,n)},s=function(t,e){return n(t,e,0)},c=function(t,e){return n(t,e,t.length-e.length)};return{supplant:function(t,e){var n=function(t){var e=typeof t;return"string"===e||"number"===e};return t.replace(/\${([^{}]*)}/g,function(t,i){var r=e[i];return n(r)?r:t})},startsWith:s,removeLeading:i,removeTrailing:r,ensureLeading:o,ensureTrailing:a,endsWith:c,contains:function(t,e){return-1!==t.indexOf(e)},trim:function(t){return t.replace(/^\s+|\s+$/g,"")},lTrim:function(t){return t.replace(/^\s+/g,"")},rTrim:function(t){return t.replace(/\s+$/g,"")},capitalize:function(t){return e.head(t).bind(function(n){return e.tail(t).map(function(t){return n.toUpperCase()+t})}).getOr(t)}}}),o("ephox.sand.info.PlatformInfo",["ephox.katamari.api.Fun","ephox.katamari.api.Strings"],function(t,e){var n=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,i=function(t){return function(n){return e.contains(n,t)}},r=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return e.contains(t,"edge/")&&e.contains(t,"chrome")&&e.contains(t,"safari")&&e.contains(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,n],search:function(t){return e.contains(t,"chrome")&&!e.contains(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return e.contains(t,"msie")||e.contains(t,"trident")}},{name:"Opera",versionRegexes:[n,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:i("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:i("firefox")},{name:"Safari",versionRegexes:[n,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(e.contains(t,"safari")||e.contains(t,"mobile/"))&&e.contains(t,"applewebkit")}}],o=[{name:"Windows",search:i("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return e.contains(t,"iphone")||e.contains(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:i("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:i("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:i("linux"),versionRegexes:[]},{name:"Solaris",search:i("sunos"),versionRegexes:[]},{name:"FreeBSD",search:i("freebsd"),versionRegexes:[]}];return{browsers:t.constant(r),oses:t.constant(o)}}),o("ephox.sand.core.PlatformDetection",["ephox.sand.core.Browser","ephox.sand.core.OperatingSystem","ephox.sand.detect.DeviceType","ephox.sand.detect.UaString","ephox.sand.info.PlatformInfo"],function(t,e,n,i,r){return{detect:function(o){var a=r.browsers(),s=r.oses(),c=i.detectBrowser(a,o).fold(t.unknown,t.nu),u=i.detectOs(s,o).fold(e.unknown,e.nu);return{browser:c,os:u,deviceType:n(u,c,o)}}}}),o("ephox.sand.api.PlatformDetection",["ephox.katamari.api.Thunk","ephox.sand.core.PlatformDetection","global!navigator"],function(t,e,n){return{detect:t.cached(function(){var t=n.userAgent;return e.detect(t)})}}),o("global!console",[],function(){return"undefined"==typeof console&&(console={log:function(){}}),console}),o("ephox.sugar.api.node.Element",["ephox.katamari.api.Fun","global!Error","global!console","global!document"],function(t,e,n,i){var r=function(t,e){var r=(e||i).createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||r.childNodes.length>1)throw n.error("HTML does not have a single root node",t),"HTML must have a single root node";return s(r.childNodes[0])},o=function(t,e){var n=(e||i).createElement(t);return s(n)},a=function(t,e){var n=(e||i).createTextNode(t);return s(n)},s=function(n){if(null===n||n===undefined)throw new e("Node cannot be null or undefined");return{dom:t.constant(n)}};return{fromHtml:r,fromTag:o,fromText:a,fromDom:s}}),o("ephox.sugar.api.node.NodeTypes",[],function(){return{ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12}}),o("ephox.sugar.api.node.Node",["ephox.sugar.api.node.NodeTypes"],function(t){var e=function(t){return t.dom().nodeName.toLowerCase()},n=function(t){return t.dom().nodeType},i=function(t){return t.dom().nodeValue},r=function(t){return function(e){return n(e)===t}},o=function(i){return n(i)===t.COMMENT||"#comment"===e(i)},a=r(t.ELEMENT),s=r(t.TEXT),c=r(t.DOCUMENT);return{name:e,type:n,value:i,isElement:a,isText:s,isDocument:c,isComment:o}}),o("ephox.katamari.api.Type",["global!Array","global!String"],function(t,e){var n=function(n){if(null===n)return"null";var i=typeof n;return"object"===i&&t.prototype.isPrototypeOf(n)?"array":"object"===i&&e.prototype.isPrototypeOf(n)?"string":i},i=function(t){return function(e){return n(e)===t}};return{isString:i("string"),isObject:i("object"),isArray:i("array"),isNull:i("null"),isBoolean:i("boolean"),isUndefined:i("undefined"),isFunction:i("function"),isNumber:i("number")}}),o("ephox.katamari.api.Obj",["ephox.katamari.api.Option","global!Object"],function(t,e){var n=function(){var t=e.keys,n=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e};return t===undefined?n:t}(),i=function(t,e){for(var i=n(t),r=0,o=i.length;r<o;r++){var a=i[r];e(t[a],a,t)}},r=function(t,e){return o(t,function(t,n,i){return{k:n,v:e(t,n,i)}})},o=function(t,e){var n={};return i(t,function(i,r){var o=e(i,r,t);n[o.k]=o.v}),n},a=function(t,e){var n=[];return i(t,function(t,i){n.push(e(t,i))}),n},s=function(t){return a(t,function(t){return t})};return{bifilter:function(t,e){var n={},r={};return i(t,function(t,i){(e(t,i)?n:r)[i]=t}),{t:n,f:r}},each:i,map:r,mapToArray:a,tupleMap:o,find:function(e,i){for(var r=n(e),o=0,a=r.length;o<a;o++){var s=r[o],c=e[s];if(i(c,s,e))return t.some(c)}return t.none()},keys:n,values:s,size:function(t){return s(t).length}}}),o("ephox.sugar.api.properties.Attr",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.sugar.api.node.Node","global!Error","global!console"],function(t,e,n,i,r,o){var a=function(e,n,i){if(!(t.isString(i)||t.isBoolean(i)||t.isNumber(i)))throw o.error("Invalid call to Attr.set. Key ",n,":: Value ",i,":: Element ",e),new r("Attribute value was not simple");e.setAttribute(n,i+"")},s=function(t,e,n){a(t.dom(),e,n)},c=function(t,e){var n=t.dom().getAttribute(e);return null===n?undefined:n},u=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},l=function(t,e,n){u(t,n)&&!u(e,n)&&s(e,n,c(t,n))};return{clone:function(t){return e.foldl(t.dom().attributes,function(t,e){return t[e.name]=e.value,t},{})},set:s,setAll:function(t,e){var i=t.dom();n.each(e,function(t,e){a(i,e,t)})},get:c,has:u,remove:function(t,e){t.dom().removeAttribute(e)},hasNone:function(t){var e=t.dom().attributes;return e===undefined||null===e||0===e.length},transfer:function(t,n,r){i.isElement(t)&&i.isElement(n)&&e.each(r,function(e){l(t,n,e)})}}}),o("ephox.sugar.api.node.Body",["ephox.katamari.api.Thunk","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","global!document"],function(t,e,n,i){var r=function(t){var e=n.isText(t)?t.dom().parentNode:t.dom();return e!==undefined&&null!==e&&e.ownerDocument.body.contains(e)},o=t.cached(function(){return a(e.fromDom(i))}),a=function(t){var n=t.dom().body;if(null===n||n===undefined)throw"Body is not available yet";return e.fromDom(n)};return{body:o,getBody:a,inBody:r}}),o("ephox.sugar.impl.Style",[],function(){return{isSupported:function(t){return t.style!==undefined}}}),o("ephox.sugar.api.properties.Css",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Body","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.impl.Style","ephox.katamari.api.Strings","global!Error","global!console","global!window"],function(t,e,n,i,r,o,a,s,c,u,l,h,d){var f=function(e,n,i){if(!t.isString(i))throw h.error("Invalid call to CSS.set. Property ",n,":: Value ",i,":: Element ",e),new l("CSS value must be a string: "+i);c.isSupported(e)&&e.style.setProperty(n,i)},p=function(t,e){c.isSupported(t)&&t.style.removeProperty(e)},m=function(t,e,n){var i=t.dom();f(i,e,n)},g=function(t,e){var n=t.dom(),i=d.getComputedStyle(n).getPropertyValue(e),r=""!==i||o.inBody(t)?i:v(n,e);return null===r?undefined:r},v=function(t,e){return c.isSupported(t)?t.style.getPropertyValue(e):""},y=function(t,e){var n=t.dom(),r=v(n,e);return i.from(r).filter(function(t){return t.length>0})},b=function(t,e,n){y(t,n).each(function(t){y(e,n).isNone()&&m(e,n,t)})};return{copy:function(t,e){var n=t.dom(),i=e.dom();c.isSupported(n)&&c.isSupported(i)&&(i.style.cssText=n.style.cssText)},set:m,preserve:function(t,e){var n=r.get(t,"style"),i=e(t);return(n===undefined?r.remove:r.set)(t,"style",n),i},setAll:function(t,e){var i=t.dom();n.each(e,function(t,e){f(i,e,t)})},setOptions:function(t,e){var i=t.dom();n.each(e,function(t,e){t.fold(function(){p(i,e)},function(t){f(i,e,t)})})},remove:function(t,e){var n=t.dom();p(n,e),r.has(t,"style")&&""===u.trim(r.get(t,"style"))&&r.remove(t,"style")},get:g,getRaw:y,getAllRaw:function(t){var e={},n=t.dom();if(c.isSupported(n))for(var i=0;i<n.style.length;i++){var r=n.style.item(i);e[r]=n.style[r]}return e},isValidValue:function(t,e,n){var i=a.fromTag(t);m(i,e,n);return y(i,e).isSome()},reflow:function(t){return t.dom().offsetWidth},transfer:function(t,n,i){s.isElement(t)&&s.isElement(n)&&e.each(i,function(e){b(t,n,e)})}}}),o("ephox.katamari.data.Immutable",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","global!Array","global!Error"],function(t,e,n,i){return function(){var r=arguments;return function(){for(var o=new n(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];if(r.length!==o.length)throw new i('Wrong number of arguments to struct. Expected "['+r.length+']", got '+o.length+" arguments");var s={};return t.each(r,function(t,n){s[t]=e.constant(o[n])}),s}}}),o("ephox.katamari.util.BagUtils",["ephox.katamari.api.Arr","ephox.katamari.api.Type","global!Error"],function(t,e,n){var i=function(t){return t.slice(0).sort()};return{sort:i,reqMessage:function(t,e){throw new n("All required keys ("+i(t).join(", ")+") were not specified. Specified keys were: "+i(e).join(", ")+".")},unsuppMessage:function(t){throw new n("Unsupported keys for object: "+i(t).join(", "))},validateStrArr:function(i,r){if(!e.isArray(r))throw new n("The "+i+" fields must be an array. Was: "+r+".");t.each(r,function(t){if(!e.isString(t))throw new n("The value "+t+" in the "+i+" fields was not a string.")})},invalidTypeMessage:function(t,e){throw new n("All values need to be of type: "+e+". Keys ("+i(t).join(", ")+") were not.")},checkDupes:function(e){var r=i(e);t.find(r,function(t,e){return e<r.length-1&&t===r[e+1]}).each(function(t){throw new n("The field: "+t+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})}}}),o("ephox.katamari.data.MixedBag",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.katamari.util.BagUtils","global!Error","global!Object"],function(t,e,n,i,r,o,a){
return function(s,c){var u=s.concat(c);if(0===u.length)throw new o("You must specify at least one required or optional field.");return r.validateStrArr("required",s),r.validateStrArr("optional",c),r.checkDupes(u),function(o){var l=n.keys(o);t.forall(s,function(e){return t.contains(l,e)})||r.reqMessage(s,l);var h=t.filter(l,function(e){return!t.contains(u,e)});h.length>0&&r.unsuppMessage(h);var d={};return t.each(s,function(t){d[t]=e.constant(o[t])}),t.each(c,function(t){d[t]=e.constant(a.prototype.hasOwnProperty.call(o,t)?i.some(o[t]):i.none())}),d}}}),o("ephox.katamari.api.Struct",["ephox.katamari.data.Immutable","ephox.katamari.data.MixedBag"],function(t,e){return{immutable:t,immutableBag:e}}),o("ephox.sugar.alien.Recurse",[],function(){return{toArray:function(t,e){var n=[],i=function(t){return n.push(t),e(t)},r=e(t);do{r=r.bind(i)}while(r.isSome());return n}}}),o("ephox.sand.api.Node",["ephox.sand.util.Global"],function(t){var e=function(){return t.getOrDie("Node")},n=function(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)};return{documentPositionPreceding:function(t,i){return n(t,i,e().DOCUMENT_POSITION_PRECEDING)},documentPositionContainedBy:function(t,i){return n(t,i,e().DOCUMENT_POSITION_CONTAINED_BY)}}}),o("ephox.sugar.api.search.Selectors",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.node.NodeTypes","global!Error","global!document"],function(t,e,n,i,r,o){var a=i.ELEMENT,s=i.DOCUMENT,c=function(t){return t.nodeType!==a&&t.nodeType!==s||0===t.childElementCount};return{all:function(e,i){var r=i===undefined?o:i.dom();return c(r)?[]:t.map(r.querySelectorAll(e),n.fromDom)},is:function(t,e){var n=t.dom();if(n.nodeType!==a)return!1;if(n.matches!==undefined)return n.matches(e);if(n.msMatchesSelector!==undefined)return n.msMatchesSelector(e);if(n.webkitMatchesSelector!==undefined)return n.webkitMatchesSelector(e);if(n.mozMatchesSelector!==undefined)return n.mozMatchesSelector(e);throw new r("Browser lacks native selectors")},one:function(t,i){var r=i===undefined?o:i.dom();return c(r)?e.none():e.from(r.querySelector(t)).map(n.fromDom)}}}),o("ephox.sugar.api.dom.Compare",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sand.api.Node","ephox.sand.api.PlatformDetection","ephox.sugar.api.search.Selectors"],function(t,e,n,i,r){var o=function(t,e){return t.dom()===e.dom()},a=function(t,e){return t.dom().isEqualNode(e.dom())},s=function(n,i){return t.exists(i,e.curry(o,n))},c=function(t,e){var n=t.dom(),i=e.dom();return n!==i&&n.contains(i)},u=function(t,e){return n.documentPositionContainedBy(t.dom(),e.dom())},l=i.detect().browser.isIE()?u:c;return{eq:o,isEqualNode:a,member:s,contains:l,is:r.is}}),o("ephox.sugar.api.search.Traverse",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.sugar.alien.Recurse","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element"],function(t,e,n,i,r,o,a,s){var c=function(t){return s.fromDom(t.dom().ownerDocument)},u=function(t){var e=c(t);return s.fromDom(e.dom().documentElement)},l=function(t){var e=t.dom().ownerDocument.defaultView;return s.fromDom(e)},h=function(t){var e=t.dom();return i.from(e.parentNode).map(s.fromDom)},d=function(t){return h(t).bind(function(n){var i=_(n);return e.findIndex(i,function(e){return a.eq(t,e)})})},f=function(e,i){for(var r=t.isFunction(i)?i:n.constant(!1),o=e.dom(),a=[];null!==o.parentNode&&o.parentNode!==undefined;){var c=o.parentNode,u=s.fromDom(c);if(a.push(u),!0===r(u))break;o=c}return a},p=function(t){var n=function(n){return e.filter(n,function(e){return!a.eq(t,e)})};return h(t).map(_).map(n).getOr([])},m=function(t){var e=t.dom();return i.from(e.offsetParent).map(s.fromDom)},g=function(t){var e=t.dom();return i.from(e.previousSibling).map(s.fromDom)},v=function(t){var e=t.dom();return i.from(e.nextSibling).map(s.fromDom)},y=function(t){return e.reverse(o.toArray(t,g))},b=function(t){return o.toArray(t,v)},_=function(t){var n=t.dom();return e.map(n.childNodes,s.fromDom)},x=function(t,e){var n=t.dom().childNodes;return i.from(n[e]).map(s.fromDom)},w=function(t){return x(t,0)},S=function(t){return x(t,t.dom().childNodes.length-1)},k=function(t){return t.dom().childNodes.length},E=r.immutable("element","offset");return{owner:c,defaultView:l,documentElement:u,parent:h,findIndex:d,parents:f,siblings:p,prevSibling:g,offsetParent:m,prevSiblings:y,nextSibling:v,nextSiblings:b,children:_,child:x,firstChild:w,lastChild:S,childNodesCount:k,leaf:function(t,e){var n=_(t);return n.length>0&&e<n.length?E(n[e],0):E(t,e)}}}),o("tinymce.core.dom.Position",["ephox.katamari.api.Arr","ephox.sand.api.PlatformDetection","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Css","ephox.sugar.api.search.Traverse"],function(t,e,n,i,r,o){var a=e.detect().browser,s=function(e){return t.find(e,i.isElement)},c=function(t){return a.isFirefox()&&"table"===i.name(t)?s(o.children(t)).filter(function(t){return"caption"===i.name(t)}).bind(function(t){return s(o.nextSiblings(t)).map(function(e){var n=e.dom().offsetTop,i=t.dom().offsetTop,r=t.dom().offsetHeight;return n<=i?-r:0})}).getOr(0):0};return{getPos:function(t,e,i){var o,a,s=0,u=0,l=t.ownerDocument;if(i=i||t,e){if(i===t&&e.getBoundingClientRect&&"static"===r.get(n.fromDom(t),"position"))return a=e.getBoundingClientRect(),s=a.left+(l.documentElement.scrollLeft||t.scrollLeft)-l.documentElement.clientLeft,u=a.top+(l.documentElement.scrollTop||t.scrollTop)-l.documentElement.clientTop,{x:s,y:u};for(o=e;o&&o!==i&&o.nodeType;)s+=o.offsetLeft||0,u+=o.offsetTop||0,o=o.offsetParent;for(o=e.parentNode;o&&o!==i&&o.nodeType;)s-=o.scrollLeft||0,u-=o.scrollTop||0,o=o.parentNode;u+=c(n.fromDom(e))}return{x:s,y:u}}}}),o("ephox.katamari.api.LazyValue",["ephox.katamari.api.Arr","ephox.katamari.api.Option","global!setTimeout"],function(t,e,n){var i=function(r){var o=e.none(),a=[],s=function(t){return i(function(e){c(function(n){e(t(n))})})},c=function(t){l()?d(t):a.push(t)},u=function(t){o=e.some(t),h(a),a=[]},l=function(){return o.isSome()},h=function(e){t.each(e,d)},d=function(t){o.each(function(e){n(function(){t(e)},0)})};return r(u),{get:c,map:s,isReady:l}};return{nu:i,pure:function(t){return i(function(e){e(t)})}}}),o("ephox.katamari.async.Bounce",["global!Array","global!setTimeout"],function(t,e){return{bounce:function(n){return function(){var i=t.prototype.slice.call(arguments),r=this;e(function(){n.apply(r,i)},0)}}}}),o("ephox.katamari.api.Future",["ephox.katamari.api.LazyValue","ephox.katamari.async.Bounce"],function(t,e){var n=function(i){var r=function(t){i(e.bounce(t))};return{map:function(t){return n(function(e){r(function(n){var i=t(n);e(i)})})},bind:function(t){return n(function(e){r(function(n){t(n).get(e)})})},anonBind:function(t){return n(function(e){r(function(){t.get(e)})})},toLazy:function(){return t.nu(r)},get:r}};return{nu:n,pure:function(t){return n(function(e){e(t)})}}}),o("ephox.katamari.async.AsyncValues",["ephox.katamari.api.Arr"],function(t){return{par:function(e,n){return n(function(n){var i=[],r=0,o=function(t){return function(o){i[t]=o,++r>=e.length&&n(i)}};0===e.length?n([]):t.each(e,function(t,e){t.get(o(e))})})}}}),o("ephox.katamari.api.Futures",["ephox.katamari.api.Arr","ephox.katamari.api.Future","ephox.katamari.async.AsyncValues"],function(t,e,n){var i=function(t){return n.par(t,e.nu)};return{par:i,mapM:function(e,n){var r=t.map(e,n);return i(r)},compose:function(t,e){return function(n){return e(n).bind(t)}}}}),o("ephox.katamari.api.Result",["ephox.katamari.api.Fun","ephox.katamari.api.Option"],function(t,e){var n=function(i){var r=function(){return n(i)},o=function(){return n(i)},a=function(t){return n(t(i))},s=function(t){t(i)},c=function(t){return t(i)},u=function(t,e){return e(i)},l=function(t){return t(i)},h=function(t){return t(i)},d=function(){return e.some(i)};return{is:function(t){return i===t},isValue:t.constant(!0),isError:t.constant(!1),getOr:t.constant(i),getOrThunk:t.constant(i),getOrDie:t.constant(i),or:r,orThunk:o,fold:u,map:a,each:s,bind:c,exists:l,forall:h,toOption:d}},i=function(n){var r=function(t){return t()},o=function(){return t.die(n)()},a=function(t){return t},s=function(t){return t()},c=function(){return i(n)},u=function(){return i(n)},l=function(t){return t(n)};return{is:t.constant(!1),isValue:t.constant(!1),isError:t.constant(!0),getOr:t.identity,getOrThunk:r,getOrDie:o,or:a,orThunk:s,fold:l,map:c,each:t.noop,bind:u,exists:t.constant(!1),forall:t.constant(!0),toOption:e.none}};return{value:n,error:i}}),o("tinymce.core.dom.StyleSheetLoader",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Future","ephox.katamari.api.Futures","ephox.katamari.api.Result","global!navigator","tinymce.core.util.Delay","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s){"use strict";return function(c,u){var l,h=0,d={};l=(u=u||{}).maxLoadTime||5e3;var f=function(t){c.getElementsByTagName("head")[0].appendChild(t)},p=function(t,e,n){var i,r,u,p,m=function(){for(var t=p.passed,e=t.length;e--;)t[e]();p.status=2,p.passed=[],p.failed=[]},g=function(){for(var t=p.failed,e=t.length;e--;)t[e]();p.status=3,p.passed=[],p.failed=[]},v=function(){var t=o.userAgent.match(/WebKit\/(\d*)/);return!!(t&&t[1]<536)},y=function(t,e){t()||((new Date).getTime()-u<l?a.setTimeout(e):g())},b=function(){y(function(){for(var t,e,n=c.styleSheets,r=n.length;r--;)if(t=n[r],(e=t.ownerNode?t.ownerNode:t.owningElement)&&e.id===i.id)return m(),!0},b)},_=function(){y(function(){try{var t=r.sheet.cssRules;return m(),!!t}catch(e){}},_)};if(t=s._addCacheSuffix(t),d[t]?p=d[t]:(p={passed:[],failed:[]},d[t]=p),e&&p.passed.push(e),n&&p.failed.push(n),1!=p.status)if(2!=p.status)if(3!=p.status){if(p.status=1,i=c.createElement("link"),i.rel="stylesheet",i.type="text/css",i.id="u"+h++,i.async=!1,i.defer=!1,u=(new Date).getTime(),"onload"in i&&!v())i.onload=b,i.onerror=g;else{if(o.userAgent.indexOf("Firefox")>0)return r=c.createElement("style"),r.textContent='@import "'+t+'"',_(),void f(r);b()}f(i),i.href=t}else g();else m()},m=function(t){return n.nu(function(n){p(t,e.compose(n,e.constant(r.value(t))),e.compose(n,e.constant(r.error(t))))})},g=function(t){return t.fold(e.identity,e.identity)};return{load:p,loadAll:function(e,n,r){i.par(t.map(e,m)).get(function(e){var i=t.partition(e,function(t){return t.isValue()});i.fail.length>0?r(i.fail.map(g)):n(i.pass.map(g))})}}}}),o("tinymce.core.dom.TreeWalker",[],function(){return function(t,e){var n=t,i=function(t,n,i,r){var o,a;if(t){if(!r&&t[n])return t[n];if(t!=e){if(o=t[i])return o;for(a=t.parentNode;a&&a!=e;a=a.parentNode)if(o=a[i])return o}}},r=function(t,n,i,r){var o,a,s;if(t){if(o=t[i],e&&o===e)return;if(o){if(!r)for(s=o[n];s;s=s[n])if(!s[n])return s;return o}if((a=t.parentNode)&&a!==e)return a}};this.current=function(){return n},this.next=function(t){return n=i(n,"firstChild","nextSibling",t)},this.prev=function(t){return n=i(n,"lastChild","previousSibling",t)},this.prev2=function(t){return n=r(n,"lastChild","previousSibling",t)}}}),o("tinymce.core.dom.ElementType",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.node.Node"],function(t,e,n){var i=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],r=["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed","source","wbr","track"],o=["td","th"],a=["thead","tbody","tfoot"],s=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],c=["li","dd","dt"],u=["ul","ol","dl"],l=function(i){var r;return function(o){return(r=r||t.mapToObject(i,e.constant(!0))).hasOwnProperty(n.name(o))}},h=l(["h1","h2","h3","h4","h5","h6"]),d=l(i),f=function(t){return n.isElement(t)&&"br"===n.name(t)};return{isBlock:d,isInline:function(t){return n.isElement(t)&&!d(t)},isHeading:h,isTextBlock:l(s),isList:l(u),isListItem:l(c),isVoid:l(r),isTableSection:l(a),isTableCell:l(o),isBr:f}}),o("tinymce.core.dom.NodeType",[],function(){var t=function(t){return function(e){return!!e&&e.nodeType==t}},e=t(1),n=function(t){return t=t.toLowerCase().split(" "),function(e){var n,i;if(e&&e.nodeType)for(i=e.nodeName.toLowerCase(),n=0;n<t.length;n++)if(i===t[n])return!0;return!1}},i=function(t,n){return n=n.toLowerCase().split(" "),function(i){var r;if(e(i))for(r=0;r<n.length;r++)if(i.ownerDocument.defaultView.getComputedStyle(i,null).getPropertyValue(t)===n[r])return!0;return!1}},r=function(t,n){return function(i){return e(i)&&i[t]===n}},o=function(t){return function(n){return e(n)&&n.hasAttribute(t)}},a=function(t,n){return function(i){return e(i)&&i.getAttribute(t)===n}},s=function(t){return e(t)&&t.hasAttribute("data-mce-bogus")},c=function(t){return function(n){if(e(n)){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}};return{isText:t(3),isElement:e,isComment:t(8),isDocument:t(9),isBr:n("br"),isContentEditableTrue:c("true"),isContentEditableFalse:c("false"),matchNodeNames:n,hasPropValue:r,hasAttribute:o,hasAttributeValue:a,matchStyleValues:i,isBogus:s}}),o("tinymce.core.dom.TrimNode",["ephox.sugar.api.node.Element","tinymce.core.dom.ElementType","tinymce.core.dom.NodeType","tinymce.core.util.Tools"],function(t,e,n,i){var r=function(t){var e=t.previousSibling&&"SPAN"===t.previousSibling.nodeName,n=t.nextSibling&&"SPAN"===t.nextSibling.nodeName;return e&&n},o=function(t){return t&&"SPAN"===t.tagName&&"bookmark"===t.getAttribute("data-mce-type")},a=function(s,c){var u,l=c.childNodes;if(!n.isElement(c)||!o(c)){for(u=l.length-1;u>=0;u--)a(s,l[u]);if(!1===n.isDocument(c)){if(n.isText(c)&&c.nodeValue.length>0){var h=i.trim(c.nodeValue).length;if(s.isBlock(c.parentNode)||h>0)return;if(0===h&&r(c))return}else if(n.isElement(c)&&(1===(l=c.childNodes).length&&o(l[0])&&c.parentNode.insertBefore(l[0],c),l.length||e.isVoid(t.fromDom(c))))return;s.remove(c)}return c}};return{trimNode:a}}),o("tinymce.core.html.Entities",["ephox.sugar.api.node.Element","tinymce.core.util.Tools"],function(t,e){var n,i,r,o=e.makeMap,a=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,s=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,c=/[<>&\"\']/g,u=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,l={128:"\u20ac",130:"\u201a",131:"\u0192",132:"\u201e",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02c6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017d",145:"\u2018",146:"\u2019",147:"\u201c",148:"\u201d",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02dc",153:"\u2122",154:"\u0161",155:"\u203a",156:"\u0153",158:"\u017e",159:"\u0178"};i={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},r={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};var h=function(e){var n;return n=t.fromTag("div").dom(),n.innerHTML=e,n.textContent||n.innerText||e},d=function(t,e){var n,r,o,a={};if(t){for(t=t.split(","),e=e||10,n=0;n<t.length;n+=2)r=String.fromCharCode(parseInt(t[n],e)),i[r]||(o="&"+t[n+1]+";",a[r]=o,a[o]=r);return a}};n=d("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var f={encodeRaw:function(t,e){return t.replace(e?a:s,function(t){return i[t]||t})},encodeAllRaw:function(t){return(""+t).replace(c,function(t){return i[t]||t})},encodeNumeric:function(t,e){return t.replace(e?a:s,function(t){return t.length>1?"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";":i[t]||"&#"+t.charCodeAt(0)+";"})},encodeNamed:function(t,e,r){return r=r||n,t.replace(e?a:s,function(t){return i[t]||r[t]||t})},getEncodeFunc:function(t,e){e=d(e)||n;var r=function(t,n){return t.replace(n?a:s,function(t){return i[t]!==undefined?i[t]:e[t]!==undefined?e[t]:t.length>1?"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";":"&#"+t.charCodeAt(0)+";"})},c=function(t,n){return f.encodeNamed(t,n,e)};return(t=o(t.replace(/\+/g,","))).named&&t.numeric?r:t.named?e?c:f.encodeNamed:t.numeric?f.encodeNumeric:f.encodeRaw},decode:function(t){return t.replace(u,function(t,e){return e?(e="x"===e.charAt(0).toLowerCase()?parseInt(e.substr(1),16):parseInt(e,10))>65535?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):l[e]||String.fromCharCode(e):r[t]||n[t]||h(t)})}};return f}),o("tinymce.core.html.Schema",["tinymce.core.util.Tools"],function(t){var e={},n={},i=t.makeMap,r=t.each,o=t.extend,a=t.explode,s=t.inArray,c=function(e,n){return(e=t.trim(e))?e.split(n||" "):[]},u=function(t){var i,o,a,s,u,l,h={},d=function(t,e,r){var o,a,s,u=function(t,e){var n,i,r={};for(n=0,i=t.length;n<i;n++)r[t[n]]=e||{};return r};for(r=r||[],e=e||"","string"==typeof r&&(r=c(r)),o=(t=c(t)).length;o--;)s={attributes:u(a=c([i,e].join(" "))),attributesOrder:a,children:u(r,n)},h[t[o]]=s},f=function(t,e){var n,i,r,o;for(n=(t=c(t)).length,e=c(e);n--;)for(i=h[t[n]],r=0,o=e.length;r<o;r++)i.attributes[e[r]]={},i.attributesOrder.push(e[r])};return e[t]?e[t]:(i="id accesskey class dir lang style tabindex title role",o="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",a="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!=t&&(i+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",o+=" article aside details dialog figure header footer hgroup section nav",a+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!=t&&(i+=" xml:lang",a=[a,l="acronym applet basefont big font strike tt"].join(" "),r(c(l),function(t){d(t,"",a)}),o=[o,u="center dir isindex noframes"].join(" "),s=[o,a].join(" "),r(c(u),function(t){d(t,"",s)})),s=s||[o,a].join(" "),d("html","manifest","head body"),d("head","","base command link meta noscript script style title"),d("title hr noscript br"),d("base","href target"),d("link","href rel media hreflang type sizes hreflang"),d("meta","name http-equiv content charset"),d("style","media type scoped"),d("script","src async defer type charset"),d("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",s),d("address dt dd div caption","",s),d("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",a),d("blockquote","cite",s),d("ol","reversed start type","li"),d("ul","","li"),d("li","value",s),d("dl","","dt dd"),d("a","href target rel media hreflang type",a),d("q","cite",a),d("ins del","cite datetime",s),d("img","src sizes srcset alt usemap ismap width height"),d("iframe","src name width height",s),d("embed","src type width height"),d("object","data type typemustmatch name usemap form width height",[s,"param"].join(" ")),d("param","name value"),d("map","name",[s,"area"].join(" ")),d("area","alt coords shape href target rel media hreflang type"),d("table","border","caption colgroup thead tfoot tbody tr"+("html4"==t?" col":"")),d("colgroup","span","col"),d("col","span"),d("tbody thead tfoot","","tr"),d("tr","","td th"),d("td","colspan rowspan headers",s),d("th","colspan rowspan headers scope abbr",s),d("form","accept-charset action autocomplete enctype method name novalidate target",s),d("fieldset","disabled form name",[s,"legend"].join(" ")),d("label","form for",a),d("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),d("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"==t?s:a),d("select","disabled form multiple name required size","option optgroup"),d("optgroup","disabled label","option"),d("option","disabled label selected value"),d("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),d("menu","type label",[s,"li"].join(" ")),d("noscript","",s),"html4"!=t&&(d("wbr"),d("ruby","",[a,"rt rp"].join(" ")),d("figcaption","",s),d("mark rt rp summary bdi","",a),d("canvas","width height",s),d("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[s,"track source"].join(" ")),d("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[s,"track source"].join(" ")),d("picture","","img source"),d("source","src srcset type media sizes"),d("track","kind src srclang label default"),d("datalist","",[a,"option"].join(" ")),d("article section nav aside header footer","",s),d("hgroup","","h1 h2 h3 h4 h5 h6"),d("figure","",[s,"figcaption"].join(" ")),d("time","datetime",a),d("dialog","open",s),d("command","type label icon disabled checked radiogroup command"),d("output","for form name",a),d("progress","value max",a),d("meter","value min max low high optimum",a),d("details","open",[s,"summary"].join(" ")),d("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!=t&&(f("script","language xml:space"),f("style","xml:space"),f("object","declare classid code codebase codetype archive standby align border hspace vspace"),f("embed","align name hspace vspace"),f("param","valuetype type"),f("a","charset name rev shape coords"),f("br","clear"),f("applet","codebase archive code object alt name width height align hspace vspace"),f("img","name longdesc align border hspace vspace"),f("iframe","longdesc frameborder marginwidth marginheight scrolling align"),f("font basefont","size color face"),f("input","usemap align"),f("select","onchange"),f("textarea"),f("h1 h2 h3 h4 h5 h6 div p legend caption","align"),f("ul","type compact"),f("li","type"),f("ol dl menu dir","compact"),f("pre","width xml:space"),f("hr","align noshade size width"),f("isindex","prompt"),f("table","summary width frame rules cellspacing cellpadding align bgcolor"),f("col","width align char charoff valign"),f("colgroup","width align char charoff valign"),f("thead","align char charoff valign"),f("tr","align char charoff valign bgcolor"),f("th","axis align char charoff valign nowrap bgcolor width height"),f("form","accept"),f("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),f("tfoot","align char charoff valign"),f("tbody","align char charoff valign"),f("area","nohref"),f("body","background bgcolor text link vlink alink")),"html4"!=t&&(f("input button select textarea","autofocus"),f("input textarea","placeholder"),f("a","download"),f("link script img","crossorigin"),f("iframe","sandbox seamless allowfullscreen")),r(c("a form meter progress dfn"),function(t){h[t]&&delete h[t].children[t]}),delete h.caption.children.table,delete h.script,e[t]=h,h)},l=function(t,e){var n;return t&&(n={},"string"==typeof t&&(t={"*":t}),r(t,function(t,r){n[r]=n[r.toUpperCase()]="map"==e?i(t,/[, ]/):a(t,/[, ]/)})),n};return function(t){var n,h,d,f,p,m,g,v,y,b,_,x,w,S=this,k={},E={},T=[],C={},L={},P=function(n,r,a){var s=t[n];return s?s=i(s,/[, ]/,i(s.toUpperCase(),/[, ]/)):(s=e[n])||(s=i(r," ",i(r.toUpperCase()," ")),s=o(s,a),e[n]=s),s};d=u((t=t||{}).schema),!1===t.verify_html&&(t.valid_elements="*[*]"),n=l(t.valid_styles),h=l(t.invalid_styles,"map"),v=l(t.valid_classes,"map"),f=P("whitespace_elements","pre script noscript style textarea video audio iframe object code"),p=P("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),m=P("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),g=P("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),b=P("non_empty_elements","td th iframe video audio object script pre code",m),_=P("move_caret_before_on_enter_elements","table",b),x=P("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure"),y=P("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption",x),w=P("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp"),r((t.special||"script noscript noframes noembed title style textarea xmp").split(" "),function(t){L[t]=new RegExp("</"+t+"[^>]*>","gi")});var A=function(t){return new RegExp("^"+t.replace(/([?+*])/g,".$1")+"$")},N=function(t){var e,n,r,o,a,u,l,h,d,f,p,m,g,v,y,b,_,x,w,S=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,E=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,C=/[*?+]/;if(t)for(t=c(t,","),k["@"]&&(b=k["@"].attributes,_=k["@"].attributesOrder),e=0,n=t.length;e<n;e++)if(a=S.exec(t[e])){if(v=a[1],d=a[2],y=a[3],h=a[5],m={},g=[],u={attributes:m,attributesOrder:g},"#"===v&&(u.paddEmpty=!0),"-"===v&&(u.removeEmpty=!0),"!"===a[4]&&(u.removeEmptyAttrs=!0),b){for(x in b)m[x]=b[x];g.push.apply(g,_)}if(h)for(r=0,o=(h=c(h,"|")).length;r<o;r++)if(a=E.exec(h[r])){if(l={},p=a[1],f=a[2].replace(/[\\:]:/g,":"),v=a[3],w=a[4],"!"===p&&(u.attributesRequired=u.attributesRequired||[],u.attributesRequired.push(f),l.required=!0),"-"===p){delete m[f],g.splice(s(g,f),1);continue}v&&("="===v&&(u.attributesDefault=u.attributesDefault||[],u.attributesDefault.push({name:f,value:w}),l.defaultValue=w),":"===v&&(u.attributesForced=u.attributesForced||[],u.attributesForced.push({name:f,value:w}),l.forcedValue=w),"<"===v&&(l.validValues=i(w,"?"))),C.test(f)?(u.attributePatterns=u.attributePatterns||[],l.pattern=A(f),u.attributePatterns.push(l)):(m[f]||g.push(f),m[f]=l)}b||"@"!=d||(b=m,_=g),y&&(u.outputName=d,k[y]=u),C.test(d)?(u.pattern=A(d),T.push(u)):k[d]=u}},R=function(t){k={},T=[],N(t),r(d,function(t,e){E[e]=t.children})},I=function(t){var n=/^(~)?(.+)$/;t&&(e.text_block_elements=e.block_elements=null,r(c(t,","),function(t){var e=n.exec(t),i="~"===e[1],a=i?"span":"div",s=e[2];if(E[s]=E[a],C[s]=a,i||(y[s.toUpperCase()]={},y[s]={}),!k[s]){var c=k[a];delete(c=o({},c)).removeEmptyAttrs,delete c.removeEmpty,k[s]=c}r(E,function(t,e){t[a]&&(E[e]=t=o({},E[e]),t[s]=t[a])})}))},D=function(n){var i=/^([+\-]?)(\w+)\[([^\]]+)\]$/;e[t.schema]=null,n&&r(c(n,","),function(t){var e,n,o=i.exec(t);o&&(n=o[1],e=n?E[o[2]]:E[o[2]]={"#comment":{}},e=E[o[2]],r(c(o[3],"|"),function(t){"-"===n?delete e[t]:e[t]={}}))})},O=function(t){var e,n=k[t];if(n)return n;for(e=T.length;e--;)if((n=T[e]).pattern.test(t))return n};t.valid_elements?R(t.valid_elements):(r(d,function(t,e){k[e]={attributes:t.attributes,attributesOrder:t.attributesOrder},E[e]=t.children}),"html5"!=t.schema&&r(c("strong/b em/i"),function(t){t=c(t,"/"),k[t[1]].outputName=t[0]}),r(c("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(t){k[t]&&(k[t].removeEmpty=!0)}),r(c("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),function(t){k[t].paddEmpty=!0}),r(c("span"),function(t){k[t].removeEmptyAttrs=!0})),I(t.custom_elements),D(t.valid_children),N(t.extended_valid_elements),D("+ol[ul|ol],+ul[ul|ol]"),r({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},function(t,e){k[e]&&(k[e].parentsRequired=c(t))}),t.invalid_elements&&r(a(t.invalid_elements),function(t){k[t]&&delete k[t]}),O("span")||N("span[!data-mce-type|*]"),S.children=E,S.getValidStyles=function(){return n},S.getInvalidStyles=function(){return h},S.getValidClasses=function(){return v},S.getBoolAttrs=function(){return g},S.getBlockElements=function(){return y},S.getTextBlockElements=function(){return x},S.getTextInlineElements=function(){return w},S.getShortEndedElements=function(){return m},S.getSelfClosingElements=function(){return p},S.getNonEmptyElements=function(){return b},S.getMoveCaretBeforeOnEnterElements=function(){return _},S.getWhiteSpaceElements=function(){return f},S.getSpecialElements=function(){return L},S.isValidChild=function(t,e){var n=E[t.toLowerCase()];return!(!n||!n[e.toLowerCase()])},S.isValid=function(t,e){var n,i,r=O(t);if(r){if(!e)return!0;if(r.attributes[e])return!0;if(n=r.attributePatterns)for(i=n.length;i--;)if(n[i].pattern.test(t))return!0}return!1},S.getElementRule=O,S.getCustomElements=function(){return C},S.addValidElements=N,S.setValidElements=R,S.addCustomElements=I,S.addValidChildren=D,S.elements=k}}),o("tinymce.core.html.Styles",[],function(){return function(t,e){var n,i,r,o,a=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,s=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,c=/\s*([^:]+):\s*([^;]+);?/g,u=/\s+$/,l={},h="\ufeff";for(t=t||{},e&&(r=e.getValidStyles(),o=e.getInvalidStyles()),i=("\\\" \\' \\; \\: ; : "+h).split(" "),n=0;n<i.length;n++)l[i[n]]=h+n,l[h+n]=i[n];var d=function(t,e,n,i){var r=function(t){return(t=parseInt(t,10).toString(16)).length>1?t:"0"+t};return"#"+r(e)+r(n)+r(i)};return{toHex:function(t){return t.replace(a,d)},parse:function(e){var i,r,o,f,p={},m=t.url_converter,g=t.url_converter_scope||this,v=function(t,e,i){var r,o,a,s;if((r=p[t+"-top"+e])&&(o=p[t+"-right"+e])&&(a=p[t+"-bottom"+e])&&(s=p[t+"-left"+e])){var c=[r,o,a,s];for(n=c.length-1;n--&&c[n]===c[n+1];);n>-1&&i||(p[t+e]=-1==n?c[0]:c.join(" "),delete p[t+"-top"+e],delete p[t+"-right"+e],delete p[t+"-bottom"+e],delete p[t+"-left"+e])}},y=function(t){var e,n=p[t];if(n){for(e=(n=n.split(" ")).length;e--;)if(n[e]!==n[0])return!1;return p[t]=n[0],!0}},b=function(t,e,n,i){y(e)&&y(n)&&y(i)&&(p[t]=p[e]+" "+p[n]+" "+p[i],delete p[e],delete p[n],delete p[i])},_=function(t){return f=!0,l[t]},x=function(t,e){return f&&(t=t.replace(/\uFEFF[0-9]/g,function(t){return l[t]})),e||(t=t.replace(/\\([\'\";:])/g,"$1")),t},w=function(t){return String.fromCharCode(parseInt(t.slice(1),16))},S=function(t){return t.replace(/\\[0-9a-f]+/gi,w)},k=function(e,n,i,r,o,a){if(o=o||a)return"'"+(o=x(o)).replace(/\'/g,"\\'")+"'";if(n=x(n||i||r),!t.allow_script_urls){var s=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(s))return"";if(!t.allow_svg_data_urls&&/^data:image\/svg/i.test(s))return""}return m&&(n=m.call(g,n,"style")),
"url('"+n.replace(/\'/g,"\\'")+"')"};if(e){for(e=(e=e.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,_).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(t){return t.replace(/[;:]/g,_)});i=c.exec(e);)if(c.lastIndex=i.index+i[0].length,r=i[1].replace(u,"").toLowerCase(),o=i[2].replace(u,""),r&&o){if(r=S(r),o=S(o),-1!==r.indexOf(h)||-1!==r.indexOf('"'))continue;if(!t.allow_script_urls&&("behavior"==r||/expression\s*\(|\/\*|\*\//.test(o)))continue;"font-weight"===r&&"700"===o?o="bold":"color"!==r&&"background-color"!==r||(o=o.toLowerCase()),o=(o=o.replace(a,d)).replace(s,k),p[r]=f?x(o,!0):o}v("border","",!0),v("border","-width"),v("border","-color"),v("border","-style"),v("padding",""),v("margin",""),b("border","border-width","border-style","border-color"),"medium none"===p.border&&delete p.border,"none"===p["border-image"]&&delete p["border-image"]}return p},serialize:function(t,e){var n,i,a="",s=function(e){var n,i,o,s;if(n=r[e])for(i=0,o=n.length;i<o;i++)e=n[i],(s=t[e])&&(a+=(a.length>0?" ":"")+e+": "+s+";")},c=function(t,e){var n;return(!(n=o["*"])||!n[t])&&(!(n=o[e])||!n[t])};if(e&&r)s("*"),s(e);else for(n in t)!(i=t[n])||o&&!c(n,e)||(a+=(a.length>0?" ":"")+n+": "+i+";");return a}}}}),o("tinymce.core.dom.DOMUtils",["global!document","global!window","tinymce.core.Env","tinymce.core.dom.DomQuery","tinymce.core.dom.EventUtils","tinymce.core.dom.Position","tinymce.core.dom.Sizzle","tinymce.core.dom.StyleSheetLoader","tinymce.core.dom.TreeWalker","tinymce.core.dom.TrimNode","tinymce.core.html.Entities","tinymce.core.html.Schema","tinymce.core.html.Styles","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f){var p=f.each,m=f.is,g=f.grep,v=n.ie,y=/^([a-z0-9],?)+$/i,b=/^[ \t\r\n]*$/,_=function(t,e){var n,i={},r=e.keep_values;return n={set:function(n,i,r){e.url_converter&&(i=e.url_converter.call(e.url_converter_scope||t,i,r,n[0])),n.attr("data-mce-"+r,i).attr(r,i)},get:function(t,e){return t.attr("data-mce-"+e)||t.attr(e)}},i={style:{set:function(t,e){null===e||"object"!=typeof e?(r&&t.attr("data-mce-style",e),t.attr("style",e)):t.css(e)},get:function(e){var n=e.attr("data-mce-style")||e.attr("style");return n=t.serializeStyle(t.parseStyle(n),e[0].nodeName)}}},r&&(i.href=i.src=n),i},x=function(t,e){var n=e.attr("style");(n=t.serializeStyle(t.parseStyle(n),e[0].nodeName))||(n=null),e.attr("data-mce-style",n)},w=function(t,e){var n,i,r=0;if(t)for(n=t.nodeType,t=t.previousSibling;t;t=t.previousSibling)i=t.nodeType,(!e||3!=i||i!=n&&t.nodeValue.length)&&(r++,n=i);return r},S=function(t,n){var o,a=this;a.doc=t,a.win=e,a.files={},a.counter=0,a.stdMode=!v||t.documentMode>=8,a.boxModel=!v||"CSS1Compat"==t.compatMode||a.stdMode,a.styleSheetLoader=new s(t),a.boundEvents=[],a.settings=n=n||{},a.schema=n.schema?n.schema:new h({}),a.styles=new d({url_converter:n.url_converter,url_converter_scope:n.url_converter_scope},n.schema),a.fixDoc(t),a.events=n.ownEvents?new r(n.proxy):r.Event,a.attrHooks=_(a,n),o=a.schema.getBlockElements(),a.$=i.overrideDefaults(function(){return{context:t,element:a.getRoot()}}),a.isBlock=function(t){if(!t)return!1;var e=t.nodeType;return e?!(1!==e||!o[t.nodeName]):!!o[t]}};return S.prototype={$$:function(t){return"string"==typeof t&&(t=this.get(t)),this.$(t)},root:null,fixDoc:function(t){var e,n=this.settings;if(v&&n.schema){"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(e){t.createElement(e)});for(e in n.schema.getCustomElements())t.createElement(e)}},clone:function(t,e){var n,i,r=this;return!v||1!==t.nodeType||e?t.cloneNode(e):(i=r.doc,e?n.firstChild:(n=i.createElement(t.nodeName),p(r.getAttribs(t),function(e){r.setAttrib(n,e.nodeName,r.getAttrib(t,e.nodeName))}),n))},getRoot:function(){var t=this;return t.settings.root_element||t.doc.body},getViewPort:function(t){var e,n;return t=t||this.win,e=t.document,n=this.boxModel?e.documentElement:e.body,{x:t.pageXOffset||n.scrollLeft,y:t.pageYOffset||n.scrollTop,w:t.innerWidth||n.clientWidth,h:t.innerHeight||n.clientHeight}},getRect:function(t){var e,n,i=this;return t=i.get(t),e=i.getPos(t),n=i.getSize(t),{x:e.x,y:e.y,w:n.w,h:n.h}},getSize:function(t){var e,n,i=this;return t=i.get(t),e=i.getStyle(t,"width"),n=i.getStyle(t,"height"),-1===e.indexOf("px")&&(e=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(e,10)||t.offsetWidth||t.clientWidth,h:parseInt(n,10)||t.offsetHeight||t.clientHeight}},getParent:function(t,e,n){return this.getParents(t,e,n,!1)},getParents:function(t,e,n,i){var r,o=this,a=[];for(t=o.get(t),i=i===undefined,n=n||("BODY"!=o.getRoot().nodeName?o.getRoot().parentNode:null),m(e,"string")&&(r=e,e="*"===e?function(t){return 1==t.nodeType}:function(t){return o.is(t,r)});t&&t!=n&&t.nodeType&&9!==t.nodeType;){if(!e||e(t)){if(!i)return t;a.push(t)}t=t.parentNode}return i?a:null},get:function(t){var e;return t&&this.doc&&"string"==typeof t&&(e=t,(t=this.doc.getElementById(t))&&t.id!==e)?this.doc.getElementsByName(e)[1]:t},getNext:function(t,e){return this._findSib(t,e,"nextSibling")},getPrev:function(t,e){return this._findSib(t,e,"previousSibling")},select:function(t,e){var n=this;return a(t,n.get(e)||n.settings.root_element||n.doc,[])},is:function(t,e){var n;if(!t)return!1;if(t.length===undefined){if("*"===e)return 1==t.nodeType;if(y.test(e)){for(e=e.toLowerCase().split(/,/),t=t.nodeName.toLowerCase(),n=e.length-1;n>=0;n--)if(e[n]==t)return!0;return!1}}if(t.nodeType&&1!=t.nodeType)return!1;var i=t.nodeType?[t]:t;return a(e,i[0].ownerDocument||i[0],null,i).length>0},add:function(t,e,n,i,r){var o=this;return this.run(t,function(t){var a;return a=m(e,"string")?o.doc.createElement(e):e,o.setAttribs(a,n),i&&(i.nodeType?a.appendChild(i):o.setHTML(a,i)),r?a:t.appendChild(a)})},create:function(t,e,n){return this.add(this.doc.createElement(t),t,e,n,1)},createHTML:function(t,e,n){var i,r="";r+="<"+t;for(i in e)e.hasOwnProperty(i)&&null!==e[i]&&"undefined"!=typeof e[i]&&(r+=" "+i+'="'+this.encode(e[i])+'"');return void 0!==n?r+">"+n+"</"+t+">":r+" />"},createFragment:function(t){var e,n,i,r=this.doc;for(i=r.createElement("div"),e=r.createDocumentFragment(),t&&(i.innerHTML=t);n=i.firstChild;)e.appendChild(n);return e},remove:function(t,e){return t=this.$$(t),e?t.each(function(){for(var t;t=this.firstChild;)3==t.nodeType&&0===t.data.length?this.removeChild(t):this.parentNode.insertBefore(t,this)}).remove():t.remove(),t.length>1?t.toArray():t[0]},setStyle:function(t,e,n){t=this.$$(t).css(e,n),this.settings.update_styles&&x(this,t)},getStyle:function(t,e,i){return t=this.$$(t),i?t.css(e):("float"==(e=e.replace(/-(\D)/g,function(t,e){return e.toUpperCase()}))&&(e=n.ie&&n.ie<12?"styleFloat":"cssFloat"),t[0]&&t[0].style?t[0].style[e]:undefined)},setStyles:function(t,e){t=this.$$(t).css(e),this.settings.update_styles&&x(this,t)},removeAllAttribs:function(t){return this.run(t,function(t){var e,n=t.attributes;for(e=n.length-1;e>=0;e--)t.removeAttributeNode(n.item(e))})},setAttrib:function(t,e,n){var i,r,o=this,a=o.settings;""===n&&(n=null),i=(t=o.$$(t)).attr(e),t.length&&((r=o.attrHooks[e])&&r.set?r.set(t,n,e):t.attr(e,n),i!=n&&a.onSetAttrib&&a.onSetAttrib({attrElm:t,attrName:e,attrValue:n}))},setAttribs:function(t,e){var n=this;n.$$(t).each(function(t,i){p(e,function(t,e){n.setAttrib(i,e,t)})})},getAttrib:function(t,e,n){var i,r,o=this;return(t=o.$$(t)).length&&(r=(i=o.attrHooks[e])&&i.get?i.get(t,e):t.attr(e)),void 0===r&&(r=n||""),r},getPos:function(t,e){return o.getPos(this.doc.body,this.get(t),e)},parseStyle:function(t){return this.styles.parse(t)},serializeStyle:function(t,e){return this.styles.serialize(t,e)},addStyle:function(e){var n,i,r=this,o=r.doc;if(r!==S.DOM&&o===t){var a=S.DOM.addedStyles;if((a=a||[])[e])return;a[e]=!0,S.DOM.addedStyles=a}(i=o.getElementById("mceDefaultStyles"))||((i=o.createElement("style")).id="mceDefaultStyles",i.type="text/css",(n=o.getElementsByTagName("head")[0]).firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i)),i.styleSheet?i.styleSheet.cssText+=e:i.appendChild(o.createTextNode(e))},loadCSS:function(e){var n,i=this,r=i.doc;i===S.DOM||r!==t?(e||(e=""),n=r.getElementsByTagName("head")[0],p(e.split(","),function(t){var e;t=f._addCacheSuffix(t),i.files[t]||(i.files[t]=!0,e=i.create("link",{rel:"stylesheet",href:t}),v&&r.documentMode&&r.recalc&&(e.onload=function(){r.recalc&&r.recalc(),e.onload=null}),n.appendChild(e))})):S.DOM.loadCSS(e)},addClass:function(t,e){this.$$(t).addClass(e)},removeClass:function(t,e){this.toggleClass(t,e,!1)},hasClass:function(t,e){return this.$$(t).hasClass(e)},toggleClass:function(t,e,n){this.$$(t).toggleClass(e,n).each(function(){""===this.className&&i(this).attr("class",null)})},show:function(t){this.$$(t).show()},hide:function(t){this.$$(t).hide()},isHidden:function(t){return"none"==this.$$(t).css("display")},uniqueId:function(t){return(t||"mce_")+this.counter++},setHTML:function(t,e){t=this.$$(t),v?t.each(function(t,n){if(!1!==n.canHaveHTML){for(;n.firstChild;)n.removeChild(n.firstChild);try{n.innerHTML="<br>"+e,n.removeChild(n.firstChild)}catch(r){i("<div></div>").html("<br>"+e).contents().slice(1).appendTo(n)}return e}}):t.html(e)},getOuterHTML:function(t){return 1==(t=this.get(t)).nodeType&&"outerHTML"in t?t.outerHTML:i("<div></div>").append(i(t).clone()).html()},setOuterHTML:function(t,e){var n=this;n.$$(t).each(function(){try{if("outerHTML"in this)return void(this.outerHTML=e)}catch(t){}n.remove(i(this).html(e),!0)})},decode:l.decode,encode:l.encodeAllRaw,insertAfter:function(t,e){return e=this.get(e),this.run(t,function(t){var n,i;return n=e.parentNode,(i=e.nextSibling)?n.insertBefore(t,i):n.appendChild(t),t})},replace:function(t,e,n){return this.run(e,function(e){return m(e,"array")&&(t=t.cloneNode(!0)),n&&p(g(e.childNodes),function(e){t.appendChild(e)}),e.parentNode.replaceChild(t,e)})},rename:function(t,e){var n,i=this;return t.nodeName!=e.toUpperCase()&&(n=i.create(e),p(i.getAttribs(t),function(e){i.setAttrib(n,e.nodeName,i.getAttrib(t,e.nodeName))}),i.replace(n,t,1)),n||t},findCommonAncestor:function(t,e){for(var n,i=t;i;){for(n=e;n&&i!=n;)n=n.parentNode;if(i==n)break;i=i.parentNode}return!i&&t.ownerDocument?t.ownerDocument.documentElement:i},toHex:function(t){return this.styles.toHex(f.trim(t))},run:function(t,e,n){var i,r=this;return"string"==typeof t&&(t=r.get(t)),!!t&&(n=n||this,t.nodeType||!t.length&&0!==t.length?e.call(n,t):(i=[],p(t,function(t,o){t&&("string"==typeof t&&(t=r.get(t)),i.push(e.call(n,t,o)))}),i))},getAttribs:function(t){var e;if(!(t=this.get(t)))return[];if(v){if(e=[],"OBJECT"==t.nodeName)return t.attributes;"OPTION"===t.nodeName&&this.getAttrib(t,"selected")&&e.push({specified:1,nodeName:"selected"});var n=/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi;return t.cloneNode(!1).outerHTML.replace(n,"").replace(/[\w:\-]+/gi,function(t){e.push({specified:1,nodeName:t})}),e}return t.attributes},isEmpty:function(t,e){var n,i,r,o,a,s,u=this,l=0;if(t=t.firstChild){a=new c(t,t.parentNode),e=e||(u.schema?u.schema.getNonEmptyElements():null),o=u.schema?u.schema.getWhiteSpaceElements():{};do{if(1===(r=t.nodeType)){var h=t.getAttribute("data-mce-bogus");if(h){t=a.next("all"===h);continue}if(s=t.nodeName.toLowerCase(),e&&e[s]){if("br"===s){l++,t=a.next();continue}return!1}for(n=(i=u.getAttribs(t)).length;n--;)if("name"===(s=i[n].nodeName)||"data-mce-bookmark"===s)return!1}if(8==r)return!1;if(3===r&&!b.test(t.nodeValue))return!1;if(3===r&&t.parentNode&&o[t.parentNode.nodeName]&&b.test(t.nodeValue))return!1;t=a.next()}while(t)}return l<=1},createRng:function(){return this.doc.createRange()},nodeIndex:w,split:function(t,e,n){var i,r,o,a=this,s=a.createRng();if(t&&e)return s.setStart(t.parentNode,a.nodeIndex(t)),s.setEnd(e.parentNode,a.nodeIndex(e)),i=s.extractContents(),(s=a.createRng()).setStart(e.parentNode,a.nodeIndex(e)+1),s.setEnd(t.parentNode,a.nodeIndex(t)+1),r=s.extractContents(),(o=t.parentNode).insertBefore(u.trimNode(a,i),t),n?o.insertBefore(n,t):o.insertBefore(e,t),o.insertBefore(u.trimNode(a,r),t),a.remove(t),n||e},bind:function(t,e,n,i){var r=this;if(f.isArray(t)){for(var o=t.length;o--;)t[o]=r.bind(t[o],e,n,i);return t}return!r.settings.collect||t!==r.doc&&t!==r.win||r.boundEvents.push([t,e,n,i]),r.events.bind(t,e,n,i||r)},unbind:function(t,e,n){var i,r=this;if(f.isArray(t)){for(i=t.length;i--;)t[i]=r.unbind(t[i],e,n);return t}if(r.boundEvents&&(t===r.doc||t===r.win))for(i=r.boundEvents.length;i--;){var o=r.boundEvents[i];t!=o[0]||e&&e!=o[1]||n&&n!=o[2]||this.events.unbind(o[0],o[1],o[2])}return this.events.unbind(t,e,n)},fire:function(t,e,n){return this.events.fire(t,e,n)},getContentEditable:function(t){var e;return t&&1==t.nodeType?(e=t.getAttribute("data-mce-contenteditable"))&&"inherit"!==e?e:"inherit"!==t.contentEditable?t.contentEditable:null:null},getContentEditableParent:function(t){for(var e=this.getRoot(),n=null;t&&t!==e&&null===(n=this.getContentEditable(t));t=t.parentNode);return n},destroy:function(){var t=this;if(t.boundEvents){for(var e=t.boundEvents.length;e--;){var n=t.boundEvents[e];this.events.unbind(n[0],n[1],n[2])}t.boundEvents=null}a.setDocument&&a.setDocument(),t.win=t.doc=t.root=t.events=t.frag=null},isChildOf:function(t,e){for(;t;){if(e===t)return!0;t=t.parentNode}return!1},dumpRng:function(t){return"startContainer: "+t.startContainer.nodeName+", startOffset: "+t.startOffset+", endContainer: "+t.endContainer.nodeName+", endOffset: "+t.endOffset},_findSib:function(t,e,n){var i=this,r=e;if(t)for("string"==typeof r&&(r=function(t){return i.is(t,e)}),t=t[n];t;t=t[n])if(r(t))return t;return null}},S.DOM=new S(t),S.nodeIndex=w,S}),o("tinymce.core.dom.ScriptLoader",["global!document","tinymce.core.dom.DOMUtils","tinymce.core.util.Tools"],function(t,e,n){var i=e.DOM,r=n.each,o=n.grep,a=function(t){return"function"==typeof t},s=function(){var e,s=0,c=1,u=2,l=3,h={},d=[],f={},p=[],m=0,g=function(e,r,o){var s,c,u=i,l=function(){u.remove(c),s&&(s.onreadystatechange=s.onload=s=null),r()},h=function(){a(o)?o():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+e)};c=u.uniqueId(),(s=t.createElement("script")).id=c,s.type="text/javascript",s.src=n._addCacheSuffix(e),"onreadystatechange"in s?s.onreadystatechange=function(){/loaded|complete/.test(s.readyState)&&l()}:s.onload=l,s.onerror=h,(t.getElementsByTagName("head")[0]||t.body).appendChild(s)};this.isDone=function(t){return h[t]==u},this.markDone=function(t){h[t]=u},this.add=this.load=function(t,n,i,r){h[t]==e&&(d.push(t),h[t]=s),n&&(f[t]||(f[t]=[]),f[t].push({success:n,failure:r,scope:i||this}))},this.remove=function(t){delete h[t],delete f[t]},this.loadQueue=function(t,e,n){this.loadScripts(d,t,e,n)},this.loadScripts=function(t,n,i,s){var d,v=[],y=function(t,n){r(f[n],function(e){a(e[t])&&e[t].call(e.scope)}),f[n]=e};p.push({success:n,failure:s,scope:i||this}),(d=function(){var e=o(t);if(t.length=0,r(e,function(t){h[t]!==u?h[t]!==l?h[t]!==c&&(h[t]=c,m++,g(t,function(){h[t]=u,m--,y("success",t),d()},function(){h[t]=l,m--,v.push(t),y("failure",t),d()})):y("failure",t):y("success",t)}),!m){var n=p.slice(0);p.length=0,r(n,function(t){0===v.length?a(t.success)&&t.success.call(t.scope):a(t.failure)&&t.failure.call(t.scope,v)})}})()}};return s.ScriptLoader=new s,s}),o("tinymce.core.AddOnManager",["ephox.katamari.api.Arr","tinymce.core.dom.ScriptLoader","tinymce.core.util.Tools"],function(t,e,n){var i=n.each,r=function(){var t=this;t.items=[],t.urls={},t.lookup={},t._listeners=[]};return r.prototype={get:function(t){return this.lookup[t]?this.lookup[t].instance:undefined},dependencies:function(t){var e;return this.lookup[t]&&(e=this.lookup[t].dependencies),e||[]},requireLangPack:function(t,n){var i=r.language;if(i&&!1!==r.languageLoad){if(n)if(-1!=(n=","+n+",").indexOf(","+i.substr(0,2)+","))i=i.substr(0,2);else if(-1==n.indexOf(","+i+","))return;e.ScriptLoader.add(this.urls[t]+"/langs/"+i+".js")}},add:function(e,n,r){this.items.push(n),this.lookup[e]={instance:n,dependencies:r};var o=t.partition(this._listeners,function(t){return t.name===e});return this._listeners=o.fail,i(o.pass,function(t){t.callback()}),n},remove:function(t){delete this.urls[t],delete this.lookup[t]},createUrl:function(t,e){return"object"==typeof e?e:{prefix:t.prefix,resource:e,suffix:t.suffix}},addComponents:function(t,n){var r=this.urls[t];i(n,function(t){e.ScriptLoader.add(r+"/"+t)})},load:function(t,n,o,a,s){var c=this,u=n,l=function(){var r=c.dependencies(t);i(r,function(t){var e=c.createUrl(n,t);c.load(e.resource,e,undefined,undefined)}),o&&(a?o.call(a):o.call(e))};c.urls[t]||("object"==typeof n&&(u=n.prefix+n.resource+n.suffix),0!==u.indexOf("/")&&-1==u.indexOf("://")&&(u=r.baseURL+"/"+u),c.urls[t]=u.substring(0,u.lastIndexOf("/")),c.lookup[t]?l():e.ScriptLoader.add(u,l,a,s))},waitFor:function(t,e){this.lookup.hasOwnProperty(t)?e():this._listeners.push({name:t,callback:e})}},r.PluginManager=new r,r.ThemeManager=new r,r}),o("tinymce.core.text.Zwsp",[],function(){var t="\ufeff";return{isZwsp:function(e){return e===t},ZWSP:t,trim:function(e){return e.replace(new RegExp(t,"g"),"")}}}),o("tinymce.core.caret.CaretContainer",["global!document","tinymce.core.dom.NodeType","tinymce.core.text.Zwsp"],function(t,e,n){var i=e.isElement,r=e.isText,o=function(t){return r(t)&&(t=t.parentNode),i(t)&&t.hasAttribute("data-mce-caret")},a=function(t){return r(t)&&n.isZwsp(t.data)},s=function(t){return o(t)||a(t)},c=function(t,e){var i,o,a,c;if(i=t.ownerDocument,a=i.createTextNode(n.ZWSP),c=t.parentNode,e){if(o=t.previousSibling,r(o)){if(s(o))return o;if(h(o))return o.splitText(o.data.length-1)}c.insertBefore(a,t)}else{if(o=t.nextSibling,r(o)){if(s(o))return o;if(l(o))return o.splitText(1),o}t.nextSibling?c.insertBefore(a,t.nextSibling):c.appendChild(a)}return a},u=function(){var e=t.createElement("br");return e.setAttribute("data-mce-bogus","1"),e},l=function(t){return r(t)&&t.data[0]==n.ZWSP},h=function(t){return r(t)&&t.data[t.data.length-1]==n.ZWSP},d=function(t){var n=t.getElementsByTagName("br"),i=n[n.length-1];e.isBogus(i)&&i.parentNode.removeChild(i)};return{isCaretContainer:s,isCaretContainerBlock:o,isCaretContainerInline:a,showCaretContainerBlock:function(t){return t&&t.hasAttribute("data-mce-caret")?(d(t),t.removeAttribute("data-mce-caret"),t.removeAttribute("data-mce-bogus"),t.removeAttribute("style"),t.removeAttribute("_moz_abspos"),t):null},insertInline:c,prependInline:function(t){if(e.isText(t)){var i=t.data;return i.length>0&&i.charAt(0)!==n.ZWSP&&t.insertData(0,n.ZWSP),t}return null},appendInline:function(t){if(e.isText(t)){var i=t.data;return i.length>0&&i.charAt(i.length-1)!==n.ZWSP&&t.insertData(i.length,n.ZWSP),t}return null},isBeforeInline:function(t){return t&&e.isText(t.container())&&t.container().data.charAt(t.offset())===n.ZWSP},isAfterInline:function(t){return t&&e.isText(t.container())&&t.container().data.charAt(t.offset()-1)===n.ZWSP},insertBlock:function(t,e,n){var i,r,o;return i=e.ownerDocument,(r=i.createElement(t)).setAttribute("data-mce-caret",n?"before":"after"),r.setAttribute("data-mce-bogus","all"),r.appendChild(u()),o=e.parentNode,n?o.insertBefore(r,e):e.nextSibling?o.insertBefore(r,e.nextSibling):o.appendChild(r),r},hasContent:function(t){return t.firstChild!==t.lastChild||!e.isBr(t.firstChild)},startsWithCaretContainer:l,endsWithCaretContainer:h}}),o("tinymce.core.caret.CaretCandidate",["tinymce.core.dom.NodeType","tinymce.core.util.Arr","tinymce.core.caret.CaretContainer"],function(t,e,n){var i=t.isContentEditableTrue,r=t.isContentEditableFalse,o=t.isBr,a=t.isText,s=t.matchNodeNames("script style textarea"),c=t.matchNodeNames("img input textarea hr iframe video audio object"),u=t.matchNodeNames("table"),l=n.isCaretContainer,h=function(t){return!l(t)&&(a(t)?!s(t.parentNode):c(t)||o(t)||u(t)||r(t))},d=function(t,e){for(t=t.parentNode;t&&t!=e;t=t.parentNode){if(r(t))return!1;if(i(t))return!0}return!0},f=function(t){return!!r(t)&&!0!==e.reduce(t.getElementsByTagName("*"),function(t,e){return t||i(e)},!1)};return{isCaretCandidate:h,isInEditable:d,isAtomic:function(t){return c(t)||f(t)},isEditableCaretCandidate:function(t,e){return h(t)&&d(t,e)}}}),o("tinymce.core.geom.ClientRect",[],function(){var t=Math.round,e=function(e){return e?{left:t(e.left),top:t(e.top),bottom:t(e.bottom),right:t(e.right),width:t(e.width),height:t(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},n=function(t,e,n){return t>=0&&t<=Math.min(e.height,n.height)/2},i=function(t,e){return t.bottom-t.height/2<e.top||!(t.top>e.bottom)&&n(e.top-t.bottom,t,e)},r=function(t,e){return t.top>e.bottom||!(t.bottom<e.top)&&n(e.bottom-t.top,t,e)},o=function(t,e){return t.left<e.left},a=function(t,e){return t.right>e.right};return{clone:e,collapse:function(t,n){return t=e(t),n?t.right=t.left:(t.left=t.left+t.width,t.right=t.left),t.width=0,t},isEqual:function(t,e){return t.left===e.left&&t.top===e.top&&t.bottom===e.bottom&&t.right===e.right},isAbove:i,isBelow:r,isLeft:o,isRight:a,compare:function(t,e){return i(t,e)?-1:r(t,e)?1:o(t,e)?-1:a(t,e)?1:0},containsXY:function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom}}}),o("tinymce.core.selection.RangeNodes",[],function(){return{getSelectedNode:function(t){var e=t.startContainer,n=t.startOffset;return e.hasChildNodes()&&t.endOffset==n+1?e.childNodes[n]:null},getNode:function(t,e){return 1===t.nodeType&&t.hasChildNodes()&&(e>=t.childNodes.length&&(e=t.childNodes.length-1),t=t.childNodes[e]),t}}}),o("tinymce.core.text.ExtendingChar",[],function(){var t=new RegExp("[\u0300-\u036f\u0483-\u0487\u0488-\u0489\u0591-\u05bd\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7-\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e3-\u0902\u093a\u093c\u0941-\u0948\u094d\u0951-\u0957\u0962-\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2-\u09e3\u0a01-\u0a02\u0a3c\u0a41-\u0a42\u0a47-\u0a48\u0a4b-\u0a4d\u0a51\u0a70-\u0a71\u0a75\u0a81-\u0a82\u0abc\u0ac1-\u0ac5\u0ac7-\u0ac8\u0acd\u0ae2-\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62-\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c00\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55-\u0c56\u0c62-\u0c63\u0c81\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc-\u0ccd\u0cd5-\u0cd6\u0ce2-\u0ce3\u0d01\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62-\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb-\u0ebc\u0ec8-\u0ecd\u0f18-\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86-\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039-\u103a\u103d-\u103e\u1058-\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108d\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17b4-\u17b5\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193b\u1a17-\u1a18\u1a1b\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1ab0-\u1abd\u1abe\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80-\u1b81\u1ba2-\u1ba5\u1ba8-\u1ba9\u1bab-\u1bad\u1be6\u1be8-\u1be9\u1bed\u1bef-\u1bf1\u1c2c-\u1c33\u1c36-\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1cf4\u1cf8-\u1cf9\u1dc0-\u1df5\u1dfc-\u1dff\u200c-\u200d\u20d0-\u20dc\u20dd-\u20e0\u20e1\u20e2-\u20e4\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302d\u302e-\u302f\u3099-\u309a\ua66f\ua670-\ua672\ua674-\ua67d\ua69e-\ua69f\ua6f0-\ua6f1\ua802\ua806\ua80b\ua825-\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\ua9e5\uaa29-\uaa2e\uaa31-\uaa32\uaa35-\uaa36\uaa43\uaa4c\uaa7c\uaab0\uaab2-\uaab4\uaab7-\uaab8\uaabe-\uaabf\uaac1\uaaec-\uaaed\uaaf6\uabe5\uabe8\uabed\ufb1e\ufe00-\ufe0f\ufe20-\ufe2f\uff9e-\uff9f]");return{isExtendingChar:function(e){return"string"==typeof e&&e.charCodeAt(0)>=768&&t.test(e)}}}),o("tinymce.core.util.Fun",[],function(){var t=[].slice,e=function(n){var i=t.call(arguments);return i.length-1>=n.length?n.apply(this,i.slice(1)):function(){var t=i.concat([].slice.call(arguments));return e.apply(this,t)}};return{constant:function(t){return function(){return t}},negate:function(t){return function(e){return!t(e)}},and:function(){var e=t.call(arguments);return function(t){for(var n=0;n<e.length;n++)if(!e[n](t))return!1;return!0}},or:function(){var e=t.call(arguments);return function(t){for(var n=0;n<e.length;n++)if(e[n](t))return!0;return!1}},curry:e,compose:function(t,e){return function(n){return t(e(n))}},noop:function(){}}}),o("tinymce.core.caret.CaretPosition",["tinymce.core.caret.CaretCandidate","tinymce.core.dom.DOMUtils","tinymce.core.dom.NodeType","tinymce.core.geom.ClientRect","tinymce.core.selection.RangeNodes","tinymce.core.text.ExtendingChar","tinymce.core.util.Fun"],function(t,e,n,i,r,o,a){var s=n.isElement,c=t.isCaretCandidate,u=n.matchStyleValues("display","block table"),l=n.matchStyleValues("float","left right"),h=a.and(s,c,a.negate(l)),d=a.negate(n.matchStyleValues("white-space","pre pre-line pre-wrap")),f=n.isText,p=n.isBr,m=e.nodeIndex,g=r.getNode,v=function(t){return"createRange"in t?t.createRange():e.DOM.createRng()},y=function(t){return t&&/[\r\n\t ]/.test(t)},b=function(t){var e,n=t.startContainer,i=t.startOffset;return!!(y(t.toString())&&d(n.parentNode)&&(e=n.data,y(e[i-1])||y(e[i+1])))},_=function(t){var e,n,r=[],a=function(t){var e,n=t.ownerDocument,r=v(n),o=n.createTextNode("\xa0"),a=t.parentNode;return a.insertBefore(o,t),r.setStart(o,0),r.setEnd(o,1),e=i.clone(r.getBoundingClientRect()),a.removeChild(o),e},c=function(t){var e,n;return n=t.getClientRects(),e=n.length>0?i.clone(n[0]):i.clone(t.getBoundingClientRect()),p(t)&&0===e.left?a(t):e},l=function(t,e){return t=i.collapse(t,e),t.width=1,t.right=t.left+1,t},d=function(t){0!==t.height&&(r.length>0&&i.isEqual(t,r[r.length-1])||r.push(t))},m=function(t,e){var n=v(t.ownerDocument);if(e<t.data.length){if(o.isExtendingChar(t.data[e]))return r;if(o.isExtendingChar(t.data[e-1])&&(n.setStart(t,e),n.setEnd(t,e+1),!b(n)))return d(l(c(n),!1)),r}e>0&&(n.setStart(t,e-1),n.setEnd(t,e),b(n)||d(l(c(n),!1))),e<t.data.length&&(n.setStart(t,e),n.setEnd(t,e+1),b(n)||d(l(c(n),!0)))};if(f(t.container()))return m(t.container(),t.offset()),r;if(s(t.container()))if(t.isAtEnd())n=g(t.container(),t.offset()),f(n)&&m(n,n.data.length),h(n)&&!p(n)&&d(l(c(n),!1));else{if(n=g(t.container(),t.offset()),f(n)&&m(n,0),h(n)&&t.isAtEnd())return d(l(c(n),!1)),r;e=g(t.container(),t.offset()-1),h(e)&&!p(e)&&(u(e)||u(n)||!h(n))&&d(l(c(e),!1)),h(n)&&d(l(c(n),!0))}return r},x=function(t,e,n){var i=function(){return f(t),0===e},r=function(){return f(t)?e>=t.data.length:e>=t.childNodes.length},o=function(){var n;return(n=v(t.ownerDocument)).setStart(t,e),n.setEnd(t,e),n},s=function(){return n||(n=_(new x(t,e))),n},c=function(){return s().length>0},u=function(n){return n&&t===n.container()&&e===n.offset()},l=function(n){return g(t,n?e-1:e)};return{container:a.constant(t),offset:a.constant(e),toRange:o,getClientRects:s,isVisible:c,isAtStart:i,isAtEnd:r,isEqual:u,getNode:l}};return x.fromRangeStart=function(t){return new x(t.startContainer,t.startOffset)},x.fromRangeEnd=function(t){return new x(t.endContainer,t.endOffset)},x.after=function(t){return new x(t.parentNode,m(t)+1)},x.before=function(t){return new x(t.parentNode,m(t))},x.isAtStart=function(t){return!!t&&t.isAtStart()},x.isAtEnd=function(t){return!!t&&t.isAtEnd()},x.isTextPosition=function(t){return!!t&&n.isText(t.container())},x}),o("tinymce.core.caret.CaretUtils",["tinymce.core.util.Fun","tinymce.core.dom.TreeWalker","tinymce.core.dom.NodeType","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretCandidate"],function(t,e,n,i,r,o){var a=n.isContentEditableTrue,s=n.isContentEditableFalse,c=n.matchStyleValues("display","block table table-cell table-caption list-item"),u=r.isCaretContainer,l=r.isCaretContainerBlock,h=t.curry,d=n.isElement,f=o.isCaretCandidate,p=function(t){return t>0},m=function(t){return t<0},g=function(t,e){for(var n;n=t(e);)if(!l(n))return n;return null},v=function(t,n,i,r,o){var a=new e(t,r);if(m(n)){if((s(t)||l(t))&&(t=g(a.prev,!0),i(t)))return t;for(;t=g(a.prev,o);)if(i(t))return t}if(p(n)){if((s(t)||l(t))&&(t=g(a.next,!0),i(t)))return t;for(;t=g(a.next,o);)if(i(t))return t}return null},y=function(t,e){for(t=t.parentNode;t&&t!=e;t=t.parentNode)if(a(t))return t;return e},b=function(t,e){for(;t&&t!=e;){if(c(t))return t;t=t.parentNode}return null},_=function(t,e,n){return b(t.container(),n)==b(e.container(),n)},x=function(t,e,n){return y(t.container(),n)==y(e.container(),n)},w=function(t,e){var n,i;return e?(n=e.container(),i=e.offset(),d(n)?n.childNodes[i+t]:null):null},S=function(t,e){var n=e.ownerDocument.createRange();return t?(n.setStartBefore(e),n.setEndBefore(e)):(n.setStartAfter(e),n.setEndAfter(e)),n},k=function(t,e,n){return b(e,t)==b(n,t)},E=function(t,e,n){var i,r;for(r=t?"previousSibling":"nextSibling";n&&n!=e;){if(i=n[r],u(i)&&(i=i[r]),s(i)){if(k(e,i,n))return i;break}if(f(i))break;n=n.parentNode}return null},T=h(S,!0),C=h(S,!1),L=function(t,e,i){var o,a,c,l,f=h(E,!0,e),p=h(E,!1,e);if(a=i.startContainer,c=i.startOffset,r.isCaretContainerBlock(a)){if(d(a)||(a=a.parentNode),"before"==(l=a.getAttribute("data-mce-caret"))&&(o=a.nextSibling,s(o)))return T(o);if("after"==l&&(o=a.previousSibling,s(o)))return C(o)}if(!i.collapsed)return i;if(n.isText(a)){if(u(a)){if(1===t){if(o=p(a))return T(o);if(o=f(a))return C(o)}if(-1===t){if(o=f(a))return C(o);if(o=p(a))return T(o)}return i}if(r.endsWithCaretContainer(a)&&c>=a.data.length-1)return 1===t&&(o=p(a))?T(o):i;if(r.startsWithCaretContainer(a)&&c<=1)return-1===t&&(o=f(a))?C(o):i;if(c===a.data.length)return(o=p(a))?T(o):i;if(0===c)return(o=f(a))?C(o):i}return i},P=function(t,e){return s(w(t,e))};return{isForwards:p,isBackwards:m,findNode:v,getEditingHost:y,getParentBlock:b,isInSameBlock:_,isInSameEditingHost:x,isBeforeContentEditableFalse:h(P,0),isAfterContentEditableFalse:h(P,-1),normalizeRange:L}}),o("tinymce.core.caret.CaretWalker",["tinymce.core.dom.NodeType","tinymce.core.caret.CaretCandidate","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.util.Arr","tinymce.core.util.Fun"],function(t,e,n,i,r,o){var a=t.isContentEditableFalse,s=t.isText,c=t.isElement,u=t.isBr,l=i.isForwards,h=i.isBackwards,d=e.isCaretCandidate,f=e.isAtomic,p=e.isEditableCaretCandidate,m=function(t,e){for(var n=[];t&&t!=e;)n.push(t),t=t.parentNode;return n},g=function(t,e){return t.hasChildNodes()&&e<t.childNodes.length?t.childNodes[e]:null},v=function(t,e){if(l(t)){if(d(e.previousSibling)&&!s(e.previousSibling))return n.before(e);if(s(e))return n(e,0)}if(h(t)){if(d(e.nextSibling)&&!s(e.nextSibling))return n.after(e);if(s(e))return n(e,e.data.length)}return h(t)?u(e)?n.before(e):n.after(e):n.before(e)},y=function(e,r){var o;return!!t.isBr(e)&&(!!(o=b(1,n.after(e),r))&&!i.isInSameBlock(n.before(e),n.before(o),r))},b=function(t,e,_){var x,w,S,k,E,T,C;if(!c(_)||!e)return null;if(e.isEqual(n.after(_))&&_.lastChild){if(C=n.after(_.lastChild),h(t)&&d(_.lastChild)&&c(_.lastChild))return u(_.lastChild)?n.before(_.lastChild):C}else C=e;if(x=C.container(),w=C.offset(),s(x)){if(h(t)&&w>0)return n(x,--w);if(l(t)&&w<x.length)return n(x,++w);S=x}else{if(h(t)&&w>0&&(k=g(x,w-1),d(k)))return!f(k)&&(E=i.findNode(k,t,p,k))?s(E)?n(E,E.data.length):n.after(E):s(k)?n(k,k.data.length):n.before(k);if(l(t)&&w<x.childNodes.length&&(k=g(x,w),d(k)))return y(k,_)?b(t,n.after(k),_):!f(k)&&(E=i.findNode(k,t,p,k))?s(E)?n(E,0):n.before(E):s(k)?n(k,0):n.after(k);S=C.getNode()}return(l(t)&&C.isAtEnd()||h(t)&&C.isAtStart())&&(S=i.findNode(S,t,o.constant(!0),_,!0),p(S))?v(t,S):(k=i.findNode(S,t,p,_),!(T=r.last(r.filter(m(x,_),a)))||k&&T.contains(k)?k?v(t,k):null:C=l(t)?n.after(T):n.before(T))};return function(t){return{next:function(e){return b(1,e,t)},prev:function(e){return b(-1,e,t)}}}}),o("tinymce.core.InsertList",["tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretWalker","tinymce.core.dom.NodeType","tinymce.core.util.Tools"],function(t,e,n,i){var r=function(t){return t.firstChild&&t.firstChild===t.lastChild},o=function(t){return"br"===t.name||"\xa0"===t.value},a=function(t,e){return t.getBlockElements()[e.name]&&r(e)&&o(e.firstChild)},s=function(t,e){var n=t.getNonEmptyElements();return e&&(e.isEmpty(n)||a(t,e))},c=function(t){var e=t.firstChild,n=t.lastChild;return e&&"META"===e.nodeName&&e.parentNode.removeChild(e),n&&"mce_marker"===n.id&&n.parentNode.removeChild(n),t},u=function(t,e,n){var i=e.serialize(n),r=t.createFragment(i);return c(r)},l=function(t){return i.grep(t.childNodes,function(t){return"LI"===t.nodeName})},h=function(t){return"\xa0"===t.data||n.isBr(t)},d=function(t){return t&&t.firstChild&&t.firstChild===t.lastChild&&h(t.firstChild)},f=function(t){return!t.firstChild||d(t)
},p=function(t){return t.length>0&&f(t[t.length-1])?t.slice(0,-1):t},m=function(t,e){var n=t.getParent(e,t.isBlock);return n&&"LI"===n.nodeName?n:null},g=function(t,e){var n=e.cloneRange(),i=e.cloneRange();return n.setStartBefore(t),i.setEndAfter(t),[n.cloneContents(),i.cloneContents()]},v=function(n,i){var r=t.before(n),o=new e(i).next(r);return o?o.toRange():null},y=function(n,i){var r=t.after(n),o=new e(i).prev(r);return o?o.toRange():null},b=function(t,e,n,r){var o=g(t,r),a=t.parentNode;return a.insertBefore(o[0],t),i.each(e,function(e){a.insertBefore(e,t)}),a.insertBefore(o[1],t),a.removeChild(t),y(e[e.length-1],n)},_=function(t,e,n){var r=t.parentNode;return i.each(e,function(e){r.insertBefore(e,t)}),v(t,n)},x=function(t,e,n,i){return i.insertAfter(e.reverse(),t),y(e[0],n)};return{isListFragment:function(t,e){var n=e.firstChild,i=e.lastChild;return n&&"meta"===n.name&&(n=n.next),i&&"mce_marker"===i.attr("id")&&(i=i.prev),s(t,i)&&(i=i.prev),!(!n||n!==i)&&("ul"===n.name||"ol"===n.name)},insertAtCaret:function(n,i,r,o){var a=u(i,n,o),s=m(i,r.startContainer),c=p(l(a.firstChild)),h=1,d=2,f=i.getRoot(),g=function(n){var o=t.fromRangeStart(r),a=new e(i.getRoot()),c=n===h?a.prev(o):a.next(o);return!c||m(i,c.getNode())!==s};return g(h)?_(s,c,f):g(d)?x(s,c,f,i):b(s,c,f,r)},isParentBlockLi:function(t,e){return!!m(t,e)},trimListItems:p,listItems:l}}),o("tinymce.core.caret.CaretBookmark",["tinymce.core.dom.NodeType","tinymce.core.dom.DOMUtils","tinymce.core.util.Fun","tinymce.core.util.Arr","tinymce.core.caret.CaretPosition"],function(t,e,n,i,r){var o=t.isText,a=t.isBogus,s=e.nodeIndex,c=function(t){var e=t.parentNode;return a(e)?c(e):e},u=function(t){return t?i.reduce(t.childNodes,function(t,e){return a(e)&&"BR"!=e.nodeName?t=t.concat(u(e)):t.push(e),t},[]):[]},l=function(t,e){for(;(t=t.previousSibling)&&o(t);)e+=t.data.length;return e},h=function(t){return function(e){return t===e}},d=function(e){var n,r,a;return n=u(c(e)),r=i.findIndex(n,h(e),e),n=n.slice(0,r+1),a=i.reduce(n,function(t,e,i){return o(e)&&o(n[i-1])&&t++,t},0),n=i.filter(n,t.matchNodeNames(e.nodeName)),(r=i.findIndex(n,h(e),e))-a},f=function(t){return(o(t)?"text()":t.nodeName.toLowerCase())+"["+d(t)+"]"},p=function(t,e,n){var i=[];for(e=e.parentNode;e!=t&&(!n||!n(e));e=e.parentNode)i.push(e);return i},m=function(e,n,r){var a=u(e);return a=i.filter(a,function(t,e){return!o(t)||!o(a[e-1])}),(a=i.filter(a,t.matchNodeNames(n)))[r]},g=function(t,e){for(var n,i=t,a=0;o(i);){if(n=i.data.length,e>=a&&e<=a+n){t=i,e-=a;break}if(!o(i.nextSibling)){t=i,e=n;break}a+=n,i=i.nextSibling}return e>t.data.length&&(e=t.data.length),new r(t,e)};return{create:function(e,r){var a,s,c,u,h,d=[];return a=r.container(),s=r.offset(),o(a)?c=l(a,s):(s>=(u=a.childNodes).length?(c="after",s=u.length-1):c="before",a=u[s]),d.push(f(a)),h=p(e,a),h=i.filter(h,n.negate(t.isBogus)),(d=d.concat(i.map(h,function(t){return f(t)}))).reverse().join("/")+","+c},resolve:function(t,e){var n,a,c;return e?(n=e.split(","),e=n[0].split("/"),c=n.length>1?n[1]:"before",(a=i.reduce(e,function(t,e){return(e=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(e))?("text()"===e[1]&&(e[1]="#text"),m(t,e[1],parseInt(e[2],10))):null},t))?o(a)?g(a,parseInt(c,10)):(c="after"===c?s(a)+1:s(a),new r(a.parentNode,c)):null):null}}}),o("tinymce.core.dom.GetBookmark",["ephox.katamari.api.Fun","tinymce.core.caret.CaretBookmark","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.selection.RangeNodes","tinymce.core.text.Zwsp","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s){var c=r.isContentEditableFalse,u=function(t,e,n){var i,o;for(o=t(e.data.slice(0,n)).length,i=e.previousSibling;i&&r.isText(i);i=i.previousSibling)o+=t(i.data).length;return o},l=function(t,e,n,i,o){var a,s=i[o?"startContainer":"endContainer"],c=i[o?"startOffset":"endOffset"],l=[],h=0,d=t.getRoot();for(r.isText(s)?l.push(n?u(e,s,c):c):(c>=(a=s.childNodes).length&&a.length&&(h=1,c=Math.max(0,a.length-1)),l.push(t.nodeIndex(a[c],n)+h));s&&s!==d;s=s.parentNode)l.push(t.nodeIndex(s,n));return l},h=function(t,e,n,i){var r=e.dom,o={};return o.start=l(r,t,n,i,!0),e.isCollapsed()||(o.end=l(r,t,n,i,!1)),o},d=function(t){r.isText(t)&&0===t.data.length&&t.parentNode.removeChild(t)},f=function(t,e,n){var i=0;return s.each(t.select(e),function(t){if("all"!==t.getAttribute("data-mce-bogus"))return t!==n&&void i++}),i},p=function(t,e){var n,i,o,a=e?"start":"end";n=t[a+"Container"],i=t[a+"Offset"],r.isElement(n)&&"TR"===n.nodeName&&(n=(o=n.childNodes)[Math.min(e?i:i-1,o.length-1)])&&(i=e?0:n.childNodes.length,t["set"+(e?"Start":"End")](n,i))},m=function(t){return p(t,!0),p(t,!1),t},g=function(t,e){var i;if(r.isElement(t)&&(t=o.getNode(t,e),c(t)))return t;if(n.isCaretContainer(t)){if(r.isText(t)&&n.isCaretContainerBlock(t)&&(t=t.parentNode),i=t.previousSibling,c(i))return i;if(i=t.nextSibling,c(i))return i}},v=function(t){return g(t.startContainer,t.startOffset)||g(t.endContainer,t.endOffset)},y=function(t,e,n){var i=n.getNode(),r=i?i.nodeName:null,o=n.getRng();return c(i)||"IMG"===r?{name:r,index:f(n.dom,r,i)}:(i=v(o))?(r=i.tagName,{name:r,index:f(n.dom,r,i)}):h(t,n,e,o)},b=function(t){var n=t.getRng();return{start:e.create(t.dom.getRoot(),i.fromRangeStart(n)),end:e.create(t.dom.getRoot(),i.fromRangeEnd(n))}},_=function(t){return{rng:t.getRng()}},x=function(t){var e=t.dom,n=t.getRng(),i=e.uniqueId(),r=t.isCollapsed(),o="overflow:hidden;line-height:0px",a=t.getNode(),s=a.nodeName,c="&#xFEFF;";if("IMG"===s)return{name:s,index:f(e,s,a)};var u=m(n.cloneRange());if(!r){u.collapse(!1);var l=e.create("span",{"data-mce-type":"bookmark",id:i+"_end",style:o},c);u.insertNode(l),d(l.nextSibling)}(n=m(n)).collapse(!0);var h=e.create("span",{"data-mce-type":"bookmark",id:i+"_start",style:o},c);return n.insertNode(h),d(h.previousSibling),t.moveToBookmark({id:i,keep:1}),{id:i}};return{getBookmark:function(t,e,n){return 2===e?y(a.trim,n,t):3===e?b(t):e?_(t):x(t)},getUndoBookmark:t.curry(y,t.identity,!0)}}),o("ephox.katamari.api.Options",["ephox.katamari.api.Option"],function(t){return{cat:function(t){for(var e=[],n=function(t){e.push(t)},i=0;i<t.length;i++)t[i].each(n);return e},findMap:function(e,n){for(var i=0;i<e.length;i++){var r=n(e[i],i);if(r.isSome())return r}return t.none()},liftN:function(e,n){for(var i=[],r=0;r<e.length;r++){var o=e[r];if(!o.isSome())return t.none();i.push(o.getOrDie())}return t.some(n.apply(null,i))}}}),o("tinymce.core.dom.ResolveBookmark",["ephox.katamari.api.Option","ephox.katamari.api.Options","tinymce.core.Env","tinymce.core.caret.CaretBookmark","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a){var s=function(t,e){return!t.isBlock(e)||e.innerHTML||n.ie||(e.innerHTML='<br data-mce-bogus="1" />'),e},c=function(t,e){var n,r;return n=t.createRng(),r=i.resolve(t.getRoot(),e.start),n.setStart(r.container(),r.offset()),r=i.resolve(t.getRoot(),e.end),n.setEnd(r.container(),r.offset()),n},u=function(t,e,n,i){var r,o,a,s,c=n[e?"start":"end"],u=t.getRoot();if(c){for(a=c[0],o=u,r=c.length-1;r>=1;r--){if(s=o.childNodes,c[r]>s.length-1)return;o=s[c[r]]}3===o.nodeType&&(a=Math.min(c[0],o.nodeValue.length)),1===o.nodeType&&(a=Math.min(c[0],o.childNodes.length)),e?i.setStart(o,a):i.setEnd(o,a)}return!0},l=function(e,i,s){var c,u,l,h,d,f,p=e.get(s.id+"_"+i),m=s.keep;if(p){if(c=p.parentNode,m?(c=p.firstChild,u=1):u=e.nodeIndex(p),d=c,f=u,!m){for(h=p.previousSibling,l=p.nextSibling,a.each(a.grep(p.childNodes),function(t){o.isText(t)&&(t.nodeValue=t.nodeValue.replace(/\uFEFF/g,""))});p=e.get(s.id+"_"+i);)e.remove(p,1);h&&l&&h.nodeType===l.nodeType&&o.isText(h)&&!n.opera&&(u=h.nodeValue.length,h.appendData(l.nodeValue),e.remove(l),d=h,f=u)}return t.some(r(d,f))}return t.none()},h=function(t,e){return t.isSome()?t:e},d=function(e,n){var i=e.createRng();return u(e,!0,n,i)&&u(e,!1,n,i)?t.some(i):t.none()},f=function(t,n){var i=l(t,"start",n),r=l(t,"end",n);return e.liftN([i,h(r,i)],function(e,n){var i=t.createRng();return i.setStart(s(t,e.container()),e.offset()),i.setEnd(s(t,n.container()),n.offset()),i})},p=function(e,n){return t.from(e.select(n.name)[n.index]).map(function(t){var n=e.createRng();return n.selectNode(t),n})};return{resolve:function(e,n){var i=e.dom;if(n){if(a.isArray(n.start))return d(i,n);if("string"==typeof n.start)return t.some(c(i,n));if(n.id)return f(i,n);if(n.name)return p(i,n);if(n.rng)return t.some(n.rng)}return t.none()}}}),o("tinymce.core.dom.Bookmarks",["tinymce.core.dom.GetBookmark","tinymce.core.dom.ResolveBookmark"],function(t,e){return{getBookmark:function(e,n,i){return t.getBookmark(e,n,i)},moveToBookmark:function(t,n){e.resolve(t,n).each(function(e){t.setRng(e)})},isBookmarkNode:function(t){return t&&"SPAN"===t.tagName&&"bookmark"===t.getAttribute("data-mce-type")}}}),o("tinymce.core.dom.ElementUtils",["tinymce.core.dom.Bookmarks","tinymce.core.util.Tools"],function(t,e){var n=e.each;return function(e){this.compare=function(i,r){if(i.nodeName!=r.nodeName)return!1;var o=function(t){var i={};return n(e.getAttribs(t),function(n){var r=n.nodeName.toLowerCase();0!==r.indexOf("_")&&"style"!==r&&0!==r.indexOf("data-")&&(i[r]=e.getAttrib(t,r))}),i},a=function(t,e){var n,i;for(i in t)if(t.hasOwnProperty(i)){if(void 0===(n=e[i]))return!1;if(t[i]!=n)return!1;delete e[i]}for(i in e)if(e.hasOwnProperty(i))return!1;return!0};return!!a(o(i),o(r))&&(!!a(e.parseStyle(e.getAttrib(i,"style")),e.parseStyle(e.getAttrib(r,"style")))&&(!t.isBookmarkNode(i)&&!t.isBookmarkNode(r)))}}}),o("ephox.sugar.api.dom.Insert",["ephox.sugar.api.search.Traverse"],function(t){var e=function(e,n){t.parent(e).each(function(t){t.dom().insertBefore(n.dom(),e.dom())})},n=function(n,i){t.nextSibling(n).fold(function(){t.parent(n).each(function(t){r(t,i)})},function(t){e(t,i)})},i=function(e,n){t.firstChild(e).fold(function(){r(e,n)},function(t){e.dom().insertBefore(n.dom(),t.dom())})},r=function(t,e){t.dom().appendChild(e.dom())};return{before:e,after:n,prepend:i,append:r,appendAt:function(n,i,o){t.child(n,o).fold(function(){r(n,i)},function(t){e(t,i)})},wrap:function(t,n){e(t,n),r(n,t)}}}),o("ephox.sugar.api.dom.InsertAll",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Insert"],function(t,e){return{before:function(n,i){t.each(i,function(t){e.before(n,t)})},after:function(n,i){t.each(i,function(t,r){var o=0===r?n:i[r-1];e.after(o,t)})},prepend:function(n,i){t.each(i.slice().reverse(),function(t){e.prepend(n,t)})},append:function(n,i){t.each(i,function(t){e.append(n,t)})}}}),o("ephox.sugar.api.dom.Remove",["ephox.katamari.api.Arr","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.search.Traverse"],function(t,e,n){var i=function(e){e.dom().textContent="",t.each(n.children(e),function(t){r(t)})},r=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)};return{empty:i,remove:r,unwrap:function(t){var i=n.children(t);i.length>0&&e.before(t,i),r(t)}}}),o("ephox.sugar.impl.NodeValue",["ephox.sand.api.PlatformDetection","ephox.katamari.api.Option","global!Error"],function(t,e,n){return function(i,r){var o=function(t){if(!i(t))throw new n("Can only get "+r+" value of a "+r+" node");return u(t).getOr("")},a=function(t){try{return s(t)}catch(n){return e.none()}},s=function(t){return i(t)?e.from(t.dom().nodeValue):e.none()},c=t.detect().browser,u=c.isIE()&&10===c.version.major?a:s;return{get:o,getOption:u,set:function(t,e){if(!i(t))throw new n("Can only set raw "+r+" value of a "+r+" node");t.dom().nodeValue=e}}}}),o("ephox.sugar.api.node.Text",["ephox.sugar.api.node.Node","ephox.sugar.impl.NodeValue"],function(t,e){var n=e(t.isText,"text");return{get:function(t){return n.get(t)},getOption:function(t){return n.getOption(t)},set:function(t,e){n.set(t,e)}}}),o("ephox.sugar.api.search.PredicateFilter",["ephox.katamari.api.Arr","ephox.sugar.api.node.Body","ephox.sugar.api.search.Traverse"],function(t,e,n){var i=function(t){return r(e.body(),t)},r=function(e,i){var o=[];return t.each(n.children(e),function(t){i(t)&&(o=o.concat([t])),o=o.concat(r(t,i))}),o};return{all:i,ancestors:function(e,i,r){return t.filter(n.parents(e,r),i)},siblings:function(e,i){return t.filter(n.siblings(e),i)},children:function(e,i){return t.filter(n.children(e),i)},descendants:r}}),o("ephox.sugar.api.search.SelectorFilter",["ephox.sugar.api.search.PredicateFilter","ephox.sugar.api.search.Selectors"],function(t,e){return{all:function(t){return e.all(t)},ancestors:function(n,i,r){return t.ancestors(n,function(t){return e.is(t,i)},r)},siblings:function(n,i){return t.siblings(n,function(t){return e.is(t,i)})},children:function(n,i){return t.children(n,function(t){return e.is(t,i)})},descendants:function(t,n){return e.all(n,t)}}}),o("tinymce.core.dom.PaddingBr",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.Traverse","tinymce.core.dom.ElementType"],function(t,e,n,i,r,o,a,s,c){var u=function(t){for(var e=[],n=t.dom();n;)e.push(i.fromDom(n)),n=n.lastChild;return e},l=function(t){return r.isText(t)?"\xa0"===o.get(t):c.isBr(t)};return{removeTrailingBr:function(e){var i=a.descendants(e,"br"),r=t.filter(u(e).slice(-1),c.isBr);i.length===r.length&&t.each(r,n.remove)},fillWithPaddingBr:function(t){n.empty(t),e.append(t,i.fromHtml('<br data-mce-bogus="1">'))},isPaddedElement:function(e){return 1===t.filter(s.children(e),l).length},trimBlockTrailingBr:function(t){s.lastChild(t).each(function(e){s.prevSibling(e).each(function(i){c.isBlock(t)&&c.isBr(e)&&c.isBlock(i)&&n.remove(e)})})}}}),o("tinymce.core.html.Writer",["tinymce.core.html.Entities","tinymce.core.util.Tools"],function(t,e){var n=e.makeMap;return function(e){var i,r,o,a,s,c=[];return e=e||{},i=e.indent,r=n(e.indent_before||""),o=n(e.indent_after||""),a=t.getEncodeFunc(e.entity_encoding||"raw",e.entities),s="html"==e.element_format,{start:function(t,e,n){var u,l,h,d;if(i&&r[t]&&c.length>0&&(d=c[c.length-1]).length>0&&"\n"!==d&&c.push("\n"),c.push("<",t),e)for(u=0,l=e.length;u<l;u++)h=e[u],c.push(" ",h.name,'="',a(h.value,!0),'"');c[c.length]=!n||s?">":" />",n&&i&&o[t]&&c.length>0&&(d=c[c.length-1]).length>0&&"\n"!==d&&c.push("\n")},end:function(t){var e;c.push("</",t,">"),i&&o[t]&&c.length>0&&(e=c[c.length-1]).length>0&&"\n"!==e&&c.push("\n")},text:function(t,e){t.length>0&&(c[c.length]=e?t:a(t))},cdata:function(t){c.push("<![CDATA[",t,"]]>")},comment:function(t){c.push("<!--",t,"-->")},pi:function(t,e){e?c.push("<?",t," ",a(e),"?>"):c.push("<?",t,"?>"),i&&c.push("\n")},doctype:function(t){c.push("<!DOCTYPE",t,">",i?"\n":"")},reset:function(){c.length=0},getContent:function(){return c.join("").replace(/\n$/,"")}}}}),o("tinymce.core.html.Serializer",["tinymce.core.html.Writer","tinymce.core.html.Schema"],function(t,e){return function(n,i){var r=this,o=new t(n);(n=n||{}).validate=!("validate"in n)||n.validate,r.schema=i=i||new e,r.writer=o,r.serialize=function(t){var e,r;r=n.validate,e={3:function(t){o.text(t.value,t.raw)},8:function(t){o.comment(t.value)},7:function(t){o.pi(t.name,t.value)},10:function(t){o.doctype(t.value)},4:function(t){o.cdata(t.value)},11:function(t){if(t=t.firstChild)do{a(t)}while(t=t.next)}},o.reset();var a=function(t){var n,s,c,u,l,h,d,f,p,m=e[t.type];if(m)m(t);else{if(n=t.name,s=t.shortEnded,c=t.attributes,r&&c&&c.length>1&&(h=[],h.map={},p=i.getElementRule(t.name))){for(d=0,f=p.attributesOrder.length;d<f;d++)(u=p.attributesOrder[d])in c.map&&(l=c.map[u],h.map[u]=l,h.push({name:u,value:l}));for(d=0,f=c.length;d<f;d++)(u=c[d].name)in h.map||(l=c.map[u],h.map[u]=l,h.push({name:u,value:l}));c=h}if(o.start(t.name,c,s),!s){if(t=t.firstChild)do{a(t)}while(t=t.next);o.end(n)}}};return 1!=t.type||n.inner?e[11](t):a(t),o.getContent()}}}),o("tinymce.core.caret.CaretFinder",["ephox.katamari.api.Fun","ephox.katamari.api.Option","tinymce.core.caret.CaretCandidate","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretWalker","tinymce.core.dom.NodeType"],function(t,e,n,i,r,o,a){var s=function(t,e,n){var r=t?i.before(n):i.after(n);return p(t,e,r)},c=function(t){return a.isBr(t)?i.before(t):i.after(t)},u=function(t){return i.isTextPosition(t)?0===t.offset():n.isCaretCandidate(t.getNode())},l=function(t){return i.isTextPosition(t)?t.offset()===t.container().data.length:n.isCaretCandidate(t.getNode(!0))},h=function(t,e){return!i.isTextPosition(t)&&!i.isTextPosition(e)&&t.getNode()===e.getNode(!0)},d=function(t){return!i.isTextPosition(t)&&a.isBr(t.getNode())},f=function(t,e,n){return t?!h(e,n)&&!d(e)&&l(e)&&u(n):!h(n,e)&&u(e)&&l(n)},p=function(t,n,i){var r=new o(n);return e.from(t?r.next(i):r.prev(i))},m=function(t,n,i){return p(t,n,i).bind(function(o){return r.isInSameBlock(i,o,n)&&f(t,i,o)?p(t,n,o):e.some(o)})},g=function(t,r){var o=t?r.firstChild:r.lastChild;return a.isText(o)?e.some(new i(o,t?0:o.data.length)):o?n.isCaretCandidate(o)?e.some(t?i.before(o):c(o)):s(t,r,o):e.none()};return{fromPosition:p,nextPosition:t.curry(p,!0),prevPosition:t.curry(p,!1),navigate:m,positionIn:g,firstPositionIn:t.curry(g,!0),lastPositionIn:t.curry(g,!1)}}),o("tinymce.core.selection.RangeNormalizer",["global!document","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils"],function(t,e,n,i){var r=function(e,n,i,r){var o=t.createRange();return o.setStart(e,n),o.setEnd(i,r),o},o=function(t){var o=n.fromRangeStart(t),a=n.fromRangeEnd(t),s=t.commonAncestorContainer;return e.fromPosition(!1,s,a).map(function(e){return!i.isInSameBlock(o,a,s)&&i.isInSameBlock(o,e,s)?r(o.container(),o.offset(),e.container(),e.offset()):t}).getOr(t)},a=function(t){return t.collapsed?t:o(t)};return{normalize:function(t){return a(t)}}}),o("tinymce.core.InsertContent",["ephox.katamari.api.Option","ephox.sugar.api.node.Element","tinymce.core.Env","tinymce.core.InsertList","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretWalker","tinymce.core.dom.ElementUtils","tinymce.core.dom.NodeType","tinymce.core.dom.PaddingBr","tinymce.core.html.Serializer","tinymce.core.selection.RangeNormalizer","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c,u,l,h){var d=s.matchNodeNames("td th"),f=function(t,e,n){if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(t.dom.createFragment(e),n);else{var i=n.firstChild,r=n.lastChild;!i||i===r&&"BR"===i.nodeName?t.dom.setHTML(n,e):t.selection.setContent(e)}},p=function(n,i){t.from(n.getParent(i,"td,th")).map(e.fromDom).each(c.trimBlockTrailingBr)},m=function(t,e,s){var c,m,g,v,y,b,_,x,w,S,k,E,T=t.schema.getTextInlineElements(),C=t.selection,L=t.dom,P=function(t){var e,n,i;e=C.getRng(!0),n=e.startContainer,i=e.startOffset;var r=function(t){return n[t]&&3==n[t].nodeType};return 3==n.nodeType&&(i>0?t=t.replace(/^&nbsp;/," "):r("previousSibling")||(t=t.replace(/^ /,"&nbsp;")),i<n.length?t=t.replace(/&nbsp;(<br>|)$/," "):r("nextSibling")||(t=t.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),t},A=function(){var t,n,i;n=(t=C.getRng(!0)).startContainer,i=t.startOffset,3==n.nodeType&&t.collapsed&&("\xa0"===n.data[i]?(n.deleteData(i,1),/[\u00a0| ]$/.test(e)||(e+=" ")):"\xa0"===n.data[i-1]&&(n.deleteData(i-1,1),/[\u00a0| ]$/.test(e)||(e=" "+e)))},N=function(){if(E){var e=t.getBody(),n=new a(L);h.each(L.select("*[data-mce-fragment]"),function(t){for(var i=t.parentNode;i&&i!=e;i=i.parentNode)T[t.nodeName.toLowerCase()]&&n.compare(i,t)&&L.remove(t,!0)})}},R=function(t){for(var e=t;e=e.walk();)1===e.type&&e.attr("data-mce-fragment","1")},I=function(t){h.each(t.getElementsByTagName("*"),function(t){t.removeAttribute("data-mce-fragment")})},D=function(t){return!!t.getAttribute("data-mce-fragment")},O=function(e){return e&&!t.schema.getShortEndedElements()[e.nodeName]},B=function(e){var i,a,s,c=function(e){for(var n=t.getBody();e&&e!==n;e=e.parentNode)if("false"===t.dom.getContentEditable(e))return e;return null};if(e){if(C.scrollIntoView(e),i=c(e))return L.remove(e),void C.select(i);x=L.createRng(),(w=e.previousSibling)&&3==w.nodeType?(x.setStart(w,w.nodeValue.length),n.ie||(S=e.nextSibling)&&3==S.nodeType&&(w.appendData(S.data),S.parentNode.removeChild(S))):(x.setStartBefore(e),x.setEndBefore(e));var u=function(e){var n=r.fromRangeStart(e);if(n=new o(t.getBody()).next(n))return n.toRange()};a=L.getParent(e,L.isBlock),L.remove(e),a&&L.isEmpty(a)&&(t.$(a).empty(),x.setStart(a,0),x.setEnd(a,0),d(a)||D(a)||!(s=u(x))?L.add(a,L.create("br",{"data-mce-bogus":"1"})):(x=s,L.remove(a))),C.setRng(x)}};if(/^ | $/.test(e)&&(e=P(e)),c=t.parser,E=s.merge,m=new u({validate:t.settings.validate},t.schema),k='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>',b={content:e,format:"html",selection:!0,paste:s.paste},(b=t.fire("BeforeSetContent",b)).isDefaultPrevented())t.fire("SetContent",{content:b.content,format:"html",selection:!0,paste:s.paste});else{-1==(e=b.content).indexOf("{$caret}")&&(e+="{$caret}"),e=e.replace(/\{\$caret\}/,k);var M=(x=C.getRng()).startContainer||(x.parentElement?x.parentElement():null),F=t.getBody();M===F&&C.isCollapsed()&&L.isBlock(F.firstChild)&&O(F.firstChild)&&L.isEmpty(F.firstChild)&&((x=L.createRng()).setStart(F.firstChild,0),x.setEnd(F.firstChild,0),C.setRng(x)),C.isCollapsed()||(t.selection.setRng(l.normalize(t.selection.getRng())),t.getDoc().execCommand("Delete",!1,null),A());var z={context:(g=C.getNode()).nodeName.toLowerCase(),data:s.data,insert:!0};if(y=c.parse(e,z),!0===s.paste&&i.isListFragment(t.schema,y)&&i.isParentBlockLi(L,g))return x=i.insertAtCaret(m,L,t.selection.getRng(!0),y),t.selection.setRng(x),void t.fire("SetContent",b);if(R(y),"mce_marker"==(w=y.lastChild).attr("id"))for(_=w,w=w.prev;w;w=w.walk(!0))if(3==w.type||!L.isBlock(w.name)){t.schema.isValidChild(w.parent.name,"span")&&w.parent.insert(_,w,"br"===w.name);break}if(t._selectionOverrides.showBlockCaretContainer(g),z.invalid){for(C.setContent(k),g=C.getNode(),v=t.getBody(),9==g.nodeType?g=w=v:w=g;w!==v;)g=w,w=w.parentNode;e=g==v?v.innerHTML:L.getOuterHTML(g),e=m.serialize(c.parse(e.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return m.serialize(y)}))),g==v?L.setHTML(v,e):L.setOuterHTML(g,e)}else e=m.serialize(y),f(t,e,g);N(),B(L.get("mce_marker")),I(t.getBody()),p(t.dom,t.selection.getStart()),t.fire("SetContent",b),t.addVisual()}},g=function(t){var e;return"string"!=typeof t?(e=h.extend({paste:t.paste,data:{paste:t.paste}},t),{content:t.content,details:e}):{content:t,details:{}}};return{insertAtCaret:function(t,e){var n=g(e);m(t,n.content,n.details)}}}),o("ephox.sugar.impl.ClosestOrAncestor",["ephox.katamari.api.Type","ephox.katamari.api.Option"],function(t,e){return function(n,i,r,o,a){return n(r,o)?e.some(r):t.isFunction(a)&&a(r)?e.none():i(r,o,a)}}),o("ephox.sugar.api.search.PredicateFind",["ephox.katamari.api.Type","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Body","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.impl.ClosestOrAncestor"],function(t,e,n,i,r,o,a,s){var c=function(t){return d(r.body(),t)},u=function(e,r,o){for(var s=e.dom(),c=t.isFunction(o)?o:n.constant(!1);s.parentNode;){s=s.parentNode;var u=a.fromDom(s);if(r(u))return i.some(u);if(c(u))break}return i.none()},l=function(t,e){var n=t.dom();return n.parentNode?h(a.fromDom(n.parentNode),function(n){return!o.eq(t,n)&&e(n)}):i.none()},h=function(t,i){return e.find(t.dom().childNodes,n.compose(i,a.fromDom)).map(a.fromDom)},d=function(t,e){var n=function(t){for(var r=0;r<t.childNodes.length;r++){if(e(a.fromDom(t.childNodes[r])))return i.some(a.fromDom(t.childNodes[r]));var o=n(t.childNodes[r]);if(o.isSome())return o}return i.none()};return n(t.dom())};return{first:c,ancestor:u,closest:function(t,e,n){return s(function(t){return e(t)},u,t,e,n)},sibling:l,child:h,descendant:d}}),o("tinymce.core.EditorSettings",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Obj","ephox.katamari.api.Option","ephox.katamari.api.Strings","ephox.katamari.api.Struct","ephox.katamari.api.Type","ephox.sand.api.PlatformDetection","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c){var u=o.immutable("sections","settings"),l=s.detect().deviceType.isTouch(),h=["lists","autolink","autosave"],d={theme:"mobile"},f=function(e){var n=a.isArray(e)?e.join(" "):e,i=t.map(a.isString(n)?n.split(" "):[],r.trim);return t.filter(i,function(t){return t.length>0})},p=function(n){return t.filter(n,e.curry(t.contains,h))},m=function(e,i){var r=n.bifilter(i,function(n,i){return t.contains(e,i)});return u(r.t,r.f)},g=function(t,e,n){var i=t.sections(),r=i.hasOwnProperty(e)?i[e]:{};return c.extend({},n,r)},v=function(t,e){return t.sections().hasOwnProperty(e)},y=function(t,e,n){return{id:t,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:e,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,padd_empty_editor:!0,render_ui:!0,indentation:"30px",inline_styles:!0,convert_fonts_to_spans:!0,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:n.convertURL,url_converter_scope:n,ie7_compat:!0}},b=function(t,e){var n=e.external_plugins?e.external_plugins:{};return t&&t.external_plugins?c.extend({},t.external_plugins,n):n},_=function(t,e){return[].concat(f(t)).concat(f(e))},x=function(t,e,n,i){var r=f(n.forced_plugins),o=f(i.plugins),a=t&&v(e,"mobile")?p(o):o,s=_(r,a);return c.extend(i,{plugins:s.join(" ")})},w=function(t,e){var n=e.settings().inline;return t&&v(e,"mobile")&&!n},S=function(t,e,n,i){var r=m(["mobile"],i),o=c.extend(e,n,r.settings(),w(t,r)?g(r,"mobile",d):{},{validate:!0,content_editable:r.settings().inline,external_plugins:b(n,r.settings())});return x(t,r,n,o)},k=function(t,e,n){return i.from(e.settings[n]).filter(t)};return{getEditorSettings:function(t,e,n,i,r){var o=y(e,n,t);return S(l,o,i,r)},get:function(t,e){return i.from(t.settings[e])},getString:e.curry(k,a.isString),combineSettings:S}}),o("tinymce.core.text.Bidi",[],function(){var t=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/;return{hasStrongRtl:function(e){return t.test(e)}}}),o("tinymce.core.keyboard.InlineUtils",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Element","ephox.sugar.api.search.Selectors","tinymce.core.EditorSettings","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.dom.DOMUtils","tinymce.core.dom.NodeType","tinymce.core.text.Bidi"],function(t,e,n,i,r,o,a,s,c,u,l,h){var d=function(e,n,i){return t.filter(u.DOM.getParents(i.container(),"*",n),e)},f=function(t,e,n){var i=c.getParentBlock(e,t),r=c.getParentBlock(n,t);return i&&i===r},p=function(t,e){var n=e.container(),i=e.offset();return t?a.isCaretContainerInline(n)?l.isText(n.nextSibling)?new s(n.nextSibling,0):s.after(n):a.isBeforeInline(e)?new s(n,i+1):e:a.isCaretContainerInline(n)?l.isText(n.previousSibling)?new s(n.previousSibling,n.previousSibling.data.length):s.before(n):a.isAfterInline(e)?new s(n,i-1):e};return{isInlineTarget:function(t,e){var n=o.getString(t,"inline_boundaries_selector").getOr("a[href],code");return r.is(i.fromDom(e),n)},findRootInline:function(t,e,i){var r=d(t,e,i);return n.from(r[r.length-1])},isRtl:function(t){return"rtl"===u.DOM.getStyle(t,"direction",!0)||h.hasStrongRtl(t.textContent)},isAtZwsp:function(t){return a.isBeforeInline(t)||a.isAfterInline(t)},normalizePosition:p,normalizeForwards:e.curry(p,!0),normalizeBackwards:e.curry(p,!1),hasSameParentBlock:f}}),o("tinymce.core.delete.DeleteUtils",["ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.PredicateFind","tinymce.core.caret.CaretFinder","tinymce.core.dom.ElementType","tinymce.core.keyboard.InlineUtils"],function(t,e,n,i,r,o,a,s){var c=function(t){return function(e){return n.eq(t,i.fromDom(e.dom().parentNode))}},u=function(t){var e=t.getBody(),n=e.firstChild&&t.dom.isBlock(e.firstChild)?e.firstChild:e;t.selection.setCursorLocation(n,0)};return{getParentBlock:function(e,i){return n.contains(e,i)?r.closest(i,function(t){return a.isTextBlock(t)||a.isListItem(t)},c(e)):t.none()},paddEmptyBody:function(t){t.dom.isEmpty(t.getBody())&&(t.setContent(""),u(t))},willDeleteLastPositionInElement:function(t,n,i){return e.liftN([o.firstPositionIn(i),o.lastPositionIn(i)],function(e,r){var a=s.normalizePosition(!0,e),c=s.normalizePosition(!1,r),u=s.normalizePosition(!1,n);return t?o.nextPosition(i,u).map(function(t){return t.isEqual(c)&&n.isEqual(a)}).getOr(!1):o.prevPosition(i,u).map(function(t){return t.isEqual(a)&&n.isEqual(c)}).getOr(!1)}).getOr(!0)}}}),o("ephox.sugar.api.search.SelectorFind",["ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Selectors","ephox.sugar.impl.ClosestOrAncestor"],function(t,e,n){var i=function(n,i,r){return t.ancestor(n,function(t){return e.is(t,i)},r)};return{first:function(t){return e.one(t)},ancestor:i,sibling:function(n,i){return t.sibling(n,function(t){return e.is(t,i)})},child:function(n,i){return t.child(n,function(t){return e.is(t,i)})},descendant:function(t,n){return e.one(n,t)},closest:function(t,r,o){return n(e.is,i,t,r,o)}}}),o("ephox.sugar.api.search.SelectorExists",["ephox.sugar.api.search.SelectorFind"],function(t){return{any:function(e){return t.first(e).isSome()},ancestor:function(e,n,i){return t.ancestor(e,n,i).isSome()},sibling:function(e,n){return t.sibling(e,n).isSome()},child:function(e,n){return t.child(e,n).isSome()},descendant:function(e,n){return t.descendant(e,n).isSome()},closest:function(e,n,i){return t.closest(e,n,i).isSome()}}}),o("tinymce.core.dom.Empty",["ephox.katamari.api.Fun","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorExists","tinymce.core.caret.CaretCandidate","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker"],function(t,e,n,i,r,o,a){var s=function(r,o){var a=n.fromDom(r),s=n.fromDom(o);return i.ancestor(s,"pre,code",t.curry(e.eq,a))},c=function(t,e){return o.isText(e)&&/^[ \t\r\n]*$/.test(e.data)&&!1===s(t,e)},u=function(t){return o.isElement(t)&&"A"===t.nodeName&&t.hasAttribute("name")},l=function(t,e){return r.isCaretCandidate(e)&&!1===c(t,e)||u(e)||h(e)},h=o.hasAttribute("data-mce-bookmark"),d=o.hasAttribute("data-mce-bogus"),f=o.hasAttributeValue("data-mce-bogus","all"),p=function(t){var e,n,i=0;if(l(t,t))return!1;if(!(n=t.firstChild))return!0;e=new a(n,t);do{if(f(n))n=e.next(!0);else if(d(n))n=e.next();else if(o.isBr(n))i++,n=e.next();else{if(l(t,n))return!1;n=e.next()}}while(n);return i<=1};return{isEmpty:function(t){return p(t.dom())}}}),o("tinymce.core.delete.BlockBoundary",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.katamari.api.Struct","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Traverse","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.delete.DeleteUtils","tinymce.core.dom.Empty","tinymce.core.dom.NodeType"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p){var m=r.immutable("block","position"),g=r.immutable("from","to"),v=function(t,e){var n=a.fromDom(t),i=a.fromDom(e.container());return d.getParentBlock(n,i).map(function(t){return m(t,e)})},y=function(t){return!1===o.eq(t.from().block(),t.to().block())},b=function(t){return u.parent(t.from().block()).bind(function(e){return u.parent(t.to().block()).filter(function(t){return o.eq(e,t)})}).isSome()},_=function(t){return!1===p.isContentEditableFalse(t.from().block())&&!1===p.isContentEditableFalse(t.to().block())},x=function(t,e,i){return p.isBr(i.position().getNode())&&!1===f.isEmpty(i.block())?l.positionIn(!1,i.block().dom()).bind(function(r){return r.isEqual(i.position())?l.fromPosition(e,t,r).bind(function(e){return v(t,e)}):n.some(i)}).getOr(i):i},w=function(t,e,n){var r=v(t,h.fromRangeStart(n)),o=r.bind(function(n){return l.fromPosition(e,t,n.position()).bind(function(n){return v(t,n).map(function(n){return x(t,e,n)})
})});return i.liftN([r,o],g).filter(function(t){return y(t)&&b(t)&&_(t)})};return{read:function(t,e,i){return i.collapsed?w(t,e,i):n.none()}}}),o("tinymce.core.dom.Parents",["ephox.katamari.api.Fun","ephox.sugar.api.dom.Compare","ephox.sugar.api.search.Traverse"],function(t,e,n){var i=function(t){return t.slice(0,-1)},r=function(t,r,o){return e.contains(r,t)?i(n.parents(t,function(t){return o(t)||e.eq(t,r)})):[]},o=function(e,n){return r(e,n,t.constant(!1))};return{parentsUntil:r,parents:o,parentsAndSelf:function(t,e){return[t].concat(o(t,e))}}}),o("tinymce.core.delete.MergeBlocks",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.dom.ElementType","tinymce.core.dom.Empty","tinymce.core.dom.NodeType","tinymce.core.dom.PaddingBr","tinymce.core.dom.Parents"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f){var p=function(e){var n=a.children(e);return t.findIndex(n,u.isBlock).fold(function(){return n},function(t){return n.slice(0,t)})},m=function(e){var n=p(e);return t.each(n,function(t){r.remove(t)}),n},g=function(t,e){s.positionIn(t,e.dom()).each(function(t){var e=t.getNode();h.isBr(e)&&r.remove(o.fromDom(e))})},v=function(e,n){var i=f.parentsAndSelf(n,e);return t.find(i.reverse(),l.isEmpty).each(r.remove)},y=function(t,i){var r=a.parents(i,function(e){return n.eq(e,t)});return e.from(r[r.length-2])},b=function(t,i){return n.contains(i,t)?a.parent(t).bind(function(r){return n.eq(r,i)?e.some(t):y(i,t)}):e.none()},_=function(e,n,o){if(l.isEmpty(o))return r.remove(o),l.isEmpty(n)&&d.fillWithPaddingBr(n),s.firstPositionIn(n.dom());g(!0,n),g(!1,o);var a=m(n);return b(n,o).fold(function(){v(e,n);var r=s.lastPositionIn(o.dom());return t.each(a,function(t){i.append(o,t)}),r},function(r){var u=s.prevPosition(o.dom(),c.before(r.dom()));return t.each(a,function(t){i.before(r,t)}),v(e,n),u})};return{mergeBlocks:function(t,e,n,i){return e?_(t,i,n):_(t,n,i)}}}),o("tinymce.core.delete.BlockBoundaryDelete",["ephox.sugar.api.node.Element","tinymce.core.delete.BlockBoundary","tinymce.core.delete.MergeBlocks"],function(t,e,n){return{backspaceDelete:function(i,r){var o,a=t.fromDom(i.getBody());return(o=e.read(a.dom(),r,i.selection.getRng()).bind(function(t){return n.mergeBlocks(a,r,t.from().block(),t.to().block())})).each(function(t){i.selection.setRng(t.toRange())}),o.isSome()}}}),o("tinymce.core.delete.BlockRangeDelete",["ephox.katamari.api.Fun","ephox.katamari.api.Options","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.PredicateFind","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.delete.DeleteUtils","tinymce.core.delete.MergeBlocks","tinymce.core.dom.ElementType"],function(t,e,n,i,r,o,a,s,c,u){var l=function(t,r){var o=r.getRng();return e.liftN([s.getParentBlock(t,i.fromDom(o.startContainer)),s.getParentBlock(t,i.fromDom(o.endContainer))],function(e,i){return!1===n.eq(e,i)&&(o.deleteContents(),c.mergeBlocks(t,!0,e,i).each(function(t){r.setRng(t.toRange())}),!0)}).getOr(!1)},h=function(e,o){var a=i.fromDom(o),s=t.curry(n.eq,e);return r.ancestor(a,u.isTableCell,s).isSome()},d=function(t,e){return h(t,e.startContainer)||h(t,e.endContainer)},f=function(t,e){var n=o.prevPosition(t.dom(),a.fromRangeStart(e)).isNone(),i=o.nextPosition(t.dom(),a.fromRangeEnd(e)).isNone();return!d(t,e)&&n&&i},p=function(t){return t.setContent(""),t.selection.setCursorLocation(),!0},m=function(t){var e=i.fromDom(t.getBody()),n=t.selection.getRng();return f(e,n)?p(t):l(e,t.selection)};return{backspaceDelete:function(t){return!t.selection.isCollapsed()&&m(t,t.selection.getRng())}}}),o("ephox.katamari.api.Adt",["ephox.katamari.api.Arr","ephox.katamari.api.Obj","ephox.katamari.api.Type","global!Array","global!Error","global!console"],function(t,e,n,i,r,o){return{generate:function(a){if(!n.isArray(a))throw new r("cases must be an array");if(0===a.length)throw new r("there must be at least one case");var s=[],c={};return t.each(a,function(u,l){var h=e.keys(u);if(1!==h.length)throw new r("one and only one name per case");var d=h[0],f=u[d];if(c[d]!==undefined)throw new r("duplicate key detected:"+d);if("cata"===d)throw new r("cannot have a case named cata (sorry)");if(!n.isArray(f))throw new r("case arguments must be an array");s.push(d),c[d]=function(){var n=arguments.length;if(n!==f.length)throw new r("Wrong number of arguments to case "+d+". Expected "+f.length+" ("+f+"), got "+n);for(var c=new i(n),u=0;u<c.length;u++)c[u]=arguments[u];return{fold:function(){if(arguments.length!==a.length)throw new r("Wrong number of arguments to fold. Expected "+a.length+", got "+arguments.length);return arguments[l].apply(null,c)},match:function(n){var i=e.keys(n);if(s.length!==i.length)throw new r("Wrong number of arguments to match. Expected: "+s.join(",")+"\nActual: "+i.join(","));if(!t.forall(s,function(e){return t.contains(i,e)}))throw new r("Not all branches were specified when using match. Specified: "+i.join(", ")+"\nRequired: "+s.join(", "));return n[d].apply(null,c)},log:function(t){o.log(t,{constructors:s,constructor:d,params:c})}}}}),c}}}),o("tinymce.core.delete.CefDeleteAction",["ephox.katamari.api.Adt","ephox.katamari.api.Option","ephox.sugar.api.node.Element","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.delete.DeleteUtils","tinymce.core.dom.Empty","tinymce.core.dom.NodeType"],function(t,e,n,i,r,o,a,s,c){var u=t.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),l=function(t,e){var n=e.getNode(!1===t),i=t?"after":"before";return c.isElement(n)&&n.getAttribute("data-mce-caret")===i},h=function(t,i,r,o){var c=o.getNode(!1===i);return a.getParentBlock(n.fromDom(t),n.fromDom(r.getNode())).map(function(t){return s.isEmpty(t)?u.remove(t.dom()):u.moveToElement(c)}).orThunk(function(){return e.some(u.moveToElement(c))})},d=function(t,n,r){return i.fromPosition(n,t,r).bind(function(i){return n&&c.isContentEditableFalse(i.getNode())?h(t,n,r,i):!1===n&&c.isContentEditableFalse(i.getNode(!0))?h(t,n,r,i):n&&o.isAfterContentEditableFalse(r)?e.some(u.moveToPosition(i)):!1===n&&o.isBeforeContentEditableFalse(r)?e.some(u.moveToPosition(i)):e.none()})},f=function(t,n){return t&&c.isContentEditableFalse(n.nextSibling)?e.some(u.moveToElement(n.nextSibling)):!1===t&&c.isContentEditableFalse(n.previousSibling)?e.some(u.moveToElement(n.previousSibling)):e.none()},p=function(t,n,i){return i.fold(function(t){return e.some(u.remove(t))},function(t){return e.some(u.moveToElement(t))},function(i){return o.isInSameBlock(n,i,t)?e.none():e.some(u.moveToPosition(i))})},m=function(t,n,i){return l(n,i)?f(n,i.getNode(!1===n)).fold(function(){return d(t,n,i)},e.some):d(t,n,i).bind(function(e){return p(t,i,e)})};return{read:function(t,n,i){var a=o.normalizeRange(n?1:-1,t,i),s=r.fromRangeStart(a);return!1===n&&o.isAfterContentEditableFalse(s)?e.some(u.remove(s.getNode(!0))):n&&o.isBeforeContentEditableFalse(s)?e.some(u.remove(s.getNode())):m(t,n,s)}}}),o("tinymce.core.delete.DeleteElement",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.PredicateFind","ephox.sugar.api.search.Traverse","tinymce.core.caret.CaretCandidate","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.dom.Empty","tinymce.core.dom.NodeType"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f){var p=function(t,e){var n=t.container(),i=t.offset();return!1===h.isTextPosition(t)&&n===e.parentNode&&i>h.before(e).offset()},m=function(t,e){return p(e,t)?new h(e.container(),e.offset()-1):e},g=function(t){return f.isText(t)?new h(t,0):h.before(t)},v=function(t){return f.isText(t)?new h(t,t.data.length):h.after(t)},y=function(t){return u.isCaretCandidate(t.previousSibling)?e.some(v(t.previousSibling)):t.previousSibling?l.lastPositionIn(t.previousSibling):e.none()},b=function(t){return u.isCaretCandidate(t.nextSibling)?e.some(g(t.nextSibling)):t.nextSibling?l.firstPositionIn(t.nextSibling):e.none()},_=function(t,n){var i=h.before(n.previousSibling?n.previousSibling:n.parentNode);return l.prevPosition(t,i).fold(function(){return l.nextPosition(t,h.after(n))},e.some)},x=function(t,n){return l.nextPosition(t,h.after(n)).fold(function(){return l.prevPosition(t,h.before(n))},e.some)},w=function(t,e){return y(e).orThunk(function(){return b(e)}).orThunk(function(){return _(t,e)})},S=function(t,e){return b(e).orThunk(function(){return y(e)}).orThunk(function(){return x(t,e)})},k=function(t,e,n){return t?S(e,n):w(e,n)},E=function(e,n,i){return k(e,n,i).map(t.curry(m,i))},T=function(t,e,n){n.fold(function(){t.focus()},function(n){t.selection.setRng(n.toRange(),e)})},C=function(t){return function(e){return e.dom()===t}},L=function(t,e){return e&&t.schema.getBlockElements().hasOwnProperty(a.name(e))},P=function(t){if(d.isEmpty(t)){var n=o.fromHtml('<br data-mce-bogus="1">');return r.empty(t),i.append(t,n),e.some(h.before(n.dom()))}return e.none()},A=function(t,e){return n.liftN([c.prevSibling(t),c.nextSibling(t),e],function(e,n,i){var o,a=e.dom(),s=n.dom();return f.isText(a)&&f.isText(s)?(o=a.data.length,a.appendData(s.data),r.remove(n),r.remove(t),i.container()===s?new h(a,o):i):(r.remove(t),i)}).orThunk(function(){return r.remove(t),e})};return{deleteElement:function(n,i,r){var o=E(i,n.getBody(),r.dom()),a=s.ancestor(r,t.curry(L,n),C(n.getBody())),c=A(r,o);n.dom.isEmpty(n.getBody())?(n.setContent(""),n.selection.setCursorLocation()):a.bind(P).fold(function(){T(n,i,c)},function(t){T(n,i,e.some(t))})}}}),o("tinymce.core.delete.CefDelete",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorFilter","tinymce.core.caret.CaretPosition","tinymce.core.delete.CefDeleteAction","tinymce.core.delete.DeleteElement","tinymce.core.delete.DeleteUtils","tinymce.core.dom.NodeType"],function(t,e,n,i,r,o,a,s,c){var u=function(t,e){return function(i){return t._selectionOverrides.hideFakeCaret(),a.deleteElement(t,e,n.fromDom(i)),!0}},l=function(t,e){return function(n){var i=e?r.before(n):r.after(n);return t.selection.setRng(i.toRange()),!0}},h=function(t){return function(e){return t.selection.setRng(e.toRange()),!0}},d=function(t,e){return o.read(t.getBody(),e,t.selection.getRng()).map(function(n){return n.fold(u(t,e),l(t,e),h(t))}).getOr(!1)},f=function(n){t.each(i.descendants(n,".mce-offscreen-selection"),e.remove)},p=function(t,e){var i=t.selection.getNode();return!!c.isContentEditableFalse(i)&&(f(n.fromDom(t.getBody())),a.deleteElement(t,e,n.fromDom(t.selection.getNode())),s.paddEmptyBody(t),!0)},m=function(t,e){for(;e&&e!==t;){if(c.isContentEditableTrue(e)||c.isContentEditableFalse(e))return e;e=e.parentNode}return null};return{backspaceDelete:function(t,e){return t.selection.isCollapsed()?d(t,e):p(t,e)},paddEmptyElement:function(t){var e,n=m(t.getBody(),t.selection.getNode());return c.isContentEditableTrue(n)&&t.dom.isBlock(n)&&t.dom.isEmpty(n)&&(e=t.dom.create("br",{"data-mce-bogus":"1"}),t.dom.setHTML(n,""),n.appendChild(e),t.selection.setRng(r.before(e).toRange())),!0}}}),o("tinymce.core.caret.CaretContainerInline",["ephox.katamari.api.Fun","tinymce.core.dom.NodeType","tinymce.core.text.Zwsp"],function(t,e,n){var i=e.isText,r=function(t){return i(t)&&t.data[0]===n.ZWSP},o=function(t){return i(t)&&t.data[t.data.length-1]===n.ZWSP},a=function(t){return t.ownerDocument.createTextNode(n.ZWSP)},s=function(t){if(i(t.previousSibling))return o(t.previousSibling)?t.previousSibling:(t.previousSibling.appendData(n.ZWSP),t.previousSibling);if(i(t))return r(t)?t:(t.insertData(0,n.ZWSP),t);var e=a(t);return t.parentNode.insertBefore(e,t),e},c=function(t){if(i(t.nextSibling))return r(t.nextSibling)?t.nextSibling:(t.nextSibling.insertData(0,n.ZWSP),t.nextSibling);if(i(t))return o(t)?t:(t.appendData(n.ZWSP),t);var e=a(t);return t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e),e},u=function(t,e){return t?s(e):c(e)};return{insertInline:u,insertInlineBefore:t.curry(u,!0),insertInlineAfter:t.curry(u,!1)}}),o("tinymce.core.caret.CaretContainerRemove",["ephox.katamari.api.Arr","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.text.Zwsp"],function(t,e,n,i,r){var o=i.isElement,a=i.isText,s=function(t){var e=t.parentNode;e&&e.removeChild(t)},c=function(t){try{return t.nodeValue}catch(e){return""}},u=function(t,e){0===e.length?s(t):t.nodeValue=e},l=function(t){var e=r.trim(t);return{count:t.length-e.length,text:e}},h=function(t,e){return g(t),e},d=function(t,e){var i=l(t.data.substr(0,e.offset())),r=l(t.data.substr(e.offset())),o=i.text+r.text;return o.length>0?(u(t,o),new n(t,e.offset()-i.count)):e},f=function(e,i){var r=i.container(),o=t.indexOf(r.childNodes,e).map(function(t){return t<i.offset()?new n(r,i.offset()-1):i}).getOr(i);return g(e),o},p=function(t,e){return e.container()===t?d(t,e):h(t,e)},m=function(t,e){return e.container()===t.parentNode?f(t,e):h(t,e)},g=function(t){if(o(t)&&e.isCaretContainer(t)&&(e.hasContent(t)?t.removeAttribute("data-mce-caret"):s(t)),a(t)){var n=r.trim(c(t));u(t,n)}};return{removeAndReposition:function(t,e){return n.isTextPosition(e)?p(t,e):m(t,e)},remove:g}}),o("tinymce.core.keyboard.BoundaryCaret",["ephox.katamari.api.Option","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretContainerInline","tinymce.core.caret.CaretContainerRemove","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.keyboard.InlineUtils"],function(t,e,n,i,r,o,a){var s=function(t,e){return a.isText(t.container())?n.insertInline(e,t.container()):n.insertInline(e,t.getNode())},c=function(t,n){var i=n.get();return i&&t.container()===i&&e.isCaretContainerInline(i)};return{renderCaret:function(e,a){return a.fold(function(r){i.remove(e.get());var a=n.insertInlineBefore(r);return e.set(a),t.some(new o(a,a.length-1))},function(t){return r.firstPositionIn(t).map(function(t){if(c(t,e))return new o(e.get(),1);i.remove(e.get());var n=s(t,!0);return e.set(n),new o(n,1)})},function(t){return r.lastPositionIn(t).map(function(t){if(c(t,e))return new o(e.get(),e.get().length-1);i.remove(e.get());var n=s(t,!1);return e.set(n),new o(n,n.length-1)})},function(r){i.remove(e.get());var a=n.insertInlineAfter(r);return e.set(a),t.some(new o(a,1))})}}}),o("tinymce.core.fmt.FormatUtils",["tinymce.core.dom.TreeWalker"],function(t){var e=function(t){return t&&/^(IMG)$/.test(t.nodeName)},n=function(n,i,o){var a,s,c,u=o.startContainer,l=o.startOffset;if((o.startContainer!==o.endContainer||!e(o.startContainer.childNodes[o.startOffset]))&&(3===u.nodeType&&l>=u.nodeValue.length&&(l=n.nodeIndex(u),u=u.parentNode),1===u.nodeType))for(l<(c=u.childNodes).length?(u=c[l],a=new t(u,n.getParent(u,n.isBlock))):(u=c[c.length-1],(a=new t(u,n.getParent(u,n.isBlock))).next(!0)),s=a.current();s;s=a.next())if(3===s.nodeType&&!r(s))return o.setStart(s,0),void i.setRng(o)},i=function(t,e,n){if(t)for(e=e?"nextSibling":"previousSibling",t=n?t:t[e];t;t=t[e])if(1===t.nodeType||!r(t))return t},r=function(t){return t&&3===t.nodeType&&/^([\t \r\n]+|)$/.test(t.nodeValue)},o=function(t,e,n){return"color"!==n&&"backgroundColor"!==n||(e=t.toHex(e)),"fontWeight"===n&&700===e&&(e="bold"),"fontFamily"===n&&(e=e.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+e};return{isInlineBlock:e,moveStart:n,getNonWhiteSpaceSibling:i,isTextBlock:function(t,e){return e.nodeType&&(e=e.nodeName),!!t.schema.getTextBlockElements()[e.toLowerCase()]},isValid:function(t,e,n){return t.schema.isValidChild(e,n)},isWhiteSpaceNode:r,replaceVars:function(t,e){return"string"!=typeof t?t=t(e):e&&(t=t.replace(/%(\w+)/g,function(t,n){return e[n]||t})),t},isEq:function(t,e){return t=t||"",e=e||"",t=""+(t.nodeName||t),e=""+(e.nodeName||e),t.toLowerCase()===e.toLowerCase()},normalizeStyleValue:o,getStyle:function(t,e,n){return o(t,t.getStyle(e,n),n)},getTextDecoration:function(t,e){var n;return t.getParent(e,function(e){return(n=t.getStyle(e,"text-decoration"))&&"none"!==n}),n},getParents:function(t,e,n){return t.getParents(e,n,t.getRoot())}}}),o("tinymce.core.fmt.ExpandRange",["tinymce.core.dom.Bookmarks","tinymce.core.dom.TreeWalker","tinymce.core.fmt.FormatUtils","tinymce.core.selection.RangeNodes"],function(t,e,n,i){var r=t.isBookmarkNode,o=n.getParents,a=n.isWhiteSpaceNode,s=n.isTextBlock,c=function(t,e){for(void 0===e&&(e=3===t.nodeType?t.length:t.childNodes.length);t&&t.hasChildNodes();)(t=t.childNodes[e])&&(e=3===t.nodeType?t.length:t.childNodes.length);return{node:t,offset:e}},u=function(t,e){var n=c(t,e);if(n.node){for(;n.node&&0===n.offset&&n.node.previousSibling;)n=c(n.node.previousSibling);n.node&&n.offset>0&&3===n.node.nodeType&&" "===n.node.nodeValue.charAt(n.offset-1)&&n.offset>1&&(t=n.node).splitText(n.offset-1)}return t},l=function(t){return"BR"===t.nodeName&&t.getAttribute("data-mce-bogus")&&!t.nextSibling},h=function(t,e){for(var n=e;n;){if(1===n.nodeType&&t.getContentEditable(n))return"false"===t.getContentEditable(n)?n:e;n=n.parentNode}return e},d=function(t,e,n,i){var r,o,a=n.nodeValue;return void 0===i&&(i=t?a.length:0),t?-1===(r=(r=a.lastIndexOf(" ",i))>(o=a.lastIndexOf("\xa0",i))?r:o)||e||r++:(r=a.indexOf(" ",i),o=a.indexOf("\xa0",i),r=-1!==r&&(-1===o||r<o)?r:o),r},f=function(t,n,i,r,o,a){var s,c,u,l;if(3===i.nodeType){if(-1!==(u=d(o,a,i,r)))return{container:i,offset:u};l=i}for(s=new e(i,t.getParent(i,t.isBlock)||n);c=s[o?"prev":"next"]();)if(3===c.nodeType){if(l=c,-1!==(u=d(o,a,c)))return{container:c,offset:u}}else if(t.isBlock(c))break;if(l)return r=o?0:l.length,{container:l,offset:r}},p=function(t,e,n,i,r){var a,s,c,u;for(3===i.nodeType&&0===i.nodeValue.length&&i[r]&&(i=i[r]),a=o(t,i),s=0;s<a.length;s++)for(c=0;c<e.length;c++)if(!("collapsed"in(u=e[c])&&u.collapsed!==n.collapsed)&&t.is(a[s],u.selector))return a[s];return i},m=function(t,e,i,r){var a,c=t.dom,u=c.getRoot();if(e[0].wrapper||(a=c.getParent(i,e[0].block,u)),!a){var l=c.getParent(i,"LI,TD,TH");a=c.getParent(3===i.nodeType?i.parentNode:i,function(e){return e!==u&&s(t,e)},l)}if(a&&e[0].wrapper&&(a=o(c,a,"ul,ol").reverse()[0]||a),!a)for(a=i;a[r]&&!c.isBlock(a[r])&&(a=a[r],!n.isEq(a,"br")););return a||i},g=function(t,e,n,i,o,s,c){var u,h,d,f,p;if(u=h=c?n:o,f=c?"previousSibling":"nextSibling",p=t.getRoot(),3===u.nodeType&&!a(u)&&(c?i>0:s<u.nodeValue.length))return u;for(;;){if(!e[0].block_expand&&t.isBlock(h))return h;for(d=h[f];d;d=d[f])if(!r(d)&&!a(d)&&!l(d))return h;if(h===p||h.parentNode===p){u=h;break}h=h.parentNode}return u};return{expandRng:function(t,e,n,o){var a,s=e.startContainer,c=e.startOffset,l=e.endContainer,d=e.endOffset,v=t.dom;return 1===s.nodeType&&s.hasChildNodes()&&3===(s=i.getNode(s,c)).nodeType&&(c=0),1===l.nodeType&&l.hasChildNodes()&&3===(l=i.getNode(l,e.collapsed?d:d-1)).nodeType&&(d=l.nodeValue.length),s=h(v,s),l=h(v,l),(r(s.parentNode)||r(s))&&3===(s=(s=r(s)?s:s.parentNode).nextSibling||s).nodeType&&(c=0),(r(l.parentNode)||r(l))&&3===(l=(l=r(l)?l:l.parentNode).previousSibling||l).nodeType&&(d=l.length),n[0].inline&&(e.collapsed&&((a=f(v,t.getBody(),s,c,!0,o))&&(s=a.container,c=a.offset),(a=f(v,t.getBody(),l,d,!1,o))&&(l=a.container,d=a.offset)),l=o?l:u(l,d)),(n[0].inline||n[0].block_expand)&&(n[0].inline&&3===s.nodeType&&0!==c||(s=g(v,n,s,c,l,d,!0)),n[0].inline&&3===l.nodeType&&d!==l.nodeValue.length||(l=g(v,n,s,c,l,d,!1))),n[0].selector&&!1!==n[0].expand&&!n[0].inline&&(s=p(v,n,e,s,"previousSibling"),l=p(v,n,e,l,"nextSibling")),(n[0].block||n[0].selector)&&(s=m(t,n,s,"previousSibling"),l=m(t,n,l,"nextSibling"),n[0].block&&(v.isBlock(s)||(s=g(v,n,s,c,l,d,!0)),v.isBlock(l)||(l=g(v,n,s,c,l,d,!1)))),1===s.nodeType&&(c=v.nodeIndex(s),s=s.parentNode),1===l.nodeType&&(d=v.nodeIndex(l)+1,l=l.parentNode),{startContainer:s,startOffset:c,endContainer:l,endOffset:d}}}}),o("tinymce.core.fmt.MatchFormat",["tinymce.core.fmt.FormatUtils"],function(t){var e=t.isEq,n=function(t,e,n){var i=t.formatter.get(n);if(i)for(var r=0;r<i.length;r++)if(!1===i[r].inherit&&t.dom.is(e,i[r].selector))return!0;return!1},i=function(t,e,i,r){var o=t.dom.getRoot();return e!==o&&(e=t.dom.getParent(e,function(e){return!!n(t,e,i)||(e.parentNode===o||!!a(t,e,i,r,!0))}),a(t,e,i,r))},r=function(t,n,i){return!!e(n,i.inline)||(!!e(n,i.block)||(i.selector?1===n.nodeType&&t.is(n,i.selector):void 0))},o=function(n,i,r,o,a,s){var c,u,l,h=r[o];if(r.onmatch)return r.onmatch(i,r,o);if(h)if("undefined"==typeof h.length){for(c in h)if(h.hasOwnProperty(c)){if(u="attributes"===o?n.getAttrib(i,c):t.getStyle(n,i,c),a&&!u&&!r.exact)return;if((!a||r.exact)&&!e(u,t.normalizeStyleValue(n,t.replaceVars(h[c],s),c)))return}}else for(l=0;l<h.length;l++)if("attributes"===o?n.getAttrib(i,h[l]):t.getStyle(n,i,h[l]))return r;return r},a=function(t,e,n,i,a){var s,c,u,l,h=t.formatter.get(n),d=t.dom;if(h&&e)for(c=0;c<h.length;c++)if(s=h[c],r(t.dom,e,s)&&o(d,e,s,"attributes",a,i)&&o(d,e,s,"styles",a,i)){if(l=s.classes)for(u=0;u<l.length;u++)if(!t.dom.hasClass(e,l[u]))return;return s}};return{matchNode:a,matchName:r,match:function(t,e,n,r){var o;return r?i(t,r,e,n):(r=t.selection.getNode(),!!i(t,r,e,n)||!((o=t.selection.getStart())===r||!i(t,o,e,n)))},matchAll:function(t,e,n){var i,r=[],o={};return i=t.selection.getStart(),t.dom.getParent(i,function(i){var s,c;for(s=0;s<e.length;s++)c=e[s],!o[c]&&a(t,i,c,n)&&(o[c]=!0,r.push(c))},t.dom.getRoot()),r},canApply:function(e,n){var i,r,o,a,s,c=e.formatter.get(n),u=e.dom;if(c)for(i=e.selection.getStart(),r=t.getParents(u,i),a=c.length-1;a>=0;a--){if(!(s=c[a].selector)||c[a].defaultBlock)return!0;for(o=r.length-1;o>=0;o--)if(u.is(r[o],s))return!0}return!1},matchesUnInheritedFormatSelector:n}}),o("tinymce.core.selection.SplitRange",["tinymce.core.dom.NodeType"],function(t){var e=function(t,e){return t.splitText(e)};return{split:function(n){var i=n.startContainer,r=n.startOffset,o=n.endContainer,a=n.endOffset;return i===o&&t.isText(i)?r>0&&r<i.nodeValue.length&&(i=(o=e(i,r)).previousSibling,a>r?(i=o=e(o,a-=r).previousSibling,a=o.nodeValue.length,r=0):a=0):(t.isText(i)&&r>0&&r<i.nodeValue.length&&(i=e(i,r),r=0),t.isText(o)&&a>0&&a<o.nodeValue.length&&(a=(o=e(o,a).previousSibling).nodeValue.length)),{startContainer:i,startOffset:r,endContainer:o,endOffset:a}}}}),o("tinymce.core.fmt.CaretFormat",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.properties.Attr","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.dom.PaddingBr","tinymce.core.dom.TreeWalker","tinymce.core.fmt.ExpandRange","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.MatchFormat","tinymce.core.selection.SplitRange","tinymce.core.text.Zwsp","tinymce.core.util.Fun"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p,m){var g=p.ZWSP,v="_mce_caret",y=function(t,e){return t.importNode(e,!0)},b=function(t){return 1===t.nodeType&&t.id===v},_=function(t){for(var e=[];t;){if(3===t.nodeType&&t.nodeValue!==g||t.childNodes.length>1)return[];1===t.nodeType&&e.push(t),t=t.firstChild}return e},x=function(t){return _(t).length>0},w=function(t){var e;if(t)for(t=(e=new u(t,t)).current();t;t=e.next())if(3===t.nodeType)return t;return null},S=function(t){var n=i.fromTag("span");return o.setAll(n,{id:v,"data-mce-bogus":"1","data-mce-type":"format-caret"}),t&&e.append(n,i.fromText(g)),n},k=function(t,e){for(;e&&e!==t;){if(e.id===v)return e;e=e.parentNode}return null},E=function(t){var e=w(t);return e&&e.nodeValue.charAt(0)===g&&e.deleteData(0,1),e},T=function(t,e,n,r){var o,a,s;o=e.getRng(!0),a=t.getParent(n,t.isBlock),x(n)?(!1!==r&&(o.setStartBefore(n),o.setEndBefore(n)),t.remove(n)):(s=E(n),o.startContainer===s&&o.startOffset>0&&o.setStart(s,o.startOffset-1),o.endContainer===s&&o.endOffset>0&&o.setEnd(s,o.endOffset-1),t.remove(n,!0)),a&&t.isEmpty(a)&&c.fillWithPaddingBr(i.fromDom(a)),e.setRng(o)},C=function(t,e,n,i,r){if(i)T(e,n,i,r);else if(!(i=k(t,n.getStart())))for(;i=e.get(v);)T(e,n,i,!1)},L=function(t,e,n){var r=t.dom,o=r.getParent(n,m.curry(h.isTextBlock,t));o&&r.isEmpty(o)?n.parentNode.replaceChild(e,n):(c.removeTrailingBr(i.fromDom(n)),r.isEmpty(n)?n.parentNode.replaceChild(e,n):r.insertAfter(e,n))},P=function(t,e){return t.appendChild(e),e},A=function(e,n){var i=t.foldr(e,function(t,e){return P(t,e.cloneNode(!1))},n);return P(i,i.ownerDocument.createTextNode(g))},N=function(t,e,n,i){C(t,e,n,null,!1),8===i&&n.isCollapsed()&&n.getStart().innerHTML===g&&C(t,e,n,k(t,n.getStart())),37!==i&&39!==i||C(t,e,n,k(t,n.getStart()))};return{setup:function(t){var e=t.dom,n=t.selection,i=t.getBody();t.on("mouseup keydown",function(t){N(i,e,n,t.keyCode)})},applyCaretFormat:function(t,e,n){var i,r,o,a,s,c,u=t.selection;a=(i=u.getRng(!0)).startOffset,c=i.startContainer.nodeValue,(r=k(t.getBody(),u.getStart()))&&(o=w(r));var h=/[^\s\u00a0\u00ad\u200b\ufeff]/;c&&a>0&&a<c.length&&h.test(c.charAt(a))&&h.test(c.charAt(a-1))?(s=u.getBookmark(),i.collapse(!0),i=l.expandRng(t,i,t.formatter.get(e)),i=f.split(i),t.formatter.apply(e,n,i),u.moveToBookmark(s)):(r&&o.nodeValue===g?t.formatter.apply(e,n,r):(o=(r=y(t.getDoc(),S(!0).dom())).firstChild,i.insertNode(r),a=1,t.formatter.apply(e,n,r)),u.setCursorLocation(o,a))},removeCaretFormat:function(t,e,n,i){var r,o,a,s,c,u,h,p=t.dom,m=t.selection,g=m.getRng(!0),v=[];for(r=g.startContainer,o=g.startOffset,c=r,3===r.nodeType&&(o!==r.nodeValue.length&&(s=!0),c=c.parentNode);c;){if(d.matchNode(t,c,e,n,i)){u=c;break}c.nextSibling&&(s=!0),v.push(c),c=c.parentNode}if(u)if(s)a=m.getBookmark(),g.collapse(!0),g=l.expandRng(t,g,t.formatter.get(e),!0),g=f.split(g),t.formatter.remove(e,n,g),m.moveToBookmark(a);else{h=k(t.getBody(),u);var y=S(!1).dom(),b=A(v,y);h?L(t,y,h):L(t,y,u),T(p,m,h,!1),m.setCursorLocation(b,1),p.isEmpty(u)&&p.remove(u)}},isCaretNode:b,getParentCaretContainer:k,replaceWithCaretFormat:function(t,r){var o=S(!1),s=A(r,o.dom());return e.before(i.fromDom(t),o),n.remove(i.fromDom(t)),a(s,0)},isFormatElement:function(t,e){return t.schema.getTextInlineElements().hasOwnProperty(r.name(e))&&!b(e.dom())&&!s.isBogus(e.dom())}}}),o("tinymce.core.util.LazyEvaluator",["ephox.katamari.api.Option"],function(t){return{evaluateUntil:function(e,n){for(var i=0;i<e.length;i++){var r=e[i].apply(null,n);if(r.isSome())return r}return t.none()}}}),o("tinymce.core.keyboard.BoundaryLocation",["ephox.katamari.api.Adt","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretUtils","tinymce.core.fmt.CaretFormat","tinymce.core.keyboard.InlineUtils","tinymce.core.util.LazyEvaluator"],function(t,e,n,i,r,o,a,s,c){var u=t.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),l=function(t,e){var n=o.getParentBlock(e,t);return n||t},h=function(t,i,o){var a=s.normalizeForwards(o),c=l(i,a.container());return s.findRootInline(t,c,a).fold(function(){return r.nextPosition(c,a).bind(e.curry(s.findRootInline,t,c)).map(function(t){return u.before(t)})},n.none)},d=function(t,e){return null===a.getParentCaretContainer(t,e)},f=function(t,n,i){return s.findRootInline(t,n,i).filter(e.curry(d,n))},p=function(t,e,i){var o=s.normalizeBackwards(i);return f(t,e,o).bind(function(t){return r.prevPosition(t,o).isNone()?n.some(u.start(t)):n.none()})},m=function(t,e,i){var o=s.normalizeForwards(i);return f(t,e,o).bind(function(t){return r.nextPosition(t,o).isNone()?n.some(u.end(t)):n.none()})},g=function(t,i,o){var a=s.normalizeBackwards(o),c=l(i,a.container());return s.findRootInline(t,c,a).fold(function(){return r.prevPosition(c,a).bind(e.curry(s.findRootInline,t,c)).map(function(t){return u.after(t)})},n.none)},v=function(t){return!1===s.isRtl(b(t))},y=function(t,e,n){return c.evaluateUntil([h,p,m,g],[t,e,n]).filter(v)},b=function(t){return t.fold(e.identity,e.identity,e.identity,e.identity)},_=function(t){return t.fold(e.constant("before"),e.constant("start"),e.constant("end"),e.constant("after"))},x=function(t){return t.fold(u.before,u.before,u.after,u.after)},w=function(t){return t.fold(u.start,u.start,u.end,u.end)},S=function(t,e){return _(t)===_(e)&&b(t)===b(e)},k=function(t,e,n,r,o,a){return i.liftN([s.findRootInline(e,n,r),s.findRootInline(e,n,o)],function(e,i){return e!==i&&s.hasSameParentBlock(n,e,i)?u.after(t?e:i):a}).getOr(a)},E=function(t,n){return t.fold(e.constant(!0),function(t){return!S(t,n)})},T=function(t,n,i,o,a){var c=s.normalizePosition(t,a);return r.fromPosition(t,i,c).map(e.curry(s.normalizePosition,t)).fold(function(){return o.map(x)},function(r){return y(n,i,r).map(e.curry(k,t,n,i,c,r)).filter(e.curry(E,o))}).filter(v)},C=function(t,i){return t?i.fold(e.compose(n.some,u.start),n.none,e.compose(n.some,u.after),n.none):i.fold(n.none,e.compose(n.some,u.before),n.none,e.compose(n.some,u.end))},L=function(t,n,i,r){var o=s.normalizePosition(t,r),a=y(n,i,o);return y(n,i,o).bind(e.curry(C,t)).orThunk(function(){return T(t,n,i,a,r)})};return{readLocation:y,findLocation:L,prevLocation:e.curry(L,!1),nextLocation:e.curry(L,!0),getElement:b,outside:x,inside:w}}),o("ephox.katamari.api.Cell",[],function(){var t=function(e){var n=e,i=function(){return n};return{get:i,set:function(t){n=t},clone:function(){return t(i())}}};return t}),o("tinymce.core.selection.WordSelection",["ephox.katamari.api.Type","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition"],function(t,e,n){var i=function(e){return t.isFunction(e.selection.getSel().modify)},r=function(t,e,i){var r=t?1:-1;return e.setRng(n(i.container(),i.offset()+r).toRange()),e.getSel().modify("move",t?"forward":"backward","word"),!0};return{hasSelectionModifyApi:i,moveByWord:function(t,o){var a=o.selection.getRng(),s=t?n.fromRangeEnd(a):n.fromRangeStart(a);return!!i(o)&&(t&&e.isBeforeInline(s)?r(!0,o.selection,s):!(t||!e.isAfterInline(s))&&r(!1,o.selection,s))}}}),o("tinymce.core.keyboard.BoundarySelection",["ephox.katamari.api.Arr","ephox.katamari.api.Cell","ephox.katamari.api.Fun","tinymce.core.caret.CaretContainerRemove","tinymce.core.caret.CaretPosition","tinymce.core.keyboard.BoundaryCaret","tinymce.core.keyboard.BoundaryLocation","tinymce.core.keyboard.InlineUtils","tinymce.core.selection.WordSelection"],function(t,e,n,i,r,o,a,s,c){var u=function(t,e){var n=t.dom.createRng();n.setStart(e.container(),e.offset()),n.setEnd(e.container(),e.offset()),t.selection.setRng(n)},l=function(t){return!1!==t.settings.inline_boundaries},h=function(t,e){t?e.setAttribute("data-mce-selected","inline-boundary"):e.removeAttribute("data-mce-selected")},d=function(t,e,n){return o.renderCaret(e,n).map(function(e){return u(t,e),n})},f=function(t,e,i){var o=t.getBody(),c=r.fromRangeStart(t.selection.getRng()),u=n.curry(s.isInlineTarget,t);return a.findLocation(i,u,o,c).bind(function(n){return d(t,e,n)})},p=function(e,i,r){var o=t.filter(i.select('*[data-mce-selected="inline-boundary"]'),e),a=t.filter(r,e);t.each(t.difference(o,a),n.curry(h,!1)),t.each(t.difference(a,o),n.curry(h,!0))},m=function(t,e){if(t.selection.isCollapsed()&&!0!==t.composing&&e.get()){var n=r.fromRangeStart(t.selection.getRng());r.isTextPosition(n)&&!1===s.isAtZwsp(n)&&(u(t,i.removeAndReposition(e.get(),n)),e.set(null))}},g=function(e,n,i,o){if(n.selection.isCollapsed()){var s=t.filter(o,e);t.each(s,function(){var t=r.fromRangeStart(n.selection.getRng());a.readLocation(e,n.getBody(),t).bind(function(t){return d(n,i,t)})})}},v=function(t,e){return function(){return!!l(e)&&c.moveByWord(t,e)}},y=function(t){var i=new e(null),r=n.curry(s.isInlineTarget,t);return t.on("NodeChange",function(e){l(t)&&(p(r,t.dom,e.parents),m(t,i),g(r,t,i,e.parents))}),i};return{move:function(t,e,n){return function(){return!!l(t)&&f(t,e,n).isSome()}},moveNextWord:n.curry(v,!0),movePrevWord:n.curry(v,!1),setupSelectedState:y,setCaretPosition:u}}),o("tinymce.core.delete.InlineBoundaryDelete",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.node.Element","global!document","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.delete.DeleteElement","tinymce.core.keyboard.BoundaryCaret","tinymce.core.keyboard.BoundaryLocation","tinymce.core.keyboard.BoundarySelection","tinymce.core.keyboard.InlineUtils"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f){var p=function(t){return!1!==t.settings.inline_boundaries},m=function(t,e){var n=r.createRange();return n.setStart(t.container(),t.offset()),
n.setEnd(e.container(),e.offset()),n},g=function(t){return n.liftN([a.firstPositionIn(t),a.lastPositionIn(t)],function(e,n){var i=f.normalizePosition(!0,e),r=f.normalizePosition(!1,n);return a.nextPosition(t,i).map(function(t){return t.isEqual(r)}).getOr(!0)}).getOr(!0)},v=function(t,e){return function(n){return l.renderCaret(e,n).map(function(e){return d.setCaretPosition(t,e),!0}).getOr(!1)}},y=function(e,n,i,r){var o=e.getBody(),a=t.curry(f.isInlineTarget,e);e.undoManager.ignore(function(){e.selection.setRng(m(i,r)),e.execCommand("Delete"),h.readLocation(a,o,s.fromRangeStart(e.selection.getRng())).map(h.inside).map(v(e,n))}),e.nodeChanged()},b=function(t,e){var n=c.getParentBlock(e,t);return n||t},_=function(n,r,o,s){var c=b(n.getBody(),s.container()),l=t.curry(f.isInlineTarget,n),d=h.readLocation(l,c,s);return d.bind(function(n){return o?n.fold(t.constant(e.some(h.inside(n))),e.none,t.constant(e.some(h.outside(n))),e.none):n.fold(e.none,t.constant(e.some(h.outside(n))),e.none,t.constant(e.some(h.inside(n))))}).map(v(n,r)).getOrThunk(function(){var t=a.navigate(o,c,s),e=t.bind(function(t){return h.readLocation(l,c,t)});return d.isSome()&&e.isSome()?f.findRootInline(l,c,s).map(function(t){return!!g(t)&&(u.deleteElement(n,o,i.fromDom(t)),!0)}).getOr(!1):e.bind(function(){return t.map(function(t){return o?y(n,r,s,t):y(n,r,t,s),!0})}).getOr(!1)})};return{backspaceDelete:function(t,e,n){if(t.selection.isCollapsed()&&p(t)){var i=s.fromRangeStart(t.selection.getRng());return _(t,e,n,i)}return!1}}}),o("tinymce.core.delete.TableDeleteAction",["ephox.katamari.api.Adt","ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.katamari.api.Struct","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind"],function(t,e,n,i,r,o,a,s,c,u){var l=o.immutable("start","end"),h=o.immutable("rng","table","cells"),d=t.generate([{removeTable:["element"]},{emptyCells:["cells"]}]),f=function(t,e){return u.closest(s.fromDom(t),"td,th",e)},p=function(t,e){return u.ancestor(t,"table",e)},m=function(t){return!1===a.eq(t.start(),t.end())},g=function(t,e){return p(t.start(),e).bind(function(n){return p(t.end(),e).bind(function(t){return a.eq(n,t)?i.some(n):i.none()})})},v=function(t,e){return r.liftN([f(t.startContainer,e),f(t.endContainer,e)],l).filter(m)},y=function(t,e){return g(t,e).bind(function(e){var n=c.descendants(e,"td,th");return h(t,e,n)})},b=function(t,e){var i=n.curry(a.eq,t);return v(e,i).map(function(t){return y(t,i)})},_=function(t,n){return e.findIndex(t,function(t){return a.eq(t,n)})},x=function(t){return r.liftN([_(t.cells(),t.rng().start()),_(t.cells(),t.rng().end())],function(e,n){return t.cells().slice(e,n+1)})},w=function(t){return x(t).bind(function(e){var n=t.cells();return e.length===n.length?d.removeTable(t.table()):d.emptyCells(e)})};return{getActionFromRange:function(t,e){return b(t,e).map(w)},getActionFromCells:function(t){return d.emptyCells(t)}}}),o("tinymce.core.selection.MultiRange",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","tinymce.core.selection.RangeNodes"],function(t,e,n){var i=function(t){for(var e=[],n=0;n<t.rangeCount;n++)e.push(t.getRangeAt(n));return e};return{getRanges:i,getSelectedNodes:function(i){return t.bind(i,function(t){var i=n.getSelectedNode(t);return i?[e.fromDom(i)]:[]})},hasMultipleRanges:function(t){return i(t).length>1}}}),o("tinymce.core.selection.TableCellSelection",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorFilter","tinymce.core.dom.ElementType","tinymce.core.selection.MultiRange"],function(t,e,n,i,r){var o=function(e){return t.filter(r.getSelectedNodes(e),i.isTableCell)},a=function(t){return n.descendants(t,"td[data-mce-selected],th[data-mce-selected]")},s=function(t,e){var n=a(e),i=o(t);return n.length>0?n:i};return{getCellsFromRanges:o,getCellsFromElement:a,getCellsFromElementOrRanges:s,getCellsFromEditor:function(t){return s(r.getRanges(t.selection.getSel()),e.fromDom(t.getBody()))}}}),o("tinymce.core.delete.TableDelete",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.delete.DeleteElement","tinymce.core.delete.TableDeleteAction","tinymce.core.dom.ElementType","tinymce.core.dom.Empty","tinymce.core.dom.PaddingBr","tinymce.core.dom.Parents","tinymce.core.selection.TableCellSelection"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p){var m=function(e,n){return t.each(n,d.fillWithPaddingBr),e.selection.setCursorLocation(n[0].dom(),0),!0},g=function(t,e){return c.deleteElement(t,!1,e),!0},v=function(t,n,i){return u.getActionFromRange(n,i).map(function(n){return n.fold(e.curry(g,t),e.curry(m,t))})},y=function(t,e){return k(t,e)},b=function(t,e,n,i){return w(e,i).fold(function(){return v(t,e,n)},function(e){return y(t,e)}).getOr(!1)},_=function(t,e){var n=r.fromDom(t.getBody()),i=t.selection.getRng(),o=p.getCellsFromEditor(t);return 0!==o.length?m(t,o):b(t,n,i,e)},x=function(e,n){return t.find(f.parentsAndSelf(n,e),l.isTableCell)},w=function(e,n){return t.find(f.parentsAndSelf(n,e),function(t){return"caption"===o.name(t)})},S=function(t,e,n,o,s){return a.navigate(n,t.getBody(),s).bind(function(t){return x(e,r.fromDom(t.getNode())).map(function(t){return!1===i.eq(t,o)})})},k=function(t,e){return d.fillWithPaddingBr(e),t.selection.setCursorLocation(e.dom(),0),n.some(!0)},E=function(t,e,n,i){return a.firstPositionIn(t.dom()).bind(function(r){return a.lastPositionIn(t.dom()).map(function(t){return e?n.isEqual(r)&&i.isEqual(t):n.isEqual(t)&&i.isEqual(r)})}).getOr(!0)},T=function(t,e){return k(t,e)},C=function(t,e,n){return w(t,r.fromDom(n.getNode())).map(function(t){return!1===i.eq(t,e)})},L=function(t,e,i,r,o){return a.navigate(i,t.getBody(),o).bind(function(n){return E(r,i,o,n)?T(t,r):C(e,r,n)}).or(n.some(!0))},P=function(t,e,n,i){var r=s.fromRangeStart(t.selection.getRng());return x(n,i).bind(function(i){return h.isEmpty(i)?k(t,i):S(t,n,e,i,r)})},A=function(t,e,n,i){var r=s.fromRangeStart(t.selection.getRng());return h.isEmpty(i)?k(t,i):L(t,n,e,i,r)},N=function(t,e,n){var i=r.fromDom(t.getBody());return w(i,n).fold(function(){return P(t,e,i,n)},function(n){return A(t,e,i,n)}).getOr(!1)};return{backspaceDelete:function(t,e){var n=r.fromDom(t.selection.getStart(!0));return t.selection.isCollapsed()?N(t,e,n):_(t,n)}}}),o("tinymce.core.delete.DeleteCommands",["tinymce.core.delete.BlockBoundaryDelete","tinymce.core.delete.BlockRangeDelete","tinymce.core.delete.CefDelete","tinymce.core.delete.DeleteUtils","tinymce.core.delete.InlineBoundaryDelete","tinymce.core.delete.TableDelete"],function(t,e,n,i,r,o){var a=function(t,e){t.getDoc().execCommand(e,!1,null)};return{deleteCommand:function(s){n.backspaceDelete(s,!1)||r.backspaceDelete(s,!1)||t.backspaceDelete(s,!1)||o.backspaceDelete(s)||e.backspaceDelete(s,!1)||(a(s,"Delete"),i.paddEmptyBody(s))},forwardDeleteCommand:function(i){n.backspaceDelete(i,!0)||r.backspaceDelete(i,!0)||t.backspaceDelete(i,!0)||o.backspaceDelete(i)||e.backspaceDelete(i,!0)||a(i,"ForwardDelete")}}}),o("tinymce.core.selection.RangeCompare",[],function(){return{isEq:function(t,e){return t&&e&&t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset}}}),o("tinymce.core.selection.NormalizeRange",["ephox.katamari.api.Option","ephox.katamari.api.Struct","tinymce.core.caret.CaretContainer","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker","tinymce.core.fmt.CaretFormat","tinymce.core.selection.RangeCompare"],function(t,e,n,i,r,o,a){var s=e.immutable("container","offset"),c=function(t,e,n){for(;t&&t!==e;){if(n(t))return t;t=t.parentNode}return null},u=function(t,e,n){return null!==c(t,e,n)},l=function(t,e,n){return u(t,e,function(t){return t.nodeName===n})},h=function(t){return t&&"TABLE"===t.nodeName},d=function(t){return t&&/^(TD|TH|CAPTION)$/.test(t.nodeName)},f=function(t,e){return n.isCaretContainer(t)&&!1===u(t,e,o.isCaretNode)},p=function(t,e,n){for(var o=new r(e,t.getParent(e.parentNode,t.isBlock)||t.getRoot());e=o[n?"prev":"next"]();)if(i.isBr(e))return!0},m=function(t,e){return t.previousSibling&&t.previousSibling.nodeName===e},g=function(t,e){for(;e&&e!==t;){if(i.isContentEditableFalse(e))return!0;e=e.parentNode}return!1},v=function(e,n,o,a,c){var u,h,d,p,m=e.getRoot(),g=e.schema.getNonEmptyElements();if(d=e.getParent(c.parentNode,e.isBlock)||m,a&&i.isBr(c)&&n&&e.isEmpty(d))return t.some(s(c.parentNode,e.nodeIndex(c)));for(u=new r(c,d);p=u[a?"prev":"next"]();){if("false"===e.getContentEditableParent(p)||f(p,m))return t.none();if(i.isText(p)&&p.nodeValue.length>0)return!1===l(p,m,"A")?t.some(s(p,a?p.nodeValue.length:0)):t.none();if(e.isBlock(p)||g[p.nodeName.toLowerCase()])return t.none();h=p}return o&&h?t.some(s(h,0)):t.none()},y=function(e,o,a,c){var u,l,f,y,b,_,x,w=e.getRoot(),S=!1;if(u=c[(a?"start":"end")+"Container"],l=c[(a?"start":"end")+"Offset"],x=i.isElement(u)&&l===u.childNodes.length,b=e.schema.getNonEmptyElements(),_=a,n.isCaretContainer(u))return t.none();if(i.isElement(u)&&l>u.childNodes.length-1&&(_=!1),i.isDocument(u)&&(u=w,l=0),u===w){if(_&&(y=u.childNodes[l>0?l-1:0])){if(n.isCaretContainer(y))return t.none();if(b[y.nodeName]||h(y))return t.none()}if(u.hasChildNodes()){if(l=Math.min(!_&&l>0?l-1:l,u.childNodes.length-1),u=u.childNodes[l],l=i.isText(u)&&x?u.data.length:0,!o&&u===w.lastChild&&h(u))return t.none();if(g(w,u)||n.isCaretContainer(u))return t.none();if(u.hasChildNodes()&&!1===h(u)){y=u,f=new r(u,w);do{if(i.isContentEditableFalse(y)||n.isCaretContainer(y)){S=!1;break}if(i.isText(y)&&y.nodeValue.length>0){l=_?0:y.nodeValue.length,u=y,S=!0;break}if(b[y.nodeName.toLowerCase()]&&!d(y)){l=e.nodeIndex(y),u=y.parentNode,"IMG"!==y.nodeName&&"PRE"!==y.nodeName||_||l++,S=!0;break}}while(y=_?f.next():f.prev())}}}return o&&(i.isText(u)&&0===l&&v(e,x,o,!0,u).each(function(t){u=t.container(),l=t.offset(),S=!0}),i.isElement(u)&&((y=u.childNodes[l])||(y=u.childNodes[l-1]),!y||!i.isBr(y)||m(y,"A")||p(e,y,!1)||p(e,y,!0)||v(e,x,o,!0,y).each(function(t){u=t.container(),l=t.offset(),S=!0}))),_&&!o&&i.isText(u)&&l===u.nodeValue.length&&v(e,x,o,!1,u).each(function(t){u=t.container(),l=t.offset(),S=!0}),S?t.some(s(u,l)):t.none()};return{normalize:function(e,n){var i=n.collapsed,r=n.cloneRange();return y(e,i,!0,r).each(function(t){r.setStart(t.container(),t.offset())}),i||y(e,i,!1,r).each(function(t){r.setEnd(t.container(),t.offset())}),i&&r.collapse(!0),a.isEq(n,r)?t.none():t.some(r)}}}),o("tinymce.core.newline.InsertBr",["ephox.katamari.api.Fun","ephox.sugar.api.dom.Insert","ephox.sugar.api.node.Element","tinymce.core.caret.CaretFinder","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker","tinymce.core.keyboard.BoundaryLocation","tinymce.core.keyboard.InlineUtils","tinymce.core.selection.NormalizeRange"],function(t,e,n,i,r,o,a,s,c,u){var l=function(t,e,n){for(var i,r=new a(e,n),o=t.getNonEmptyElements();i=r.next();)if(o[i.nodeName.toLowerCase()]||i.length>0)return!0},h=function(t,e,n){var i=t.create("span",{},"&nbsp;");n.parentNode.insertBefore(i,n),e.scrollIntoView(i),t.remove(i)},d=function(t,e,n,i){var r=t.createRng();i?(r.setStartBefore(n),r.setEndBefore(n)):(r.setStartAfter(n),r.setEndAfter(n)),e.setRng(r)},f=function(t,e){var n,i,r=t.selection,o=t.dom,a=r.getRng(!0);u.normalize(o,a).each(function(t){a.setStart(t.startContainer,t.startOffset),a.setEnd(t.endContainer,t.endOffset)});var s=a.startOffset,c=a.startContainer;if(1===c.nodeType&&c.hasChildNodes()){var f=s>c.childNodes.length-1;c=c.childNodes[Math.min(s,c.childNodes.length-1)]||c,s=f&&3===c.nodeType?c.nodeValue.length:0}var p=o.getParent(c,o.isBlock),m=p?o.getParent(p.parentNode,o.isBlock):null,g=m?m.nodeName.toUpperCase():"",v=e&&e.ctrlKey;"LI"!==g||v||(p=m),c&&3===c.nodeType&&s>=c.nodeValue.length&&(l(t.schema,c,p)||(n=o.create("br"),a.insertNode(n),a.setStartAfter(n),a.setEndAfter(n),i=!0)),n=o.create("br"),a.insertNode(n),h(o,r,n),d(o,r,n,i),t.undoManager.add()},p=function(t,i){var r=n.fromTag("br");e.before(n.fromDom(i),r),t.undoManager.add()},m=function(t,i){v(t.getBody(),i)||e.after(n.fromDom(i),n.fromTag("br"));var r=n.fromTag("br");e.after(n.fromDom(i),r),h(t.dom,t.selection,r.dom()),d(t.dom,t.selection,r.dom(),!1),t.undoManager.add()},g=function(t){return o.isBr(t.getNode())},v=function(t,e){return!!g(r.after(e))||i.nextPosition(t,r.after(e)).map(function(t){return o.isBr(t.getNode())}).getOr(!1)},y=function(t){return t&&"A"===t.nodeName&&"href"in t},b=function(e){return e.fold(t.constant(!1),y,y,t.constant(!1))},_=function(e){var n=t.curry(c.isInlineTarget,e),i=r.fromRangeStart(e.selection.getRng());return s.readLocation(n,e.getBody(),i).filter(b)},x=function(e,n){n.fold(t.noop,t.curry(p,e),t.curry(m,e),t.noop)};return{insert:function(e,n){var i=_(e);i.isSome()?i.each(t.curry(x,e)):f(e,n)}}}),o("ephox.sugar.api.selection.Situ",["ephox.katamari.api.Adt","ephox.katamari.api.Fun"],function(t,e){var n=t.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),i=function(t,e,n,i){return t.fold(e,n,i)},r=function(t){return t.fold(e.identity,e.identity,e.identity)};return{before:n.before,on:n.on,after:n.after,cata:i,getStart:r}}),o("ephox.sugar.api.selection.Selection",["ephox.katamari.api.Adt","ephox.katamari.api.Struct","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Situ"],function(t,e,n,i,r){var o=t.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),a=e.immutable("start","soffset","finish","foffset"),s=function(t){return o.exact(t.start(),t.soffset(),t.finish(),t.foffset())},c=function(t){return t.match({domRange:function(t){return n.fromDom(t.startContainer)},relative:function(t){return r.getStart(t)},exact:function(t){return t}})},u=function(t){var e=c(t);return i.defaultView(e)};return{domRange:o.domRange,relative:o.relative,exact:o.exact,exactFromRange:s,range:a,getWin:u}}),o("tinymce.core.selection.SelectionBookmark",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sand.api.PlatformDetection","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.node.Text","ephox.sugar.api.search.Traverse","ephox.sugar.api.selection.Selection","global!document"],function(t,e,n,i,r,o,a,s,c,u){var l=n.detect().browser,h=function(t,e){var n=o.isText(e)?a.get(e).length:s.children(e).length+1;return t>n?n:t<0?0:t},d=function(t){return c.range(t.start(),h(t.soffset(),t.start()),t.finish(),h(t.foffset(),t.finish()))},f=function(t,e){return i.contains(t,e)||i.eq(t,e)},p=function(t){return function(e){return f(t,e.start())&&f(t,e.finish())}},m=function(t){return!0===t.inline||l.isIE()},g=function(t){return c.range(r.fromDom(t.startContainer),t.startOffset,r.fromDom(t.endContainer),t.endOffset)},v=function(t){var n=t.getSelection();return(n&&0!==n.rangeCount?e.from(n.getRangeAt(0)):e.none()).map(g)},y=function(t){var e=s.defaultView(t);return v(e.dom()).filter(p(t))},b=function(t,n){return e.from(n).filter(p(t)).map(d)},_=function(t){var n=u.createRange();return n.setStart(t.start().dom(),t.soffset()),n.setEnd(t.finish().dom(),t.foffset()),e.some(n)},x=function(n){return(n.bookmark?n.bookmark:e.none()).bind(t.curry(b,r.fromDom(n.getBody()))).bind(_)};return{store:function(t){var n=m(t)?y(r.fromDom(t.getBody())):e.none();t.bookmark=n.isSome()?n:t.bookmark},storeNative:function(t,n){var i=r.fromDom(t.getBody()),o=(m(t)?e.from(n):e.none()).map(g).filter(p(i));t.bookmark=o.isSome()?o:t.bookmark},readRange:v,restore:function(t){x(t).each(function(e){t.selection.setRng(e)})},getRng:x,getBookmark:y,validate:b}}),o("tinymce.core.EditorCommands",["tinymce.core.Env","tinymce.core.InsertContent","tinymce.core.delete.DeleteCommands","tinymce.core.dom.NodeType","tinymce.core.newline.InsertBr","tinymce.core.selection.SelectionBookmark","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a){var s=a.each,c=a.extend,u=a.map,l=a.inArray,h=a.explode,d=!0,f=!1;return function(a){var p,m,g,v,y={state:{},exec:{},value:{}},b=a.settings;a.on("PreInit",function(){p=a.dom,m=a.selection,b=a.settings,g=a.formatter});var _=function(t){var e;if(!a.quirks.isHidden()&&!a.removed){if(t=t.toLowerCase(),e=y.state[t])return e(t);try{return a.getDoc().queryCommandState(t)}catch(n){}return!1}},x=function(t,e){e=e||"exec",s(t,function(t,n){s(n.toLowerCase().split(","),function(n){y[e][n]=t})})};c(this,{execCommand:function(t,e,n,i){var r,c,u=0;if(!a.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(t)||i&&i.skip_focus?o.restore(a):a.focus(),(i=a.fire("BeforeExecCommand",{command:t,ui:e,value:n})).isDefaultPrevented())return!1;if(c=t.toLowerCase(),r=y.exec[c])return r(c,e,n),a.fire("ExecCommand",{command:t,ui:e,value:n}),!0;if(s(a.plugins,function(i){if(i.execCommand&&i.execCommand(t,e,n))return a.fire("ExecCommand",{command:t,ui:e,value:n}),u=!0,!1}),u)return u;if(a.theme&&a.theme.execCommand&&a.theme.execCommand(t,e,n))return a.fire("ExecCommand",{command:t,ui:e,value:n}),!0;try{u=a.getDoc().execCommand(t,e,n)}catch(l){}return!!u&&(a.fire("ExecCommand",{command:t,ui:e,value:n}),!0)}},queryCommandState:_,queryCommandValue:function(t){var e;if(!a.quirks.isHidden()&&!a.removed){if(t=t.toLowerCase(),e=y.value[t])return e(t);try{return a.getDoc().queryCommandValue(t)}catch(n){}}},queryCommandSupported:function(t){if(t=t.toLowerCase(),y.exec[t])return!0;try{return a.getDoc().queryCommandSupported(t)}catch(e){}return!1},addCommands:x,addCommand:function(t,e,n){t=t.toLowerCase(),y.exec[t]=function(t,i,r,o){return e.call(n||a,i,r,o)}},addQueryStateHandler:function(t,e,n){t=t.toLowerCase(),y.state[t]=function(){return e.call(n||a)}},addQueryValueHandler:function(t,e,n){t=t.toLowerCase(),y.value[t]=function(){return e.call(n||a)}},hasCustomCommand:function(t){return t=t.toLowerCase(),!!y.exec[t]}});var w=function(t,e,n){return e===undefined&&(e=f),n===undefined&&(n=null),a.getDoc().execCommand(t,e,n)},S=function(t){return g.match(t)},k=function(t,e){g.toggle(t,e?{value:e}:undefined),a.nodeChanged()},E=function(t){v=m.getBookmark(t)},T=function(){m.moveToBookmark(v)};x({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){a.undoManager.add()},"Cut,Copy,Paste":function(e){var n,i=a.getDoc();try{w(e)}catch(o){n=d}if("paste"!==e||i.queryCommandEnabled(e)||(n=!0),n||!i.queryCommandSupported(e)){var r=a.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");t.mac&&(r=r.replace(/Ctrl\+/g,"\u2318+")),a.notificationManager.open({text:r,type:"error"})}},unlink:function(){if(m.isCollapsed()){var t=a.dom.getParent(a.selection.getStart(),"a");t&&a.dom.remove(t,!0)}else g.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(t){var e=t.substring(7);"full"==e&&(e="justify"),s("left,center,right,justify".split(","),function(t){e!=t&&g.remove("align"+t)}),"none"!=e&&k("align"+e)},"InsertUnorderedList,InsertOrderedList":function(t){var e,n;w(t),(e=p.getParent(m.getNode(),"ol,ul"))&&(n=e.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(n.nodeName)&&(E(),p.split(n,e),T()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(t){k(t)},"ForeColor,HiliteColor,FontName":function(t,e,n){k(t,n)},FontSize:function(t,e,n){var i,r;n>=1&&n<=7&&(r=h(b.font_size_style_values),n=(i=h(b.font_size_classes))?i[n-1]||n:r[n-1]||n),k(t,n)},RemoveFormat:function(t){g.remove(t)},mceBlockQuote:function(){k("blockquote")},FormatBlock:function(t,e,n){return k(n||"p")},mceCleanup:function(){var t=m.getBookmark();a.setContent(a.getContent({cleanup:d}),{cleanup:d}),m.moveToBookmark(t)},mceRemoveNode:function(t,e,n){var i=n||m.getNode();i!=a.getBody()&&(E(),a.dom.remove(i,d),T())},mceSelectNodeDepth:function(t,e,n){var i=0;p.getParent(m.getNode(),function(t){if(1==t.nodeType&&i++==n)return m.select(t),f},a.getBody())},mceSelectNode:function(t,e,n){m.select(n)},mceInsertContent:function(t,n,i){e.insertAtCaret(a,i)},mceInsertRawHTML:function(t,e,n){m.setContent("tiny_mce_marker"),a.setContent(a.getContent().replace(/tiny_mce_marker/g,function(){return n}))},mceToggleFormat:function(t,e,n){k(n)},mceSetContent:function(t,e,n){a.setContent(n)},"Indent,Outdent":function(t){var e,n,i;e=b.indentation,n=/[a-z%]+$/i.exec(e),e=parseInt(e,10),_("InsertUnorderedList")||_("InsertOrderedList")?w(t):(b.forced_root_block||p.getParent(m.getNode(),p.isBlock)||g.apply("div"),s(m.getSelectedBlocks(),function(r){if("false"!==p.getContentEditable(r)&&"LI"!==r.nodeName){var o=a.getParam("indent_use_margin",!1)?"margin":"padding";o="TABLE"===r.nodeName?"margin":o,o+="rtl"==p.getStyle(r,"direction",!0)?"Right":"Left","outdent"==t?(i=Math.max(0,parseInt(r.style[o]||0,10)-e),p.setStyle(r,o,i?i+n:"")):(i=parseInt(r.style[o]||0,10)+e+n,p.setStyle(r,o,i))}}))},mceRepaint:function(){},InsertHorizontalRule:function(){a.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){a.hasVisual=!a.hasVisual,a.addVisual()},mceReplaceContent:function(t,e,n){a.execCommand("mceInsertContent",!1,n.replace(/\{\$selection\}/g,m.getContent({format:"text"})))},mceInsertLink:function(t,e,n){var i;"string"==typeof n&&(n={href:n}),i=p.getParent(m.getNode(),"a"),n.href=n.href.replace(" ","%20"),i&&n.href||g.remove("link"),n.href&&g.apply("link",n,i)},selectAll:function(){var t=p.getParent(m.getStart(),i.isContentEditableTrue);if(t){var e=p.createRng();e.selectNodeContents(t),m.setRng(e)}},"delete":function(){n.deleteCommand(a)},forwardDelete:function(){n.forwardDeleteCommand(a)},mceNewDocument:function(){a.setContent("")},InsertLineBreak:function(t,e,n){return r.insert(a,n),!0}}),x({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(t){var e="align"+t.substring(7),n=m.isCollapsed()?[p.getParent(m.getNode(),p.isBlock)]:m.getSelectedBlocks(),i=u(n,function(t){return!!g.matchNode(t,e)});return-1!==l(i,d)},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(t){return S(t)},mceBlockQuote:function(){return S("blockquote")},Outdent:function(){var t;if(b.inline_styles){if((t=p.getParent(m.getStart(),p.isBlock))&&parseInt(t.style.paddingLeft,10)>0)return d;if((t=p.getParent(m.getEnd(),p.isBlock))&&parseInt(t.style.paddingLeft,10)>0)return d}return _("InsertUnorderedList")||_("InsertOrderedList")||!b.inline_styles&&!!p.getParent(m.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(t){var e=p.getParent(m.getNode(),"ul,ol");return e&&("insertunorderedlist"===t&&"UL"===e.tagName||"insertorderedlist"===t&&"OL"===e.tagName)}},"state"),x({"FontSize,FontName":function(t){var e,n=0;return(e=p.getParent(m.getNode(),"span"))&&(n="fontsize"==t?e.style.fontSize:e.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()),n}},"value"),x({Undo:function(){a.undoManager.undo()},Redo:function(){a.undoManager.redo()}})}}),o("tinymce.core.util.EventDispatcher",["tinymce.core.util.Tools"],function(t){var e=t.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend"," "),n=function(e){var n,i,r=this,o={},a=function(){return!1},s=function(){return!0};n=(e=e||{}).scope||r,i=e.toggleEvent||a;var c=function(t,i){var r,c,u,h;if(t=t.toLowerCase(),i=i||{},i.type=t,i.target||(i.target=n),i.preventDefault||(i.preventDefault=function(){i.isDefaultPrevented=s},i.stopPropagation=function(){i.isPropagationStopped=s},i.stopImmediatePropagation=function(){i.isImmediatePropagationStopped=s},i.isDefaultPrevented=a,i.isPropagationStopped=a,i.isImmediatePropagationStopped=a),e.beforeFire&&e.beforeFire(i),r=o[t])for(c=0,u=r.length;c<u;c++){if((h=r[c]).once&&l(t,h.func),i.isImmediatePropagationStopped())return i.stopPropagation(),i;if(!1===h.func.call(n,i))return i.preventDefault(),i}return i},u=function(e,n,s,c){var u,l,h;if(!1===n&&(n=a),n)for(n={func:n},c&&t.extend(n,c),h=(l=e.toLowerCase().split(" ")).length;h--;)e=l[h],(u=o[e])||(u=o[e]=[],i(e,!0)),s?u.unshift(n):u.push(n);return r},l=function(t,e){var n,a,s,c,u;if(t)for(n=(c=t.toLowerCase().split(" ")).length;n--;){if(t=c[n],a=o[t],!t){for(s in o)i(s,!1),delete o[s];return r}if(a){if(e)for(u=a.length;u--;)a[u].func===e&&(a=a.slice(0,u).concat(a.slice(u+1)),o[t]=a);else a.length=0;a.length||(i(t,!1),delete o[t])}}else{for(t in o)i(t,!1);o={}}return r},h=function(t,e,n){return u(t,e,n,{once:!0})},d=function(t){return t=t.toLowerCase(),!(!o[t]||0===o[t].length)};r.fire=c,r.on=u,r.off=l,r.once=h,r.has=d};return n.isNative=function(t){return!!e[t.toLowerCase()]},n}),o("tinymce.core.util.Observable",["tinymce.core.util.EventDispatcher"],function(t){var e=function(e){return e._eventDispatcher||(e._eventDispatcher=new t({scope:e,toggleEvent:function(n,i){t.isNative(n)&&e.toggleNativeEvent&&e.toggleNativeEvent(n,i)}})),e._eventDispatcher};return{fire:function(t,n,i){var r=this;if(r.removed&&"remove"!==t)return n;if(n=e(r).fire(t,n,i),!1!==i&&r.parent)for(var o=r.parent();o&&!n.isPropagationStopped();)o.fire(t,n,!1),o=o.parent();return n},on:function(t,n,i){return e(this).on(t,n,i)},off:function(t,n){return e(this).off(t,n)},once:function(t,n){return e(this).once(t,n)},hasEventListeners:function(t){return e(this).has(t)}}}),o("tinymce.core.EditorObservable",["tinymce.core.util.Observable","tinymce.core.dom.DOMUtils","tinymce.core.util.Tools"],function(t,e,n){var i,r=e.DOM,o=function(t,e){return"selectionchange"==e?t.getDoc():!t.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(e)?t.getDoc().documentElement:t.settings.event_root?(t.eventRoot||(t.eventRoot=r.select(t.settings.event_root)[0]),t.eventRoot):t.getBody()},a=function(t,e){var n,a,s=function(t){return!t.hidden&&!t.readonly};if(t.delegates||(t.delegates={}),!t.delegates[e]&&!t.removed)if(n=o(t,e),t.settings.event_root){if(i||(i={},t.editorManager.on("removeEditor",function(){var e;if(!t.editorManager.activeEditor&&i){for(e in i)t.dom.unbind(o(t,e));i=null}})),i[e])return;a=function(n){for(var i=n.target,o=t.editorManager.get(),a=o.length;a--;){var c=o[a].getBody();(c===i||r.isChildOf(i,c))&&s(o[a])&&o[a].fire(e,n)}},i[e]=a,r.bind(n,e,a)}else a=function(n){s(t)&&t.fire(e,n)},r.bind(n,e,a),t.delegates[e]=a},s={bindPendingEventDelegates:function(){var t=this;n.each(t._pendingNativeEvents,function(e){a(t,e)})},toggleNativeEvent:function(t,e){var n=this;"focus"!=t&&"blur"!=t&&(e?n.initialized?a(n,t):n._pendingNativeEvents?n._pendingNativeEvents.push(t):n._pendingNativeEvents=[t]:n.initialized&&(n.dom.unbind(o(n,t),t,n.delegates[t]),delete n.delegates[t]))},unbindAllNativeEvents:function(){var t,e=this;if(e.delegates){for(t in e.delegates)e.dom.unbind(o(e,t),t,e.delegates[t]);delete e.delegates}e.inline||(e.getBody().onload=null,e.dom.unbind(e.getWin()),e.dom.unbind(e.getDoc())),e.dom.unbind(e.getBody()),e.dom.unbind(e.getContainer())}};return s=n.extend({},t,s)}),o("tinymce.core.Mode",[],function(){var t=function(t,e,n){try{t.getDoc().execCommand(e,!1,n)}catch(i){}},e=function(t){var e,n;return e=t.getBody(),n=function(e){t.dom.getParents(e.target,"a").length>0&&e.preventDefault()},t.dom.bind(e,"click",n),{unbind:function(){t.dom.unbind(e,"click",n)}}},n=function(n,i){n._clickBlocker&&(n._clickBlocker.unbind(),n._clickBlocker=null),i?(n._clickBlocker=e(n),n.selection.controlSelection.hideResizeRect(),n.readonly=!0,n.getBody().contentEditable=!1):(n.readonly=!1,n.getBody().contentEditable=!0,t(n,"StyleWithCSS",!1),t(n,"enableInlineTableEditing",!1),t(n,"enableObjectResizing",!1),n.focus(),n.nodeChanged())};return{setMode:function(t,e){var i=t.readonly?"readonly":"design";e!=i&&(t.initialized?n(t,"readonly"==e):t.on("init",function(){n(t,"readonly"==e)}),t.fire("SwitchMode",{mode:e}))}}}),o("tinymce.core.Shortcuts",["tinymce.core.util.Tools","tinymce.core.Env"],function(t,e){var n=t.each,i=t.explode,r={f9:120,f10:121,f11:122},o=t.makeMap("alt,ctrl,shift,meta,access");return function(a){var s=this,c={},u=[],l=function(t){var a,s,c={};n(i(t,"+"),function(t){t in o?c[t]=!0:/^[0-9]{2,}$/.test(t)?c.keyCode=parseInt(t,10):(c.charCode=t.charCodeAt(0),c.keyCode=r[t]||t.toUpperCase().charCodeAt(0))}),a=[c.keyCode];for(s in o)c[s]?a.push(s):c[s]=!1;return c.id=a.join(","),c.access&&(c.alt=!0,e.mac?c.ctrl=!0:c.shift=!0),c.meta&&(e.mac?c.meta=!0:(c.ctrl=!0,c.meta=!1)),c},h=function(e,n,r,o){var s;return s=t.map(i(e,">"),l),s[s.length-1]=t.extend(s[s.length-1],{func:r,scope:o||a}),t.extend(s[0],{desc:a.translate(n),subpatterns:s.slice(1)})},d=function(t){return t.altKey||t.ctrlKey||t.metaKey},f=function(t){return"keydown"===t.type&&t.keyCode>=112&&t.keyCode<=123},p=function(t,e){return!!e&&(e.ctrl==t.ctrlKey&&e.meta==t.metaKey&&(e.alt==t.altKey&&e.shift==t.shiftKey&&(!!(t.keyCode==e.keyCode||t.charCode&&t.charCode==e.charCode)&&(t.preventDefault(),!0))))},m=function(t){return t.func?t.func.call(t.scope):null};a.on("keyup keypress keydown",function(t){!d(t)&&!f(t)||t.isDefaultPrevented()||(n(c,function(e){if(p(t,e))return u=e.subpatterns.slice(0),"keydown"==t.type&&m(e),!0}),p(t,u[0])&&(1===u.length&&"keydown"==t.type&&m(u[0]),u.shift()))}),s.add=function(e,r,o,s){var u;return u=o,"string"==typeof o?o=function(){a.execCommand(u,!1,null)}:t.isArray(u)&&(o=function(){a.execCommand(u[0],u[1],u[2])}),n(i(t.trim(e.toLowerCase())),function(t){var e=h(t,r,o,s);c[e.id]=e}),!0},s.remove=function(t){var e=h(t);return!!c[e.id]&&(delete c[e.id],!0)}}}),o("tinymce.core.html.SaxParser",["tinymce.core.html.Schema","tinymce.core.html.Entities","tinymce.core.util.Tools"],function(t,e,n){var i=n.each,r=function(t){return 0===t.indexOf("data-")||0===t.indexOf("aria-")},o=function(t){return t.replace(/<!--|-->/g,"")},a=function(t,e,n){var i,r,o,a,s=1;for(a=t.getShortEndedElements(),(o=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g).lastIndex=i=n;r=o.exec(e);){if(i=o.lastIndex,"/"===r[1])s--;else if(!r[1]){if(r[2]in a)continue;s++}if(0===s)break}return i},s=function(s,c){var u=this,l=function(){};s=s||{},u.schema=c=c||new t,!1!==s.fix_self_closing&&(s.fix_self_closing=!0),i("comment cdata text start end pi doctype".split(" "),function(t){t&&(u[t]=s[t]||l)}),u.parse=function(t){var i,u,l,h,d,f,p,m,g,v,y,b,_,x,w,S,k,E,T,C,L,P,A,N,R,I,D,O,B,M=this,F=0,z=[],j=0,H=e.decode,$=n.makeMap("src,href,data,background,formaction,poster"),U=/((java|vb)script|mhtml):/i,q=/^data:/i,W=function(t){var e,n;for(e=z.length;e--&&z[e].name!==t;);if(e>=0){for(n=z.length-1;n>=e;n--)(t=z[n]).valid&&M.end(t.name);z.length=e}},V=function(t,e,n,i,o){var a,c,u=/[\s\u0000-\u001F]+/g;if(e=e.toLowerCase(),n=e in y?e:H(n||i||o||""),_&&!m&&!1===r(e)){if(!(a=E[e])&&T){for(c=T.length;c--&&!(a=T[c]).pattern.test(e););-1===c&&(a=null)}if(!a)return;if(a.validValues&&!(n in a.validValues))return}if($[e]&&!s.allow_script_urls){var l=n.replace(u,"");try{l=decodeURIComponent(l)}catch(d){l=unescape(l)}if(U.test(l))return;if(!s.allow_html_data_urls&&q.test(l)&&!/^data:image\//i.test(l))return}m&&(e in $||0===e.indexOf("on"))||(h.map[e]=n,h.push({name:e,value:n}))};for(R=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),I=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,v=c.getShortEndedElements(),N=s.self_closing_elements||c.getSelfClosingElements(),y=c.getBoolAttrs(),_=s.validate,g=s.remove_internals,B=s.fix_self_closing,D=c.getSpecialElements(),A=t+">";i=R.exec(A);){if(F<i.index&&M.text(H(t.substr(F,i.index-F))),u=i[6])":"===(u=u.toLowerCase()).charAt(0)&&(u=u.substr(1)),W(u);else if(u=i[7]){if(i.index+i[0].length>t.length){M.text(H(t.substr(i.index))),F=i.index+i[0].length;continue}if(":"===(u=u.toLowerCase()).charAt(0)&&(u=u.substr(1)),b=u in v,B&&N[u]&&z.length>0&&z[z.length-1].name===u&&W(u),!_||(x=c.getElementRule(u))){if(w=!0,_&&(E=x.attributes,T=x.attributePatterns),(k=i[8])?((m=-1!==k.indexOf("data-mce-type"))&&g&&(w=!1),(h=[]).map={},k.replace(I,V)):(h=[]).map={},_&&!m){if(C=x.attributesRequired,L=x.attributesDefault,P=x.attributesForced,x.removeEmptyAttrs&&!h.length&&(w=!1),P)for(d=P.length;d--;)p=(S=P[d]).name,
"{$uid}"===(O=S.value)&&(O="mce_"+j++),h.map[p]=O,h.push({name:p,value:O});if(L)for(d=L.length;d--;)(p=(S=L[d]).name)in h.map||("{$uid}"===(O=S.value)&&(O="mce_"+j++),h.map[p]=O,h.push({name:p,value:O}));if(C){for(d=C.length;d--&&!(C[d]in h.map););-1===d&&(w=!1)}if(S=h.map["data-mce-bogus"]){if("all"===S){F=a(c,t,R.lastIndex),R.lastIndex=F;continue}w=!1}}w&&M.start(u,h,b)}else w=!1;if(l=D[u]){l.lastIndex=F=i.index+i[0].length,(i=l.exec(t))?(w&&(f=t.substr(F,i.index-F)),F=i.index+i[0].length):(f=t.substr(F),F=t.length),w&&(f.length>0&&M.text(f,!0),M.end(u)),R.lastIndex=F;continue}b||(k&&k.indexOf("/")==k.length-1?w&&M.end(u):z.push({name:u,valid:w}))}else(u=i[1])?(">"===u.charAt(0)&&(u=" "+u),s.allow_conditional_comments||"[if"!==u.substr(0,3).toLowerCase()||(u=" "+u),M.comment(u)):(u=i[2])?M.cdata(o(u)):(u=i[3])?M.doctype(u):(u=i[4])&&M.pi(u,i[5]);F=i.index+i[0].length}for(F<t.length&&M.text(H(t.substr(F))),d=z.length-1;d>=0;d--)(u=z[d]).valid&&M.end(u.name)}};return s.findEndTag=a,s}),o("tinymce.core.dom.TrimHtml",["tinymce.core.html.SaxParser","tinymce.core.text.Zwsp"],function(t,e){var n=function(t,e){var n=new RegExp(["\\s?("+t.join("|")+')="[^"]+"'].join("|"),"gi");return e.replace(n,"")},i=function(e,i){var r,o,a,s,c,u=i,l=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,h=e.schema;for(u=n(e.getTempAttrs(),u),c=h.getShortEndedElements();s=l.exec(u);)o=l.lastIndex,a=s[0].length,r=c[s[1]]?o:t.findEndTag(h,u,o),u=u.substring(0,o-a)+u.substring(r),l.lastIndex=o-a;return u};return{trimExternal:function(t,n){return e.trim(i(t,n))},trimInternal:i}}),o("ephox.sugar.api.search.PredicateExists",["ephox.sugar.api.search.PredicateFind"],function(t){return{any:function(e){return t.first(e).isSome()},ancestor:function(e,n,i){return t.ancestor(e,n,i).isSome()},closest:function(e,n,i){return t.closest(e,n,i).isSome()},sibling:function(e,n){return t.sibling(e,n).isSome()},child:function(e,n){return t.child(e,n).isSome()},descendant:function(e,n){return t.descendant(e,n).isSome()}}}),o("ephox.sugar.api.dom.Focus",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.search.PredicateExists","ephox.sugar.api.search.Traverse","global!document"],function(t,e,n,i,r,o,a){var s=function(t){t.dom().focus()},c=function(t){var n=t!==undefined?t.dom():a;return e.from(n.activeElement).map(i.fromDom)};return{hasFocus:function(t){var e=o.owner(t).dom();return t.dom()===e.activeElement},focus:s,blur:function(t){t.dom().blur()},active:c,search:function(t){return c(o.owner(t)).filter(function(e){return t.dom().contains(e.dom())})},focusInside:function(e){var i=o.owner(e);c(i).filter(function(i){return r.closest(i,t.curry(n.eq,e))}).fold(function(){s(e)},t.noop)}}}),o("tinymce.core.focus.EditorFocus",["ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Focus","ephox.sugar.api.node.Element","tinymce.core.Env","tinymce.core.caret.CaretFinder","tinymce.core.dom.ElementType","tinymce.core.selection.RangeNodes","tinymce.core.selection.SelectionBookmark"],function(t,e,n,i,r,o,a,s,c){var u=function(t,e){return t.dom.getParent(e,function(e){return"true"===t.dom.getContentEditable(e)})},l=function(e){return e.collapsed?t.from(s.getNode(e.startContainer,e.startOffset)).map(i.fromDom):t.none()},h=function(n,i){return l(i).bind(function(i){return a.isTableSection(i)?t.some(i):!1===e.contains(n,i)?t.some(n):t.none()})},d=function(t,e){h(i.fromDom(t.getBody()),e).bind(function(t){return o.firstPositionIn(t.dom())}).fold(function(){t.selection.normalize()},function(e){t.selection.setRng(e.toRange())})},f=function(t){if(t.setActive)try{t.setActive()}catch(e){t.focus()}else t.focus()},p=function(t){return n.hasFocus(t)||n.search(t).isSome()},m=function(t){return t.iframeElement&&n.hasFocus(i.fromDom(t.iframeElement))},g=function(t){var e=t.getBody();return e&&p(i.fromDom(e))},v=function(t){return t.inline?g(t):m(t)},y=function(t){var e,n=t.selection,i=t.settings.content_editable,o=t.getBody(),a=n.getRng();if(t.quirks.refreshContentEditable(),e=u(t,n.getNode()),t.$.contains(o,e))return f(e),d(t,a),void b(t);t.bookmark!==undefined&&!1===v(t)&&c.getRng(t).each(function(e){t.selection.setRng(e),a=e}),i||(r.opera||f(o),t.getWin().focus()),(r.gecko||i)&&(f(o),d(t,a)),b(t)},b=function(t){t.editorManager.setActive(t)};return{focus:function(t,e){t.removed||(e?b(t):y(t))},hasFocus:v}}),o("tinymce.core.EditorView",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Css","ephox.sugar.api.search.Traverse"],function(t,e,n,i,r,o){var a=function(t,e){return e.dom()[t]},s=function(t,e){return parseInt(r.get(e,t),10)},c=t.curry(a,"clientWidth"),u=t.curry(a,"clientHeight"),l=t.curry(s,"margin-top"),h=t.curry(s,"margin-left"),d=function(t){return t.dom().getBoundingClientRect()},f=function(t,e,n){var i=c(t),r=u(t);return e>=0&&n>=0&&e<=i&&n<=r},p=function(t,e,n,i){var r=d(e);return{x:n-(t?r.left+e.dom().clientLeft+h(e):0),y:i-(t?r.top+e.dom().clientTop+l(e):0)}},m=function(t){return e.from(t).map(i.fromDom)};return{isXYInContentArea:function(t,e,n){var r=i.fromDom(t.getBody()),a=t.inline?r:o.documentElement(r),s=p(t.inline,a,e,n);return f(a,s.x,s.y)},isEditorAttachedToDom:function(t){var e=t.inline?t.getBody():t.getContentAreaContainer();return m(e).map(function(t){return n.contains(o.owner(t),t)}).getOr(!1)}}}),o("tinymce.core.ui.NotificationManagerImpl",[],function(){return function(){var t=function(){throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:t,close:t,reposition:t,getArgs:t}}}),o("tinymce.core.api.NotificationManager",["ephox.katamari.api.Arr","ephox.katamari.api.Option","tinymce.core.EditorView","tinymce.core.ui.NotificationManagerImpl","tinymce.core.util.Delay"],function(t,e,n,i,r){return function(o){var a=[],s=function(){var t=o.theme;return t&&t.getNotificationManagerImpl?t.getNotificationManagerImpl():i()},c=function(){return e.from(a[0])},u=function(t,e){return!(t.type!==e.type||t.text!==e.text||t.progressBar||t.timeout||e.progressBar||e.timeout)},l=function(){a.length>0&&s().reposition(a)},h=function(t){a.push(t)},d=function(e){t.findIndex(a,function(t){return t===e}).each(function(t){a.splice(t,1)})},f=function(e){if(!o.removed&&n.isEditorAttachedToDom(o))return t.find(a,function(t){return u(s().getArgs(t),e)}).getOrThunk(function(){o.editorManager.setActive(o);var t=s().open(e,function(){d(t),l()});return h(t),l(),t})},p=function(){c().each(function(t){s().close(t),d(t),l()})},m=function(){return a};return function(e){e.on("SkinLoaded",function(){var t=e.settings.service_message;t&&f({text:t,type:"warning",timeout:0,icon:""})}),e.on("ResizeEditor ResizeWindow",function(){r.requestAnimationFrame(l)}),e.on("remove",function(){t.each(a,function(t){s().close(t)})})}(o),{open:f,close:p,getNotifications:m}}}),o("tinymce.core.ui.WindowManagerImpl",[],function(){return function(){var t=function(){throw new Error("Theme did not provide a WindowManager implementation.")};return{open:t,alert:t,confirm:t,close:t,getParams:t,setParams:t}}}),o("tinymce.core.api.WindowManager",["ephox.katamari.api.Arr","ephox.katamari.api.Option","tinymce.core.selection.SelectionBookmark","tinymce.core.ui.WindowManagerImpl"],function(t,e,n,i){return function(r){var o=[],a=function(){var t=r.theme;return t&&t.getWindowManagerImpl?t.getWindowManagerImpl():i()},s=function(t,e){return function(){return e?e.apply(t,arguments):undefined}},c=function(t){r.fire("OpenWindow",{win:t})},u=function(t){r.fire("CloseWindow",{win:t})},l=function(t){o.push(t),c(t)},h=function(e){t.findIndex(o,function(t){return t===e}).each(function(t){o.splice(t,1),u(e),0===o.length&&r.focus()})},d=function(){return e.from(o[o.length-1])},f=function(t,e){r.editorManager.setActive(r),n.store(r);var i=a().open(t,e,h);return l(i),i},p=function(t,e,n){var i=a().alert(t,s(n||this,e),h);l(i)},m=function(t,e,n){var i=a().confirm(t,s(n||this,e),h);l(i)},g=function(){d().each(function(t){a().close(t),h(t)})},v=function(){return d().map(a().getParams).getOr(null)},y=function(t){d().each(function(e){a().setParams(e,t)})},b=function(){return o};return r.on("remove",function(){t.each(o.slice(0),function(t){a().close(t)})}),{windows:o,open:f,alert:p,confirm:m,close:g,getParams:v,setParams:y,getWindows:b}}}),o("tinymce.core.ErrorReporter",["global!window","tinymce.core.AddOnManager"],function(t,e){var n=e.PluginManager,i=function(t,e){for(var i in n.urls){if(n.urls[i]+"/plugin"+e+".js"===t)return i}return null},r=function(t,e){var n=i(e,t.suffix);return n?"Failed to load plugin: "+n+" from url "+e:"Failed to load plugin url: "+e},o=function(t,e){t.notificationManager.open({type:"error",text:e})},a=function(t,e){t._skinLoaded?o(t,e):t.on("SkinLoaded",function(){o(t,e)})};return{pluginLoadError:function(t,e){a(t,r(t,e))},uploadError:function(t,e){a(t,"Failed to upload image: "+e)},displayError:a,initError:function(){var e=t.console;e&&!t.test&&(e.error?e.error.apply(e,arguments):e.log.apply(e,arguments))}}}),o("tinymce.core.PluginManager",["tinymce.core.AddOnManager"],function(t){return t.PluginManager}),o("tinymce.core.ThemeManager",["tinymce.core.AddOnManager"],function(t){return t.ThemeManager}),o("ephox.sand.api.XMLHttpRequest",["ephox.sand.util.Global"],function(t){return function(){return new(t.getOrDie("XMLHttpRequest"))}}),o("tinymce.core.file.Uploader",["ephox.sand.api.XMLHttpRequest","global!window","tinymce.core.util.Fun","tinymce.core.util.Promise","tinymce.core.util.Tools"],function(t,e,n,i,r){return function(n,o){var a={},s=function(t,e){return t?t.replace(/\/$/,"")+"/"+e.replace(/^\//,""):e},c=function(n,i,r,a){var c,u;(c=new t).open("POST",o.url),c.withCredentials=o.credentials,c.upload.onprogress=function(t){a(t.loaded/t.total*100)},c.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+c.status)},c.onload=function(){var t;c.status<200||c.status>=300?r("HTTP Error: "+c.status):(t=JSON.parse(c.responseText))&&"string"==typeof t.location?i(s(o.basePath,t.location)):r("Invalid JSON: "+c.responseText)},(u=new e.FormData).append("file",n.blob(),n.filename()),c.send(u)},u=function(){return new i(function(t){t([])})},l=function(t,e){return{url:e,blobInfo:t,status:!0}},h=function(t,e){return{url:"",blobInfo:t,status:!1,error:e}},d=function(t,e){r.each(a[t],function(t){t(e)}),delete a[t]},f=function(t,e,r){return n.markPending(t.blobUri()),new i(function(i){var o,a,s=function(){};try{var c=function(){o&&(o.close(),a=s)};e(t,function(e){c(),n.markUploaded(t.blobUri(),e),d(t.blobUri(),l(t,e)),i(l(t,e))},function(e){c(),n.removeFailed(t.blobUri()),d(t.blobUri(),h(t,e)),i(h(t,e))},a=function(t){t<0||t>100||(o||(o=r()),o.progressBar.value(t))})}catch(u){i(h(t,u.message))}})},p=function(t){return t===c},m=function(t){var e=t.blobUri();return new i(function(t){a[e]=a[e]||[],a[e].push(t)})},g=function(t,e){return t=r.grep(t,function(t){return!n.isUploaded(t.blobUri())}),i.all(r.map(t,function(t){return n.isPending(t.blobUri())?m(t):f(t,o.handler,e)}))},v=function(t,e){return!o.url&&p(o.handler)?u():g(t,e)};return o=r.extend({credentials:!1,handler:c},o),{upload:v}}}),o("ephox.sand.api.Blob",["ephox.sand.util.Global"],function(t){return function(e,n){return new(t.getOrDie("Blob"))(e,n)}}),o("ephox.sand.api.FileReader",["ephox.sand.util.Global"],function(t){return function(){return new(t.getOrDie("FileReader"))}}),o("ephox.sand.api.Uint8Array",["ephox.sand.util.Global"],function(t){return function(e){return new(t.getOrDie("Uint8Array"))(e)}}),o("ephox.sand.api.Window",["ephox.sand.util.Global"],function(t){return{atob:function(e){return t.getOrDie("atob")(e)},requestAnimationFrame:function(e){t.getOrDie("requestAnimationFrame")(e)}}}),o("tinymce.core.file.Conversions",["ephox.sand.api.Blob","ephox.sand.api.FileReader","ephox.sand.api.Uint8Array","ephox.sand.api.Window","ephox.sand.api.XMLHttpRequest","tinymce.core.util.Promise"],function(t,e,n,i,r,o){var a=function(t){return new o(function(e,n){var i=function(){n("Cannot convert "+t+" to Blob. Resource might not exist or is inaccessible.")};try{var o=new r;o.open("GET",t,!0),o.responseType="blob",o.onload=function(){200==this.status?e(this.response):i()},o.onerror=i,o.send()}catch(a){i()}})},s=function(t){var e,n;return t=decodeURIComponent(t).split(","),(n=/data:([^;]+)/.exec(t[0]))&&(e=n[1]),{type:e,data:t[1]}},c=function(e){return new o(function(r){var o,a,c;e=s(e);try{o=i.atob(e.data)}catch(u){return void r(new t([]))}for(a=new n(o.length),c=0;c<a.length;c++)a[c]=o.charCodeAt(c);r(new t([a],{type:e.type}))})};return{uriToBlob:function(t){return 0===t.indexOf("blob:")?a(t):0===t.indexOf("data:")?c(t):null},blobToDataUri:function(t){return new o(function(n){var i=new e;i.onloadend=function(){n(i.result)},i.readAsDataURL(t)})},parseDataUri:s}}),o("tinymce.core.file.ImageScanner",["tinymce.core.util.Promise","tinymce.core.util.Arr","tinymce.core.util.Fun","tinymce.core.file.Conversions","tinymce.core.Env"],function(t,e,n,i,r){var o=0,a=function(t){return(t||"blobid")+o++},s=function(t,e,n,r){var o,s;0!==e.src.indexOf("blob:")?(o=i.parseDataUri(e.src).data,(s=t.findFirst(function(t){return t.base64()===o}))?n({image:e,blobInfo:s}):i.uriToBlob(e.src).then(function(i){s=t.create(a(),i,o),t.add(s),n({image:e,blobInfo:s})},function(t){r(t)})):(s=t.getByUri(e.src))?n({image:e,blobInfo:s}):i.uriToBlob(e.src).then(function(r){i.blobToDataUri(r).then(function(c){o=i.parseDataUri(c).data,s=t.create(a(),r,o),t.add(s),n({image:e,blobInfo:s})})},function(t){r(t)})},c=function(t){return t?t.getElementsByTagName("img"):[]};return function(i,o){var a={};return{findAll:function(u,l){var h,d;return l||(l=n.constant(!0)),h=e.filter(c(u),function(t){var e=t.src;return!!r.fileApi&&(!t.hasAttribute("data-mce-bogus")&&(!t.hasAttribute("data-mce-placeholder")&&(!(!e||e==r.transparentSrc)&&(0===e.indexOf("blob:")?!i.isUploaded(e):0===e.indexOf("data:")&&l(t)))))}),d=e.map(h,function(e){var n;return a[e.src]?new t(function(t){a[e.src].then(function(n){if("string"==typeof n)return n;t({image:e,blobInfo:n.blobInfo})})}):(n=new t(function(t,n){s(o,e,t,n)}).then(function(t){return delete a[t.image.src],t})["catch"](function(t){return delete a[e.src],t}),a[e.src]=n,n)}),t.all(d)}}}}),o("tinymce.core.util.Uuid",[],function(){var t=0,e=function(){var t=function(){return Math.round(4294967295*Math.random()).toString(36)};return"s"+(new Date).getTime().toString(36)+t()+t()+t()};return{uuid:function(n){return n+t+++e()}}}),o("tinymce.core.file.BlobCache",["ephox.sand.api.URL","tinymce.core.util.Arr","tinymce.core.util.Fun","tinymce.core.util.Uuid"],function(t,e,n,i){return function(){var r=[],o=n.constant,a=function(t){return{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"}[t.toLowerCase()]||"dat"},s=function(t,e,n,i){return c("object"==typeof t?t:{id:t,name:i,blob:e,base64:n})},c=function(e){var n,r;if(!e.blob||!e.base64)throw"blob and base64 representations of the image are required for BlobInfo to be created";return n=e.id||i.uuid("blobid"),r=e.name||n,{id:o(n),name:o(r),filename:o(r+"."+a(e.blob.type)),blob:o(e.blob),base64:o(e.base64),blobUri:o(e.blobUri||t.createObjectURL(e.blob)),uri:o(e.uri)}},u=function(t){l(t.id())||r.push(t)},l=function(t){return h(function(e){return e.id()===t})},h=function(t){return e.filter(r,t)[0]};return{create:s,add:u,get:l,getByUri:function(t){return h(function(e){return e.blobUri()==t})},findFirst:h,removeByUri:function(n){r=e.filter(r,function(e){return e.blobUri()!==n||(t.revokeObjectURL(e.blobUri()),!1)})},destroy:function(){e.each(r,function(e){t.revokeObjectURL(e.blobUri())}),r=[]}}}}),o("tinymce.core.file.UploadStatus",[],function(){return function(){var t=1,e=2,n={},i=function(t,e){return{status:t,resultUri:e}},r=function(t){return t in n};return{hasBlobUri:r,getResultUri:function(t){var e=n[t];return e?e.resultUri:null},isPending:function(e){return!!r(e)&&n[e].status===t},isUploaded:function(t){return!!r(t)&&n[t].status===e},markPending:function(e){n[e]=i(t,null)},markUploaded:function(t,r){n[t]=i(e,r)},removeFailed:function(t){delete n[t]},destroy:function(){n={}}}}}),o("tinymce.core.EditorUpload",["tinymce.core.util.Arr","tinymce.core.file.Uploader","tinymce.core.file.ImageScanner","tinymce.core.file.BlobCache","tinymce.core.file.UploadStatus","tinymce.core.ErrorReporter"],function(t,e,n,i,r,o){return function(a){var s,c,u=new i,l=a.settings,h=new r,d=function(t){return function(e){return a.selection?t(e):[]}},f=function(){return"?"+(new Date).getTime()},p=function(t,e,n){var i=0;do{-1!==(i=t.indexOf(e,i))&&(t=t.substring(0,i)+n+t.substr(i+e.length),i+=n.length-e.length+1)}while(-1!==i);return t},m=function(t,e,n){return t=p(t,'src="'+e+'"','src="'+n+'"'),t=p(t,'data-mce-src="'+e+'"','data-mce-src="'+n+'"')},g=function(e,n){t.each(a.undoManager.data,function(i){"fragmented"===i.type?i.fragments=t.map(i.fragments,function(t){return m(t,e,n)}):i.content=m(i.content,e,n)})},v=function(){return a.notificationManager.open({text:a.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})},y=function(t,e){u.removeByUri(t.src),g(t.src,e),a.$(t).attr({src:l.images_reuse_filename?e+f():e,"data-mce-src":a.convertURL(e,"src")})},b=function(n){return s||(s=new e(h,{url:l.images_upload_url,basePath:l.images_upload_base_path,credentials:l.images_upload_credentials,handler:l.images_upload_handler})),w().then(d(function(e){var i;return i=t.map(e,function(t){return t.blobInfo}),s.upload(i,v).then(d(function(i){var r=t.map(i,function(t,n){var i=e[n].image;return t.status&&!1!==a.settings.images_replace_blob_uris?y(i,t.url):t.error&&o.uploadError(a,t.error),{element:i,status:t.status}});return n&&n(r),r}))}))},_=function(t){if(!1!==l.automatic_uploads)return b(t)},x=function(t){return!l.images_dataimg_filter||l.images_dataimg_filter(t)},w=function(){return c||(c=new n(h,u)),c.findAll(a.getBody(),x).then(d(function(e){return e=t.filter(e,function(t){return"string"!=typeof t||(o.displayError(a,t),!1)}),t.each(e,function(t){g(t.image.src,t.blobInfo.blobUri()),t.image.src=t.blobInfo.blobUri(),t.image.removeAttribute("data-mce-src")}),e}))},S=function(){u.destroy(),h.destroy(),c=s=null},k=function(e){return e.replace(/src="(blob:[^"]+)"/g,function(e,n){var i=h.getResultUri(n);if(i)return'src="'+i+'"';var r=u.getByUri(n);return r||(r=t.reduce(a.editorManager.get(),function(t,e){return t||e.editorUpload&&e.editorUpload.blobCache.getByUri(n)},null)),r?'src="data:'+r.blob().type+";base64,"+r.base64()+'"':e})};return a.on("setContent",function(){!1!==a.settings.automatic_uploads?_():w()}),a.on("RawSaveContent",function(t){t.content=k(t.content)}),a.on("getContent",function(t){t.source_view||"raw"==t.format||(t.content=k(t.content))}),a.on("PostRender",function(){a.parser.addNodeFilter("img",function(e){t.each(e,function(t){var e=t.attr("src");if(!u.getByUri(e)){var n=h.getResultUri(e);n&&t.attr("src",n)}})})}),{blobCache:u,uploadImages:b,uploadImagesAuto:_,scanForImages:w,destroy:S}}}),o("tinymce.core.ForceBlocks",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.node.Element","tinymce.core.dom.Bookmarks","tinymce.core.dom.NodeType","tinymce.core.dom.Parents","tinymce.core.focus.EditorFocus"],function(t,e,n,i,r,o,a){var s=function(t,e){return t.hasOwnProperty(e.nodeName)},c=function(t,e){return!!r.isText(e)||!!r.isElement(e)&&(!s(t,e)&&!i.isBookmarkNode(e))},u=function(e,i,r){return t.exists(o.parents(n.fromDom(r),n.fromDom(i)),function(t){return s(e,t.dom())})},l=function(t){var e,n,i,o,s,l,h,d,f,p,m,g=t.settings,v=t.dom,y=t.selection,b=t.schema,_=b.getBlockElements(),x=y.getStart(),w=t.getBody();if(m=g.forced_root_block,x&&r.isElement(x)&&m&&(p=w.nodeName.toLowerCase(),b.isValidChild(p,m.toLowerCase())&&!u(_,w,x))){for(n=(e=y.getRng()).startContainer,i=e.startOffset,o=e.endContainer,s=e.endOffset,f=a.hasFocus(t),x=w.firstChild;x;)if(c(_,x)){if(r.isText(x)&&0===x.nodeValue.length){h=x,x=x.nextSibling,v.remove(h);continue}l||(l=v.create(m,t.settings.forced_root_block_attrs),x.parentNode.insertBefore(l,x),d=!0),h=x,x=x.nextSibling,l.appendChild(h)}else l=null,x=x.nextSibling;d&&f&&(e.setStart(n,i),e.setEnd(o,s),y.setRng(e),t.nodeChanged())}};return{setup:function(t){t.settings.forced_root_block&&t.on("NodeChange",e.curry(l,t))}}}),o("tinymce.core.NodeChange",["tinymce.core.Env","tinymce.core.selection.RangeCompare","tinymce.core.util.Delay"],function(t,e,n){return function(i){var r,o=[],a=function(t){var e,n;if((n=i.$(t).parentsUntil(i.getBody()).add(t)).length===o.length){for(e=n.length;e>=0&&n[e]===o[e];e--);if(-1===e)return o=n,!0}return o=n,!1};"onselectionchange"in i.getDoc()||i.on("NodeChange Click MouseUp KeyUp Focus",function(t){var n,o;o={startContainer:(n=i.selection.getRng()).startContainer,startOffset:n.startOffset,endContainer:n.endContainer,endOffset:n.endOffset},"nodechange"!=t.type&&e.isEq(o,r)||i.fire("SelectionChange"),r=o}),i.on("contextmenu",function(){i.fire("SelectionChange")}),i.on("SelectionChange",function(){var e=i.selection.getStart(!0);!e||!t.range&&i.selection.isCollapsed()||!a(e)&&i.dom.isChildOf(e,i.getBody())&&i.nodeChanged({selectionChange:!0})}),i.on("MouseUp",function(t){t.isDefaultPrevented()||("IMG"==i.selection.getNode().nodeName?n.setEditorTimeout(i,function(){i.nodeChanged()}):i.nodeChanged())}),this.nodeChanged=function(t){var e,n,r,o=i.selection;i.initialized&&o&&!i.settings.disable_nodechange&&!i.readonly&&(r=i.getBody(),(e=o.getStart(!0)||r).ownerDocument==i.getDoc()&&i.dom.isChildOf(e,r)||(e=r),n=[],i.dom.getParent(e,function(t){if(t===r)return!0;n.push(t)}),(t=t||{}).element=e,t.parents=n,i.fire("NodeChange",t))}}}),o("tinymce.core.dom.MousePosition",[],function(){var t=function(t){var e,n,i,r;return r=t.getBoundingClientRect(),e=t.ownerDocument,n=e.documentElement,i=e.defaultView,{top:r.top+i.pageYOffset-n.clientTop,left:r.left+i.pageXOffset-n.clientLeft}},e=function(e){return e.inline?t(e.getBody()):{left:0,top:0}},n=function(t){var e=t.getBody();return t.inline?{left:e.scrollLeft,top:e.scrollTop}:{left:0,top:0}},i=function(t){var e=t.getBody(),n=t.getDoc().documentElement,i={left:e.scrollLeft,top:e.scrollTop},r={left:e.scrollLeft||n.scrollLeft,top:e.scrollTop||n.scrollTop};return t.inline?i:r},r=function(e,n){if(n.target.ownerDocument!==e.getDoc()){var r=t(e.getContentAreaContainer()),o=i(e);return{left:n.pageX-r.left+o.left,top:n.pageY-r.top+o.top}}return{left:n.pageX,top:n.pageY}},o=function(t,e,n){return{pageX:n.left-t.left+e.left,pageY:n.top-t.top+e.top}};return{calc:function(t,i){return o(e(t),n(t),r(t,i))}}}),o("tinymce.core.DragDropOverrides",["global!document","tinymce.core.dom.DOMUtils","tinymce.core.dom.MousePosition","tinymce.core.dom.NodeType","tinymce.core.util.Arr","tinymce.core.util.Delay","tinymce.core.util.Fun"],function(t,e,n,i,r,o,a){var s=i.isContentEditableFalse,c=i.isContentEditableTrue,u=function(t,e){return s(e)&&e!==t},l=function(t,e,n){return e!==n&&!t.dom.isChildOf(e,n)&&!s(e)},h=function(t){var e=t.cloneNode(!0);return e.removeAttribute("data-mce-selected"),e},d=function(t,e,n,i){var r=e.cloneNode(!0);t.dom.setStyles(r,{width:n,height:i}),t.dom.setAttrib(r,"data-mce-selected",null);var o=t.dom.create("div",{"class":"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return t.dom.setStyles(o,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:i}),t.dom.setStyles(r,{margin:0,boxSizing:"border-box"}),o.appendChild(r),o},f=function(t,e){t.parentNode!==e&&e.appendChild(t)},p=function(t,e,n,i,r,o){var a=0,s=0;t.style.left=e.pageX+"px",t.style.top=e.pageY+"px",e.pageX+n>r&&(a=e.pageX+n-r),e.pageY+i>o&&(s=e.pageY+i-o),t.style.width=n-a+"px",t.style.height=i-s+"px"},m=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},g=function(t){return 0===t.button},v=function(t){return t.element},y=function(t,e){return{pageX:e.pageX-t.relX,pageY:e.pageY+5}},b=function(t,e){return function(n){if(g(n)){var i=r.find(e.dom.getParents(n.target),a.or(s,c));if(u(e.getBody(),i)){var o=e.dom.getPos(i),l=e.getBody(),h=e.getDoc().documentElement;t.element=i,t.screenX=n.screenX,t.screenY=n.screenY,t.maxX=(e.inline?l.scrollWidth:h.offsetWidth)-2,t.maxY=(e.inline?l.scrollHeight:h.offsetHeight)-2,t.relX=n.pageX-o.x,t.relY=n.pageY-o.y,t.width=i.offsetWidth,t.height=i.offsetHeight,t.ghost=d(e,i,t.width,t.height)}}}},_=function(t,e){var i=o.throttle(function(t,n){e._selectionOverrides.hideFakeCaret(),e.selection.placeCaretAt(t,n)},0);return function(r){var o=Math.max(Math.abs(r.screenX-t.screenX),Math.abs(r.screenY-t.screenY));if(v(t)&&!t.dragging&&o>10){if(e.fire("dragstart",{target:t.element}).isDefaultPrevented())return;t.dragging=!0,e.focus()}if(t.dragging){var a=y(t,n.calc(e,r));f(t.ghost,e.getBody()),p(t.ghost,a,t.width,t.height,t.maxX,t.maxY),i(r.clientX,r.clientY)}}},x=function(t){var e=t.getSel().getRangeAt(0).startContainer;return 3===e.nodeType?e.parentNode:e},w=function(t,e){return function(n){if(t.dragging&&l(e,x(e.selection),t.element)){var i=h(t.element),r=e.fire("drop",{targetClone:i,clientX:n.clientX,clientY:n.clientY});r.isDefaultPrevented()||(i=r.targetClone,e.undoManager.transact(function(){m(t.element),e.insertContent(e.dom.getOuterHTML(i)),e._selectionOverrides.hideFakeCaret()}))}k(t)}},S=function(t,e){return function(){k(t),t.dragging&&e.fire("dragend")}},k=function(t){t.dragging=!1,t.element=null,m(t.ghost)},E=function(n){var i,r,o,a,s,c,u={};i=e.DOM,c=t,r=b(u,n),o=_(u,n),a=w(u,n),s=S(u,n),n.on("mousedown",r),n.on("mousemove",o),n.on("mouseup",a),i.bind(c,"mousemove",o),i.bind(c,"mouseup",s),n.on("remove",function(){i.unbind(c,"mousemove",o),i.unbind(c,"mouseup",s)})},T=function(t){t.on("drop",function(e){var n="undefined"!=typeof e.clientX?t.getDoc().elementFromPoint(e.clientX,e.clientY):null;(s(n)||s(t.dom.getContentEditableParent(n)))&&e.preventDefault()})};return{init:function(t){E(t),T(t)}}}),o("tinymce.core.caret.FakeCaret",["global!clearInterval","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretContainerRemove","tinymce.core.dom.DomQuery","tinymce.core.dom.NodeType","tinymce.core.geom.ClientRect","tinymce.core.util.Delay"],function(t,e,n,i,r,o,a){var s=r.isContentEditableFalse,c=function(t){return t&&/^(TD|TH)$/i.test(t.nodeName)};return function(r,u){var l,h,d=null,f=function(t,e){var n,i,a,s,c,u=o.collapse(t.getBoundingClientRect(),e);return"BODY"==r.tagName?(n=r.ownerDocument.documentElement,i=r.scrollLeft||n.scrollLeft,a=r.scrollTop||n.scrollTop):(c=r.getBoundingClientRect(),i=r.scrollLeft-c.left,a=r.scrollTop-c.top),u.left+=i,u.right+=i,u.top+=a,u.bottom+=a,u.width=1,(s=t.offsetWidth-t.clientWidth)>0&&(e&&(s*=-1),u.left+=s,u.right+=s),u},p=function(){var t,n,o,a,s;for(t=i("*[contentEditable=false]",r),a=0;a<t.length;a++)o=(n=t[a]).previousSibling,e.endsWithCaretContainer(o)&&(1==(s=o.data).length?o.parentNode.removeChild(o):o.deleteData(s.length-1,1)),o=n.nextSibling,e.startsWithCaretContainer(o)&&(1==(s=o.data).length?o.parentNode.removeChild(o):o.deleteData(0,1));return null},m=function(t,n){var o,a;return g(),c(n)?null:u(n)?(h=e.insertBlock("p",n,t),o=f(n,t),i(h).css("top",o.top),d=i('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(o).appendTo(r),t&&d.addClass("mce-visual-caret-before"),y(),(a=n.ownerDocument.createRange()).setStart(h,0),a.setEnd(h,0),a):(h=e.insertInline(n,t),a=n.ownerDocument.createRange(),s(h.nextSibling)?(a.setStart(h,0),a.setEnd(h,0)):(a.setStart(h,1),a.setEnd(h,1)),a)},g=function(){p(),h&&(n.remove(h),h=null),d&&(d.remove(),d=null),t(l)},v=function(){return r.ownerDocument.activeElement===r},y=function(){l=a.setInterval(function(){v()?i("div.mce-visual-caret",r).toggleClass("mce-visual-caret-hidden"):i("div.mce-visual-caret",r).addClass("mce-visual-caret-hidden")},500)};return{show:m,hide:g,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},destroy:function(){a.clearInterval(l)}}}}),o("tinymce.core.dom.Dimensions",["tinymce.core.util.Arr","tinymce.core.dom.NodeType","tinymce.core.geom.ClientRect"],function(t,e,n){var i=function(r){var o=function(e){return t.map(e,function(t){return t=n.clone(t),t.node=r,t})};if(t.isArray(r))return t.reduce(r,function(t,e){return t.concat(i(e))},[]);if(e.isElement(r))return o(r.getClientRects());if(e.isText(r)){var a=r.ownerDocument.createRange();return a.setStart(r,0),a.setEnd(r,r.data.length),o(a.getClientRects())}};return{getClientRects:i}}),o("tinymce.core.caret.LineUtils",["tinymce.core.util.Fun","tinymce.core.util.Arr","tinymce.core.dom.NodeType","tinymce.core.dom.Dimensions","tinymce.core.geom.ClientRect","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretCandidate"],function(t,e,n,i,r,o,a){var s=n.isContentEditableFalse,c=o.findNode,u=t.curry,l=function(t,e){return Math.abs(t.left-e)},h=function(t,e){return Math.abs(t.right-e)},d=function(t,n){var i=function(t,e){return t>=e.left&&t<=e.right};return e.reduce(t,function(t,e){var r,o;return r=Math.min(l(t,n),h(t,n)),o=Math.min(l(e,n),h(e,n)),i(n,e)?e:i(n,t)?t:o==r&&s(e.node)?e:o<r?e:t})},f=function(t,e,n,i){for(;i=c(i,t,a.isEditableCaretCandidate,e);)if(n(i))return},p=function(t,n){var o=[],a=function(t,r){var a;return a=e.filter(i.getClientRects(r),function(e){return!t(e,n)}),o=o.concat(a),0===a.length};return o.push(n),f(-1,t,u(a,r.isAbove),n.node),f(1,t,u(a,r.isBelow),n.node),o},m=function(t){return e.filter(e.toArray(t.getElementsByTagName("*")),s)},g=function(t,e){return{node:t.node,before:l(t,e)<h(t,e)}};return{findClosestClientRect:d,findLineNodeRects:p,closestCaret:function(t,n,r){var o,a;return o=i.getClientRects(m(t)),o=e.filter(o,function(t){return r>=t.top&&r<=t.bottom}),(a=d(o,n))&&(a=d(p(t,a),n))&&s(a.node)?g(a,n):null}}}),o("tinymce.core.dom.RangePoint",["ephox.katamari.api.Arr","tinymce.core.geom.ClientRect"],function(t,e){return{isXYWithinRange:function(n,i,r){return!r.collapsed&&t.foldl(r.getClientRects(),function(t,r){return t||e.containsXY(r,n,i)},!1)}}}),o("ephox.katamari.api.Throttler",["global!clearTimeout","global!setTimeout"],function(t,e){return{adaptable:function(n,i){var r=null,o=null;return{cancel:function(){null!==r&&(t(r),r=null,o=null)},throttle:function(){o=arguments,null===r&&(r=e(function(){n.apply(null,o),r=null,o=null},i))}}},first:function(n,i){var r=null;return{cancel:function(){null!==r&&(t(r),r=null)},throttle:function(){var t=arguments;null===r&&(r=e(function(){n.apply(null,t),r=null,t=null},i))}}},last:function(n,i){var r=null;return{cancel:function(){null!==r&&(t(r),r=null)},throttle:function(){var o=arguments;null!==r&&t(r),r=e(function(){n.apply(null,o),r=null,o=null},i)}}}}}),o("tinymce.core.keyboard.CefUtils",["tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.dom.NodeType","tinymce.core.util.Fun"],function(t,e,n,i){var r=n.isContentEditableTrue,o=n.isContentEditableFalse,a=function(t,e,n,i){return e._selectionOverrides.showCaret(t,n,i)},s=function(t){var e=t.ownerDocument.createRange();return e.selectNode(t),e},c=function(n,s){var c,u;return s=e.normalizeRange(1,n.getBody(),s),c=t.fromRangeStart(s),o(c.getNode())?a(1,n,c.getNode(),!c.isAtEnd()):o(c.getNode(!0))?a(1,n,c.getNode(!0),!1):(u=n.dom.getParent(c.getNode(),i.or(o,r)),o(u)?a(1,n,u,!1):null)};return{showCaret:a,selectNode:function(t,e){return t.fire("BeforeObjectSelected",{target:e}).isDefaultPrevented()?null:s(e)},renderCaretAtRange:c,renderRangeCaret:function(t,e){return e&&e.collapsed?c(t,e)||e:e}}}),o("tinymce.core.focus.CefFocus",["ephox.katamari.api.Throttler","tinymce.core.keyboard.CefUtils"],function(t,e){return{setup:function(n){var i=t.first(function(){if(!n.removed){var t=e.renderRangeCaret(n,n.selection.getRng());n.selection.setRng(t)}},0);n.on("focus",function(){i.throttle()}),n.on("blur",function(){i.cancel()})}}}),o("tinymce.core.util.VK",["tinymce.core.Env"],function(t){return{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(t){return t.shiftKey||t.ctrlKey||t.altKey||this.metaKeyPressed(t)},metaKeyPressed:function(e){return t.mac?e.metaKey:e.ctrlKey&&!e.altKey}}}),
o("tinymce.core.SelectionOverrides",["ephox.katamari.api.Arr","ephox.sugar.api.dom.Remove","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.SelectorFilter","ephox.sugar.api.search.SelectorFind","tinymce.core.DragDropOverrides","tinymce.core.EditorView","tinymce.core.Env","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretWalker","tinymce.core.caret.FakeCaret","tinymce.core.caret.LineUtils","tinymce.core.dom.NodeType","tinymce.core.dom.RangePoint","tinymce.core.focus.CefFocus","tinymce.core.keyboard.CefUtils","tinymce.core.util.VK"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p,m,g,v,y,b){var _=m.isContentEditableTrue,x=m.isContentEditableFalse,w=h.isAfterContentEditableFalse,S=h.isBeforeContentEditableFalse;return function(m){var k,E=function(t){return m.dom.isBlock(t)},T=m.getBody(),C=new f(m.getBody(),E),L="sel-"+m.dom.uniqueId(),P=function(t){return m.dom.hasClass(t,"mce-offscreen-selection")},A=function(){var t=m.dom.get(L);return t?t.getElementsByTagName("*")[0]:t},N=function(t){t&&m.selection.setRng(t)},R=function(){return m.selection.getRng()},I=function(t,e){m.selection.scrollIntoView(t,e)},D=function(t,e,n){return m.fire("ShowCaret",{target:e,direction:t,before:n}).isDefaultPrevented()?null:(I(e,-1===t),C.show(n,e))},O=function(t,e){return e=h.normalizeRange(t,T,e),-1==t?l.fromRangeStart(e):l.fromRangeEnd(e)},B=function(t){t.hasAttribute("data-mce-caret")&&(u.showCaretContainerBlock(t),N(R()),I(t[0]))},M=function(){var t=function(t){for(var e=m.getBody();t&&t!=e;){if(_(t)||x(t))return t;t=t.parentNode}return null};m.on("mouseup",function(t){var e=R();e.collapsed&&s.isXYInContentArea(m,t.clientX,t.clientY)&&N(y.renderCaretAtRange(m,e))}),m.on("click",function(e){var n;(n=t(e.target))&&(x(n)&&(e.preventDefault(),m.focus()),_(n)&&m.dom.isChildOf(n,m.selection.getNode())&&$())}),m.on("blur NewBlock",function(){$()});var e=function(t){var e=new d(t);if(!t.firstChild)return!1;var n=l.before(t.firstChild),i=e.next(n);return i&&!S(i)&&!w(i)},n=function(t,e){return m.dom.getParent(t,m.dom.isBlock)===m.dom.getParent(e,m.dom.isBlock)},i=function(t,i){var r=m.dom.getParent(t,m.dom.isBlock),o=m.dom.getParent(i,m.dom.isBlock);return r&&!n(r,o)&&e(r)};(function(e){var n=!1;e.on("touchstart",function(){n=!1}),e.on("touchmove",function(){n=!0}),e.on("touchend",function(i){var r=t(i.target);x(r)&&(n||(i.preventDefault(),H(y.selectNode(e,r))))})})(m),m.on("mousedown",function(e){var n;if(!1!==s.isXYInContentArea(m,e.clientX,e.clientY))if(n=t(e.target))x(n)?(e.preventDefault(),H(y.selectNode(m,n))):($(),_(n)&&e.shiftKey||g.isXYWithinRange(e.clientX,e.clientY,m.selection.getRng())||m.selection.placeCaretAt(e.clientX,e.clientY));else{$(),q();var r=p.closestCaret(T,e.clientX,e.clientY);r&&(i(e.target,r.node)||(e.preventDefault(),m.getBody().focus(),N(D(1,r.node,r.before))))}}),m.on("keypress",function(t){b.modifierPressed(t)||(t.keyCode,x(m.selection.getNode())&&t.preventDefault())}),m.on("getSelectionRange",function(t){var e=t.range;if(k){if(!k.parentNode)return void(k=null);(e=e.cloneRange()).selectNode(k),t.range=e}}),m.on("setSelectionRange",function(t){var e;(e=H(t.range,t.forward))&&(t.range=e)}),m.on("AfterSetSelectionRange",function(t){var e=t.range;j(e)||q(),P(e.startContainer.parentNode)||$()}),m.on("copy",function(t){var e=t.clipboardData;if(!t.isDefaultPrevented()&&t.clipboardData&&!c.ie){var n=A();n&&(t.preventDefault(),e.clearData(),e.setData("text/html",n.outerHTML),e.setData("text/plain",n.outerText))}}),a.init(m),v.setup(m)},F=function(){var t=m.contentStyles,e=".mce-content-body";t.push(C.getCss()),t.push(e+" .mce-offscreen-selection {position: absolute;left: -9999999999px;max-width: 1000000px;}"+e+" *[contentEditable=false] {cursor: default;}"+e+" *[contentEditable=true] {cursor: text;}")},z=function(t){return u.isCaretContainer(t)||u.startsWithCaretContainer(t)||u.endsWithCaretContainer(t)},j=function(t){return z(t.startContainer)||z(t.endContainer)},H=function(e,a){var s,u,l,h,d,f,p,g,v,y,b=m.$,_=m.dom;if(!e)return null;if(e.collapsed){if(!j(e))if(!1===a){if(g=O(-1,e),x(g.getNode(!0)))return D(-1,g.getNode(!0),!1);if(x(g.getNode()))return D(-1,g.getNode(),!g.isAtEnd())}else{if(g=O(1,e),x(g.getNode()))return D(1,g.getNode(),!g.isAtEnd());if(x(g.getNode(!0)))return D(1,g.getNode(!0),!1)}return null}return h=e.startContainer,d=e.startOffset,f=e.endOffset,3===h.nodeType&&0===d&&x(h.parentNode)&&(h=h.parentNode,d=_.nodeIndex(h),h=h.parentNode),1!=h.nodeType?null:(f==d+1&&(s=h.childNodes[d]),x(s)?(v=y=s.cloneNode(!0),(p=m.fire("ObjectSelected",{target:s,targetClone:v})).isDefaultPrevented()?null:(u=o.descendant(n.fromDom(m.getBody()),"#"+L).fold(function(){return b([])},function(t){return b([t.dom()])}),v=p.targetClone,0===u.length&&(u=b('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",L)).appendTo(m.getBody()),e=m.dom.createRng(),v===y&&c.ie?(u.empty().append('<p style="font-size: 0" data-mce-bogus="all">\xa0</p>').append(v),e.setStartAfter(u[0].firstChild.firstChild),e.setEndAfter(v)):(u.empty().append("\xa0").append(v).append("\xa0"),e.setStart(u[0].firstChild,1),e.setEnd(u[0].lastChild,0)),u.css({top:_.getPos(s,m.getBody()).y}),u[0].focus(),(l=m.selection.getSel()).removeAllRanges(),l.addRange(e),t.each(r.descendants(n.fromDom(m.getBody()),"*[data-mce-selected]"),function(t){i.remove(t,"data-mce-selected")}),s.setAttribute("data-mce-selected",1),k=s,q(),e)):null)},$=function(){k&&(k.removeAttribute("data-mce-selected"),o.descendant(n.fromDom(m.getBody()),"#"+L).each(e.remove),k=null)},U=function(){C.destroy(),k=null},q=function(){C.hide()};return c.ceFalse&&(M(),F()),{showCaret:D,showBlockCaretContainer:B,hideFakeCaret:q,destroy:U}}}),o("tinymce.core.undo.Diff",[],function(){var t=0,e=1,n=2;return{KEEP:t,DELETE:n,INSERT:e,diff:function(i,r){var o=i.length+r.length+2,a=new Array(o),s=new Array(o),c=function(t,e,n){return{start:t,end:e,diag:n}},u=function(o,a,s,c,l){var d=h(o,a,s,c);if(null===d||d.start===a&&d.diag===a-c||d.end===o&&d.diag===o-s)for(var f=o,p=s;f<a||p<c;)f<a&&p<c&&i[f]===r[p]?(l.push([t,i[f]]),++f,++p):a-o>c-s?(l.push([n,i[f]]),++f):(l.push([e,r[p]]),++p);else{u(o,d.start,s,d.start-d.diag,l);for(var m=d.start;m<d.end;++m)l.push([t,i[m]]);u(d.end,a,d.end-d.diag,c,l)}},l=function(t,e,n,o){for(var a=t;a-e<o&&a<n&&i[a]===r[a-e];)++a;return c(t,a,e)},h=function(t,e,n,o){var c=e-t,u=o-n;if(0===c||0===u)return null;var h=c-u,d=u+c,f=(d%2==0?d:d+1)/2;a[1+f]=t,s[1+f]=e+1;for(var p=0;p<=f;++p){for(var m=-p;m<=p;m+=2){var g=m+f;m===-p||m!=p&&a[g-1]<a[g+1]?a[g]=a[g+1]:a[g]=a[g-1]+1;for(var v=a[g],y=v-t+n-m;v<e&&y<o&&i[v]===r[y];)a[g]=++v,++y;if(h%2!=0&&h-p<=m&&m<=h+p&&s[g-h]<=a[g])return l(s[g-h],m+t-n,e,o)}for(m=h-p;m<=h+p;m+=2){for(g=m+f-h,m===h-p||m!=h+p&&s[g+1]<=s[g-1]?s[g]=s[g+1]-1:s[g]=s[g-1],y=(v=s[g]-1)-t+n-m;v>=t&&y>=n&&i[v]===r[y];)s[g]=v--,y--;if(h%2==0&&-p<=m&&m<=p&&s[g]<=a[g+h])return l(s[g],m+t-n,e,o)}}},d=[];return u(0,i.length,0,r.length,d),d}}}),o("tinymce.core.undo.Fragments",["global!document","tinymce.core.html.Entities","tinymce.core.undo.Diff","tinymce.core.util.Arr"],function(t,e,n,i){var r=function(t){return 1===t.nodeType?t.outerHTML:3===t.nodeType?e.encodeRaw(t.data,!1):8===t.nodeType?"<!--"+t.data+"-->":""},o=function(e){var n,i,r;for(r=t.createElement("div"),n=t.createDocumentFragment(),e&&(r.innerHTML=e);i=r.firstChild;)n.appendChild(i);return n},a=function(t,e,n){var i=o(e);if(t.hasChildNodes()&&n<t.childNodes.length){var r=t.childNodes[n];r.parentNode.insertBefore(i,r)}else t.appendChild(i)},s=function(t,e){if(t.hasChildNodes()&&e<t.childNodes.length){var n=t.childNodes[e];n.parentNode.removeChild(n)}},c=function(t,e){var r=0;i.each(t,function(t){t[0]===n.KEEP?r++:t[0]===n.INSERT?(a(e,t[1],r),r++):t[0]===n.DELETE&&s(e,r)})};return{read:function(t){return i.filter(i.map(t.childNodes,r),function(t){return t.length>0})},write:function(t,e){var o=i.map(e.childNodes,r);return c(n.diff(o,t),e),e}}}),o("tinymce.core.undo.Levels",["ephox.katamari.api.Arr","tinymce.core.dom.TrimHtml","tinymce.core.undo.Fragments"],function(t,e,n){var i=function(t){return-1!==t.indexOf("</iframe>")},r=function(t){return{type:"fragmented",fragments:t,content:"",bookmark:null,beforeBookmark:null}},o=function(t){return{type:"complete",fragments:null,content:t,bookmark:null,beforeBookmark:null}},a=function(t){return"fragmented"===t.type?t.fragments.join(""):t.content};return{createFragmentedLevel:r,createCompleteLevel:o,createFromEditor:function(a){var s,c,u;return s=n.read(a.getBody()),u=t.bind(s,function(t){var n=e.trimInternal(a.serializer,t);return n.length>0?[n]:[]}),c=u.join(""),i(c)?r(u):o(c)},applyToEditor:function(t,e,i){"fragmented"===e.type?n.write(e.fragments,t.getBody()):t.setContent(e.content,{format:"raw"}),t.selection.moveToBookmark(i?e.beforeBookmark:e.bookmark)},isEq:function(t,e){return!!t&&!!e&&a(t)===a(e)}}}),o("tinymce.core.UndoManager",["tinymce.core.dom.GetBookmark","tinymce.core.undo.Levels","tinymce.core.util.Tools"],function(t,e,n){return function(i){var r,o,a=this,s=0,c=[],u=0,l=function(){return 0===u},h=function(t){l()&&(a.typing=t)},d=function(t){i.setDirty(t)},f=function(t){h(!1),a.add({},t)},p=function(){a.typing&&(h(!1),a.add())};return i.on("init",function(){a.add()}),i.on("BeforeExecCommand",function(t){var e=t.command;"Undo"!==e&&"Redo"!==e&&"mceRepaint"!==e&&(p(),a.beforeChange())}),i.on("ExecCommand",function(t){var e=t.command;"Undo"!==e&&"Redo"!==e&&"mceRepaint"!==e&&f(t)}),i.on("ObjectResizeStart Cut",function(){a.beforeChange()}),i.on("SaveContent ObjectResized blur",f),i.on("DragEnd",f),i.on("KeyUp",function(t){var n=t.keyCode;t.isDefaultPrevented()||((n>=33&&n<=36||n>=37&&n<=40||45===n||t.ctrlKey)&&(f(),i.nodeChanged()),46!==n&&8!==n||i.nodeChanged(),o&&a.typing&&!1===e.isEq(e.createFromEditor(i),c[0])&&(!1===i.isDirty()&&(d(!0),i.fire("change",{level:c[0],lastLevel:null})),i.fire("TypingUndo"),o=!1,i.nodeChanged()))}),i.on("KeyDown",function(t){var e=t.keyCode;if(!t.isDefaultPrevented())if(e>=33&&e<=36||e>=37&&e<=40||45===e)a.typing&&f(t);else{var n=t.ctrlKey&&!t.altKey||t.metaKey;!(e<16||e>20)||224===e||91===e||a.typing||n||(a.beforeChange(),h(!0),a.add({},t),o=!0)}}),i.on("MouseDown",function(t){a.typing&&f(t)}),i.addShortcut("meta+z","","Undo"),i.addShortcut("meta+y,meta+shift+z","","Redo"),i.on("AddUndo Undo Redo ClearUndos",function(t){t.isDefaultPrevented()||i.nodeChanged()}),a={data:c,typing:!1,beforeChange:function(){l()&&(r=t.getUndoBookmark(i.selection))},add:function(o,a){var u,h,f,p=i.settings;if(f=e.createFromEditor(i),o=o||{},o=n.extend(o,f),!1===l()||i.removed)return null;if(h=c[s],i.fire("BeforeAddUndo",{level:o,lastLevel:h,originalEvent:a}).isDefaultPrevented())return null;if(h&&e.isEq(h,o))return null;if(c[s]&&(c[s].beforeBookmark=r),p.custom_undo_redo_levels&&c.length>p.custom_undo_redo_levels){for(u=0;u<c.length-1;u++)c[u]=c[u+1];c.length--,s=c.length}o.bookmark=t.getUndoBookmark(i.selection),s<c.length-1&&(c.length=s+1),c.push(o),s=c.length-1;var m={level:o,lastLevel:h,originalEvent:a};return i.fire("AddUndo",m),s>0&&(d(!0),i.fire("change",m)),o},undo:function(){var t;return a.typing&&(a.add(),a.typing=!1,h(!1)),s>0&&(t=c[--s],e.applyToEditor(i,t,!0),d(!0),i.fire("undo",{level:t})),t},redo:function(){var t;return s<c.length-1&&(t=c[++s],e.applyToEditor(i,t,!1),d(!0),i.fire("redo",{level:t})),t},clear:function(){c=[],s=0,a.typing=!1,a.data=c,i.fire("ClearUndos")},hasUndo:function(){return s>0||a.typing&&c[0]&&!e.isEq(e.createFromEditor(i),c[0])},hasRedo:function(){return s<c.length-1&&!a.typing},transact:function(t){return p(),a.beforeChange(),a.ignore(t),a.add()},ignore:function(t){try{u++,t()}finally{u--}},extra:function(t,n){var r,o;a.transact(t)&&(o=c[s].bookmark,r=c[s-1],e.applyToEditor(i,r,!0),a.transact(n)&&(c[s-1].beforeBookmark=o))}}}}),o("tinymce.core.fmt.Hooks",["tinymce.core.util.Arr","tinymce.core.dom.NodeType","tinymce.core.dom.DomQuery"],function(t,e,n){var i={},r=t.filter,o=t.each,a=function(t,e){o(i[t],function(t){t(e)})};return function(t,e){var n=i[t];n||(i[t]=n=[]),i[t].push(e)}("pre",function(i){var a,s,c=i.selection.getRng(),u=function(e){return a(e.previousSibling)&&-1!==t.indexOf(s,e.previousSibling)},l=function(t,e){n(e).remove(),n(t).append("<br><br>").append(e.childNodes)};a=e.matchNodeNames("pre"),c.collapsed||(s=i.selection.getSelectedBlocks(),o(r(r(s,a),u),function(t){l(t.previousSibling,t)}))}),{postProcess:a}}),o("tinymce.core.selection.RangeWalk",["tinymce.core.util.Tools"],function(t){var e=t.each,n=function(t,e){var n=t.childNodes;return--e>n.length-1?e=n.length-1:e<0&&(e=0),n[e]||t};return{walk:function(t,i,r){var o,a,s,c,u,l,h,d=i.startContainer,f=i.startOffset,p=i.endContainer,m=i.endOffset;if((h=t.select("td[data-mce-selected],th[data-mce-selected]")).length>0)e(h,function(t){r([t])});else{var g=function(t){var e;return 3===(e=t[0]).nodeType&&e===d&&f>=e.nodeValue.length&&t.splice(0,1),e=t[t.length-1],0===m&&t.length>0&&e===p&&3===e.nodeType&&t.splice(t.length-1,1),t},v=function(t,e,n){for(var i=[];t&&t!=n;t=t[e])i.push(t);return i},y=function(t,e){do{if(t.parentNode===e)return t;t=t.parentNode}while(t)},b=function(t,e,n){var i=n?"nextSibling":"previousSibling";for(u=(c=t).parentNode;c&&c!=e;c=u)u=c.parentNode,(l=v(c===t?c:c[i],i)).length&&(n||l.reverse(),r(g(l)))};if(1===d.nodeType&&d.hasChildNodes()&&(d=d.childNodes[f]),1===p.nodeType&&p.hasChildNodes()&&(p=n(p,m)),d===p)return r(g([d]));for(o=t.findCommonAncestor(d,p),c=d;c;c=c.parentNode){if(c===p)return b(d,o,!0);if(c===o)break}for(c=p;c;c=c.parentNode){if(c===d)return b(p,o);if(c===o)break}a=y(d,o)||d,s=y(p,o)||p,b(d,a,!0),(l=v(a===d?a:a.nextSibling,"nextSibling",s===p?s.nextSibling:s)).length&&r(g(l)),b(p,s)}}}}),o("tinymce.core.fmt.RemoveFormat",["tinymce.core.dom.Bookmarks","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker","tinymce.core.fmt.CaretFormat","tinymce.core.fmt.ExpandRange","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.MatchFormat","tinymce.core.selection.RangeWalk","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c){var u=/^(src|href|style)$/,l=c.each,h=o.isEq,d=function(t){return/^(TH|TD)$/.test(t.nodeName)},f=function(t,i,r){var o,a,s;return o=i[r?"startContainer":"endContainer"],a=i[r?"startOffset":"endOffset"],e.isElement(o)&&(s=o.childNodes.length-1,!r&&a&&a--,o=o.childNodes[a>s?s:a]),e.isText(o)&&r&&a>=o.nodeValue.length&&(o=new n(o,t.getBody()).next()||o),e.isText(o)&&!r&&0===a&&(o=new n(o,t.getBody()).prev()||o),o},p=function(t,e,n,i){var r=t.create(n,i);return e.parentNode.insertBefore(r,e),r.appendChild(e),r},m=function(t,n,i){return!!h(n,i.inline)||(!!h(n,i.block)||(i.selector?e.isElement(n)&&t.is(n,i.selector):void 0))},g=function(t,e){return e.links&&"A"===t.tagName},v=function(t,e,n,i){return!(e=o.getNonWhiteSpaceSibling(e,n,i))||"BR"===e.nodeName||t.isBlock(e)},y=function(t,e,n){var i,r=e.parentNode,a=t.dom,s=t.settings.forced_root_block;n.block&&(s?r===a.getRoot()&&(n.list_block&&h(e,n.list_block)||l(c.grep(e.childNodes),function(e){o.isValid(t,s,e.nodeName.toLowerCase())?i?i.appendChild(e):(i=p(a,e,s),a.setAttribs(i,t.settings.forced_root_block_attrs)):i=0})):a.isBlock(e)&&!a.isBlock(r)&&(v(a,e,!1)||v(a,e.firstChild,!0,1)||e.insertBefore(a.create("br"),e.firstChild),v(a,e,!0)||v(a,e.lastChild,!1,1)||e.appendChild(a.create("br")))),n.selector&&n.inline&&!h(n.inline,e)||a.remove(e,1)},b=function(t,e,n,i,r){var a,s,c,d=t.dom;if(!m(d,i,e)&&!g(i,e))return!1;if("all"!==e.remove)for(l(e.styles,function(t,a){t=o.normalizeStyleValue(d,o.replaceVars(t,n),a),"number"==typeof a&&(a=t,r=0),(e.remove_similar||!r||h(o.getStyle(d,r,a),t))&&d.setStyle(i,a,""),c=1}),c&&""===d.getAttrib(i,"style")&&(i.removeAttribute("style"),i.removeAttribute("data-mce-style")),l(e.attributes,function(t,e){var a;if(t=o.replaceVars(t,n),"number"==typeof e&&(e=t,r=0),!r||h(d.getAttrib(r,e),t)){if("class"===e&&(t=d.getAttrib(i,e))&&(a="",l(t.split(/\s+/),function(t){/mce\-\w+/.test(t)&&(a+=(a?" ":"")+t)}),a))return void d.setAttrib(i,e,a);"class"===e&&i.removeAttribute("className"),u.test(e)&&i.removeAttribute("data-mce-"+e),i.removeAttribute(e)}}),l(e.classes,function(t){t=o.replaceVars(t,n),r&&!d.hasClass(r,t)||d.removeClass(i,t)}),s=d.getAttribs(i),a=0;a<s.length;a++){var f=s[a].nodeName;if(0!==f.indexOf("_")&&0!==f.indexOf("data-"))return!1}return"none"!==e.remove?(y(t,i,e),!0):void 0},_=function(t,e,n,i,r){var s;return l(o.getParents(t.dom,e.parentNode).reverse(),function(e){var o;s||"_start"===e.id||"_end"===e.id||(o=a.matchNode(t,e,n,i,r))&&!1!==o.split&&(s=e)}),s},x=function(t,e,n,i,r,o,a,s){var c,u,l,h,d,f,p=t.dom;if(n){for(f=n.parentNode,c=i.parentNode;c&&c!==f;c=c.parentNode){for(u=p.clone(c,!1),d=0;d<e.length;d++)if(b(t,e[d],s,u,u)){u=0;break}u&&(l&&u.appendChild(l),h||(h=u),l=u)}!o||a.mixed&&p.isBlock(n)||(i=p.split(n,i)),l&&(r.parentNode.insertBefore(l,r),h.appendChild(r))}return i};return{removeFormat:b,remove:function(n,u,h,m,g){var v,y,w=n.formatter.get(u),S=w[0],k=!0,E=n.dom,T=n.selection,C=function(t){var e=_(n,t,u,h,g);return x(n,w,e,t,t,!0,S,h)},L=function(t){var i,r,o,a,s;if(e.isElement(t)&&E.getContentEditable(t)&&(a=k,k="true"===E.getContentEditable(t),s=!0),i=c.grep(t.childNodes),k&&!s)for(r=0,o=w.length;r<o&&!b(n,w[r],h,t,t);r++);if(S.deep&&i.length){for(r=0,o=i.length;r<o;r++)L(i[r]);s&&(k=a)}},P=function(n){var i=E.get(n?"_start":"_end"),r=i[n?"firstChild":"lastChild"];return t.isBookmarkNode(r)&&(r=r[n?"firstChild":"lastChild"]),e.isText(r)&&0===r.data.length&&(r=n?i.previousSibling||i.nextSibling:i.nextSibling||i.previousSibling),E.remove(i,!0),r},A=function(t){var i,a,c=t.commonAncestorContainer;if(t=r.expandRng(n,t,w,!0),S.split){if(i=f(n,t,!0),a=f(n,t),i!==a){if(/^(TR|TH|TD)$/.test(i.nodeName)&&i.firstChild&&(i="TR"===i.nodeName?i.firstChild.firstChild||i:i.firstChild||i),c&&/^T(HEAD|BODY|FOOT|R)$/.test(c.nodeName)&&d(a)&&a.firstChild&&(a=a.firstChild||a),E.isChildOf(i,a)&&i!==a&&!E.isBlock(a)&&!d(i)&&!d(a))return i=p(E,i,"span",{id:"_start","data-mce-type":"bookmark"}),C(i),void(i=P(!0));i=p(E,i,"span",{id:"_start","data-mce-type":"bookmark"}),a=p(E,a,"span",{id:"_end","data-mce-type":"bookmark"}),C(i),C(a),i=P(!0),a=P()}else i=a=C(i);t.startContainer=i.parentNode?i.parentNode:i,t.startOffset=E.nodeIndex(i),t.endContainer=a.parentNode?a.parentNode:a,t.endOffset=E.nodeIndex(a)+1}s.walk(E,t,function(t){l(t,function(t){L(t),e.isElement(t)&&"underline"===n.dom.getStyle(t,"text-decoration")&&t.parentNode&&"underline"===o.getTextDecoration(E,t.parentNode)&&b(n,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,t)})})};if(m)m.nodeType?((y=E.createRng()).setStartBefore(m),y.setEndAfter(m),A(y)):A(m);else if("false"!==E.getContentEditable(T.getNode()))T.isCollapsed()&&S.inline&&!E.select("td[data-mce-selected],th[data-mce-selected]").length?i.removeCaretFormat(n,u,h,g):(v=T.getBookmark(),A(T.getRng(!0)),T.moveToBookmark(v),S.inline&&a.match(n,u,h,T.getStart())&&o.moveStart(E,T,T.getRng(!0)),n.nodeChanged());else{m=T.getNode();for(var N=0,R=w.length;N<R&&(!w[N].ceFalseOverride||!b(n,w[N],h,m,m));N++);}}}}),o("tinymce.core.fmt.MergeFormats",["ephox.katamari.api.Fun","tinymce.core.dom.Bookmarks","tinymce.core.dom.ElementUtils","tinymce.core.dom.NodeType","tinymce.core.fmt.CaretFormat","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.MatchFormat","tinymce.core.fmt.RemoveFormat","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c){var u=c.each,l=function(t){return t&&1===t.nodeType&&!e.isBookmarkNode(t)&&!r.isCaretNode(t)&&!i.isBogus(t)},h=function(t,n){var i;for(i=t;i;i=i[n]){if(3===i.nodeType&&0!==i.nodeValue.length)return t;if(1===i.nodeType&&!e.isBookmarkNode(i))return i}return t},d=function(t,e,i){var r,o,a=new n(t);if(e&&i&&(e=h(e,"previousSibling"),i=h(i,"nextSibling"),a.compare(e,i))){for(r=e.nextSibling;r&&r!==i;)o=r,r=r.nextSibling,e.appendChild(o);return t.remove(i),c.each(c.grep(i.childNodes),function(t){e.appendChild(t)}),e}return i},f=function(t,e,n){u(t.childNodes,function(t){l(t)&&(e(t)&&n(t),t.hasChildNodes()&&f(t,e,n))})},p=function(e,n){return t.curry(function(t,n){return!(!n||!o.getStyle(e,n,t))},n)},m=function(e,n,i){return t.curry(function(t,n,i){e.setStyle(i,t,n),""===i.getAttribute("style")&&i.removeAttribute("style"),g(e,i)},n,i)},g=function(t,e){"SPAN"===e.nodeName&&0===t.getAttribs(e).length&&t.remove(e,!0)},v=function(t,e){var n;1===e.nodeType&&e.parentNode&&1===e.parentNode.nodeType&&(n=o.getTextDecoration(t,e.parentNode),t.getStyle(e,"color")&&n?t.setStyle(e,"text-decoration",n):t.getStyle(e,"text-decoration")===n&&t.setStyle(e,"text-decoration",null))},y=function(t,e,n){if(e.clear_child_styles){var i=e.links?"*:not(a)":"*";u(t.select(i,n),function(n){l(n)&&u(e.styles,function(e,i){t.setStyle(n,i,"")})})}};return{mergeWithChildren:function(t,e,n,i){u(e,function(e){u(t.dom.select(e.inline,i),function(i){l(i)&&s.removeFormat(t,e,n,i,e.exact?i:null)}),y(t.dom,e,i)})},mergeUnderlineAndColor:function(e,n,i,r){(n.styles.color||n.styles.textDecoration)&&(c.walk(r,t.curry(v,e),"childNodes"),v(e,r))},mergeBackgroundColorAndFontSize:function(t,e,n,i){e.styles&&e.styles.backgroundColor&&f(i,p(t,"fontSize"),m(t,"backgroundColor",o.replaceVars(e.styles.backgroundColor,n)))},mergeSubSup:function(t,e,n,i){"sub"!==e.inline&&"sup"!==e.inline||(f(i,p(t,"fontSize"),m(t,"fontSize","")),t.remove(t.select("sup"===e.inline?"sub":"sup",i),!0))},mergeSiblings:function(t,e,n,i){i&&!1!==e.merge_siblings&&(i=d(t,o.getNonWhiteSpaceSibling(i),i),i=d(t,i,o.getNonWhiteSpaceSibling(i,!0)))},mergeWithParents:function(t,e,n,i,r){a.matchNode(t,r.parentNode,n,i)&&s.removeFormat(t,e,i,r)||e.merge_with_parents&&t.dom.getParent(r.parentNode,function(o){if(a.matchNode(t,o,n,i))return s.removeFormat(t,e,i,r),!0})}}}),o("tinymce.core.fmt.ApplyFormat",["tinymce.core.dom.Bookmarks","tinymce.core.dom.NodeType","tinymce.core.fmt.CaretFormat","tinymce.core.fmt.ExpandRange","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.Hooks","tinymce.core.fmt.MatchFormat","tinymce.core.fmt.MergeFormats","tinymce.core.selection.RangeNormalizer","tinymce.core.selection.RangeWalk","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c,u,l){var h=l.each,d=function(i){return i&&1===i.nodeType&&!t.isBookmarkNode(i)&&!n.isCaretNode(i)&&!e.isBogus(i)},f=function(e,p,m,g){var v,y,b=e.formatter.get(p),_=b[0],x=!g&&e.selection.isCollapsed(),w=e.dom,S=e.selection,k=function(t,e){if(e=e||_,t){if(e.onformat&&e.onformat(t,e,m,g),h(e.styles,function(e,n){w.setStyle(t,n,r.replaceVars(e,m))}),e.styles){var n=w.getAttrib(t,"style");n&&t.setAttribute("data-mce-style",n)}h(e.attributes,function(e,n){w.setAttrib(t,n,r.replaceVars(e,m))}),h(e.classes,function(e){e=r.replaceVars(e,m),w.hasClass(t,e)||w.addClass(t,e)})}},E=function(t,e){var i=!1;return!!_.selector&&(h(t,function(t){if(!("collapsed"in t&&t.collapsed!==x))return w.is(e,t.selector)&&!n.isCaretNode(e)?(k(e,t),i=!0,!1):void 0}),i)},T=function(i,o,c,f){var g,v,y=[],x=!0;g=_.inline||_.block,v=i.create(g),k(v),u.walk(i,o,function(t){var o,s=function(t){var c,u,d,w;if(w=x,c=t.nodeName.toLowerCase(),u=t.parentNode.nodeName.toLowerCase(),1===t.nodeType&&i.getContentEditable(t)&&(w=x,x="true"===i.getContentEditable(t),d=!0),r.isEq(c,"br"))return o=0,void(_.block&&i.remove(t));if(_.wrapper&&a.matchNode(e,t,p,m))o=0;else{if(x&&!d&&_.block&&!_.wrapper&&r.isTextBlock(e,c)&&r.isValid(e,u,g))return t=i.rename(t,g),k(t),y.push(t),void(o=0);if(_.selector){var S=E(b,t);if(!_.inline||S)return void(o=0)}!x||d||!r.isValid(e,g,c)||!r.isValid(e,u,g)||!f&&3===t.nodeType&&1===t.nodeValue.length&&65279===t.nodeValue.charCodeAt(0)||n.isCaretNode(t)||_.inline&&i.isBlock(t)?(o=0,h(l.grep(t.childNodes),s),d&&(x=w),o=0):(o||(o=i.clone(v,!1),t.parentNode.insertBefore(o,t),y.push(o)),o.appendChild(t))}};h(t,s)}),!0===_.links&&h(y,function(t){var e=function(t){"A"===t.nodeName&&k(t,_),h(l.grep(t.childNodes),e)};e(t)}),h(y,function(n){var o,c=function(t){var e=!1;return h(t.childNodes,function(t){if(d(t))return e=t,!1}),e},u=function(e){var n,r;return(n=c(e))&&!t.isBookmarkNode(n)&&a.matchName(i,n,_)&&(r=i.clone(n,!1),k(r),i.replace(r,e,!0),i.remove(n,1)),r||e};o=function(e){var n=0;return h(e.childNodes,function(e){r.isWhiteSpaceNode(e)||t.isBookmarkNode(e)||n++}),n}(n),!(y.length>1)&&i.isBlock(n)||0!==o?(_.inline||_.wrapper)&&(_.exact||1!==o||(n=u(n)),s.mergeWithChildren(e,b,m,n),s.mergeWithParents(e,_,p,m,n),s.mergeBackgroundColorAndFontSize(i,_,m,n),s.mergeSubSup(i,_,m,n),s.mergeSiblings(i,_,m,n)):i.remove(n,1)})};if("false"!==w.getContentEditable(S.getNode())){if(_){if(g)g.nodeType?E(b,g)||((y=w.createRng()).setStartBefore(g),y.setEndAfter(g),T(w,i.expandRng(e,y,b),null,!0)):T(w,g,null,!0);else if(x&&_.inline&&!w.select("td[data-mce-selected],th[data-mce-selected]").length)n.applyCaretFormat(e,p,m);else{var C=e.selection.getNode();e.settings.forced_root_block||!b[0].defaultBlock||w.getParent(C,w.isBlock)||f(e,b[0].defaultBlock),e.selection.setRng(c.normalize(e.selection.getRng())),v=S.getBookmark(),T(w,i.expandRng(e,S.getRng(!0),b),v),_.styles&&s.mergeUnderlineAndColor(w,_,m,C),S.moveToBookmark(v),r.moveStart(w,S,S.getRng(!0)),e.nodeChanged()}o.postProcess(p,e)}}else{g=S.getNode();for(var L=0,P=b.length;L<P;L++)if(b[L].ceFalseOverride&&w.is(g,b[L].selector))return void k(g,b[L])}};return{applyFormat:f}}),o("tinymce.core.fmt.FormatChanged",["ephox.katamari.api.Cell","tinymce.core.fmt.FormatUtils","tinymce.core.fmt.MatchFormat","tinymce.core.util.Tools"],function(t,e,n,i){var r=i.each,o=function(t,o){var a={};t.set({}),o.on("NodeChange",function(s){var c=e.getParents(o.dom,s.element),u={};c=i.grep(c,function(t){return 1===t.nodeType&&!t.getAttribute("data-mce-bogus")}),r(t.get(),function(t,e){r(c,function(i){return o.formatter.matchNode(i,e,{},t.similar)?(a[e]||(r(t,function(t){t(!0,{node:i,format:e,parents:c})}),a[e]=t),u[e]=t,!1):!n.matchesUnInheritedFormatSelector(o,i,e)&&void 0})}),r(a,function(t,e){u[e]||(delete a[e],r(t,function(t){t(!1,{node:s.element,format:e,parents:c})}))})})},a=function(t,e,n,i){var o=t.get();r(e.split(","),function(t){o[t]||(o[t]=[],o[t].similar=i),o[t].push(n)}),t.set(o)};return{formatChanged:function(t,e,n,i,r){null===e.get()&&o(e,t),a(e,n,i,r)}}}),o("tinymce.core.fmt.DefaultFormats",["tinymce.core.util.Tools"],function(t){return{get:function(e){var n={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",styles:{fontSize:"%value"},clear_child_styles:!0},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(n,i,r){t.each(r,function(t,i){e.setAttrib(n,i,t)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return t.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(t){n[t]={block:t,remove:"all"}}),n}}}),o("tinymce.core.fmt.FormatRegistry",["tinymce.core.fmt.DefaultFormats","tinymce.core.util.Tools"],function(t,e){return function(n){var i={},r=function(t){return t?i[t]:i},o=function(t,n){t&&("string"!=typeof t?e.each(t,function(t,e){o(e,t)}):(n=n.length?n:[n],e.each(n,function(t){"undefined"==typeof t.deep&&(t.deep=!t.selector),"undefined"==typeof t.split&&(t.split=!t.selector||t.inline),"undefined"==typeof t.remove&&t.selector&&!t.inline&&(t.remove="none"),t.selector&&t.inline&&(t.mixed=!0,t.block_expand=!0),"string"==typeof t.classes&&(t.classes=t.classes.split(/\s+/))}),i[t]=n))},a=function(t){return t&&i[t]&&delete i[t],i};return o(t.get(n.dom)),o(n.settings.formats),{get:r,register:o,unregister:a}}}),o("tinymce.core.fmt.Preview",["tinymce.core.dom.DOMUtils","tinymce.core.util.Tools","tinymce.core.html.Schema"],function(t,e,n){var i=e.each,r=t.DOM,o=function(t,i){var o,a,s,c=i&&i.schema||new n({}),u=function(t,e){e.classes.length&&r.addClass(t,e.classes.join(" ")),r.setAttribs(t,e.attrs)},l=function(t){var e;return a="string"==typeof t?{name:t,classes:[],attrs:{}}:t,e=r.create(a.name),u(e,a),e},h=function(t,n){var i="string"!=typeof t?t.nodeName.toLowerCase():t,r=c.getElementRule(i),o=r&&r.parentsRequired;return!(!o||!o.length)&&(n&&-1!==e.inArray(o,n)?n:o[0])},d=function(t,n,i){var o,a,s,c=n.length>0&&n[0],u=c&&c.name;if(s=h(t,u))u===s?(a=n[0],n=n.slice(1)):a=s;else if(c)a=n[0],n=n.slice(1);else if(!i)return t;return a&&(o=l(a)).appendChild(t),i&&(o||(o=r.create("div")).appendChild(t),e.each(i,function(e){var n=l(e);o.insertBefore(n,t)})),d(o,n,a&&a.siblings)};return t&&t.length?(a=t[0],o=l(a),(s=r.create("div")).appendChild(d(o,t.slice(1),a.siblings)),s):""},a=function(t,e){return o(c(t),e)},s=function(t){var n,i={classes:[],attrs:{}};return"*"!==(t=i.selector=e.trim(t))&&(n=t.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,function(t,n,r,o,a){switch(n){case"#":i.attrs.id=r;break;case".":i.classes.push(r);break;case":":-1!==e.inArray("checked disabled enabled read-only required".split(" "),r)&&(i.attrs[r]=r)}if("["===o){var s=a.match(/([\w\-]+)(?:\=\"([^\"]+))?/);s&&(i.attrs[s[1]]=s[2])}return""})),i.name=n||"div",i},c=function(t){return t&&"string"==typeof t?(t=t.split(/\s*,\s*/)[0],t=t.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),e.map(t.split(/(?:>|\s+(?![^\[\]]+\]))/),function(t){var n=e.map(t.split(/(?:~\+|~|\+)/),s),i=n.pop();return n.length&&(i.siblings=n),i}).reverse()):[]};return{getCssText:function(t,e){var n,a,s,u,l,h,d="";if(!1===(h=t.settings.preview_styles))return"";"string"!=typeof h&&(h="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow");var f=function(t){return t.replace(/%(\w+)/g,"")};if("string"==typeof e){if(!(e=t.formatter.get(e)))return;e=e[0]}return"preview"in e&&!1===(h=e.preview)?"":(n=e.block||e.inline||"span",(u=c(e.selector)).length?(u[0].name||(u[0].name=n),n=e.selector,a=o(u,t)):a=o([n],t),s=r.select(n,a)[0]||a.firstChild,i(e.styles,function(t,e){(t=f(t))&&r.setStyle(s,e,t)}),i(e.attributes,function(t,e){(t=f(t))&&r.setAttrib(s,e,t)}),i(e.classes,function(t){t=f(t),r.hasClass(s,t)||r.addClass(s,t)}),t.fire("PreviewFormats"),r.setStyles(a,{position:"absolute",left:-65535}),t.getBody().appendChild(a),
l=r.getStyle(t.getBody(),"fontSize",!0),l=/px$/.test(l)?parseInt(l,10):0,i(h.split(" "),function(e){var n=r.getStyle(s,e,!0);if(!("background-color"===e&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=r.getStyle(t.getBody(),e,!0),"#ffffff"===r.toHex(n).toLowerCase())||"color"===e&&"#000000"===r.toHex(n).toLowerCase())){if("font-size"===e&&/em|%$/.test(n)){if(0===l)return;n=(n=parseFloat(n,10)/(/%$/.test(n)?100:1))*l+"px"}"border"===e&&n&&(d+="padding:0 2px;"),d+=e+":"+n+";"}}),t.fire("AfterPreviewFormats"),r.remove(a),d)},parseSelector:c,selectorToHtml:a}}),o("tinymce.core.fmt.ToggleFormat",["tinymce.core.fmt.ApplyFormat","tinymce.core.fmt.MatchFormat","tinymce.core.fmt.RemoveFormat"],function(t,e,n){return{toggle:function(i,r,o,a,s){var c=r.get(o);!e.match(i,o,a,s)||"toggle"in c[0]&&!c[0].toggle?t.applyFormat(i,o,a,s):n.remove(i,o,a,s)}}}),o("tinymce.core.keyboard.FormatShortcuts",[],function(){return{setup:function(t){t.addShortcut("meta+b","","Bold"),t.addShortcut("meta+i","","Italic"),t.addShortcut("meta+u","","Underline");for(var e=1;e<=6;e++)t.addShortcut("access+"+e,"",["FormatBlock",!1,"h"+e]);t.addShortcut("access+7","",["FormatBlock",!1,"p"]),t.addShortcut("access+8","",["FormatBlock",!1,"div"]),t.addShortcut("access+9","",["FormatBlock",!1,"address"])}}}),o("tinymce.core.api.Formatter",["ephox.katamari.api.Cell","ephox.katamari.api.Fun","tinymce.core.fmt.ApplyFormat","tinymce.core.fmt.CaretFormat","tinymce.core.fmt.FormatChanged","tinymce.core.fmt.FormatRegistry","tinymce.core.fmt.MatchFormat","tinymce.core.fmt.Preview","tinymce.core.fmt.RemoveFormat","tinymce.core.fmt.ToggleFormat","tinymce.core.keyboard.FormatShortcuts"],function(t,e,n,i,r,o,a,s,c,u,l){return function(h){var d=o(h),f=t(null);return l.setup(h),i.setup(h),{get:d.get,register:d.register,unregister:d.unregister,apply:e.curry(n.applyFormat,h),remove:e.curry(c.remove,h),toggle:e.curry(u.toggle,h,d),match:e.curry(a.match,h),matchAll:e.curry(a.matchAll,h),matchNode:e.curry(a.matchNode,h),canApply:e.curry(a.canApply,h),formatChanged:e.curry(r.formatChanged,h,f),getCssText:e.curry(s.getCssText,h)}}}),o("ephox.katamari.api.Merger",["ephox.katamari.api.Type","global!Array","global!Error"],function(t,e,n){var i=function(t,e){return e},r=function(t){return function(){for(var i=new e(arguments.length),r=0;r<i.length;r++)i[r]=arguments[r];if(0===i.length)throw new n("Can't merge zero objects");for(var o={},a=0;a<i.length;a++){var s=i[a];for(var c in s)s.hasOwnProperty(c)&&(o[c]=t(o[c],s[c]))}return o}},o=r(function(e,n){return t.isObject(e)&&t.isObject(n)?o(e,n):n}),a=r(i);return{deepMerge:o,merge:a}}),o("tinymce.core.api.Events",[],function(){return{firePreProcess:function(t,e){return t.fire("PreProcess",e)},firePostProcess:function(t,e){return t.fire("PostProcess",e)}}}),o("tinymce.core.dom.DomSerializerFilters",["ephox.katamari.api.Arr","tinymce.core.html.Entities"],function(t,e){return{register:function(n,i,r){n.addAttributeFilter("data-mce-tabindex",function(t,e){for(var n,i=t.length;i--;)(n=t[i]).attr("tabindex",n.attributes.map["data-mce-tabindex"]),n.attr(e,null)}),n.addAttributeFilter("src,href,style",function(t,e){for(var n,o,a,s=t.length,c="data-mce-"+e,u=i.url_converter,l=i.url_converter_scope;s--;)(o=(n=t[s]).attributes.map[c])!==a?(n.attr(e,o.length>0?o:null),n.attr(c,null)):(o=n.attributes.map[e],"style"===e?o=r.serializeStyle(r.parseStyle(o),n.name):u&&(o=u.call(l,o,e,n.name)),n.attr(e,o.length>0?o:null))}),n.addAttributeFilter("class",function(t){for(var e,n,i=t.length;i--;)(n=(e=t[i]).attr("class"))&&(n=e.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),e.attr("class",n.length>0?n:null))}),n.addAttributeFilter("data-mce-type",function(t,e,n){for(var i,r=t.length;r--;)"bookmark"!==(i=t[r]).attributes.map["data-mce-type"]||n.cleanup||i.remove()}),n.addNodeFilter("noscript",function(t){for(var n,i=t.length;i--;)(n=t[i].firstChild)&&(n.value=e.decode(n.value))}),n.addNodeFilter("script,style",function(t,e){for(var n,r,o,a=t.length,s=function(t){return t.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};a--;)r=(n=t[a]).firstChild?n.firstChild.value:"","script"===e?((o=n.attr("type"))&&n.attr("type","mce-no/type"===o?null:o.replace(/^mce\-/,"")),"xhtml"===i.element_format&&r.length>0&&(n.firstChild.value="// <![CDATA[\n"+s(r)+"\n// ]]>")):"xhtml"===i.element_format&&r.length>0&&(n.firstChild.value="<!--\n"+s(r)+"\n-->")}),n.addNodeFilter("#comment",function(t){for(var e,n=t.length;n--;)0===(e=t[n]).value.indexOf("[CDATA[")?(e.name="#cdata",e.type=4,e.value=e.value.replace(/^\[CDATA\[|\]\]$/g,"")):0===e.value.indexOf("mce:protected ")&&(e.name="#text",e.type=3,e.raw=!0,e.value=unescape(e.value).substr(14))}),n.addNodeFilter("xml:namespace,input",function(t,e){for(var n,i=t.length;i--;)7===(n=t[i]).type?n.remove():1===n.type&&("input"!==e||"type"in n.attributes.map||n.attr("type","text"))}),n.addAttributeFilter("data-mce-type",function(e){t.each(e,function(t){"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(n.schema.getNonEmptyElements())?t.remove():t.unwrap())})}),n.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize",function(t,e){for(var n=t.length;n--;)t[n].attr(e,null)})},trimTrailingBr:function(t){var e,n,i=function(t){return t&&"br"===t.name};i(e=t.lastChild)&&i(n=e.prev)&&(e.remove(),n.remove())}}}),o("tinymce.core.dom.DomSerializerPreProcess",["ephox.katamari.api.Merger","global!document","tinymce.core.api.Events","tinymce.core.util.Tools"],function(t,e,n,i){var r=function(r,o,a){var s,c,u,l=r.dom;return o=o.cloneNode(!0),(s=e.implementation).createHTMLDocument&&(c=s.createHTMLDocument(""),i.each("BODY"===o.nodeName?o.childNodes:[o],function(t){c.body.appendChild(c.importNode(t,!0))}),o="BODY"!==o.nodeName?c.body.firstChild:c.body,u=l.doc,l.doc=c),n.firePreProcess(r,t.merge(a,{node:o})),u&&(l.doc=u),o},o=function(t,e){return t&&t.hasEventListeners("PreProcess")&&!e.no_events};return{process:function(t,e,n){return o(t,n)?r(t,e,n):e}}}),o("tinymce.core.html.LegacyFilter",["ephox.katamari.api.Arr","tinymce.core.html.Styles","tinymce.core.util.Tools"],function(t,e,n){var i=function(e,n){t.each(n,function(t){e.attr(t,null)})},r=function(e,n,r){e.addNodeFilter("font",function(e){t.each(e,function(t){var e=n.parse(t.attr("style")),o=t.attr("color"),a=t.attr("face"),s=t.attr("size");o&&(e.color=o),a&&(e["font-family"]=a),s&&(e["font-size"]=r[parseInt(t.attr("size"),10)-1]),t.name="span",t.attr("style",n.serialize(e)),i(t,["color","face","size"])})})},o=function(e,n){e.addNodeFilter("strike",function(e){t.each(e,function(t){var e=n.parse(t.attr("style"));e["text-decoration"]="line-through",t.name="span",t.attr("style",n.serialize(e))})})},a=function(t,i){var a=e();i.convert_fonts_to_spans&&r(t,a,n.explode(i.font_size_legacy_values)),o(t,a)};return{register:function(t,e){e.inline_styles&&a(t,e)}}}),o("tinymce.core.html.Node",[],function(){var t=/^[ \t\r\n]*$/,e={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},n=function(t,e,n){var i,r,o=n?"lastChild":"firstChild",a=n?"prev":"next";if(t[o])return t[o];if(t!==e){if(i=t[a])return i;for(r=t.parent;r&&r!==e;r=r.parent)if(i=r[a])return i}},i=function(t,e){this.name=t,this.type=e,1===e&&(this.attributes=[],this.attributes.map={})};return i.prototype={replace:function(t){var e=this;return t.parent&&t.remove(),e.insert(t,e),e.remove(),e},attr:function(t,e){var n,i,r,o=this;if("string"!=typeof t){for(i in t)o.attr(i,t[i]);return o}if(n=o.attributes){if(e!==r){if(null===e){if(t in n.map)for(delete n.map[t],i=n.length;i--;)if(n[i].name===t)return n=n.splice(i,1),o;return o}if(t in n.map){for(i=n.length;i--;)if(n[i].name===t){n[i].value=e;break}}else n.push({name:t,value:e});return n.map[t]=e,o}return n.map[t]}},clone:function(){var t,e,n,r,o,a=this,s=new i(a.name,a.type);if(n=a.attributes){for((o=[]).map={},t=0,e=n.length;t<e;t++)"id"!==(r=n[t]).name&&(o[o.length]={name:r.name,value:r.value},o.map[r.name]=r.value);s.attributes=o}return s.value=a.value,s.shortEnded=a.shortEnded,s},wrap:function(t){var e=this;return e.parent.insert(t,e),t.append(e),e},unwrap:function(){var t,e,n=this;for(t=n.firstChild;t;)e=t.next,n.insert(t,n,!0),t=e;n.remove()},remove:function(){var t=this,e=t.parent,n=t.next,i=t.prev;return e&&(e.firstChild===t?(e.firstChild=n,n&&(n.prev=null)):i.next=n,e.lastChild===t?(e.lastChild=i,i&&(i.next=null)):n.prev=i,t.parent=t.next=t.prev=null),t},append:function(t){var e,n=this;return t.parent&&t.remove(),(e=n.lastChild)?(e.next=t,t.prev=e,n.lastChild=t):n.lastChild=n.firstChild=t,t.parent=n,t},insert:function(t,e,n){var i;return t.parent&&t.remove(),i=e.parent||this,n?(e===i.firstChild?i.firstChild=t:e.prev.next=t,t.prev=e.prev,t.next=e,e.prev=t):(e===i.lastChild?i.lastChild=t:e.next.prev=t,t.next=e.next,t.prev=e,e.next=t),t.parent=i,t},getAll:function(t){var e,i=this,r=[];for(e=i.firstChild;e;e=n(e,i))e.name===t&&r.push(e);return r},empty:function(){var t,e,i,r=this;if(r.firstChild){for(t=[],i=r.firstChild;i;i=n(i,r))t.push(i);for(e=t.length;e--;)(i=t[e]).parent=i.firstChild=i.lastChild=i.next=i.prev=null}return r.firstChild=r.lastChild=null,r},isEmpty:function(e,i,r){var o,a,s=this,c=s.firstChild;if(i=i||{},c)do{if(1===c.type){if(c.attributes.map["data-mce-bogus"])continue;if(e[c.name])return!1;for(o=c.attributes.length;o--;)if("name"===(a=c.attributes[o].name)||0===a.indexOf("data-mce-bookmark"))return!1}if(8===c.type)return!1;if(3===c.type&&!t.test(c.value))return!1;if(3===c.type&&c.parent&&i[c.parent.name]&&t.test(c.value))return!1;if(r&&r(c))return!1}while(c=n(c,s));return!0},walk:function(t){return n(this,null,t)}},i.create=function(t,n){var r,o;if(r=new i(t,e[t]||1),n)for(o in n)r.attr(o,n[o]);return r},i}),o("tinymce.core.html.DomParser",["tinymce.core.html.LegacyFilter","tinymce.core.html.Node","tinymce.core.html.SaxParser","tinymce.core.html.Schema","tinymce.core.util.Tools"],function(t,e,n,i,r){var o=r.makeMap,a=r.each,s=r.explode,c=r.extend,u=function(t,n,i,r){(t.padd_empty_with_br||n.insert)&&i[r.name]?r.empty().append(new e("br","1")).shortEnded=!0:r.empty().append(new e("#text","3")).value="\xa0"},l=function(t){return h(t,"#text")&&"\xa0"===t.firstChild.value},h=function(t,e){return t&&t.firstChild&&t.firstChild===t.lastChild&&t.firstChild.name===e},d=function(t,e){var n=t.getElementRule(e.name);return n&&n.paddEmpty},f=function(t,e,n,i){return i.isEmpty(e,n,function(e){return d(t,e)})};return function(d,p){var m=this,g={},v=[],y={},b={};(d=d||{}).validate=!("validate"in d)||d.validate,d.root_name=d.root_name||"body",m.schema=p=p||new i;var _=function(t){var n,i,r,a,s,c,u,l,d,g,v,y,b,_,x,w;for(y=o("tr,td,th,tbody,thead,tfoot,table"),g=p.getNonEmptyElements(),v=p.getWhiteSpaceElements(),b=p.getTextBlockElements(),_=p.getSpecialElements(),n=0;n<t.length;n++)if((i=t[n]).parent&&!i.fixed)if(b[i.name]&&"li"==i.parent.name){for(x=i.next;x&&b[x.name];)x.name="li",x.fixed=!0,i.parent.insert(x,i.parent),x=x.next;i.unwrap(i)}else{for(a=[i],r=i.parent;r&&!p.isValidChild(r.name,i.name)&&!y[r.name];r=r.parent)a.push(r);if(r&&a.length>1){for(a.reverse(),s=c=m.filterNode(a[0].clone()),d=0;d<a.length-1;d++){for(p.isValidChild(c.name,a[d].name)?(u=m.filterNode(a[d].clone()),c.append(u)):u=c,l=a[d].firstChild;l&&l!=a[d+1];)w=l.next,u.append(l),l=w;c=u}f(p,g,v,s)?r.insert(i,a[0],!0):(r.insert(s,a[0],!0),r.insert(i,s)),r=a[0],(f(p,g,v,r)||h(r,"br"))&&r.empty().remove()}else if(i.parent){if("li"===i.name){if((x=i.prev)&&("ul"===x.name||"ul"===x.name)){x.append(i);continue}if((x=i.next)&&("ul"===x.name||"ul"===x.name)){x.insert(i,x.firstChild,!0);continue}i.wrap(m.filterNode(new e("ul",1)));continue}p.isValidChild(i.parent.name,"div")&&p.isValidChild("div",i.name)?i.wrap(m.filterNode(new e("div",1))):_[i.name]?i.empty().remove():i.unwrap()}}};m.filterNode=function(t){var e,n,i;n in g&&((i=y[n])?i.push(t):y[n]=[t]),e=v.length;for(;e--;)(n=v[e].name)in t.attributes.map&&((i=b[n])?i.push(t):b[n]=[t]);return t},m.addNodeFilter=function(t,e){a(s(t),function(t){var n=g[t];n||(g[t]=n=[]),n.push(e)})},m.addAttributeFilter=function(t,e){a(s(t),function(t){var n;for(n=0;n<v.length;n++)if(v[n].name===t)return void v[n].callbacks.push(e);v.push({name:t,callbacks:[e]})})},m.parse=function(t,i){var r,a,s,h,m,x,w,S,k,E,T,C,L,P,A,N,R,I,D,O,B,M=[];i=i||{},y={},b={},C=c(o("script,style,head,html,body,title,meta,param"),p.getBlockElements()),O=p.getNonEmptyElements(),D=p.children,T=d.validate,B="forced_root_block"in i?i.forced_root_block:d.forced_root_block,I=p.getWhiteSpaceElements(),L=/^[ \t\r\n]+/,A=/[ \t\r\n]+$/,N=/[ \t\r\n]+/g,R=/^[ \t\r\n]+$/;var F=function(){var t,e,n=a.firstChild,i=function(t){t&&((n=t.firstChild)&&3==n.type&&(n.value=n.value.replace(L,"")),(n=t.lastChild)&&3==n.type&&(n.value=n.value.replace(A,"")))};if(p.isValidChild(a.name,B.toLowerCase())){for(;n;)t=n.next,3==n.type||1==n.type&&"p"!==n.name&&!C[n.name]&&!n.attr("data-mce-type")?e?e.append(n):((e=z(B,1)).attr(d.forced_root_block_attrs),a.insert(e,n),e.append(n)):(i(e),e=null),n=t;i(e)}},z=function(t,n){var i,r=new e(t,n);return t in g&&((i=y[t])?i.push(r):y[t]=[r]),r},j=function(t){var e,n,i,r,o=p.getBlockElements();for(e=t.prev;e&&3===e.type;){if((i=e.value.replace(A,"")).length>0)return void(e.value=i);if(n=e.next){if(3==n.type&&n.value.length){e=e.prev;continue}if(!o[n.name]&&"script"!=n.name&&"style"!=n.name){e=e.prev;continue}}r=e.prev,e.remove(),e=r}},H=function(t){var e,n={};for(e in t)"li"!==e&&"p"!=e&&(n[e]=t[e]);return n};if(r=new n({validate:T,allow_script_urls:d.allow_script_urls,allow_conditional_comments:d.allow_conditional_comments,self_closing_elements:H(p.getSelfClosingElements()),cdata:function(t){s.append(z("#cdata",4)).value=t},text:function(t,e){var n;P||(t=t.replace(N," "),s.lastChild&&C[s.lastChild.name]&&(t=t.replace(L,""))),0!==t.length&&((n=z("#text",3)).raw=!!e,s.append(n).value=t)},comment:function(t){s.append(z("#comment",8)).value=t},pi:function(t,e){s.append(z(t,7)).value=e,j(s)},doctype:function(t){s.append(z("#doctype",10)).value=t,j(s)},start:function(t,e,n){var i,r,o,a,c;if(o=T?p.getElementRule(t):{}){for((i=z(o.outputName||t,1)).attributes=e,i.shortEnded=n,s.append(i),(c=D[s.name])&&D[i.name]&&!c[i.name]&&M.push(i),r=v.length;r--;)(a=v[r].name)in e.map&&((k=b[a])?k.push(i):b[a]=[i]);C[t]&&j(i),n||(s=i),!P&&I[t]&&(P=!0)}},end:function(t){var e,n,r,o,a;if(n=T?p.getElementRule(t):{}){if(C[t]&&!P){if((e=s.firstChild)&&3===e.type)if((r=e.value.replace(L,"")).length>0)e.value=r,e=e.next;else for(o=e.next,e.remove(),e=o;e&&3===e.type;)r=e.value,o=e.next,(0===r.length||R.test(r))&&(e.remove(),e=o),e=o;if((e=s.lastChild)&&3===e.type)if((r=e.value.replace(A,"")).length>0)e.value=r,e=e.prev;else for(o=e.prev,e.remove(),e=o;e&&3===e.type;)r=e.value,o=e.prev,(0===r.length||R.test(r))&&(e.remove(),e=o),e=o}if(P&&I[t]&&(P=!1),n.removeEmpty&&f(p,O,I,s)&&!s.attributes.map.name&&!s.attributes.map.id)return a=s.parent,C[s.name]?s.empty().remove():s.unwrap(),void(s=a);n.paddEmpty&&(l(s)||f(p,O,I,s))&&u(d,i,C,s),s=s.parent}}},p),a=s=new e(i.context||d.root_name,11),r.parse(t),T&&M.length&&(i.context?i.invalid=!0:_(M)),B&&("body"==a.name||i.isRootContent)&&F(),!i.invalid){for(E in y){for(k=g[E],w=(h=y[E]).length;w--;)h[w].parent||h.splice(w,1);for(m=0,x=k.length;m<x;m++)k[m](h,E,i)}for(m=0,x=v.length;m<x;m++)if((k=v[m]).name in b){for(w=(h=b[k.name]).length;w--;)h[w].parent||h.splice(w,1);for(w=0,S=k.callbacks.length;w<S;w++)k.callbacks[w](h,k.name,i)}}return a},d.remove_trailing_brs&&m.addNodeFilter("br",function(t,n,i){var r,o,a,s,l,h,m,g,v=t.length,y=c({},p.getBlockElements()),b=p.getNonEmptyElements(),_=p.getNonEmptyElements();for(y.body=1,r=0;r<v;r++)if(o=t[r],a=o.parent,y[o.parent.name]&&o===a.lastChild){for(l=o.prev;l;){if("span"!==(h=l.name)||"bookmark"!==l.attr("data-mce-type")){if("br"!==h)break;if("br"===h){o=null;break}}l=l.prev}o&&(o.remove(),f(p,b,_,a)&&(m=p.getElementRule(a.name))&&(m.removeEmpty?a.remove():m.paddEmpty&&u(d,i,y,a)))}else{for(s=o;a&&a.firstChild===s&&a.lastChild===s&&(s=a,!y[a.name]);)a=a.parent;s===a&&!0!==d.padd_empty_with_br&&((g=new e("#text",3)).value="\xa0",o.replace(g))}}),m.addAttributeFilter("href",function(t){var e,n=t.length,i=function(t){return t.split(" ").filter(function(t){return t.length>0}).concat(["noopener"]).sort().join(" ")},o=function(t){var e=t?r.trim(t):"";return/\b(noopener)\b/g.test(e)?e:i(e)};if(!d.allow_unsafe_link_target)for(;n--;)"a"===(e=t[n]).name&&"_blank"===e.attr("target")&&e.attr("rel",o(e.attr("rel")))}),d.allow_html_in_named_anchor||m.addAttributeFilter("id,name",function(t){for(var e,n,i,r,o=t.length;o--;)if("a"===(r=t[o]).name&&r.firstChild&&!r.attr("href")){i=r.parent,e=r.lastChild;do{n=e.prev,i.insert(e,r),e=n}while(e)}}),d.fix_list_elements&&m.addNodeFilter("ul,ol",function(t){for(var n,i,r=t.length;r--;)if(n=t[r],"ul"===(i=n.parent).name||"ol"===i.name)if(n.prev&&"li"===n.prev.name)n.prev.append(n);else{var o=new e("li",1);o.attr("style","list-style-type: none"),n.wrap(o)}}),d.validate&&p.getValidClasses()&&m.addAttributeFilter("class",function(t){for(var e,n,i,r,o,a,s,c=t.length,u=p.getValidClasses();c--;){for(n=(e=t[c]).attr("class").split(" "),o="",i=0;i<n.length;i++)r=n[i],s=!1,(a=u["*"])&&a[r]&&(s=!0),a=u[e.name],!s&&a&&a[r]&&(s=!0),s&&(o&&(o+=" "),o+=r);o.length||(o=null),e.attr("class",o)}}),t.register(this,d)}}),o("tinymce.core.dom.DomSerializer",["ephox.katamari.api.Fun","ephox.katamari.api.Merger","tinymce.core.api.Events","tinymce.core.dom.DOMUtils","tinymce.core.dom.DomSerializerFilters","tinymce.core.dom.DomSerializerPreProcess","tinymce.core.html.DomParser","tinymce.core.html.Schema","tinymce.core.html.Serializer","tinymce.core.text.Zwsp","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c,u,l){var h=function(t,e,n){-1===l.inArray(e,n)&&(t.addAttributeFilter(n,function(t,e){for(var n=t.length;n--;)t[n].attr(e,null)}),e.push(n))},d=function(t,i,r){if(!i.no_events&&t){return n.firePostProcess(t,e.merge(i,{content:r})).content}return r},f=function(t,e,n){var i=u.trim(n.getInner?e.innerHTML:t.getOuterHTML(e));return n.selection?i:l.trim(i)},p=function(t,n,i,o){var a=o.selection?e.merge({forced_root_block:!1},o):o,s=t.parse(i,a);return r.trimTrailingBr(s),s},m=function(t,e,n){return new c(t,e).serialize(n)},g=function(t,e,n,i,r){var o=m(e,n,i);return d(t,r,o)};return function(n,c){var u,l,d,m=["data-mce-selected"];u=c&&c.dom?c.dom:i.DOM,l=c&&c.schema?c.schema:new s(n),n.entity_encoding=n.entity_encoding||"named",n.remove_trailing_brs=!("remove_trailing_brs"in n)||n.remove_trailing_brs,d=new a(n,l),r.register(d,n,u);var v=function(t,i){var r=e.merge({format:"html"},i||{}),a=o.process(c,t,r),s=f(u,a,r),h=p(d,u,s,r);return"tree"===r.format?h:g(c,n,l,h,r)};return{schema:l,addNodeFilter:d.addNodeFilter,addAttributeFilter:d.addAttributeFilter,serialize:v,addRules:function(t){l.addValidElements(t)},setRules:function(t){l.setValidElements(t)},addTempAttr:t.curry(h,d,m),getTempAttrs:function(){return m}}}}),o("tinymce.core.api.dom.Serializer",["tinymce.core.dom.DomSerializer"],function(t){return function(e,n){var i=new t(e,n);return{schema:i.schema,addNodeFilter:i.addNodeFilter,addAttributeFilter:i.addAttributeFilter,serialize:i.serialize,addRules:i.addRules,setRules:i.setRules,addTempAttr:i.addTempAttr,getTempAttrs:i.getTempAttrs}}}),o("tinymce.core.caret.CaretContainerInput",["ephox.katamari.api.Fun","ephox.sugar.api.node.Element","ephox.sugar.api.search.SelectorFind","tinymce.core.caret.CaretContainer"],function(t,e,n,i){var r=function(i){return n.descendant(e.fromDom(i.getBody()),"*[data-mce-caret]").fold(t.constant(null),function(t){return t.dom()})},o=function(t){t.selection.setRng(t.selection.getRng())},a=function(t,e){e.hasAttribute("data-mce-caret")&&(i.showCaretContainerBlock(e),o(t),t.selection.scrollIntoView(e))},s=function(t,e){var n=r(t);if(n)return"compositionstart"===e.type?(e.preventDefault(),e.stopPropagation(),void a(n)):void(i.hasContent(n)&&a(t,n))};return{setup:function(e){e.on("keyup compositionstart",t.curry(s,e))}}}),o("tinymce.core.api.dom.BookmarkManager",["ephox.katamari.api.Fun","tinymce.core.dom.Bookmarks"],function(t,e){var n=function(n){return{getBookmark:t.curry(e.getBookmark,n),moveToBookmark:t.curry(e.moveToBookmark,n)}};return n.isBookmarkNode=e.isBookmarkNode,n}),o("tinymce.core.dom.ControlSelection",["ephox.katamari.api.Fun","ephox.sugar.api.node.Element","ephox.sugar.api.search.Selectors","global!document","tinymce.core.dom.NodeType","tinymce.core.dom.RangePoint","tinymce.core.Env","tinymce.core.util.Delay","tinymce.core.util.Tools","tinymce.core.util.VK"],function(t,e,n,i,r,o,a,s,c,u){var l=r.isContentEditableFalse,h=r.isContentEditableTrue,d=function(t,e){for(;e&&e!=t;){if(h(e)||l(e))return e;e=e.parentNode}return null};return function(t,r){var h,f,p,m,g,v,y,b,_,x,w,S,k,E,T,C,L,P=r.dom,A=c.each,N=r.getDoc(),R=i,I=Math.abs,D=Math.round,O=r.getBody();m={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var B=".mce-content-body";r.contentStyles.push(B+" div.mce-resizehandle {position: absolute;border: 1px solid black;box-sizing: content-box;background: #FFF;width: 7px;height: 7px;z-index: 10000}"+B+" .mce-resizehandle:hover {background: #000}"+B+" img[data-mce-selected],"+B+" hr[data-mce-selected] {outline: 1px solid black;resize: none}"+B+" .mce-clonedresizable {position: absolute;"+(a.gecko?"":"outline: 1px dashed black;")+"opacity: .5;filter: alpha(opacity=50);z-index: 10000}"+B+" .mce-resize-helper {background: #555;background: rgba(0,0,0,0.75);border-radius: 3px;border: 1px;color: white;display: none;font-family: sans-serif;font-size: 12px;white-space: nowrap;line-height: 14px;margin: 5px 10px;padding: 5px;position: absolute;z-index: 10001}");var M=function(t){return t&&("IMG"===t.nodeName||r.dom.is(t,"figure.image"))},F=function(t,e){return M(t.target)&&!o.isXYWithinRange(t.clientX,t.clientY,e)},z=function(t){var e=t.target;F(t,r.selection.getRng())&&!t.isDefaultPrevented()&&(t.preventDefault(),r.selection.select(e))},j=function(t){return r.dom.is(t,"figure.image")?t.querySelector("img"):t},H=function(t){var i=r.settings.object_resizing;return!1!==i&&!a.iOS&&("string"!=typeof i&&(i="table,img,figure.image,div"),"false"!==t.getAttribute("data-mce-resize")&&(t!=r.getBody()&&n.is(e.fromDom(t),i)))},$=function(t){var e,n,i,o;e=t.screenX-v,n=t.screenY-y,E=e*g[2]+x,T=n*g[3]+w,E=E<5?5:E,T=T<5?5:T,(M(h)&&!1!==r.settings.resize_img_proportional?!u.modifierPressed(t):u.modifierPressed(t)||M(h)&&g[2]*g[3]!=0)&&(I(e)>I(n)?(T=D(E*S),E=D(T/S)):(E=D(T/S),T=D(E*S))),P.setStyles(j(f),{width:E,height:T}),i=g.startPos.x+e,o=g.startPos.y+n,i=i>0?i:0,o=o>0?o:0,P.setStyles(p,{left:i,top:o,display:"block"}),p.innerHTML=E+" &times; "+T,g[2]<0&&f.clientWidth<=E&&P.setStyle(f,"left",b+(x-E)),g[3]<0&&f.clientHeight<=T&&P.setStyle(f,"top",_+(w-T)),(e=O.scrollWidth-C)+(n=O.scrollHeight-L)!==0&&P.setStyles(p,{left:i-e,top:o-n}),k||(r.fire("ObjectResizeStart",{target:h,width:x,height:w}),k=!0)},U=function(){k=!1;var t=function(t,e){e&&(h.style[t]||!r.schema.isValid(h.nodeName.toLowerCase(),t)?P.setStyle(j(h),t,e):P.setAttrib(j(h),t,e))};t("width",E),t("height",T),P.unbind(N,"mousemove",$),P.unbind(N,"mouseup",U),R!=N&&(P.unbind(R,"mousemove",$),P.unbind(R,"mouseup",U)),P.remove(f),P.remove(p),q(h),r.fire("ObjectResized",{target:h,width:E,height:T}),P.setAttrib(h,"style",P.getAttrib(h,"style")),r.nodeChanged()},q=function(t){var e,n,i,o,s;W(),G(),e=P.getPos(t,O),b=e.x,_=e.y,s=t.getBoundingClientRect(),n=s.width||s.right-s.left,i=s.height||s.bottom-s.top,h!=t&&(h=t,E=T=0),o=r.fire("ObjectSelected",{target:t}),H(t)&&!o.isDefaultPrevented()?A(m,function(t,e){var r,o=function(e){v=e.screenX,y=e.screenY,x=j(h).clientWidth,w=j(h).clientHeight,S=w/x,g=t,t.startPos={x:n*t[0]+b,y:i*t[1]+_},C=O.scrollWidth,L=O.scrollHeight,f=h.cloneNode(!0),P.addClass(f,"mce-clonedresizable"),P.setAttrib(f,"data-mce-bogus","all"),f.contentEditable=!1,f.unSelectabe=!0,P.setStyles(f,{left:b,top:_,margin:0}),f.removeAttribute("data-mce-selected"),O.appendChild(f),P.bind(N,"mousemove",$),P.bind(N,"mouseup",U),R!=N&&(P.bind(R,"mousemove",$),P.bind(R,"mouseup",U)),p=P.add(O,"div",{"class":"mce-resize-helper","data-mce-bogus":"all"},x+" &times; "+w)};(r=P.get("mceResizeHandle"+e))&&P.remove(r),r=P.add(O,"div",{id:"mceResizeHandle"+e,"data-mce-bogus":"all","class":"mce-resizehandle",unselectable:!0,style:"cursor:"+e+"-resize; margin:0; padding:0"}),a.ie&&(r.contentEditable=!1),P.bind(r,"mousedown",function(t){t.stopImmediatePropagation(),t.preventDefault(),o(t)}),t.elm=r,P.setStyles(r,{left:n*t[0]+b-r.offsetWidth/2,top:i*t[1]+_-r.offsetHeight/2})}):W(),h.setAttribute("data-mce-selected","1")},W=function(){var t,e;G(),h&&h.removeAttribute("data-mce-selected");for(t in m)(e=P.get("mceResizeHandle"+t))&&(P.unbind(e),P.remove(e))},V=function(e){var n,i,o=function(t,e){if(t)do{if(t===e)return!0}while(t=t.parentNode)};k||r.removed||(A(P.select("img[data-mce-selected],hr[data-mce-selected]"),function(t){t.removeAttribute("data-mce-selected")}),i="mousedown"==e.type?e.target:t.getNode(),o(i=P.$(i).closest("table,img,figure.image,hr")[0],O)&&(K(),n=t.getStart(!0),o(n,i)&&o(t.getEnd(!0),i))?q(i):W())},Z=function(t){return l(d(r.getBody(),t))},G=function(){for(var t in m){var e=m[t];e.elm&&(P.unbind(e.elm),delete e.elm)}},K=function(){try{r.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(t){}};r.on("init",function(){K(),a.ie&&a.ie>=11&&(r.on("mousedown click",function(t){var e=t.target,n=e.nodeName;k||!/^(TABLE|IMG|HR)$/.test(n)||Z(e)||(2!==t.button&&r.selection.select(e,"TABLE"==n),"mousedown"==t.type&&r.nodeChanged())}),r.dom.bind(O,"mscontrolselect",function(t){var e=function(t){s.setEditorTimeout(r,function(){r.selection.select(t)})};if(Z(t.target))return t.preventDefault(),void e(t.target);/^(TABLE|IMG|HR)$/.test(t.target.nodeName)&&(t.preventDefault(),"IMG"==t.target.tagName&&e(t.target))}));var t=s.throttle(function(t){r.composing||V(t)});r.on("nodechange ResizeEditor ResizeWindow drop",t),r.on("keyup compositionend",function(e){h&&"TABLE"==h.nodeName&&t(e)}),r.on("hide blur",W),r.on("contextmenu",z)}),r.on("remove",G);return{isResizable:H,showResizeRect:q,hideResizeRect:W,updateResizeRect:V,destroy:function(){h=f=null}}}}),o("tinymce.core.dom.ScrollIntoView",["tinymce.core.dom.NodeType"],function(t){var e=function(t){for(var e=0,n=0,i=t;i&&i.nodeType;)e+=i.offsetLeft||0,n+=i.offsetTop||0,i=i.offsetParent;return{x:e,y:n}},n=function(t,e,n){var i={elm:e,alignToTop:n};return t.fire("scrollIntoView",i),i.isDefaultPrevented()};return{scrollIntoView:function(i,r,o){var a,s,c,u,l=i.dom,h=l.getRoot(),d=0;if(!n(i,r,o)&&t.isElement(r)){if(!1===o&&(d=r.offsetHeight),"BODY"!==h.nodeName){var f=i.selection.getScrollContainer();if(f)return a=e(r).y-e(f).y+d,u=f.clientHeight,c=f.scrollTop,void((a<c||a+25>c+u)&&(f.scrollTop=a<c?a:a-u+25))}s=l.getViewPort(i.getWin()),a=l.getPos(r).y+d,c=s.y,u=s.h,(a<s.y||a+25>c+u)&&i.getWin().scrollTo(0,a<c?a:a-u+25)}}}}),o("tinymce.core.selection.CaretRangeFromPoint",["tinymce.core.dom.NodeType","tinymce.core.util.Tools"],function(t,e){var n=function(e){return t.isContentEditableTrue(e)||t.isContentEditableFalse(e)},i=function(t,e,n){for(;t&&t!==e;){if(n(t))return t;t=t.parentNode}return null},r=function(t,n,i){var r,o,a;if(r=i.elementFromPoint(t,n),o=i.body.createTextRange(),r&&"HTML"!==r.tagName||(r=i.body),o.moveToElementText(r),a=e.toArray(o.getClientRects()),(a=a.sort(function(t,e){return t=Math.abs(Math.max(t.top-n,t.bottom-n)),e=Math.abs(Math.max(e.top-n,e.bottom-n)),t-e})).length>0){n=(a[0].bottom+a[0].top)/2;try{return o.moveToPoint(t,n),o.collapse(!0),o}catch(s){}}return null},o=function(e,r){var o=e&&e.parentElement?e.parentElement():null;return t.isContentEditableFalse(i(o,r,n))?null:e};return{fromPoint:function(t,e,n){var i,a;if(n.caretPositionFromPoint)(a=n.caretPositionFromPoint(t,e))&&((i=n.createRange()).setStart(a.offsetNode,a.offset),i.collapse(!0));else if(n.caretRangeFromPoint)i=n.caretRangeFromPoint(t,e);else if(n.body.createTextRange){i=n.body.createTextRange();try{i.moveToPoint(t,e),i.collapse(!0)}catch(s){i=r(t,e,n)}return o(i,n.body)}return i}}}),o("tinymce.core.selection.EventProcessRanges",["ephox.katamari.api.Arr"],function(t){return{processRanges:function(e,n){return t.map(n,function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t})}}}),o("ephox.sugar.api.dom.Replication",["ephox.sugar.api.properties.Attr","ephox.sugar.api.node.Element","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Remove","ephox.sugar.api.search.Traverse"],function(t,e,n,i,r,o){var a=function(t,n){return e.fromDom(t.dom().cloneNode(n))},s=function(t){return a(t,!0)},c=function(n,i){var r=e.fromTag(i),o=t.clone(n);return t.setAll(r,o),r};return{shallow:function(t){return a(t,!1)},shallowAs:c,deep:s,copy:function(t,e){var n=c(t,e),r=o.children(s(t));return i.append(n,r),n},mutate:function(t,e){var a=c(t,e);n.before(t,a);var s=o.children(t);return i.append(a,s),r.remove(t),a}}}),o("ephox.sugar.api.node.Fragment",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","global!document"],function(t,e,n){return{fromElements:function(i,r){var o=(r||n).createDocumentFragment();return t.each(i,function(t){o.appendChild(t.dom())}),e.fromDom(o)}}}),o("tinymce.core.selection.SelectionUtils",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.katamari.api.Options","ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","ephox.sugar.api.search.Traverse","tinymce.core.dom.NodeType"],function(t,e,n,i,r,o,a,s,c){var u=function(t){var e=t.startContainer,i=t.startOffset;return c.isText(e)?0===i?n.some(o.fromDom(e)):n.none():n.from(e.childNodes[i]).map(o.fromDom)},l=function(t){var e=t.endContainer,i=t.endOffset;return c.isText(e)?i===e.data.length?n.some(o.fromDom(e)):n.none():n.from(e.childNodes[i-1]).map(o.fromDom)},h=function(t){return s.firstChild(t).fold(e.constant([t]),function(e){return[t].concat(h(e))})},d=function(t){return s.lastChild(t).fold(e.constant([t]),function(e){return"br"===a.name(e)?s.prevSibling(e).map(function(e){return[t].concat(d(e))}).getOr([]):[t].concat(d(e))})};return{hasAllContentsSelected:function(n,o){return i.liftN([u(o),l(o)],function(i,o){var a=t.find(h(n),e.curry(r.eq,i)),s=t.find(d(n),e.curry(r.eq,o));return a.isSome()&&s.isSome()}).getOr(!1)}}}),o("tinymce.core.selection.SimpleTableModel",["ephox.katamari.api.Arr","ephox.katamari.api.Option","ephox.katamari.api.Struct","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.InsertAll","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.search.SelectorFilter"],function(t,e,n,i,r,o,a,s,c,u){var l=n.immutable("element","width","rows"),h=n.immutable("element","cells"),d=n.immutable("x","y"),f=function(t,e){var n=parseInt(c.get(t,e),10);return isNaN(n)?1:n},p=function(t,e,n,i,r){for(var o=f(r,"rowspan"),s=f(r,"colspan"),c=t.rows(),u=n;u<n+o;u++){c[u]||(c[u]=h(a.deep(i),[]));for(var l=e;l<e+s;l++){c[u].cells()[l]=u==n&&l==e?r:a.shallow(r)}}},m=function(t,e,n){var i=t.rows();return!!(i[n]?i[n].cells():[])[e]},g=function(t,e,n){for(;m(t,e,n);)e++;return e},v=function(e){return t.foldl(e,function(t,e){return e.cells().length>t?e.cells().length:t},0)},y=function(t,n){for(var r=t.rows(),o=0;o<r.length;o++)for(var a=r[o].cells(),s=0;s<a.length;s++)if(i.eq(a[s],n))return e.some(d(s,o));return e.none()},b=function(t,e,n,i,r){for(var o=[],a=t.rows(),s=n;s<=r;s++){var c=a[s].cells(),u=e<i?c.slice(e,i+1):c.slice(i,e+1);o.push(h(a[s].element(),u))}return o},_=function(t,e,n){var i=e.x(),r=e.y(),o=n.x(),a=n.y(),s=r<a?b(t,i,r,o,a):b(t,i,a,o,r);return l(t.element(),v(s),s)},x=function(t,e){var n=a.shallow(t.element()),i=s.fromTag("tbody");return o.append(i,e),r.append(n,i),n},w=function(e){return t.map(e.rows(),function(e){var n=t.map(e.cells(),function(t){var e=a.deep(t);return c.remove(e,"colspan"),c.remove(e,"rowspan"),e}),i=a.shallow(e.element());return o.append(i,n),i})};return{fromDom:function(e){var n=l(a.shallow(e),0,[]);return t.each(u.descendants(e,"tr"),function(e,i){t.each(u.descendants(e,"td,th"),function(t,r){p(n,g(n,r,i),i,e,t)})}),l(n.element(),v(n.rows()),n.rows())},toDom:function(t){return x(t,w(t))},subsection:function(t,e,n){return y(t,e).bind(function(e){return y(t,n).map(function(n){return _(t,e,n)})})}}}),
o("tinymce.core.selection.FragmentReader",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.dom.Compare","ephox.sugar.api.dom.Insert","ephox.sugar.api.dom.Replication","ephox.sugar.api.node.Element","ephox.sugar.api.node.Fragment","ephox.sugar.api.node.Node","ephox.sugar.api.search.SelectorFind","ephox.sugar.api.search.Traverse","tinymce.core.dom.ElementType","tinymce.core.dom.Parents","tinymce.core.selection.SelectionUtils","tinymce.core.selection.SimpleTableModel","tinymce.core.selection.TableCellSelection"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p){var m=function(e){return t.find(e,function(t){return"ul"===s.name(t)||"ol"===s.name(t)})},g=function(n,i){return t.find(n,function(t){return"li"===s.name(t)&&d.hasAllContentsSelected(t,i)}).fold(e.constant([]),function(){return m(n).map(function(t){return[o.fromTag("li"),o.fromTag(s.name(t))]}).getOr([])})},v=function(e,n){var r=t.foldl(n,function(t,e){return i.append(e,t),e},e);return n.length>0?a.fromElements([r]):r},y=function(t){return l.isListItem(t)?u.parent(t).filter(l.isList).fold(e.constant([]),function(e){return[t,e]}):l.isList(t)?[t]:[]},b=function(e,n){var i=o.fromDom(n.commonAncestorContainer),a=h.parentsAndSelf(i,e),s=t.filter(a,function(t){return l.isInline(t)||l.isHeading(t)}),c=g(a,n),u=s.concat(c.length?c:y(i));return t.map(u,r.shallow)},_=function(){return a.fromElements([])},x=function(t,e){return v(o.fromDom(e.cloneContents()),b(t,e))},w=function(t,i){return c.ancestor(i,"table",e.curry(n.eq,t))},S=function(t,e){return w(t,e[0]).bind(function(t){var n=e[0],i=e[e.length-1],r=f.fromDom(t);return f.subsection(r,n,i).map(function(t){return a.fromElements([f.toDom(t)])})}).getOrThunk(_)},k=function(t,e){return e.length>0&&e[0].collapsed?_():x(t,e[0])};return{read:function(t,e){var n=p.getCellsFromElementOrRanges(e,t);return n.length>0?S(t,n):k(t,e)}}}),o("tinymce.core.selection.GetSelectionContent",["ephox.sugar.api.node.Element","tinymce.core.selection.EventProcessRanges","tinymce.core.selection.FragmentReader","tinymce.core.selection.MultiRange","tinymce.core.text.Zwsp"],function(t,e,n,i,r){return{getContent:function(o,a){var s,c=o.selection.getRng(),u=o.dom.create("body"),l=o.selection.getSel(),h=e.processRanges(o,i.getRanges(l));if(a=a||{},a.get=!0,a.format=a.format||"html",a.selection=!0,(a=o.fire("BeforeGetContent",a)).isDefaultPrevented())return o.fire("GetContent",a),a.content;if("text"===a.format)return o.selection.isCollapsed()?"":r.trim(c.text||(l.toString?l.toString():""));c.cloneContents?(s=a.contextual?n.read(t.fromDom(o.getBody()),h).dom():c.cloneContents())&&u.appendChild(s):c.item!==undefined||c.htmlText!==undefined?(u.innerHTML="<br>"+(c.item?c.item(0).outerHTML:c.htmlText),u.removeChild(u.firstChild)):u.innerHTML=c.toString(),a.getInner=!0;var d=o.selection.serializer.serialize(u,a);return"tree"===a.format?d:(a.content=o.selection.isCollapsed()?"":d,o.fire("GetContent",a),a.content)}}}),o("tinymce.core.selection.SetSelectionContent",[],function(){return{setContent:function(t,e,n){var i,r,o,a=t.selection.getRng(),s=t.getDoc();if(n=n||{format:"html"},n.set=!0,n.selection=!0,n.content=e,n.no_events||!(n=t.fire("BeforeSetContent",n)).isDefaultPrevented()){if(e=n.content,a.insertNode){e+='<span id="__caret">_</span>',a.startContainer==s&&a.endContainer==s?s.body.innerHTML=e:(a.deleteContents(),0===s.body.childNodes.length?s.body.innerHTML=e:a.createContextualFragment?a.insertNode(a.createContextualFragment(e)):(r=s.createDocumentFragment(),o=s.createElement("div"),r.appendChild(o),o.outerHTML=e,a.insertNode(r))),i=t.dom.get("__caret"),(a=s.createRange()).setStartBefore(i),a.setEndBefore(i),t.selection.setRng(a),t.dom.remove("__caret");try{t.selection.setRng(a)}catch(c){}}else a.item&&(s.execCommand("Delete",!1,null),a=t.getRng()),/^\s+/.test(e)?(a.pasteHTML('<span id="__mce_tmp">_</span>'+e),t.dom.remove("__mce_tmp")):a.pasteHTML(e);n.no_events||t.fire("SetContent",n)}else t.fire("SetContent",n)}}}),o("tinymce.core.dom.Selection",["ephox.sugar.api.dom.Compare","ephox.sugar.api.node.Element","tinymce.core.Env","tinymce.core.api.dom.BookmarkManager","tinymce.core.caret.CaretPosition","tinymce.core.dom.ControlSelection","tinymce.core.dom.ScrollIntoView","tinymce.core.dom.TreeWalker","tinymce.core.focus.EditorFocus","tinymce.core.selection.CaretRangeFromPoint","tinymce.core.selection.EventProcessRanges","tinymce.core.selection.GetSelectionContent","tinymce.core.selection.MultiRange","tinymce.core.selection.NormalizeRange","tinymce.core.selection.SelectionBookmark","tinymce.core.selection.SetSelectionContent","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p,m,g){var v=g.each,y=g.trim,b=function(n){return!(!n||!n.ownerDocument)&&t.contains(e.fromDom(n.ownerDocument),e.fromDom(n))},_=function(t){return!!t&&(!!t.select||b(t.startContainer)&&b(t.endContainer))},x=function(t,e,n,r){var a=this;a.dom=t,a.win=e,a.serializer=n,a.editor=r,a.bookmarkManager=new i(a),a.controlSelection=new o(a,r)};return x.prototype={setCursorLocation:function(t,e){var n=this,i=n.dom.createRng();t?(i.setStart(t,e),i.setEnd(t,e),n.setRng(i),n.collapse(!1)):(n._moveEndPoint(i,n.editor.getBody(),!0),n.setRng(i))},getContent:function(t){return h.getContent(this.editor,t)},setContent:function(t,e){m.setContent(this.editor,t,e)},getStart:function(t){var e,n=this.getRng();return 1==(e=n.startContainer).nodeType&&e.hasChildNodes()&&(t&&n.collapsed||(e=e.childNodes[Math.min(e.childNodes.length-1,n.startOffset)])),e&&3==e.nodeType?e.parentNode:e},getEnd:function(t){var e,n,i=this.getRng();return e=i.endContainer,n=i.endOffset,1==e.nodeType&&e.hasChildNodes()&&(t&&i.collapsed||(e=e.childNodes[n>0?n-1:n])),e&&3==e.nodeType?e.parentNode:e},getBookmark:function(t,e){return this.bookmarkManager.getBookmark(t,e)},moveToBookmark:function(t){return this.bookmarkManager.moveToBookmark(t)},select:function(t,e){var n,i=this,r=i.dom,o=r.createRng();return t&&(n=r.nodeIndex(t),o.setStart(t.parentNode,n),o.setEnd(t.parentNode,n+1),e&&(i._moveEndPoint(o,t,!0),i._moveEndPoint(o,t)),i.setRng(o)),t},isCollapsed:function(){var t=this,e=t.getRng(),n=t.getSel();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!n||e.collapsed)},collapse:function(t){var e=this,n=e.getRng();n.collapse(!!t),e.setRng(n)},getSel:function(){var t=this.win;return t.getSelection?t.getSelection():t.document.selection},getRng:function(){var t,e,n,i,r=this,o=function(t,e,n){try{return e.compareBoundaryPoints(t,n)}catch(i){return-1}};if(!r.win)return null;if(void 0===(i=r.win.document)||null===i)return null;if(r.editor.bookmark!==undefined&&!1===c.hasFocus(r.editor)){var a=p.getRng(r.editor);if(a.isSome())return a.getOr(i.createRange())}try{(t=r.getSel())&&(e=t.rangeCount>0?t.getRangeAt(0):t.createRange?t.createRange():i.createRange())}catch(s){}return(e=l.processRanges(r.editor,[e])[0])||(e=i.createRange?i.createRange():i.body.createTextRange()),e.setStart&&9===e.startContainer.nodeType&&e.collapsed&&(n=r.dom.getRoot(),e.setStart(n,0),e.setEnd(n,0)),r.selectedRange&&r.explicitRange&&(0===o(e.START_TO_START,e,r.selectedRange)&&0===o(e.END_TO_END,e,r.selectedRange)?e=r.explicitRange:(r.selectedRange=null,r.explicitRange=null)),e},setRng:function(t,e){var i,r,o,a=this;if(_(t))if(t.select){a.explicitRange=null;try{t.select()}catch(s){}}else{if(i=a.getSel(),o=a.editor.fire("SetSelectionRange",{range:t,forward:e}),t=o.range,i){a.explicitRange=t;try{i.removeAllRanges(),i.addRange(t)}catch(s){}!1===e&&i.extend&&(i.collapse(t.endContainer,t.endOffset),i.extend(t.startContainer,t.startOffset)),a.selectedRange=i.rangeCount>0?i.getRangeAt(0):null}t.collapsed||t.startContainer!==t.endContainer||!i.setBaseAndExtent||n.ie||t.endOffset-t.startOffset<2&&t.startContainer.hasChildNodes()&&(r=t.startContainer.childNodes[t.startOffset])&&"IMG"===r.tagName&&(i.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),i.anchorNode===t.startContainer&&i.focusNode===t.endContainer||i.setBaseAndExtent(r,0,r,1)),a.editor.fire("AfterSetSelectionRange",{range:t,forward:e})}},setNode:function(t){var e=this;return e.setContent(e.dom.getOuterHTML(t)),t},getNode:function(){var t,e,n,i,r,o=this,a=o.getRng(),s=o.dom.getRoot(),c=function(t,e){for(var n=t;t&&3===t.nodeType&&0===t.length;)t=e?t.nextSibling:t.previousSibling;return t||n};return a?(e=a.startContainer,n=a.endContainer,i=a.startOffset,r=a.endOffset,t=a.commonAncestorContainer,!a.collapsed&&(e==n&&r-i<2&&e.hasChildNodes()&&(t=e.childNodes[i]),3===e.nodeType&&3===n.nodeType&&(e=e.length===i?c(e.nextSibling,!0):e.parentNode,n=0===r?c(n.previousSibling,!1):n.parentNode,e&&e===n))?e:t&&3==t.nodeType?t.parentNode:t):s},getSelectedBlocks:function(t,e){var n,i,r=this,o=r.dom,a=[];if(i=o.getRoot(),t=o.getParent(t||r.getStart(),o.isBlock),e=o.getParent(e||r.getEnd(),o.isBlock),t&&t!=i&&a.push(t),t&&e&&t!=e){n=t;for(var c=new s(t,i);(n=c.next())&&n!=e;)o.isBlock(n)&&a.push(n)}return e&&t!=e&&e!=i&&a.push(e),a},isForward:function(){var t,e,n=this.dom,i=this.getSel();return!(i&&i.anchorNode&&i.focusNode)||((t=n.createRng()).setStart(i.anchorNode,i.anchorOffset),t.collapse(!0),(e=n.createRng()).setStart(i.focusNode,i.focusOffset),e.collapse(!0),t.compareBoundaryPoints(t.START_TO_START,e)<=0)},normalize:function(){var t=this,e=t.getRng();if(!d.hasMultipleRanges(t.getSel())){var n=f.normalize(t.dom,e);return n.each(function(e){t.setRng(e,t.isForward())}),n.getOr(e)}return e},selectorChanged:function(t,e){var n,i=this;return i.selectorChangedData||(i.selectorChangedData={},n={},i.editor.on("NodeChange",function(t){var e=t.element,r=i.dom,o=r.getParents(e,null,r.getRoot()),a={};v(i.selectorChangedData,function(t,e){v(o,function(i){if(r.is(i,e))return n[e]||(v(t,function(t){t(!0,{node:i,selector:e,parents:o})}),n[e]=t),a[e]=t,!1})}),v(n,function(t,i){a[i]||(delete n[i],v(t,function(t){t(!1,{node:e,selector:i,parents:o})}))})})),i.selectorChangedData[t]||(i.selectorChangedData[t]=[]),i.selectorChangedData[t].push(e),i},getScrollContainer:function(){for(var t,e=this.dom.getRoot();e&&"BODY"!=e.nodeName;){if(e.scrollHeight>e.clientHeight){t=e;break}e=e.parentNode}return t},scrollIntoView:function(t,e){a.scrollIntoView(this.editor,t,e)},placeCaretAt:function(t,e){this.setRng(u.fromPoint(t,e,this.editor.getDoc()))},_moveEndPoint:function(t,e,i){var r=e,o=new s(e,r),a=this.dom.schema.getNonEmptyElements();do{if(3==e.nodeType&&0!==y(e.nodeValue).length)return void(i?t.setStart(e,0):t.setEnd(e,e.nodeValue.length));if(a[e.nodeName]&&!/^(TD|TH)$/.test(e.nodeName))return void(i?t.setStartBefore(e):"BR"==e.nodeName?t.setEndBefore(e):t.setEndAfter(e));if(n.ie&&n.ie<11&&this.dom.isBlock(e)&&this.dom.isEmpty(e))return void(i?t.setStart(e,0):t.setEnd(e,0))}while(e=i?o.next():o.prev());"BODY"==r.nodeName&&(i?t.setStart(r,0):t.setEnd(r,r.childNodes.length))},getBoundingClientRect:function(){var t=this.getRng();return t.collapsed?r.fromRangeStart(t).getClientRects()[0]:t.getBoundingClientRect()},destroy:function(){this.win=null,this.controlSelection.destroy()}},x}),o("tinymce.core.caret.LineWalker",["tinymce.core.util.Fun","tinymce.core.util.Arr","tinymce.core.dom.Dimensions","tinymce.core.caret.CaretCandidate","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretWalker","tinymce.core.caret.CaretPosition","tinymce.core.geom.ClientRect"],function(t,e,n,i,r,o,a,s){var c=t.curry,u=function(t,e,n,o){for(;o=r.findNode(o,t,i.isEditableCaretCandidate,e);)if(n(o))return},l=function(t,i,r,o,a,s){var c,l,h=0,d=[],f=function(o){var s,c,u;for(u=n.getClientRects(o),-1==t&&(u=u.reverse()),s=0;s<u.length;s++)if(c=u[s],!r(c,l)){if(d.length>0&&i(c,e.last(d))&&h++,c.line=h,a(c))return!0;d.push(c)}};return(l=e.last(s.getClientRects()))?(c=s.getNode(),f(c),u(t,o,f,c),d):d},h=function(t,e){return e.line>t},d=function(t,e){return e.line===t};return{upUntil:c(l,-1,s.isAbove,s.isBelow),downUntil:c(l,1,s.isBelow,s.isAbove),positionsUntil:function(t,n,i,r){var c,u,l,h,d,f,p=new o(n),m=[],g=0,v=function(t){return e.last(t.getClientRects())};1==t?(c=p.next,u=s.isBelow,l=s.isAbove,h=a.after(r)):(c=p.prev,u=s.isAbove,l=s.isBelow,h=a.before(r)),f=v(h);do{if(h.isVisible()&&(d=v(h),!l(d,f))){if(m.length>0&&u(d,e.last(m))&&g++,d=s.clone(d),d.position=h,d.line=g,i(d))return m;m.push(d)}}while(h=c(h));return m},isAboveLine:c(h),isLine:c(d)}}),o("tinymce.core.keyboard.CefNavigation",["tinymce.core.Env","tinymce.core.caret.CaretContainer","tinymce.core.caret.CaretPosition","tinymce.core.caret.CaretUtils","tinymce.core.caret.CaretWalker","tinymce.core.caret.LineUtils","tinymce.core.caret.LineWalker","tinymce.core.dom.NodeType","tinymce.core.keyboard.CefUtils","tinymce.core.selection.RangeNodes","tinymce.core.util.Arr","tinymce.core.util.Fun"],function(t,e,n,i,r,o,a,s,c,u,l,h){var d=s.isContentEditableFalse,f=u.getSelectedNode,p=i.isAfterContentEditableFalse,m=i.isBeforeContentEditableFalse,g=function(t,e){for(;e=t(e);)if(e.isVisible())return e;return e},v=function(t,e){var n=i.isInSameBlock(t,e);return!(n||!s.isBr(t.getNode()))||n},y=function(t){return e.isCaretContainerBlock(t.startContainer)},b=function(t,e,r){return r=i.normalizeRange(t,e,r),-1===t?n.fromRangeStart(r):n.fromRangeEnd(r)},_=function(t,e,n,i,r){var o,a,s,u;return!r.collapsed&&(o=f(r),d(o))?c.showCaret(t,e,o,-1===t):(u=y(r),a=b(t,e.getBody(),r),i(a)?c.selectNode(e,a.getNode(-1===t)):(a=n(a))?i(a)?c.showCaret(t,e,a.getNode(-1===t),1===t):(s=n(a),i(s)&&v(a,s)?c.showCaret(t,e,s.getNode(-1===t),1===t):u?c.renderRangeCaret(e,a.toRange()):null):u?r:null)},x=function(t,e,n,i){var r,s,u,h,g,v,y,_,x;if(x=f(i),r=b(t,e.getBody(),i),s=n(e.getBody(),a.isAboveLine(1),r),u=l.filter(s,a.isLine(1)),g=l.last(r.getClientRects()),m(r)&&(x=r.getNode()),p(r)&&(x=r.getNode(!0)),!g)return null;if(v=g.left,(h=o.findClosestClientRect(u,v))&&d(h.node))return y=Math.abs(v-h.left),_=Math.abs(v-h.right),c.showCaret(t,e,h.node,y<_);if(x){var w=a.positionsUntil(t,e.getBody(),a.isAboveLine(1),x);if(h=o.findClosestClientRect(l.filter(w,a.isLine(1)),v))return c.renderRangeCaret(e,h.position.toRange());if(h=l.last(l.filter(w,a.isLine(0))))return c.renderRangeCaret(e,h.position.toRange())}},w=function(e){var n=e.dom.create(e.settings.forced_root_block);return(!t.ie||t.ie>=11)&&(n.innerHTML='<br data-mce-bogus="1">'),n},S=function(t,e,i){var o,a,s=new r(t.getBody()),c=h.curry(g,s.next),u=h.curry(g,s.prev);if(i.collapsed&&t.settings.forced_root_block){if(!(o=t.dom.getParent(i.startContainer,"PRE")))return;(1===e?c(n.fromRangeStart(i)):u(n.fromRangeStart(i)))||(a=w(t),1===e?t.$(o).after(a):t.$(o).before(a),t.selection.select(a,!0),t.selection.collapse())}},k=function(t,e){var n,i=new r(t.getBody()),o=h.curry(g,i.next),a=h.curry(g,i.prev),s=e?1:-1,c=e?o:a,u=e?m:p,l=t.selection.getRng();return(n=_(s,t,c,u,l))?n:(n=S(t,s,l))||null},E=function(t,e){var n,i=e?1:-1,r=e?a.downUntil:a.upUntil,o=t.selection.getRng();return(n=x(i,t,r,o))?n:(n=S(t,i,o))||null};return{moveH:function(t,e){return function(){var n=k(t,e);return!!n&&(t.selection.setRng(n),!0)}},moveV:function(t,e){return function(){var n=E(t,e);return!!n&&(t.selection.setRng(n),!0)}}}}),o("tinymce.core.keyboard.MatchKeys",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.katamari.api.Merger"],function(t,e,n){var i=function(i){return t.map(i,function(t){return n.merge({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:e.noop},t)})},r=function(t,e){return e.keyCode===t.keyCode&&e.shiftKey===t.shiftKey&&e.altKey===t.altKey&&e.ctrlKey===t.ctrlKey&&e.metaKey===t.metaKey},o=function(e,n){return t.bind(i(e),function(t){return r(t,n)?[t]:[]})};return{match:o,action:function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}},execute:function(e,n){return t.find(o(e,n),function(t){return t.action()})}}}),o("tinymce.core.keyboard.ArrowKeys",["ephox.sand.api.PlatformDetection","tinymce.core.keyboard.BoundarySelection","tinymce.core.keyboard.CefNavigation","tinymce.core.keyboard.MatchKeys","tinymce.core.util.VK"],function(t,e,n,i,r){var o=function(o,a,s){var c=t.detect().os;i.execute([{keyCode:r.RIGHT,action:n.moveH(o,!0)},{keyCode:r.LEFT,action:n.moveH(o,!1)},{keyCode:r.UP,action:n.moveV(o,!1)},{keyCode:r.DOWN,action:n.moveV(o,!0)},{keyCode:r.RIGHT,action:e.move(o,a,!0)},{keyCode:r.LEFT,action:e.move(o,a,!1)},{keyCode:r.RIGHT,ctrlKey:!c.isOSX(),altKey:c.isOSX(),action:e.moveNextWord(o,a)},{keyCode:r.LEFT,ctrlKey:!c.isOSX(),altKey:c.isOSX(),action:e.movePrevWord(o,a)}],s).each(function(){s.preventDefault()})};return{setup:function(t,e){t.on("keydown",function(n){!1===n.isDefaultPrevented()&&o(t,e,n)})}}}),o("tinymce.core.delete.InlineFormatDelete",["ephox.katamari.api.Arr","ephox.katamari.api.Fun","ephox.sugar.api.node.Element","ephox.sugar.api.search.Traverse","tinymce.core.caret.CaretPosition","tinymce.core.delete.DeleteElement","tinymce.core.delete.DeleteUtils","tinymce.core.dom.ElementType","tinymce.core.dom.Parents","tinymce.core.fmt.CaretFormat"],function(t,e,n,i,r,o,a,s,c,u){var l=function(n,i){var r=c.parentsAndSelf(i,n);return t.findIndex(r,s.isBlock).fold(e.constant(r),function(t){return r.slice(0,t)})},h=function(t){return 1===i.children(t).length},d=function(n,i,r,a){var s=e.curry(u.isFormatElement,i),c=t.map(t.filter(a,s),function(t){return t.dom()});if(0===c.length)o.deleteElement(i,n,r);else{var l=u.replaceWithCaretFormat(r.dom(),c);i.selection.setRng(l.toRange())}},f=function(e,i){var o=n.fromDom(e.getBody()),s=n.fromDom(e.selection.getStart()),c=t.filter(l(o,s),h);return t.last(c).map(function(t){var n=r.fromRangeStart(e.selection.getRng());return!!a.willDeleteLastPositionInElement(i,n,t.dom())&&(d(i,e,t,c),!0)}).getOr(!1)};return{backspaceDelete:function(t,e){return!!t.selection.isCollapsed()&&f(t,e)}}}),o("tinymce.core.keyboard.DeleteBackspaceKeys",["tinymce.core.delete.BlockBoundaryDelete","tinymce.core.delete.BlockRangeDelete","tinymce.core.delete.CefDelete","tinymce.core.delete.InlineBoundaryDelete","tinymce.core.delete.InlineFormatDelete","tinymce.core.delete.TableDelete","tinymce.core.keyboard.MatchKeys","tinymce.core.util.VK"],function(t,e,n,i,r,o,a,s){var c=function(c,u,l){a.execute([{keyCode:s.BACKSPACE,action:a.action(n.backspaceDelete,c,!1)},{keyCode:s.DELETE,action:a.action(n.backspaceDelete,c,!0)},{keyCode:s.BACKSPACE,action:a.action(i.backspaceDelete,c,u,!1)},{keyCode:s.DELETE,action:a.action(i.backspaceDelete,c,u,!0)},{keyCode:s.BACKSPACE,action:a.action(e.backspaceDelete,c,!1)},{keyCode:s.DELETE,action:a.action(e.backspaceDelete,c,!0)},{keyCode:s.BACKSPACE,action:a.action(t.backspaceDelete,c,!1)},{keyCode:s.DELETE,action:a.action(t.backspaceDelete,c,!0)},{keyCode:s.BACKSPACE,action:a.action(o.backspaceDelete,c,!1)},{keyCode:s.DELETE,action:a.action(o.backspaceDelete,c,!0)},{keyCode:s.BACKSPACE,action:a.action(r.backspaceDelete,c,!1)},{keyCode:s.DELETE,action:a.action(r.backspaceDelete,c,!0)}],l).each(function(){l.preventDefault()})},u=function(t,e){a.execute([{keyCode:s.BACKSPACE,action:a.action(n.paddEmptyElement,t)},{keyCode:s.DELETE,action:a.action(n.paddEmptyElement,t)}],e)};return{setup:function(t,e){t.on("keydown",function(n){!1===n.isDefaultPrevented()&&c(t,e,n)}),t.on("keyup",function(e){!1===e.isDefaultPrevented()&&u(t,e)})}}}),o("tinymce.core.api.Settings",[],function(){var t=function(t,e,n){var i=t.getParam(e,n);if(-1!==i.indexOf("=")){var r=t.getParam(e,"","hash");return r.hasOwnProperty(t.id)?r[t.id]:n}return i};return{getIframeAttrs:function(t){return t.getParam("iframe_attrs",{})},getDocType:function(t){return t.getParam("doctype","<!DOCTYPE html>")},getDocumentBaseUrl:function(t){return t.getParam("document_base_url","")},getBodyId:function(e){return t(e,"body_id","tinymce")},getBodyClass:function(e){return t(e,"body_class","")},getContentSecurityPolicy:function(t){return t.getParam("content_security_policy","")},shouldPutBrInPre:function(t){return t.getParam("br_in_pre",!0)},getForcedRootBlock:function(t){if(t.getParam("force_p_newlines",!1))return"p";var e=t.getParam("forced_root_block","p");return!1===e?"":e},getForcedRootBlockAttrs:function(t){return t.getParam("forced_root_block_attrs",{})},getBrNewLineSelector:function(t){return t.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")},getNoNewLineSelector:function(t){return t.getParam("no_newline_selector","")},shouldKeepStyles:function(t){return t.getParam("keep_styles",!0)},shouldEndContainerOnEmtpyBlock:function(t){return t.getParam("end_container_on_empty_block",!1)}}}),o("tinymce.core.newline.NewLineUtils",["ephox.katamari.api.Fun","ephox.katamari.api.Option","ephox.sugar.api.node.Element","tinymce.core.dom.ElementType","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker"],function(t,e,n,i,r,o){var a=function(t){for(;t;){if(1===t.nodeType||3===t.nodeType&&t.data&&/[\r\n\s]/.test(t.data))return t;t=t.nextSibling}},s=function(t){return e.from(t.dom.getParent(t.selection.getStart(!0),t.dom.isBlock))};return{moveToCaretPosition:function(t,e){var n,i,s,c,u=e,l=t.dom,h=t.schema.getMoveCaretBeforeOnEnterElements();if(e){if(/^(LI|DT|DD)$/.test(e.nodeName)){var d=a(e.firstChild);d&&/^(UL|OL|DL)$/.test(d.nodeName)&&e.insertBefore(l.doc.createTextNode("\xa0"),e.firstChild)}if(s=l.createRng(),e.normalize(),e.hasChildNodes()){for(n=new o(e,e);i=n.current();){if(r.isText(i)){s.setStart(i,0),s.setEnd(i,0);break}if(h[i.nodeName.toLowerCase()]){s.setStartBefore(i),s.setEndBefore(i);break}u=i,i=n.next()}i||(s.setStart(u,0),s.setEnd(u,0))}else r.isBr(e)?e.nextSibling&&l.isBlock(e.nextSibling)?(s.setStartBefore(e),s.setEndBefore(e)):(s.setStartAfter(e),s.setEndAfter(e)):(s.setStart(e,0),s.setEnd(e,0));t.selection.setRng(s),l.remove(c),t.selection.scrollIntoView(e)}},getEditableRoot:function(t,e){var n,i,r=t.getRoot();for(n=e;n!==r&&"false"!==t.getContentEditable(n);)"true"===t.getContentEditable(n)&&(i=n),n=n.parentNode;return n!==r?i:r},getParentBlock:s,getParentBlockName:function(e){return s(e).fold(t.constant(""),function(t){return t.nodeName.toUpperCase()})},isListItemParentBlock:function(t){return s(t).filter(function(t){return i.isListItem(n.fromDom(t))}).isSome()}}}),o("tinymce.core.newline.InsertLi",["tinymce.core.dom.NodeType","tinymce.core.newline.NewLineUtils"],function(t,e){var n=function(t,e){return t.firstChild&&t.firstChild.nodeName===e},i=function(t,e){return t&&t.parentNode&&t.parentNode.nodeName===e},r=function(t){return t&&/^(OL|UL|LI)$/.test(t.nodeName)},o=function(t){return r(t)&&r(t.parentNode)},a=function(t){var e=t.parentNode;return/^(LI|DT|DD)$/.test(e.nodeName)?e:t},s=function(e,n,i){for(var r=e[i?"firstChild":"lastChild"];r&&!t.isElement(r);)r=r[i?"nextSibling":"previousSibling"];return r===n};return{insert:function(t,r,c,u,l){var h=t.dom,d=t.selection.getRng();if(c!==t.getBody()){o(c)&&(l="LI");var f=l?r(l):h.create("BR");if(s(c,u,!0)&&s(c,u,!1))i(c,"LI")?h.insertAfter(f,a(c)):h.replace(f,c);else if(s(c,u,!0))i(c,"LI")?(h.insertAfter(f,a(c)),f.appendChild(h.doc.createTextNode(" ")),f.appendChild(c)):c.parentNode.insertBefore(f,c);else if(s(c,u,!1))h.insertAfter(f,a(c));else{c=a(c);var p=d.cloneRange();p.setStartAfter(u),p.setEndAfter(c);var m=p.extractContents();"LI"===l&&n(m,"LI")?(f=m.firstChild,h.insertAfter(m,c)):(h.insertAfter(m,c),h.insertAfter(f,c))}h.remove(u),e.moveToCaretPosition(t,f)}}}}),o("tinymce.core.newline.InsertBlock",["tinymce.core.api.Settings","tinymce.core.caret.CaretContainer","tinymce.core.dom.NodeType","tinymce.core.dom.TreeWalker","tinymce.core.fmt.CaretFormat","tinymce.core.newline.InsertLi","tinymce.core.newline.NewLineUtils","tinymce.core.selection.NormalizeRange","tinymce.core.text.Zwsp","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c,u){var l=function(t){return t&&"A"===t.nodeName&&0===u.trim(c.trim(t.innerText||t.textContent)).length},h=function(t){return t&&/^(TD|TH|CAPTION)$/.test(t.nodeName)},d=function(t){t.innerHTML='<br data-mce-bogus="1">'},f=function(t,e){return t.nodeName===e||t.previousSibling&&t.previousSibling.nodeName===e},p=function(t,e){return e&&t.isBlock(e)&&!/^(TD|TH|CAPTION|FORM)$/.test(e.nodeName)&&!/^(fixed|absolute)/i.test(e.style.position)&&"true"!==t.getContentEditable(e)},m=function(t,e,i){var r,o=i,a=[];if(o){for(;o=o.firstChild;){if(t.isBlock(o))return;n.isElement(o)&&!e[o.nodeName.toLowerCase()]&&a.push(o)}for(r=a.length;r--;)!(o=a[r]).hasChildNodes()||o.firstChild===o.lastChild&&""===o.firstChild.nodeValue?t.remove(o):l(o)&&t.remove(o)}},g=function(t,e,i){return!1===n.isText(e)?i:t?1===i&&e.data.charAt(i-1)===c.ZWSP?0:i:i===e.data.length-1&&e.data.charAt(i)===c.ZWSP?e.data.length:i},v=function(t){var e=t.cloneRange();return e.setStart(t.startContainer,g(!0,t.startContainer,t.startOffset)),e.setEnd(t.endContainer,g(!1,t.endContainer,t.endOffset)),e},y=function(t){do{n.isText(t)&&(t.nodeValue=t.nodeValue.replace(/^[\r\n]+/,"")),t=t.firstChild}while(t)},b=function(t,e){var n,i,r=t.getRoot();for(n=e;n!==r&&"false"!==t.getContentEditable(n);)"true"===t.getContentEditable(n)&&(i=n),n=n.parentNode;return n!==r?i:r},_=function(e,n){var i=t.getForcedRootBlock(e);i&&i.toLowerCase()===n.tagName.toLowerCase()&&e.dom.setAttribs(n,t.getForcedRootBlockAttrs(e))},x=function(t,e,n,i,r){var o,a,s,c,u,l,d=e||"P",f=t.dom,m=b(f,i);if(!(a=f.getParent(i,f.isBlock))||!p(f,a)){if(a=a||m,l=a===t.getBody()||h(a)?a.nodeName.toLowerCase():a.parentNode.nodeName.toLowerCase(),!a.hasChildNodes())return o=f.create(d),_(t,o),a.appendChild(o),n.setStart(o,0),n.setEnd(o,0),o;for(c=i;c.parentNode!==a;)c=c.parentNode;for(;c&&!f.isBlock(c);)s=c,c=c.previousSibling;if(s&&t.schema.isValidChild(l,d.toLowerCase())){for(o=f.create(d),_(t,o),s.parentNode.insertBefore(o,s),c=s;c&&!f.isBlock(c);)u=c.nextSibling,o.appendChild(c),c=u;n.setStart(i,r),n.setEnd(i,r)}}return i},w=function(t,e){var n;e.normalize(),(n=e.lastChild)&&!/^(left|right)$/gi.test(t.getStyle(n,"float",!0))||t.add(e,"br")};return{insert:function(c,u){var l,h,S,k,E,T,C,L,P,A,N,R,I,D=c.dom,O=c.schema,B=O.getNonEmptyElements(),M=c.selection.getRng(),F=function(e){var n,i,o,a=S,s=O.getTextInlineElements();if(e||"TABLE"===A||"HR"===A?(n=D.create(e||R),_(c,n)):n=E.cloneNode(!1),o=n,!1===t.shouldKeepStyles(c))D.setAttrib(n,"style",null),D.setAttrib(n,"class",null);else do{if(s[a.nodeName]){if(r.isCaretNode(a))continue;i=a.cloneNode(!1),D.setAttrib(i,"id",""),n.hasChildNodes()?(i.appendChild(n.firstChild),n.appendChild(i)):(o=i,n.appendChild(i))}}while((a=a.parentNode)&&a!==h);return d(o),n},z=function(t){var e,r,o,a;if(a=g(t,S,k),n.isText(S)&&(t?a>0:a<S.nodeValue.length))return!1;if(S.parentNode===E&&I&&!t)return!0;if(t&&n.isElement(S)&&S===E.firstChild)return!0;if(f(S,"TABLE")||f(S,"HR"))return I&&!t||!I&&t;for(e=new i(S,E),n.isText(S)&&(t&&0===a?e.prev():t||a!==S.nodeValue.length||e.next());r=e.current();){if(n.isElement(r)){if(!r.getAttribute("data-mce-bogus")&&(o=r.nodeName.toLowerCase(),B[o]&&"br"!==o))return!1}else if(n.isText(r)&&!/^[ \t\r\n]*$/.test(r.nodeValue))return!1;t?e.prev():e.next()}return!0},j=function(){C=/^(H[1-6]|PRE|FIGURE)$/.test(A)&&"HGROUP"!==N?F(R):F(),t.shouldEndContainerOnEmtpyBlock(c)&&p(D,P)&&D.isEmpty(E)?C=D.split(P,E):D.insertAfter(C,E),a.moveToCaretPosition(c,C)};s.normalize(D,M).each(function(t){M.setStart(t.startContainer,t.startOffset),M.setEnd(t.endContainer,t.endOffset)}),S=M.startContainer,k=M.startOffset,R=t.getForcedRootBlock(c),T=u.shiftKey,n.isElement(S)&&S.hasChildNodes()&&(I=k>S.childNodes.length-1,S=S.childNodes[Math.min(k,S.childNodes.length-1)]||S,k=I&&n.isText(S)?S.nodeValue.length:0),(h=b(D,S))&&((R&&!T||!R&&T)&&(S=x(c,R,M,S,k)),E=D.getParent(S,D.isBlock),P=E?D.getParent(E.parentNode,D.isBlock):null,A=E?E.nodeName.toUpperCase():"","LI"!==(N=P?P.nodeName.toUpperCase():"")||u.ctrlKey||(E=P,P=P.parentNode,A=N),/^(LI|DT|DD)$/.test(A)&&D.isEmpty(E)?o.insert(c,F,P,E,R):R&&E===c.getBody()||(R=R||"P",e.isCaretContainerBlock(E)?(C=e.showCaretContainerBlock(E),D.isEmpty(E)&&d(E),a.moveToCaretPosition(c,C)):z()?j():z(!0)?(C=E.parentNode.insertBefore(F(),E),a.moveToCaretPosition(c,f(E,"HR")?C:E)):((l=v(M).cloneRange()).setEndAfter(E),L=l.extractContents(),y(L),C=L.firstChild,D.insertAfter(L,E),m(D,B,C),w(D,E),D.isEmpty(E)&&d(E),C.normalize(),D.isEmpty(C)?(D.remove(C),j()):a.moveToCaretPosition(c,C)),D.setAttrib(C,"id",""),c.fire("NewBlock",{newBlock:C})))}}}),o("tinymce.core.newline.ContextSelectors",["ephox.sugar.api.node.Element","ephox.sugar.api.search.Selectors","tinymce.core.api.Settings","tinymce.core.newline.NewLineUtils"],function(t,e,n,i){var r=function(n,r){return i.getParentBlock(n).filter(function(n){return r.length>0&&e.is(t.fromDom(n),r)}).isSome()};return{shouldInsertBr:function(t){return r(t,n.getBrNewLineSelector(t))},shouldBlockNewLine:function(t){return r(t,n.getNoNewLineSelector(t))}}}),o("tinymce.core.newline.NewLineAction",["ephox.katamari.api.Adt","ephox.katamari.api.Arr","ephox.katamari.api.Option","tinymce.core.api.Settings","tinymce.core.newline.ContextSelectors","tinymce.core.newline.NewLineUtils","tinymce.core.util.LazyEvaluator"],function(t,e,n,i,r,o,a){var s=t.generate([{br:[]},{block:[]},{none:[]}]),c=function(t){return r.shouldBlockNewLine(t)},u=function(t){return function(e){return""===i.getForcedRootBlock(e)===t}},l=function(t){return function(e){return o.isListItemParentBlock(e)===t}},h=function(t){return function(e){return"PRE"===o.getParentBlockName(e)===t}},d=function(t){return function(e){return i.shouldPutBrInPre(e)===t}},f=function(t){return r.shouldInsertBr(t)},p=function(t,e){return e},m=function(t){var e=i.getForcedRootBlock(t),n=o.getEditableRoot(t.dom,t.selection.getStart());return n&&t.schema.isValidChild(n.nodeName,e||"P")},g=function(t,i){return function(r,o){return e.foldl(t,function(t,e){return t&&e(r,o)},!0)?n.some(i):n.none()}};return{getAction:function(t,e){return a.evaluateUntil([g([c],s.none()),g([h(!0),d(!1),p],s.br()),g([h(!0),d(!1)],s.block()),g([h(!0),d(!0),p],s.block()),g([h(!0),d(!0)],s.br()),g([l(!0),p],s.br()),g([l(!0)],s.block()),g([u(!0),p,m],s.block()),g([u(!0)],s.br()),g([f],s.br()),g([u(!1),p],s.br()),g([m],s.block())],[t,e.shiftKey]).getOr(s.none())}}}),o("tinymce.core.newline.InsertNewLine",["ephox.katamari.api.Fun","tinymce.core.newline.InsertBlock","tinymce.core.newline.InsertBr","tinymce.core.newline.NewLineAction"],function(t,e,n,i){return{insert:function(r,o){i.getAction(r,o).fold(function(){n.insert(r,o)},function(){e.insert(r,o)},t.noop)}}}),o("tinymce.core.keyboard.EnterKey",["tinymce.core.newline.InsertNewLine","tinymce.core.util.VK"],function(t,e){var n=function(t){t.typing&&(t.typing=!1,t.add())},i=function(e,i){i.isDefaultPrevented()||(i.preventDefault(),n(e.undoManager),e.undoManager.transact(function(){!1===e.selection.isCollapsed()&&e.execCommand("Delete"),t.insert(e,i)}))};return{setup:function(t){t.on("keydown",function(n){n.keyCode===e.ENTER&&i(t,n)})}}}),o("tinymce.core.keyboard.InsertSpace",["ephox.katamari.api.Fun","tinymce.core.caret.CaretPosition","tinymce.core.dom.NodeType","tinymce.core.keyboard.BoundaryLocation","tinymce.core.keyboard.InlineUtils"],function(t,e,n,i,r){var o=function(t,e){return u(t)&&n.isText(e.container())},a=function(t,e){var n=e.container(),i=e.offset();n.insertData(i,"\xa0"),t.selection.setCursorLocation(n,i+1)},s=function(t,e,n){return!!o(n,e)&&(a(t,e),!0)},c=function(n){var o=t.curry(r.isInlineTarget,n),a=e.fromRangeStart(n.selection.getRng());return i.readLocation(o,n.getBody(),a).map(t.curry(s,n,a)).getOr(!1)},u=function(e){return e.fold(t.constant(!1),t.constant(!0),t.constant(!0),t.constant(!1))};return{insertAtSelection:function(t){return!!t.selection.isCollapsed()&&c(t)}}}),o("tinymce.core.keyboard.SpaceKey",["tinymce.core.keyboard.InsertSpace","tinymce.core.keyboard.MatchKeys","tinymce.core.util.VK"],function(t,e,n){var i=function(i,r){e.execute([{keyCode:n.SPACEBAR,action:e.action(t.insertAtSelection,i)}],r).each(function(){r.preventDefault()})};return{setup:function(t){t.on("keydown",function(e){!1===e.isDefaultPrevented()&&i(t,e)})}}}),o("tinymce.core.keyboard.KeyboardOverrides",["tinymce.core.keyboard.ArrowKeys","tinymce.core.keyboard.BoundarySelection","tinymce.core.keyboard.DeleteBackspaceKeys","tinymce.core.keyboard.EnterKey","tinymce.core.keyboard.SpaceKey"],function(t,e,n,i,r){return{setup:function(o){var a=e.setupSelectedState(o);t.setup(o,a),n.setup(o,a),i.setup(o),r.setup(o)}}}),o("tinymce.core.util.Quirks",["global!document","global!window","tinymce.core.Env","tinymce.core.caret.CaretContainer","tinymce.core.selection.CaretRangeFromPoint","tinymce.core.util.Delay","tinymce.core.util.Tools","tinymce.core.util.VK"],function(t,e,n,i,r,o,a,s){return function(c){var u=a.each,l=s.BACKSPACE,h=s.DELETE,d=c.dom,f=c.selection,p=c.settings,m=c.parser,g=n.gecko,v=n.ie,y=n.webkit,b="data:text/mce-internal,",_=v?"Text":"URL",x=function(t,e){try{c.getDoc().execCommand(t,!1,e)}catch(n){}},w=function(t){
return t.isDefaultPrevented()},S=function(t){var e,n;t.dataTransfer&&(c.selection.isCollapsed()&&"IMG"==t.target.tagName&&f.select(t.target),(e=c.selection.getContent()).length>0&&(n=b+escape(c.id)+","+escape(e),t.dataTransfer.setData(_,n)))},k=function(t){var e;return t.dataTransfer&&(e=t.dataTransfer.getData(_))&&e.indexOf(b)>=0?(e=e.substr(b.length).split(","),{id:unescape(e[0]),html:unescape(e[1])}):null},E=function(t,e){c.queryCommandSupported("mceInsertClipboardContent")?c.execCommand("mceInsertClipboardContent",!1,{content:t,internal:e}):c.execCommand("mceInsertContent",!1,t)},T=function(){var t=function(t){var e=d.create("body"),n=t.cloneContents();return e.appendChild(n),f.serializer.serialize(e,{format:"html"})},e=function(e){var n=t(e),i=d.createRng();i.selectNode(c.getBody());return n===t(i)};c.on("keydown",function(t){var n,i,r=t.keyCode;if(!w(t)&&(r==h||r==l)){if(n=c.selection.isCollapsed(),i=c.getBody(),n&&!d.isEmpty(i))return;if(!n&&!e(c.selection.getRng()))return;t.preventDefault(),c.setContent(""),i.firstChild&&d.isBlock(i.firstChild)?c.selection.setCursorLocation(i.firstChild,0):c.selection.setCursorLocation(i,0),c.nodeChanged()}})},C=function(){c.shortcuts.add("meta+a",null,"SelectAll")},L=function(){c.settings.content_editable||d.bind(c.getDoc(),"mousedown mouseup",function(t){var e;if(t.target==c.getDoc().documentElement)if(e=f.getRng(),c.getBody().focus(),"mousedown"==t.type){if(i.isCaretContainer(e.startContainer))return;f.placeCaretAt(t.clientX,t.clientY)}else f.setRng(e)})},P=function(){c.on("keydown",function(t){if(!w(t)&&t.keyCode===l){if(!c.getBody().getElementsByTagName("hr").length)return;if(f.isCollapsed()&&0===f.getRng(!0).startOffset){var e=f.getNode(),n=e.previousSibling;if("HR"==e.nodeName)return d.remove(e),void t.preventDefault();n&&n.nodeName&&"hr"===n.nodeName.toLowerCase()&&(d.remove(n),t.preventDefault())}}})},A=function(){e.Range.prototype.getClientRects||c.on("mousedown",function(t){if(!w(t)&&"HTML"===t.target.nodeName){var e=c.getBody();e.blur(),o.setEditorTimeout(c,function(){e.focus()})}})},N=function(){c.on("click",function(t){var e=t.target;/^(IMG|HR)$/.test(e.nodeName)&&"false"!==d.getContentEditableParent(e)&&(t.preventDefault(),c.selection.select(e),c.nodeChanged()),"A"==e.nodeName&&d.hasClass(e,"mce-item-anchor")&&(t.preventDefault(),f.select(e))})},R=function(){var t=function(){var t=d.getAttribs(f.getStart().cloneNode(!1));return function(){var e=f.getStart();e!==c.getBody()&&(d.setAttrib(e,"style",null),u(t,function(t){e.setAttributeNode(t.cloneNode(!0))}))}},e=function(){return!f.isCollapsed()&&d.getParent(f.getStart(),d.isBlock)!=d.getParent(f.getEnd(),d.isBlock)};c.on("keypress",function(n){var i;if(!w(n)&&(8==n.keyCode||46==n.keyCode)&&e())return i=t(),c.getDoc().execCommand("delete",!1,null),i(),n.preventDefault(),!1}),d.bind(c.getDoc(),"cut",function(n){var i;!w(n)&&e()&&(i=t(),o.setEditorTimeout(c,function(){i()}))})},I=function(){c.on("keydown",function(t){if(!w(t)&&t.keyCode===l&&f.isCollapsed()&&0===f.getRng(!0).startOffset){var e=f.getNode().previousSibling;if(e&&e.nodeName&&"table"===e.nodeName.toLowerCase())return t.preventDefault(),!1}})},D=function(){var t=function(){Z(),x("StyleWithCSS",!1),x("enableInlineTableEditing",!1),p.object_resizing||x("enableObjectResizing",!1)};p.readonly||c.on("BeforeExecCommand MouseDown",t)},O=function(){var t=function(){u(d.select("a"),function(t){var e=t.parentNode,n=d.getRoot();if(e.lastChild===t){for(;e&&!d.isBlock(e);){if(e.parentNode.lastChild!==e||e===n)return;e=e.parentNode}d.add(e,"br",{"data-mce-bogus":1})}})};c.on("SetContent ExecCommand",function(e){"setcontent"!=e.type&&"mceInsertLink"!==e.command||t()})},B=function(){p.forced_root_block&&c.on("init",function(){x("DefaultParagraphSeparator",p.forced_root_block)})},M=function(){c.on("keyup focusin mouseup",function(t){s.modifierPressed(t)||f.normalize()},!0)},F=function(){c.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},z=function(){c.inline||c.on("keydown",function(){t.activeElement==t.body&&c.getWin().focus()})},j=function(){c.inline||(c.contentStyles.push("body {min-height: 150px}"),c.on("click",function(t){var e;if("HTML"==t.target.nodeName){if(n.ie>11)return void c.getBody().focus();e=c.selection.getRng(),c.getBody().focus(),c.selection.setRng(e),c.selection.normalize(),c.nodeChanged()}}))},H=function(){n.mac&&c.on("keydown",function(t){!s.metaKeyPressed(t)||t.shiftKey||37!=t.keyCode&&39!=t.keyCode||(t.preventDefault(),c.selection.getSel().modify("move",37==t.keyCode?"backward":"forward","lineboundary"))})},$=function(){x("AutoUrlDetect",!1)},U=function(){c.on("click",function(t){var e=t.target;do{if("A"===e.tagName)return void t.preventDefault()}while(e=e.parentNode)}),c.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},q=function(){c.on("init",function(){c.dom.bind(c.getBody(),"submit",function(t){t.preventDefault()})})},W=function(){m.addNodeFilter("br",function(t){for(var e=t.length;e--;)"Apple-interchange-newline"==t[e].attr("class")&&t[e].remove()})},V=function(){c.on("dragstart",function(t){S(t)}),c.on("drop",function(t){if(!w(t)){var e=k(t);if(e&&e.id!=c.id){t.preventDefault();var n=r.fromPoint(t.x,t.y,c.getDoc());f.setRng(n),E(e.html,!0)}}})},Z=function(){},G=function(){var t;return!g||c.removed?0:!(t=c.selection.getSel())||!t.rangeCount||0===t.rangeCount};return function(){c.on("keydown",function(t){var e,n,i,r,o;if(!w(t)&&t.keyCode==s.BACKSPACE&&(e=f.getRng(),n=e.startContainer,i=e.startOffset,r=d.getRoot(),o=n,e.collapsed&&0===i)){for(;o&&o.parentNode&&o.parentNode.firstChild==o&&o.parentNode!=r;)o=o.parentNode;"BLOCKQUOTE"===o.tagName&&(c.formatter.toggle("blockquote",null,o),(e=d.createRng()).setStart(n,0),e.setEnd(n,0),f.setRng(e))}})}(),T(),n.windowsPhone||M(),y&&(L(),N(),B(),q(),I(),W(),n.iOS?(z(),j(),U()):C()),n.ie>=11&&(j(),I()),n.ie&&(C(),$(),V()),g&&(P(),A(),R(),D(),O(),F(),H(),I()),{refreshContentEditable:Z,isHidden:G}}}),o("tinymce.core.init.InitContentBody",["ephox.sugar.api.dom.Insert","ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","global!document","global!window","tinymce.core.EditorUpload","tinymce.core.ForceBlocks","tinymce.core.NodeChange","tinymce.core.SelectionOverrides","tinymce.core.UndoManager","tinymce.core.api.Formatter","tinymce.core.api.dom.Serializer","tinymce.core.caret.CaretContainerInput","tinymce.core.dom.DOMUtils","tinymce.core.dom.Selection","tinymce.core.html.DomParser","tinymce.core.html.Node","tinymce.core.html.Schema","tinymce.core.keyboard.KeyboardOverrides","tinymce.core.util.Delay","tinymce.core.util.Quirks","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p,m,g,v,y,b,_,x){var w=f.DOM,S=function(i,r){var o=e.fromDom(i.getDoc().head),a=e.fromTag("style");n.set(a,"type","text/css"),t.append(a,e.fromText(r)),t.append(o,a)},k=function(t){var e=new m(t.settings,t.schema);return e.addAttributeFilter("src,href,style,tabindex",function(e,n){for(var i,r,o,a=e.length,s=t.dom;a--;)if(i=e[a],r=i.attr(n),o="data-mce-"+n,!i.attributes.map[o]){if(0===r.indexOf("data:")||0===r.indexOf("blob:"))continue;"style"===n?((r=s.serializeStyle(s.parseStyle(r),i.name)).length||(r=null),i.attr(o,r),i.attr(n,r)):"tabindex"===n?(i.attr(o,r),i.attr(n,null)):i.attr(o,t.convertURL(r,n,i.name))}}),e.addNodeFilter("script",function(t){for(var e,n,i=t.length;i--;)0!==(n=(e=t[i]).attr("type")||"no/type").indexOf("mce-")&&e.attr("type","mce-"+n)}),e.addNodeFilter("#cdata",function(t){for(var e,n=t.length;n--;)(e=t[n]).type=8,e.name="#comment",e.value="[CDATA["+e.value+"]]"}),e.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(e){for(var n,i=e.length,r=t.schema.getNonEmptyElements();i--;)(n=e[i]).isEmpty(r)&&0===n.getAll("br").length&&(n.append(new g("br",1)).shortEnded=!0)}),e},E=function(t){t.settings.auto_focus&&b.setEditorTimeout(t,function(){var e;(e=!0===t.settings.auto_focus?t:t.editorManager.get(t.settings.auto_focus)).destroyed||e.focus()},100)},T=function(t){t.bindPendingEventDelegates(),t.initialized=!0,t.fire("init"),t.focus(!0),t.nodeChanged({initial:!0}),t.execCallback("init_instance_callback",t),E(t)},C=function(t){return t.inline?w.styleSheetLoader:t.dom.styleSheetLoader};return{initContentBody:function(t,e){var n,m,g=t.settings,b=t.getElement(),E=t.getDoc();g.inline||(t.getElement().style.visibility=t.orgVisibility),e||g.content_editable||(E.open(),E.write(t.iframeHTML),E.close()),g.content_editable&&(t.on("remove",function(){var t=this.getBody();w.removeClass(t,"mce-content-body"),w.removeClass(t,"mce-edit-focus"),w.setAttrib(t,"contentEditable",null)}),w.addClass(b,"mce-content-body"),t.contentDocument=E=g.content_document||i,t.contentWindow=g.content_window||r,t.bodyElement=b,g.content_document=g.content_window=null,g.root_name=b.nodeName.toLowerCase()),(n=t.getBody()).disabled=!0,t.readonly=g.readonly,t.readonly||(t.inline&&"static"===w.getStyle(n,"position",!0)&&(n.style.position="relative"),n.contentEditable=t.getParam("content_editable_state",!0)),n.disabled=!1,t.editorUpload=new o(t),t.schema=new v(g),t.dom=new f(E,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,hex_colors:g.force_hex_style_colors,class_filter:g.class_filter,update_styles:!0,root_element:t.inline?t.getBody():null,collect:g.content_editable,schema:t.schema,onSetAttrib:function(e){t.fire("SetAttrib",e)}}),t.parser=k(t),t.serializer=new h(g,t),t.selection=new p(t.dom,t.getWin(),t.serializer,t),t.formatter=new l(t),t.undoManager=new u(t),t._nodeChangeDispatcher=new s(t),t._selectionOverrides=new c(t),d.setup(t),y.setup(t),a.setup(t),t.fire("PreInit"),g.browser_spellcheck||g.gecko_spellcheck||(E.body.spellcheck=!1,w.setAttrib(n,"spellcheck","false")),t.quirks=new _(t),t.fire("PostRender"),g.directionality&&(n.dir=g.directionality),g.nowrap&&(n.style.whiteSpace="nowrap"),g.protect&&t.on("BeforeSetContent",function(t){x.each(g.protect,function(e){t.content=t.content.replace(e,function(t){return"<!--mce:protected "+escape(t)+"-->"})})}),t.on("SetContent",function(){t.addVisual(t.getBody())}),g.padd_empty_editor&&t.on("PostProcess",function(t){t.content=t.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|<br \/>|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")}),t.load({initial:!0,format:"html"}),t.startContent=t.getContent({format:"raw"}),t.on("compositionstart compositionend",function(e){t.composing="compositionstart"===e.type}),t.contentStyles.length>0&&(m="",x.each(t.contentStyles,function(t){m+=t+"\r\n"}),t.dom.addStyle(m)),C(t).loadAll(t.contentCSS,function(){T(t)},function(){T(t)}),g.content_style&&S(t,g.content_style)}}}),o("tinymce.core.init.InitIframe",["ephox.sugar.api.node.Element","ephox.sugar.api.properties.Attr","ephox.sugar.api.properties.Css","global!document","global!window","tinymce.core.Env","tinymce.core.api.Settings","tinymce.core.dom.DOMUtils","tinymce.core.init.InitContentBody","tinymce.core.util.Uuid"],function(t,e,n,i,r,o,a,s,c,u){var l=s.DOM,h=function(t,e){if(i.domain!==r.location.hostname&&o.ie&&o.ie<12){var n=u.uuid("mce");t[n]=function(){c.initContentBody(t)};var a='javascript:(function(){document.open();document.domain="'+i.domain+'";var ed = window.parent.tinymce.get("'+t.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return l.setAttrib(e,"src",a),!0}return!1},d=function(t){var e="number"==typeof t?t+"px":t;return e||""},f=function(i,r,o,a){var s=t.fromTag("iframe");return e.setAll(s,a),e.setAll(s,{id:i+"_ifr",frameBorder:"0",allowTransparency:"true",title:r}),n.setAll(s,{width:"100%",height:d(o),display:"block"}),s},p=function(t){var e,n,i;return i=a.getDocType(t)+"<html><head>",a.getDocumentBaseUrl(t)!==t.documentBaseUrl&&(i+='<base href="'+t.documentBaseURI.getURI()+'" />'),i+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',e=a.getBodyId(t),n=a.getBodyClass(t),a.getContentSecurityPolicy(t)&&(i+='<meta http-equiv="Content-Security-Policy" content="'+a.getContentSecurityPolicy(t)+'" />'),i+='</head><body id="'+e+'" class="mce-content-body '+n+'" data-id="'+t.id+'"><br></body></html>'},m=function(t,e){var n=t.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),i=f(t.id,n,e.height,a.getIframeAttrs(t)).dom();i.onload=function(){i.onload=null,t.fire("load")};var r=h(t,i);return t.contentAreaContainer=e.iframeContainer,t.iframeElement=i,t.iframeHTML=p(t),l.add(e.iframeContainer,i),r};return{init:function(t,e){var n=m(t,e);e.editorContainer&&(l.get(e.editorContainer).style.display=t.orgDisplay,t.hidden=l.isHidden(e.editorContainer)),t.getElement().style.display="none",l.setAttrib(t.id,"aria-hidden",!0),n||c.initContentBody(t)}}}),o("tinymce.core.init.Init",["ephox.katamari.api.Type","global!document","global!window","tinymce.core.PluginManager","tinymce.core.ThemeManager","tinymce.core.dom.DOMUtils","tinymce.core.init.InitContentBody","tinymce.core.init.InitIframe","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c){var u=o.DOM,l=function(t,e,n){var r,o,a=i.get(n);if(r=i.urls[n]||t.documentBaseUrl.replace(/\/$/,""),n=c.trim(n),a&&-1===c.inArray(e,n)){if(c.each(i.dependencies(n),function(n){l(t,e,n)}),t.plugins[n])return;o=new a(t,r,t.$),t.plugins[n]=o,o.init&&(o.init(t,r),e.push(n))}},h=function(t){return t.replace(/^\-/,"")},d=function(t){var e=[];c.each(t.settings.plugins.split(/[ ,]/),function(n){l(t,e,h(n))})},f=function(e){var n,i=e.settings.theme;t.isString(i)?(e.settings.theme=h(i),n=r.get(i),e.theme=new n(e,r.urls[i]),e.theme.init&&e.theme.init(e,r.urls[i]||e.documentBaseUrl.replace(/\/$/,""),e.$)):e.theme={}},p=function(t){var e,n,i,r,o,a=t.settings,s=t.getElement();return e=a.width||u.getStyle(s,"width")||"100%",n=a.height||u.getStyle(s,"height")||s.offsetHeight,i=a.min_height||100,(r=/^[0-9\.]+(|px)$/i).test(""+e)&&(e=Math.max(parseInt(e,10),100)),r.test(""+n)&&(n=Math.max(parseInt(n,10),i)),o=t.theme.renderUI({targetNode:s,width:e,height:n,deltaWidth:a.delta_width,deltaHeight:a.delta_height}),a.content_editable||(n=(o.iframeHeight||n)+("number"==typeof n?o.deltaHeight||0:""))<i&&(n=i),o.height=n,o},m=function(t){var e,n=t.getElement();return(e=t.settings.theme(t,n)).editorContainer.nodeType&&(e.editorContainer.id=e.editorContainer.id||t.id+"_parent"),e.iframeContainer&&e.iframeContainer.nodeType&&(e.iframeContainer.id=e.iframeContainer.id||t.id+"_iframecontainer"),e.height=e.iframeHeight?e.iframeHeight:n.offsetHeight,e},g=function(t){return{editorContainer:t,iframeContainer:t}},v=function(t){var e=u.create("div");return u.insertAfter(e,t),g(e)},y=function(t){var e=t.getElement();return t.inline?g(null):v(e)},b=function(e){var n=e.settings,i=e.getElement();return e.orgDisplay=i.style.display,t.isString(n.theme)?p(e):t.isFunction(n.theme)?m(e):y(e)};return{init:function(t){var e,n=t.settings,i=t.getElement();return t.rtl=n.rtl_ui||t.editorManager.i18n.rtl,t.editorManager.i18n.setCode(n.language),n.aria_label=n.aria_label||u.getAttrib(i,"aria-label",t.getLang("aria.rich_text_area")),t.fire("ScriptsLoaded"),f(t),d(t),e=b(t),t.editorContainer=e.editorContainer?e.editorContainer:null,n.content_css&&c.each(c.explode(n.content_css),function(e){t.contentCSS.push(t.documentBaseURI.toAbsolute(e))}),n.content_editable?a.initContentBody(t):s.init(t,e)}}}),o("tinymce.core.init.Render",["ephox.katamari.api.Type","global!window","tinymce.core.api.NotificationManager","tinymce.core.api.WindowManager","tinymce.core.dom.DOMUtils","tinymce.core.dom.EventUtils","tinymce.core.dom.ScriptLoader","tinymce.core.Env","tinymce.core.ErrorReporter","tinymce.core.init.Init","tinymce.core.PluginManager","tinymce.core.ThemeManager","tinymce.core.util.Tools"],function(t,e,n,i,r,o,a,s,c,u,l,h,d){var f=r.DOM,p=function(t){return"-"===t.charAt(0)},m=function(t,e){var n=e.settings;n.language&&"en"!==n.language&&!n.language_url&&(n.language_url=e.editorManager.baseURL+"/langs/"+n.language+".js"),n.language_url&&!e.editorManager.i18n.data[n.language]&&t.add(n.language_url)},g=function(e,n,i,r){var o=n.settings,a=o.theme;if(t.isString(a)){if(!p(a)&&!h.urls.hasOwnProperty(a)){var s=o.theme_url;s?h.load(a,n.documentBaseURI.toAbsolute(s)):h.load(a,"themes/"+a+"/theme"+i+".js")}e.loadQueue(function(){h.waitFor(a,r)})}else r()},v=function(t,e){d.isArray(t.plugins)&&(t.plugins=t.plugins.join(" ")),d.each(t.external_plugins,function(e,n){l.load(n,e),t.plugins+=" "+n}),d.each(t.plugins.split(/[ ,]/),function(t){if((t=d.trim(t))&&!l.urls[t])if(p(t)){t=t.substr(1,t.length);var n=l.dependencies(t);d.each(n,function(t){var n={prefix:"plugins/",resource:t,suffix:"/plugin"+e+".js"};t=l.createUrl(n,t),l.load(t.resource,t)})}else l.load(t,{prefix:"plugins/",resource:t,suffix:"/plugin"+e+".js"})})},y=function(t,e){var n=a.ScriptLoader;g(n,t,e,function(){m(n,t),v(t.settings,e),n.loadQueue(function(){t.removed||u.init(t)},t,function(e){c.pluginLoadError(t,e[0]),t.removed||u.init(t)})})};return{render:function(t){var r=t.settings,a=t.id,c=function(){f.unbind(e,"ready",c),t.render()};if(o.Event.domLoaded){if(t.getElement()&&s.contentEditable){r.inline?t.inline=!0:(t.orgVisibility=t.getElement().style.visibility,t.getElement().style.visibility="hidden");var u=t.getElement().form||f.getParent(a,"form");u&&(t.formElement=u,r.hidden_input&&!/TEXTAREA|INPUT/i.test(t.getElement().nodeName)&&(f.insertAfter(f.create("input",{type:"hidden",name:a}),a),t.hasHiddenInput=!0),t.formEventDelegate=function(e){t.fire(e.type,e)},f.bind(u,"submit reset",t.formEventDelegate),t.on("reset",function(){t.setContent(t.startContent,{format:"raw"})}),!r.submit_patch||u.submit.nodeType||u.submit.length||u._mceOldSubmit||(u._mceOldSubmit=u.submit,u.submit=function(){return t.editorManager.triggerSave(),t.setDirty(!1),u._mceOldSubmit(u)})),t.windowManager=new i(t),t.notificationManager=new n(t),"xml"===r.encoding&&t.on("GetContent",function(t){t.save&&(t.content=f.encode(t.content))}),r.add_form_submit_trigger&&t.on("submit",function(){t.initialized&&t.save()}),r.add_unload_trigger&&(t._beforeUnload=function(){!t.initialized||t.destroyed||t.isHidden()||t.save({format:"raw",no_events:!0,set_dirty:!1})},t.editorManager.on("BeforeUnload",t._beforeUnload)),t.editorManager.add(t),y(t,t.suffix)}}else f.bind(e,"ready",c)}}}),o("tinymce.core.ui.Sidebar",[],function(){return{add:function(t,e,n){var i=t.sidebars?t.sidebars:[];i.push({name:e,settings:n}),t.sidebars=i}}}),o("tinymce.core.util.URI",["global!document","tinymce.core.util.Tools"],function(t,e){var n=e.each,i=e.trim,r="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),o={ftp:21,http:80,https:443,mailto:25},a=function(e,o){var s,c,u=this;if(e=i(e),o=u.settings=o||{},s=o.base_uri,/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e))u.source=e;else{var l=0===e.indexOf("//");0!==e.indexOf("/")||l||(e=(s?s.protocol||"http":"http")+"://mce_host"+e),/^[\w\-]*:?\/\//.test(e)||(c=o.base_uri?o.base_uri.path:new a(t.location.href).directory,""===o.base_uri.protocol?e="//mce_host"+u.toAbsPath(c,e):(e=/([^#?]*)([#?]?.*)/.exec(e),e=(s&&s.protocol||"http")+"://mce_host"+u.toAbsPath(c,e[1])+e[2])),e=e.replace(/@@/g,"(mce_at)"),e=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e),n(r,function(t,n){var i=e[n];i&&(i=i.replace(/\(mce_at\)/g,"@@")),u[t]=i}),s&&(u.protocol||(u.protocol=s.protocol),u.userInfo||(u.userInfo=s.userInfo),u.port||"mce_host"!==u.host||(u.port=s.port),u.host&&"mce_host"!==u.host||(u.host=s.host),u.source=""),l&&(u.protocol="")}};return a.prototype={setPath:function(t){var e=this;t=/^(.*?)\/?(\w+)?$/.exec(t),e.path=t[0],e.directory=t[1],e.file=t[2],e.source="",e.getURI()},toRelative:function(t){var e,n=this;if("./"===t)return t;if("mce_host"!=(t=new a(t,{base_uri:n})).host&&n.host!=t.host&&t.host||n.port!=t.port||n.protocol!=t.protocol&&""!==t.protocol)return t.getURI();var i=n.getURI(),r=t.getURI();return i==r||"/"==i.charAt(i.length-1)&&i.substr(0,i.length-1)==r?i:(e=n.toRelPath(n.path,t.path),t.query&&(e+="?"+t.query),t.anchor&&(e+="#"+t.anchor),e)},toAbsolute:function(t,e){return(t=new a(t,{base_uri:this})).getURI(e&&this.isSameOrigin(t))},isSameOrigin:function(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;var e=o[this.protocol];if(e&&(this.port||e)==(t.port||e))return!0}return!1},toRelPath:function(t,e){var n,i,r,o=0,a="";if(t=t.substring(0,t.lastIndexOf("/")),t=t.split("/"),n=e.split("/"),t.length>=n.length)for(i=0,r=t.length;i<r;i++)if(i>=n.length||t[i]!=n[i]){o=i+1;break}if(t.length<n.length)for(i=0,r=n.length;i<r;i++)if(i>=t.length||t[i]!=n[i]){o=i+1;break}if(1===o)return e;for(i=0,r=t.length-(o-1);i<r;i++)a+="../";for(i=o-1,r=n.length;i<r;i++)a+=i!=o-1?"/"+n[i]:n[i];return a},toAbsPath:function(t,e){var i,r,o,a=0,s=[];for(r=/\/$/.test(e)?"/":"",t=t.split("/"),e=e.split("/"),n(t,function(t){t&&s.push(t)}),t=s,i=e.length-1,s=[];i>=0;i--)0!==e[i].length&&"."!==e[i]&&(".."!==e[i]?a>0?a--:s.push(e[i]):a++);return i=t.length-a,0!==(o=i<=0?s.reverse().join("/"):t.slice(0,i).join("/")+"/"+s.reverse().join("/")).indexOf("/")&&(o="/"+o),r&&o.lastIndexOf("/")!==o.length-1&&(o+=r),o},getURI:function(t){var e,n=this;return n.source&&!t||(e="",t||(n.protocol?e+=n.protocol+"://":e+="//",n.userInfo&&(e+=n.userInfo+"@"),n.host&&(e+=n.host),n.port&&(e+=":"+n.port)),n.path&&(e+=n.path),n.query&&(e+="?"+n.query),n.anchor&&(e+="#"+n.anchor),n.source=e),n.source}},a.parseDataUri=function(t){var e,n;return t=decodeURIComponent(t).split(","),(n=/data:([^;]+)/.exec(t[0]))&&(e=n[1]),{type:e,data:t[1]}},a.getDocumentBaseUrl=function(t){var e;return e=0!==t.protocol.indexOf("http")&&"file:"!==t.protocol?t.href:t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(e)&&(e=e.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(e)||(e+="/")),e},a}),o("tinymce.core.Editor",["tinymce.core.AddOnManager","tinymce.core.EditorCommands","tinymce.core.EditorObservable","tinymce.core.EditorSettings","tinymce.core.Env","tinymce.core.Mode","tinymce.core.Shortcuts","tinymce.core.dom.DOMUtils","tinymce.core.dom.DomQuery","tinymce.core.dom.TrimHtml","tinymce.core.focus.EditorFocus","tinymce.core.html.Serializer","tinymce.core.init.Render","tinymce.core.ui.Sidebar","tinymce.core.util.Tools","tinymce.core.util.URI","tinymce.core.util.Uuid"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p,m,g){var v=s.DOM,y=p.extend,b=p.each,_=p.trim,x=p.resolve,w=r.ie,S=function(n,o,s){var u,l,h=this;u=h.documentBaseUrl=s.documentBaseURL,l=s.baseURI,o=i.getEditorSettings(h,n,u,s.defaultSettings,o),h.settings=o,t.language=o.language||"en",t.languageLoad=o.language_load,t.baseURL=s.baseURL,h.id=n,h.setDirty(!1),h.plugins={},h.documentBaseURI=new m(o.document_base_url,{base_uri:l}),h.baseURI=l,h.contentCSS=[],h.contentStyles=[],h.shortcuts=new a(h),h.loadedCSS={},h.editorCommands=new e(h),h.suffix=s.suffix,h.editorManager=s,h.inline=o.inline,h.buttons={},h.menuItems={},o.cache_suffix&&(r.cacheSuffix=o.cache_suffix.replace(/^[\?\&]+/,"")),!1===o.override_viewport&&(r.overrideViewPort=!1),s.fire("SetupEditor",h),h.execCallback("setup",h),h.$=c.overrideDefaults(function(){return{context:h.inline?h.getBody():h.getDoc(),element:h.getBody()}})};return S.prototype={render:function(){d.render(this)},focus:function(t){l.focus(this,t)},execCallback:function(t){var e,n=this,i=n.settings[t];if(i)return n.callbackLookup&&(e=n.callbackLookup[t])&&(i=e.func,e=e.scope),"string"==typeof i&&(e=(e=i.replace(/\.\w+$/,""))?x(e):0,i=x(i),n.callbackLookup=n.callbackLookup||{},n.callbackLookup[t]={func:i,scope:e}),i.apply(e||n,Array.prototype.slice.call(arguments,1))},translate:function(t){if(t&&p.is(t,"string")){var e=this.settings.language||"en",n=this.editorManager.i18n;t=n.data[e+"."+t]||t.replace(/\{\#([^\}]+)\}/g,function(t,i){return n.data[e+"."+i]||"{#"+i+"}"})}return this.editorManager.translate(t)},getLang:function(t,e){return this.editorManager.i18n.data[(this.settings.language||"en")+"."+t]||(e!==undefined?e:"{#"+t+"}")},getParam:function(t,e,n){var i,r=t in this.settings?this.settings[t]:e;return"hash"===n?(i={},"string"==typeof r?b(r.indexOf("=")>0?r.split(/[;,](?![^=;,]*(?:[;,]|$))/):r.split(","),function(t){(t=t.split("=")).length>1?i[_(t[0])]=_(t[1]):i[_(t[0])]=_(t)}):i=r,i):r},nodeChanged:function(t){this._nodeChangeDispatcher.nodeChanged(t)},addButton:function(t,e){var n=this;e.cmd&&(e.onclick=function(){n.execCommand(e.cmd)}),e.stateSelector&&"undefined"==typeof e.active&&(e.active=!1),e.text||e.icon||(e.icon=t),n.buttons=n.buttons,e.tooltip=e.tooltip||e.title,n.buttons[t]=e},addSidebar:function(t,e){return f.add(this,t,e)},addMenuItem:function(t,e){var n=this;e.cmd&&(e.onclick=function(){n.execCommand(e.cmd)}),n.menuItems=n.menuItems,n.menuItems[t]=e},addContextToolbar:function(t,e){var n,i=this;i.contextToolbars=i.contextToolbars||[],"string"==typeof t&&(n=t,t=function(t){return i.dom.is(t,n)}),i.contextToolbars.push({id:g.uuid("mcet"),predicate:t,items:e})},addCommand:function(t,e,n){this.editorCommands.addCommand(t,e,n)},addQueryStateHandler:function(t,e,n){this.editorCommands.addQueryStateHandler(t,e,n)},addQueryValueHandler:function(t,e,n){this.editorCommands.addQueryValueHandler(t,e,n)},addShortcut:function(t,e,n,i){this.shortcuts.add(t,e,n,i)},execCommand:function(t,e,n,i){return this.editorCommands.execCommand(t,e,n,i)},queryCommandState:function(t){return this.editorCommands.queryCommandState(t)},queryCommandValue:function(t){return this.editorCommands.queryCommandValue(t)},queryCommandSupported:function(t){return this.editorCommands.queryCommandSupported(t)},show:function(){var t=this;t.hidden&&(t.hidden=!1,t.inline?t.getBody().contentEditable=!0:(v.show(t.getContainer()),v.hide(t.id)),t.load(),t.fire("show"))},hide:function(){var t=this,e=t.getDoc();t.hidden||(w&&e&&!t.inline&&e.execCommand("SelectAll"),t.save(),t.inline?(t.getBody().contentEditable=!1,t==t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):(v.hide(t.getContainer()),v.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.fire("hide"))},isHidden:function(){return!!this.hidden},setProgressState:function(t,e){this.fire("ProgressState",{state:t,time:e})},load:function(t){var e,n=this,i=n.getElement();return n.removed?"":i?(t=t||{},t.load=!0,e=n.setContent(i.value!==undefined?i.value:i.innerHTML,t),t.element=i,t.no_events||n.fire("LoadContent",t),t.element=i=null,e):void 0},save:function(t){var e,n,i=this,r=i.getElement();if(r&&i.initialized&&!i.removed)return t=t||{},t.save=!0,t.element=r,e=t.content=i.getContent(t),t.no_events||i.fire("SaveContent",t),"raw"==t.format&&i.fire("RawSaveContent",t),e=t.content,/TEXTAREA|INPUT/i.test(r.nodeName)?r.value=e:(i.inline||(r.innerHTML=e),(n=v.getParent(i.id,"form"))&&b(n.elements,function(t){if(t.name==i.id)return t.value=e,!1})),t.element=r=null,!1!==t.set_dirty&&i.setDirty(!1),e},setContent:function(t,e){var n,i,r=this,o=r.getBody();return e=e||{},e.format=e.format||"html",e.set=!0,e.content=t,e.no_events||r.fire("BeforeSetContent",e),0===(t=e.content).length||/^\s+$/.test(t)?(i=w&&w<11?"":'<br data-mce-bogus="1">',"TABLE"==o.nodeName?t="<tr><td>"+i+"</td></tr>":/^(UL|OL)$/.test(o.nodeName)&&(t="<li>"+i+"</li>"),(n=r.settings.forced_root_block)&&r.schema.isValidChild(o.nodeName.toLowerCase(),n.toLowerCase())?(t=i,t=r.dom.createHTML(n,r.settings.forced_root_block_attrs,t)):w||t||(t='<br data-mce-bogus="1">'),r.dom.setHTML(o,t),r.fire("SetContent",e)):("raw"!==e.format&&(t=new h({validate:r.validate},r.schema).serialize(r.parser.parse(t,{isRootContent:!0,insert:!0}))),e.content=_(t),r.dom.setHTML(o,e.content),e.no_events||r.fire("SetContent",e)),e.content},getContent:function(t){var e,n=this,i=n.getBody();if(n.removed)return"";if(t=t||{},t.format=t.format||"html",t.get=!0,t.getInner=!0,t.no_events||n.fire("BeforeGetContent",t),"raw"===t.format)e=p.trim(u.trimExternal(n.serializer,i.innerHTML));else if("text"===t.format)e=i.innerText||i.textContent;else{if("tree"===t.format)return n.serializer.serialize(i,t);e=n.serializer.serialize(i,t)}return"text"!==t.format?t.content=_(e):t.content=e,t.no_events||n.fire("GetContent",t),t.content},insertContent:function(t,e){e&&(t=y({content:t},e)),this.execCommand("mceInsertContent",!1,t)},isDirty:function(){return!this.isNotDirty},setDirty:function(t){var e=!this.isNotDirty;this.isNotDirty=!t,t&&t!=e&&this.fire("dirty")},setMode:function(t){o.setMode(this,t)},getContainer:function(){var t=this;return t.container||(t.container=v.get(t.editorContainer||t.id+"_parent")),t.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return this.targetElm||(this.targetElm=v.get(this.id)),this.targetElm},getWin:function(){var t,e=this;return e.contentWindow||(t=e.iframeElement)&&(e.contentWindow=t.contentWindow),e.contentWindow},getDoc:function(){var t,e=this;return e.contentDocument||(t=e.getWin())&&(e.contentDocument=t.document),e.contentDocument},getBody:function(){var t=this.getDoc();return this.bodyElement||(t?t.body:null)},convertURL:function(t,e,n){var i=this,r=i.settings;return r.urlconverter_callback?i.execCallback("urlconverter_callback",t,n,!0,e):!r.convert_urls||n&&"LINK"==n.nodeName||0===t.indexOf("file:")||0===t.length?t:r.relative_urls?i.documentBaseURI.toRelative(t):t=i.documentBaseURI.toAbsolute(t,r.remove_script_host)},addVisual:function(t){var e,n=this,i=n.settings,r=n.dom;t=t||n.getBody(),n.hasVisual===undefined&&(n.hasVisual=i.visual),b(r.select("table,a",t),function(t){var o;switch(t.nodeName){case"TABLE":return e=i.visual_table_class||"mce-item-table",void((o=r.getAttrib(t,"border"))&&"0"!=o||!n.hasVisual?r.removeClass(t,e):r.addClass(t,e));case"A":return void(r.getAttrib(t,"href",!1)||(o=r.getAttrib(t,"name")||t.id,e=i.visual_anchor_class||"mce-item-anchor",o&&n.hasVisual?r.addClass(t,e):r.removeClass(t,e)))}}),n.fire("VisualAid",{element:t,hasVisual:n.hasVisual})},remove:function(){var t=this;t.removed||(t.save(),t.removed=1,t.unbindAllNativeEvents(),t.hasHiddenInput&&v.remove(t.getElement().nextSibling),t.inline||(w&&w<10&&t.getDoc().execCommand("SelectAll",!1,null),v.setStyle(t.id,"display",t.orgDisplay),t.getBody().onload=null),t.fire("remove"),t.editorManager.remove(t),v.remove(t.getContainer()),t._selectionOverrides.destroy(),t.editorUpload.destroy(),t.destroy())},destroy:function(t){var e,n=this;n.destroyed||(t||n.removed?(t||(n.editorManager.off("beforeunload",n._beforeUnload),n.theme&&n.theme.destroy&&n.theme.destroy(),n.selection.destroy(),n.dom.destroy()),(e=n.formElement)&&(e._mceOldSubmit&&(e.submit=e._mceOldSubmit,e._mceOldSubmit=null),v.unbind(e,"submit reset",n.formEventDelegate)),n.contentAreaContainer=n.formElement=n.container=n.editorContainer=null,n.bodyElement=n.contentDocument=n.contentWindow=null,n.iframeElement=n.targetElm=null,n.selection&&(n.selection=n.selection.win=n.selection.dom=n.selection.dom.doc=null),n.destroyed=1):n.remove())},uploadImages:function(t){return this.editorUpload.uploadImages(t)},_scanForImages:function(){return this.editorUpload.scanForImages()}},y(S.prototype,n),S}),o("tinymce.core.api.FocusManager",["global!document"],function(){return{isEditorUIElement:function(t){return-1!==t.className.toString().indexOf("mce-")}}}),o("tinymce.core.selection.SelectionRestore",["ephox.katamari.api.Throttler","ephox.sand.api.PlatformDetection","global!document","tinymce.core.dom.DOMUtils","tinymce.core.selection.SelectionBookmark"],function(t,e,n,i,r){var o=function(t){return"nodechange"===t.type&&t.selectionChange},a=function(t,e){var r=function(){e.throttle()};i.DOM.bind(n,"mouseup",r),t.on("remove",function(){i.DOM.unbind(n,"mouseup",r)})},s=function(t){t.on("focusout",function(){r.store(t)})},c=function(t,e){t.on("mouseup touchend",function(){e.throttle()})},u=function(t,n){var i=e.detect().browser;i.isIE()||i.isEdge()?s(t):c(t,n),t.on("keyup nodechange",function(e){o(e)||r.store(t)})};return{register:function(e){var n=t.first(function(){r.store(e)},0);e.inline&&a(e,n),e.on("init",function(){u(e,n)}),e.on("remove",function(){n.cancel()})}}}),o("tinymce.core.focus.FocusController",["ephox.katamari.api.Fun","global!document","tinymce.core.api.FocusManager","tinymce.core.dom.DOMUtils","tinymce.core.selection.SelectionRestore","tinymce.core.util.Delay"],function(t,e,n,i,r,o){var a,s=i.DOM,c=function(t){return n.isEditorUIElement(t)},u=function(t,e){var n=t?t.settings.custom_ui_selector:"";return null!==s.getParent(e,function(e){return c(e)||!!n&&t.dom.is(e,n)})},l=function(){try{return e.activeElement}catch(t){return e.body}},h=function(t,n){var i=n.editor;r.register(i),i.on("focusin",function(){var e=t.focusedEditor;e!=i&&(e&&e.fire("blur",{focusedEditor:i}),t.setActive(i),
t.focusedEditor=i,i.fire("focus",{blurredEditor:e}),i.focus(!0))}),i.on("focusout",function(){o.setEditorTimeout(i,function(){var e=t.focusedEditor;u(i,l())||e!=i||(i.fire("blur",{focusedEditor:null}),t.focusedEditor=null)})}),a||(a=function(n){var i,r=t.activeEditor;i=n.target,r&&i.ownerDocument===e&&(i===e.body||u(r,i)||t.focusedEditor!==r||(r.fire("blur",{focusedEditor:null}),t.focusedEditor=null))},s.bind(e,"focusin",a))},d=function(t,n){t.focusedEditor==n.editor&&(t.focusedEditor=null),t.activeEditor||(s.unbind(e,"focusin",a),a=null)};return{setup:function(e){e.on("AddEditor",t.curry(h,e)),e.on("RemoveEditor",t.curry(d,e))},isEditorUIElement:c,isUIElement:u}}),o("tinymce.core.util.I18n",["tinymce.core.util.Tools"],function(t){"use strict";var e={},n="en";return{setCode:function(t){t&&(n=t,this.rtl=!!this.data[t]&&"rtl"===this.data[t]._dir)},getCode:function(){return n},rtl:!1,add:function(t,n){var i=e[t];i||(e[t]=i={});for(var r in n)i[r]=n[r];this.setCode(t)},translate:function(i){var r=e[n]||{},o=function(e){return t.is(e,"function")?Object.prototype.toString.call(e):a(e)?"":""+e},a=function(e){return""===e||null===e||t.is(e,"undefined")},s=function(e){return e=o(e),t.hasOwn(r,e)?o(r[e]):e};if(a(i))return"";if(t.is(i,"object")&&t.hasOwn(i,"raw"))return o(i.raw);if(t.is(i,"array")){var c=i.slice(1);i=s(i[0]).replace(/\{([0-9]+)\}/g,function(e,n){return t.hasOwn(c,n)?o(c[n]):e})}return s(i).replace(/{context:\w+}$/,"")},data:e}}),o("tinymce.core.EditorManager",["ephox.katamari.api.Arr","ephox.katamari.api.Type","global!document","global!window","tinymce.core.AddOnManager","tinymce.core.Editor","tinymce.core.Env","tinymce.core.ErrorReporter","tinymce.core.dom.DOMUtils","tinymce.core.dom.DomQuery","tinymce.core.focus.FocusController","tinymce.core.util.I18n","tinymce.core.util.Observable","tinymce.core.util.Promise","tinymce.core.util.Tools","tinymce.core.util.URI"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p,m){var g,v,y=c.DOM,b=p.explode,_=p.each,x=p.extend,w=0,S=!1,k=[],E=[],T=function(t){return"length"!==t},C=function(t){_(v.get(),function(e){"scroll"===t.type?e.fire("ScrollWindow",t):e.fire("ResizeWindow",t)})},L=function(t){t!==S&&(t?u(i).on("resize scroll",C):u(i).off("resize scroll",C),S=t)},P=function(e){var n=E;delete k[e.id];for(var i=0;i<k.length;i++)if(k[i]===e){k.splice(i,1);break}return E=t.filter(E,function(t){return e!==t}),v.activeEditor===e&&(v.activeEditor=E.length>0?E[0]:null),v.focusedEditor===e&&(v.focusedEditor=null),n.length!==E.length},A=function(t){return t&&t.initialized&&!(t.getContainer()||t.getBody()).parentNode&&(P(t),t.unbindAllNativeEvents(),t.destroy(!0),t.removed=!0,t=null),t};return v={defaultSettings:{},$:u,majorVersion:"4",minorVersion:"7.3",releaseDate:"2017-11-23",editors:k,i18n:h,activeEditor:null,settings:{},setup:function(){var t,e,r,o,a=this,s="";if(e=m.getDocumentBaseUrl(n.location),/^[^:]+:\/\/\/?[^\/]+\//.test(e)&&(e=e.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(e)||(e+="/")),r=i.tinymce||i.tinyMCEPreInit)t=r.base||r.baseURL,s=r.suffix;else{for(var c=n.getElementsByTagName("script"),u=0;u<c.length;u++){var h=(o=c[u].src).substring(o.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(o)){-1!=h.indexOf(".min")&&(s=".min"),t=o.substring(0,o.lastIndexOf("/"));break}}!t&&n.currentScript&&(-1!=(o=n.currentScript.src).indexOf(".min")&&(s=".min"),t=o.substring(0,o.lastIndexOf("/")))}a.baseURL=new m(e).toAbsolute(t),a.documentBaseURL=e,a.baseURI=new m(a.baseURL),a.suffix=s,l.setup(a)},overrideDefaults:function(t){var e,n;(e=t.base_url)&&(this.baseURL=new m(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new m(this.baseURL)),n=t.suffix,t.suffix&&(this.suffix=n),this.defaultSettings=t;var i=t.plugin_base_urls;for(var o in i)r.PluginManager.urls[o]=i[o]},init:function(t){var e,r,c=this;r=p.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option tbody tfoot thead tr script noscript style textarea video audio iframe object menu"," ");var l=function(t,e){return t.inline&&e.tagName.toLowerCase()in r},h=function(t){var e=t.id;return e||(e=(e=t.name)&&!y.get(e)?t.name:y.uniqueId(),t.setAttribute("id",e)),e},d=function(e){var n=t[e];if(n)return n.apply(c,Array.prototype.slice.call(arguments,2))},m=function(t,e){return e.constructor===RegExp?e.test(t.className):y.hasClass(t,e)},g=function(t){var e,i=[];if(a.ie&&a.ie<11)return s.initError("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(t.types)return _(t.types,function(t){i=i.concat(y.select(t.selector))}),i;if(t.selector)return y.select(t.selector);if(t.target)return[t.target];switch(t.mode){case"exact":(e=t.elements||"").length>0&&_(b(e),function(t){var e;(e=y.get(t))?i.push(e):_(n.forms,function(e){_(e.elements,function(e){e.name===t&&(t="mce_editor_"+w++,y.setAttrib(e,"id",t),i.push(e))})})});break;case"textareas":case"specific_textareas":_(y.select("textarea"),function(e){t.editor_deselector&&m(e,t.editor_deselector)||t.editor_selector&&!m(e,t.editor_selector)||i.push(e)})}return i},v=function(t){e=t},S=function(){var e,n=0,r=[],a=function(t,i,a){var s=new o(t,i,c);r.push(s),s.on("init",function(){++n===e.length&&v(r)}),s.targetElm=s.targetElm||a,s.render()};y.unbind(i,"ready",S),d("onpageload"),e=u.unique(g(t)),t.types?_(t.types,function(n){p.each(e,function(e){return!y.is(e,n.selector)||(a(h(e),x({},t,n),e),!1)})}):(p.each(e,function(t){A(c.get(t.id))}),0===(e=p.grep(e,function(t){return!c.get(t.id)})).length?v([]):_(e,function(e){l(t,e)?s.initError("Could not initialize inline editor on invalid inline target element",e):a(h(e),t,e)}))};return c.settings=t,y.bind(i,"ready",S),new f(function(t){e?t(e):v=function(e){t(e)}})},get:function(n){return 0===arguments.length?E.slice(0):e.isString(n)?t.find(E,function(t){return t.id===n}).getOr(null):e.isNumber(n)&&E[n]?E[n]:null},add:function(t){var e=this;return k[t.id]===t?t:(null===e.get(t.id)&&(T(t.id)&&(k[t.id]=t),k.push(t),E.push(t)),L(!0),e.activeEditor=t,e.fire("AddEditor",{editor:t}),g||(g=function(){e.fire("BeforeUnload")},y.bind(i,"beforeunload",g)),t)},createEditor:function(t,e){return this.add(new o(t,e,this))},remove:function(t){var n,r,o=this;{if(t)return e.isString(t)?(t=t.selector||t,void _(y.select(t),function(t){(r=o.get(t.id))&&o.remove(r)})):(r=t,e.isNull(o.get(r.id))?null:(P(r)&&o.fire("RemoveEditor",{editor:r}),0===E.length&&y.unbind(i,"beforeunload",g),r.remove(),L(E.length>0),r));for(n=E.length-1;n>=0;n--)o.remove(E[n])}},execCommand:function(t,e,n){var i=this,r=i.get(n);switch(t){case"mceAddEditor":return i.get(n)||new o(n,i.settings,i).render(),!0;case"mceRemoveEditor":return r&&r.remove(),!0;case"mceToggleEditor":return r?(r.isHidden()?r.show():r.hide(),!0):(i.execCommand("mceAddEditor",0,n),!0)}return!!i.activeEditor&&i.activeEditor.execCommand(t,e,n)},triggerSave:function(){_(E,function(t){t.save()})},addI18n:function(t,e){h.add(t,e)},translate:function(t){return h.translate(t)},setActive:function(t){var e=this.activeEditor;this.activeEditor!=t&&(e&&e.fire("deactivate",{relatedTarget:t}),t.fire("activate",{relatedTarget:e})),this.activeEditor=t}},x(v,d),v.setup(),v}),o("tinymce.core.api.dom.RangeUtils",["ephox.katamari.api.Fun","tinymce.core.selection.CaretRangeFromPoint","tinymce.core.selection.NormalizeRange","tinymce.core.selection.RangeCompare","tinymce.core.selection.RangeNodes","tinymce.core.selection.RangeWalk","tinymce.core.selection.SplitRange"],function(t,e,n,i,r,o,a){var s=function(e){return{walk:function(t,n){return o.walk(e,t,n)},split:a.split,normalize:function(i){return n.normalize(e,i).fold(t.constant(!1),function(t){return i.setStart(t.startContainer,t.startOffset),i.setEnd(t.endContainer,t.endOffset),!0})}}};return s.compareRanges=i.isEq,s.getCaretRangeFromPoint=e.fromPoint,s.getSelectedNode=r.getSelectedNode,s.getNode=r.getNode,s}),o("tinymce.core.geom.Rect",[],function(){"use strict";var t=Math.min,e=Math.max,n=Math.round,i=function(t,e,i){var r,o,a,c,u,l;return r=e.x,o=e.y,a=t.w,c=t.h,u=e.w,l=e.h,"b"===(i=(i||"").split(""))[0]&&(o+=l),"r"===i[1]&&(r+=u),"c"===i[0]&&(o+=n(l/2)),"c"===i[1]&&(r+=n(u/2)),"b"===i[3]&&(o-=c),"r"===i[4]&&(r-=a),"c"===i[3]&&(o-=n(c/2)),"c"===i[4]&&(r-=n(a/2)),s(r,o,a,c)},r=function(t,e,n){return s(t.x-e,t.y-n,t.w+2*e,t.h+2*n)},o=function(n,i){var r,o,a,c;return r=e(n.x,i.x),o=e(n.y,i.y),a=t(n.x+n.w,i.x+i.w),c=t(n.y+n.h,i.y+i.h),a-r<0||c-o<0?null:s(r,o,a-r,c-o)},a=function(t,n,i){var r,o,a,c,u,l,h,d,f,p;return u=t.x,l=t.y,h=t.x+t.w,d=t.y+t.h,f=n.x+n.w,p=n.y+n.h,r=e(0,n.x-u),o=e(0,n.y-l),a=e(0,h-f),c=e(0,d-p),u+=r,l+=o,i&&(h+=r,d+=o,u-=a,l-=c),h-=a,d-=c,s(u,l,h-u,d-l)},s=function(t,e,n,i){return{x:t,y:e,w:n,h:i}};return{inflate:r,relativePosition:i,findBestRelativePosition:function(t,e,n,r){var o,a;for(a=0;a<r.length;a++)if((o=i(t,e,r[a])).x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return r[a];return null},intersect:o,clamp:a,create:s,fromClientRect:function(t){return s(t.left,t.top,t.width,t.height)}}}),o("tinymce.core.ui.Factory",[],function(){"use strict";var t={};return{add:function(e,n){t[e.toLowerCase()]=n},has:function(e){return!!t[e.toLowerCase()]},get:function(e){var n=e.toLowerCase(),i=t.hasOwnProperty(n)?t[n]:null;if(null===i)throw new Error("Could not find module for type: "+e);return i},create:function(e,n){var i;if("string"==typeof e?(n=n||{}).type=e:e=(n=e).type,e=e.toLowerCase(),!(i=t[e]))throw new Error("Could not find control by type: "+e);return i=new i(n),i.type=e,i}}}),o("tinymce.core.util.Class",["tinymce.core.util.Tools"],function(t){var e,n,i=t.each,r=t.extend,o=function(){};return o.extend=e=function(t){var o,a,s,c=this,u=c.prototype,l=function(){var t,e,i,r=this;if(!n&&(r.init&&r.init.apply(r,arguments),e=r.Mixins))for(t=e.length;t--;)(i=e[t]).init&&i.init.apply(r,arguments)},h=function(){return this},d=function(t,e){return function(){var n,i=this,r=i._super;return i._super=u[t],n=e.apply(i,arguments),i._super=r,n}};n=!0,o=new c,n=!1,t.Mixins&&(i(t.Mixins,function(e){for(var n in e)"init"!==n&&(t[n]=e[n])}),u.Mixins&&(t.Mixins=u.Mixins.concat(t.Mixins))),t.Methods&&i(t.Methods.split(","),function(e){t[e]=h}),t.Properties&&i(t.Properties.split(","),function(e){var n="_"+e;t[e]=function(t){var e,i=this;return t!==e?(i[n]=t,i):i[n]}}),t.Statics&&i(t.Statics,function(t,e){l[e]=t}),t.Defaults&&u.Defaults&&(t.Defaults=r({},u.Defaults,t.Defaults));for(a in t)"function"==typeof(s=t[a])&&u[a]?o[a]=d(a,s):o[a]=s;return l.prototype=o,l.constructor=l,l.extend=e,l},o}),o("tinymce.core.util.Color",[],function(){var t=Math.min,e=Math.max,n=Math.round;return function(i){var r=this,o=0,a=0,s=0,c=function(i,r,o){var a,s,c,u,l,h;return a=0,s=0,c=0,i/=255,r/=255,o/=255,l=t(i,t(r,o)),h=e(i,e(r,o)),l==h?(c=l,{h:0,s:0,v:100*c}):(u=i==l?r-o:o==l?i-r:o-i,a=i==l?3:o==l?1:5,a=60*(a-u/(h-l)),s=(h-l)/h,c=h,{h:n(a),s:n(100*s),v:n(100*c)})},u=function(i,r,c){var u,l,h,d;if(i=(parseInt(i,10)||0)%360,r=parseInt(r,10)/100,c=parseInt(c,10)/100,r=e(0,t(r,1)),c=e(0,t(c,1)),0!==r){switch(u=i/60,l=c*r,h=l*(1-Math.abs(u%2-1)),d=c-l,Math.floor(u)){case 0:o=l,a=h,s=0;break;case 1:o=h,a=l,s=0;break;case 2:o=0,a=l,s=h;break;case 3:o=0,a=h,s=l;break;case 4:o=h,a=0,s=l;break;case 5:o=l,a=0,s=h;break;default:o=a=s=0}o=n(255*(o+d)),a=n(255*(a+d)),s=n(255*(s+d))}else o=a=s=n(255*c)},l=function(){var t=function(t){return(t=parseInt(t,10).toString(16)).length>1?t:"0"+t};return"#"+t(o)+t(a)+t(s)},h=function(){return{r:o,g:a,b:s}},d=function(){return c(o,a,s)},f=function(t){var e;return"object"==typeof t?"r"in t?(o=t.r,a=t.g,s=t.b):"v"in t&&u(t.h,t.s,t.v):(e=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(t))?(o=parseInt(e[1],10),a=parseInt(e[2],10),s=parseInt(e[3],10)):(e=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(t))?(o=parseInt(e[1],16),a=parseInt(e[2],16),s=parseInt(e[3],16)):(e=/#([0-F])([0-F])([0-F])/gi.exec(t))&&(o=parseInt(e[1]+e[1],16),a=parseInt(e[2]+e[2],16),s=parseInt(e[3]+e[3],16)),o=o<0?0:o>255?255:o,a=a<0?0:a>255?255:a,s=s<0?0:s>255?255:s,r};i&&f(i),r.toRgb=h,r.toHsv=d,r.toHex=l,r.parse=f}}),o("tinymce.core.util.JSON",["global!window"],function(t){var e=function(t,n){var i,r,o,a;if(n=n||'"',null===t)return"null";if("string"==(o=typeof t))return r="\bb\tt\nn\ff\rr\"\"''\\\\",n+t.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(t,e){return'"'===n&&"'"===t?t:(i=r.indexOf(e))+1?"\\"+r.charAt(i+1):(t=e.charCodeAt().toString(16),"\\u"+"0000".substring(t.length)+t)})+n;if("object"==o){if(t.hasOwnProperty&&"[object Array]"===Object.prototype.toString.call(t)){for(i=0,r="[";i<t.length;i++)r+=(i>0?",":"")+e(t[i],n);return r+"]"}r="{";for(a in t)t.hasOwnProperty(a)&&(r+="function"!=typeof t[a]?(r.length>1?","+n:n)+a+n+":"+e(t[a],n):"");return r+"}"}return""+t};return{serialize:e,parse:function(e){try{return t[String.fromCharCode(101)+"val"]("("+e+")")}catch(n){}}}}),o("tinymce.core.util.JSONP",["tinymce.core.dom.DOMUtils"],function(t){return{callbacks:{},count:0,send:function(e){var n=this,i=t.DOM,r=e.count!==undefined?e.count:n.count,o="tinymce_jsonp_"+r;n.callbacks[r]=function(t){i.remove(o),delete n.callbacks[r],e.callback(t)},i.add(i.doc.body,"script",{id:o,src:e.url,type:"text/javascript"}),n.count++}}}),o("tinymce.core.util.XHR",["ephox.sand.api.XMLHttpRequest","global!setTimeout","tinymce.core.util.Observable","tinymce.core.util.Tools"],function(t,e,n,i){var r={send:function(n){var o,a=0,s=function(){!n.async||4==o.readyState||a++>1e4?(n.success&&a<1e4&&200==o.status?n.success.call(n.success_scope,""+o.responseText,o,n):n.error&&n.error.call(n.error_scope,a>1e4?"TIMED_OUT":"GENERAL",o,n),o=null):e(s,10)};if(n.scope=n.scope||this,n.success_scope=n.success_scope||n.scope,n.error_scope=n.error_scope||n.scope,n.async=!1!==n.async,n.data=n.data||"",r.fire("beforeInitialize",{settings:n}),o=new t){if(o.overrideMimeType&&o.overrideMimeType(n.content_type),o.open(n.type||(n.data?"POST":"GET"),n.url,n.async),n.crossDomain&&(o.withCredentials=!0),n.content_type&&o.setRequestHeader("Content-Type",n.content_type),n.requestheaders&&i.each(n.requestheaders,function(t){o.setRequestHeader(t.key,t.value)}),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),(o=r.fire("beforeSend",{xhr:o,settings:n}).xhr).send(n.data),!n.async)return s();e(s,10)}}};return i.extend(r,n),r}),o("tinymce.core.util.JSONRequest",["tinymce.core.util.JSON","tinymce.core.util.XHR","tinymce.core.util.Tools"],function(t,e,n){var i=n.extend,r=function(t){this.settings=i({},t),this.count=0};return r.sendRPC=function(t){return(new r).send(t)},r.prototype={send:function(n){var r=n.error,o=n.success;(n=i(this.settings,n)).success=function(e,i){void 0===(e=t.parse(e))&&(e={error:"JSON Parse error."}),e.error?r.call(n.error_scope||n.scope,e.error,i):o.call(n.success_scope||n.scope,e.result)},n.error=function(t,e){r&&r.call(n.error_scope||n.scope,t,e)},n.data=t.serialize({id:n.id||"c"+this.count++,method:n.method,params:n.params}),n.content_type="application/json",e.send(n)}},r}),o("tinymce.core.util.LocalStorage",["global!document","global!window"],function(t,e){var n,i,r,o,a,s;try{if(e.localStorage)return e.localStorage}catch(l){}a="tinymce",i=t.documentElement,(s=!!i.addBehavior)&&i.addBehavior("#default#userData");var c=function(){o=[];for(var t in r)o.push(t);n.length=o.length},u=function(){var t,e="";if(s){for(var n in r)t=r[n],e+=(e?",":"")+n.length.toString(32)+","+n+","+t.length.toString(32)+","+t;i.setAttribute(a,e);try{i.save(a)}catch(l){}c()}};return n={key:function(t){return o[t]},getItem:function(t){return t in r?r[t]:null},setItem:function(t,e){r[t]=""+e,u()},removeItem:function(t){delete r[t],u()},clear:function(){r={},u()}},function(){var t,e,n,o=0;if(r={},s){var u=function(t){var n,i;return-1===(i=t!==undefined?o+t:e.indexOf(",",o))||i>e.length?null:(n=e.substring(o,i),o=i+1,n)};i.load(a),e=i.getAttribute(a)||"";do{var l=u();if(null===l)break;if(null!==(t=u(parseInt(l,32)||0))){if(null===(l=u()))break;n=u(parseInt(l,32)||0),t&&(r[t]=n)}}while(null!==t);c()}}(),n}),o("tinymce.core.api.Tinymce",["tinymce.core.AddOnManager","tinymce.core.Editor","tinymce.core.EditorCommands","tinymce.core.EditorManager","tinymce.core.EditorObservable","tinymce.core.Env","tinymce.core.Shortcuts","tinymce.core.UndoManager","tinymce.core.api.FocusManager","tinymce.core.api.Formatter","tinymce.core.api.NotificationManager","tinymce.core.api.WindowManager","tinymce.core.api.dom.BookmarkManager","tinymce.core.api.dom.RangeUtils","tinymce.core.api.dom.Serializer","tinymce.core.dom.ControlSelection","tinymce.core.dom.DOMUtils","tinymce.core.dom.DomQuery","tinymce.core.dom.EventUtils","tinymce.core.dom.ScriptLoader","tinymce.core.dom.Selection","tinymce.core.dom.Sizzle","tinymce.core.dom.TreeWalker","tinymce.core.geom.Rect","tinymce.core.html.DomParser","tinymce.core.html.Entities","tinymce.core.html.Node","tinymce.core.html.SaxParser","tinymce.core.html.Schema","tinymce.core.html.Serializer","tinymce.core.html.Styles","tinymce.core.html.Writer","tinymce.core.ui.Factory","tinymce.core.util.Class","tinymce.core.util.Color","tinymce.core.util.Delay","tinymce.core.util.EventDispatcher","tinymce.core.util.I18n","tinymce.core.util.JSON","tinymce.core.util.JSONP","tinymce.core.util.JSONRequest","tinymce.core.util.LocalStorage","tinymce.core.util.Observable","tinymce.core.util.Promise","tinymce.core.util.Tools","tinymce.core.util.URI","tinymce.core.util.VK","tinymce.core.util.XHR"],function(t,e,n,i,r,o,a,s,c,u,l,h,d,f,p,m,g,v,y,b,_,x,w,S,k,E,T,C,L,P,A,N,R,I,D,O,B,M,F,z,j,H,$,U,q,W,V,Z){var G=i,K={geom:{Rect:S},util:{Promise:U,Delay:O,Tools:q,VK:V,URI:W,Class:I,EventDispatcher:B,Observable:$,I18n:M,XHR:Z,JSON:F,JSONRequest:j,JSONP:z,LocalStorage:H,Color:D},dom:{EventUtils:y,Sizzle:x,DomQuery:v,TreeWalker:w,DOMUtils:g,ScriptLoader:b,RangeUtils:f,Serializer:p,ControlSelection:m,BookmarkManager:d,Selection:_,Event:y.Event},html:{Styles:A,Entities:E,Node:T,Schema:L,SaxParser:C,DomParser:k,Writer:N,Serializer:P},ui:{Factory:R},Env:o,AddOnManager:t,Formatter:u,UndoManager:s,EditorCommands:n,WindowManager:h,NotificationManager:l,EditorObservable:r,Shortcuts:a,Editor:e,FocusManager:c,EditorManager:i,DOM:g.DOM,ScriptLoader:b.ScriptLoader,PluginManager:t.PluginManager,ThemeManager:t.ThemeManager,trim:q.trim,isArray:q.isArray,is:q.is,toArray:q.toArray,makeMap:q.makeMap,each:q.each,map:q.map,grep:q.grep,inArray:q.inArray,extend:q.extend,create:q.create,walk:q.walk,createNS:q.createNS,resolve:q.resolve,explode:q.explode,_addCacheSuffix:q._addCacheSuffix,isOpera:o.opera,isWebKit:o.webkit,isIE:o.ie,isGecko:o.gecko,isMac:o.mac};return G=q.extend(G,K)}),o("tinymce.core.api.Main",["ephox.katamari.api.Fun","global!window","tinymce.core.api.Tinymce"],function(t,e,n){var i=this||e,r=function(e){"function"!=typeof i.define||i.define.amd||(i.define("ephox/tinymce",[],t.constant(e)),i.define("tinymce.core.EditorManager",[],t.constant(e))),"object"==typeof module&&(module.exports=e)},o=function(t){e.tinymce=t,e.tinyMCE=t};return function(){return o(n),r(n),n}}),i("tinymce.core.api.Main")()}(),function(t,e){"use strict";t.rails!==e&&t.error("jquery-ujs has already been loaded!");var n,i=t(document);t.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:"button[data-remote]:not([form]):not(form button), button[data-confirm]:not([form]):not(form button)",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",disableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",requiredInputSelector:"input[name][required]:not([disabled]), textarea[name][required]:not([disabled])",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]",csrfToken:function(){return t("meta[name=csrf-token]").attr("content")},csrfParam:function(){return t("meta[name=csrf-param]").attr("content")},CSRFProtection:function(t){var e=n.csrfToken();e&&t.setRequestHeader("X-CSRF-Token",e)},refreshCSRFTokens:function(){t('form input[name="'+n.csrfParam()+'"]').val(n.csrfToken())},fire:function(e,n,i){var r=t.Event(n);return e.trigger(r,i),!1!==r.result},confirm:function(t){return confirm(t)},ajax:function(e){return t.ajax(e)},href:function(t){return t[0].href},isRemote:function(t){return t.data("remote")!==e&&!1!==t.data("remote")},handleRemote:function(i){var r,o,a,s,c,u;if(n.fire(i,"ajax:before")){if(s=i.data("with-credentials")||null,c=i.data("type")||t.ajaxSettings&&t.ajaxSettings.dataType,i.is("form")){r=i.data("ujs:submit-button-formmethod")||i.attr("method"),o=i.data("ujs:submit-button-formaction")||i.attr("action"),a=t(i[0]).serializeArray();var l=i.data("ujs:submit-button");l&&(a.push(l),i.data("ujs:submit-button",null)),i.data("ujs:submit-button-formmethod",null),i.data("ujs:submit-button-formaction",null)}else i.is(n.inputChangeSelector)?(r=i.data("method"),o=i.data("url"),a=i.serialize(),i.data("params")&&(a=a+"&"+i.data("params"))):i.is(n.buttonClickSelector)?(r=i.data("method")||"get",o=i.data("url"),a=i.serialize(),i.data("params")&&(a=a+"&"+i.data("params"))):(r=i.data("method"),o=n.href(i),a=i.data("params")||null);return u={type:r||"GET",data:a,dataType:c,beforeSend:function(t,r){if(r.dataType===e&&t.setRequestHeader("accept","*/*;q=0.5, "+r.accepts.script),!n.fire(i,"ajax:beforeSend",[t,r]))return!1;i.trigger("ajax:send",t)},success:function(t,e,n){i.trigger("ajax:success",[t,e,n])},complete:function(t,e){i.trigger("ajax:complete",[t,e])},error:function(t,e,n){i.trigger("ajax:error",[t,e,n])},crossDomain:n.isCrossDomain(o)},s&&(u.xhrFields={withCredentials:s}),o&&(u.url=o),n.ajax(u)}return!1},isCrossDomain:function(t){var e=document.createElement("a");e.href=location.href;var n=document.createElement("a");try{return n.href=t,n.href=n.href,!((!n.protocol||":"===n.protocol)&&!n.host||e.protocol+"//"+e.host==n.protocol+"//"+n.host)}catch(i){return!0}},handleMethod:function(i){var r=n.href(i),o=i.data("method"),a=i.attr("target"),s=n.csrfToken(),c=n.csrfParam(),u=t('<form method="post" action="'+r+'"></form>'),l='<input name="_method" value="'+o+'" type="hidden" />';c===e||s===e||n.isCrossDomain(r)||(l+='<input name="'+c+'" value="'+s+'" type="hidden" />'),a&&u.attr("target",a),u.hide().append(l).appendTo("body"),u.submit()},formElements:function(e,n){return e.is("form")?t(e[0].elements).filter(n):e.find(n)},disableFormElements:function(e){n.formElements(e,n.disableSelector).each(function(){n.disableFormElement(t(this))})},disableFormElement:function(t){var n,i;n=t.is("button")?"html":"val",(i=t.data("disable-with"))!==e&&(t.data("ujs:enable-with",t[n]()),t[n](i)),t.prop("disabled",!0),t.data("ujs:disabled",!0)},enableFormElements:function(e){n.formElements(e,n.enableSelector).each(function(){n.enableFormElement(t(this))})},enableFormElement:function(t){var n=t.is("button")?"html":"val";t.data("ujs:enable-with")!==e&&(t[n](t.data("ujs:enable-with")),t.removeData("ujs:enable-with")),t.prop("disabled",!1),t.removeData("ujs:disabled")},allowAction:function(t){var e,i=t.data("confirm"),r=!1;if(!i)return!0;if(n.fire(t,"confirm")){try{r=n.confirm(i)}catch(o){(console.error||console.log).call(console,o.stack||o)}e=n.fire(t,"confirm:complete",[r])}return r&&e},blankInputs:function(e,n,i){var r,o,a,s,c=t(),u=n||"input,textarea",l={};return e.find(u).each(function(){(r=t(this)).is("input[type=radio]")?(s=r.attr("name"),l[s]||(0===e.find('input[type=radio]:checked[name="'+s+'"]').length&&(a=e.find('input[type=radio][name="'+s+'"]'),c=c.add(a)),l[s]=s)):(o=r.is("input[type=checkbox],input[type=radio]")?r.is(":checked"):!!r.val())===i&&(c=c.add(r))}),!!c.length&&c},nonBlankInputs:function(t,e){return n.blankInputs(t,e,!0)},stopEverything:function(e){return t(e.target).trigger("ujs:everythingStopped"),e.stopImmediatePropagation(),!1},disableElement:function(t){var i=t.data("disable-with");i!==e&&(t.data("ujs:enable-with",t.html()),t.html(i)),t.bind("click.railsDisable",function(t){return n.stopEverything(t)}),t.data("ujs:disabled",!0)},enableElement:function(t){t.data("ujs:enable-with")!==e&&(t.html(t.data("ujs:enable-with")),t.removeData("ujs:enable-with")),t.unbind("click.railsDisable"),t.removeData("ujs:disabled")}},n.fire(i,"rails:attachBindings")&&(t.ajaxPrefilter(function(t,e,i){t.crossDomain||n.CSRFProtection(i)}),t(window).on("pageshow.rails",function(){t(t.rails.enableSelector).each(function(){var e=t(this);e.data("ujs:disabled")&&t.rails.enableFormElement(e)}),t(t.rails.linkDisableSelector).each(function(){var e=t(this);e.data("ujs:disabled")&&t.rails.enableElement(e)})}),i.on("ajax:complete",n.linkDisableSelector,function(){n.enableElement(t(this))}),i.on("ajax:complete",n.buttonDisableSelector,function(){n.enableFormElement(t(this))}),i.on("click.rails",n.linkClickSelector,function(e){var i=t(this),r=i.data("method"),o=i.data("params"),a=e.metaKey||e.ctrlKey;if(!n.allowAction(i))return n.stopEverything(e);if(!a&&i.is(n.linkDisableSelector)&&n.disableElement(i),n.isRemote(i)){if(a&&(!r||"GET"===r)&&!o)return!0;var s=n.handleRemote(i);return!1===s?n.enableElement(i):s.fail(function(){n.enableElement(i)}),!1}return r?(n.handleMethod(i),!1):void 0}),i.on("click.rails",n.buttonClickSelector,function(e){var i=t(this);if(!n.allowAction(i)||!n.isRemote(i))return n.stopEverything(e);i.is(n.buttonDisableSelector)&&n.disableFormElement(i);var r=n.handleRemote(i);return!1===r?n.enableFormElement(i):r.fail(function(){n.enableFormElement(i)}),!1}),i.on("change.rails",n.inputChangeSelector,function(e){var i=t(this);return n.allowAction(i)&&n.isRemote(i)?(n.handleRemote(i),!1):n.stopEverything(e)}),i.on("submit.rails",n.formSubmitSelector,function(i){var r,o,a=t(this),s=n.isRemote(a);if(!n.allowAction(a))return n.stopEverything(i);if(a.attr("novalidate")===e)if(a.data("ujs:formnovalidate-button")===e){if((r=n.blankInputs(a,n.requiredInputSelector,!1))&&n.fire(a,"ajax:aborted:required",[r]))return n.stopEverything(i)}else a.data("ujs:formnovalidate-button",e);if(s){if(o=n.nonBlankInputs(a,n.fileInputSelector)){setTimeout(function(){n.disableFormElements(a)},13);var c=n.fire(a,"ajax:aborted:file",[o]);return c||setTimeout(function(){n.enableFormElements(a)},13),c}return n.handleRemote(a),!1}setTimeout(function(){n.disableFormElements(a)},13)}),i.on("click.rails",n.formInputClickSelector,function(e){var i=t(this);if(!n.allowAction(i))return n.stopEverything(e);var r=i.attr("name"),o=r?{name:r,value:i.val()}:null,a=i.closest("form");0===a.length&&(a=t("#"+i.attr("form"))),a.data("ujs:submit-button",o),a.data("ujs:formnovalidate-button",i.attr("formnovalidate")),a.data("ujs:submit-button-formaction",i.attr("formaction")),a.data("ujs:submit-button-formmethod",i.attr("formmethod"))}),i.on("ajax:send.rails",n.formSubmitSelector,function(e){this===e.target&&n.disableFormElements(t(this))}),i.on("ajax:complete.rails",n.formSubmitSelector,function(e){this===e.target&&n.enableFormElements(t(this))}),t(function(){n.refreshCSRFTokens()}))}(jQuery),function(){(function(){(function(){this.Turbolinks={supported:null!=window.history.pushState&&null!=window.requestAnimationFrame&&null!=window.addEventListener,visit:function(e,n){return t.controller.visit(e,n)},clearCache:function(){return t.controller.clearCache()}}}).call(this)}).call(this);var t=this.Turbolinks;(function(){(function(){var e,n,i=[].slice;t.copyObject=function(t){var e,n,i;n={};for(e in t)i=t[e],n[e]=i;return n},t.closest=function(t,n){return e.call(t,n)},e=function(){var t,e;return t=document.documentElement,null!=(e=t.closest)?e:function(t){var e;for(e=this;e;){if(e.nodeType===Node.ELEMENT_NODE&&n.call(e,t))return e;e=e.parentNode}}}(),t.defer=function(t){return setTimeout(t,1)},t.throttle=function(t){var e;return e=null,function(){var n;return n=1<=arguments.length?i.call(arguments,0):[],null!=e?e:e=requestAnimationFrame(function(i){return function(){return e=null,t.apply(i,n)}}(this))}},t.dispatch=function(t,e){var n,i,r,o,a;return o=null!=e?e:{},a=o.target,n=o.cancelable,i=o.data,(r=document.createEvent("Events")).initEvent(t,!0,!0===n),r.data=null!=i?i:{},(null!=a?a:document).dispatchEvent(r),r},t.match=function(t,e){return n.call(t,e)},n=function(){var t,e,n,i;return t=document.documentElement,null!=(e=null!=(n=null!=(i=t.matchesSelector)?i:t.webkitMatchesSelector)?n:t.msMatchesSelector)?e:t.mozMatchesSelector}(),t.uuid=function(){var t,e,n;for(n="",t=e=1;36>=e;t=++e)n+=9===t||14===t||19===t||24===t?"-":15===t?"4":20===t?(Math.floor(4*Math.random())+8).toString(16):Math.floor(15*Math.random()).toString(16);return n}}).call(this),function(){t.Location=function(){function t(t){var e,n;null==t&&(t=""),(n=document.createElement("a")).href=t.toString(),this.absoluteURL=n.href,2>(e=n.hash.length)?this.requestURL=this.absoluteURL:(this.requestURL=this.absoluteURL.slice(0,-e),this.anchor=n.hash.slice(1))}var e,n,i,r;return t.wrap=function(t){return t instanceof this?t:new this(t)},t.prototype.getOrigin=function(){return this.absoluteURL.split("/",3).join("/")},t.prototype.getPath=function(){var t,e;return null!=(t=null!=(e=this.absoluteURL.match(/\/\/[^\/]*(\/[^?;]*)/))?e[1]:void 0)?t:"/"},t.prototype.getPathComponents=function(){return this.getPath().split("/").slice(1)},t.prototype.getLastPathComponent=function(){return this.getPathComponents().slice(-1)[0]},t.prototype.getExtension=function(){var t,e;return null!=(t=null!=(e=this.getLastPathComponent().match(/\.[^.]*$/))?e[0]:void 0)?t:""},t.prototype.isHTML=function(){return this.getExtension().match(/^(?:|\.(?:htm|html|xhtml))$/)},t.prototype.isPrefixedBy=function(t){var e;return e=n(t),this.isEqualTo(t)||r(this.absoluteURL,e)},t.prototype.isEqualTo=function(t){return this.absoluteURL===(null!=t?t.absoluteURL:void 0)},t.prototype.toCacheKey=function(){return this.requestURL},t.prototype.toJSON=function(){return this.absoluteURL},t.prototype.toString=function(){return this.absoluteURL},t.prototype.valueOf=function(){return this.absoluteURL},n=function(t){return e(t.getOrigin()+t.getPath())},e=function(t){return i(t,"/")?t:t+"/"},r=function(t,e){return t.slice(0,e.length)===e},i=function(t,e){return t.slice(-e.length)===e},t}()}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}};t.HttpRequest=function(){function n(n,i,r){this.delegate=n,this.requestCanceled=e(this.requestCanceled,this),this.requestTimedOut=e(this.requestTimedOut,this),this.requestFailed=e(this.requestFailed,this),this.requestLoaded=e(this.requestLoaded,this),this.requestProgressed=e(this.requestProgressed,this),this.url=t.Location.wrap(i).requestURL,this.referrer=t.Location.wrap(r).absoluteURL,this.createXHR()}return n.NETWORK_FAILURE=0,n.TIMEOUT_FAILURE=-1,n.timeout=60,n.prototype.send=function(){var t;return this.xhr&&!this.sent?(this.notifyApplicationBeforeRequestStart(),this.setProgress(0),this.xhr.send(),this.sent=!0,"function"==typeof(t=this.delegate).requestStarted?t.requestStarted():void 0):void 0},n.prototype.cancel=function(){return this.xhr&&this.sent?this.xhr.abort():void 0},n.prototype.requestProgressed=function(t){return t.lengthComputable?this.setProgress(t.loaded/t.total):void 0},n.prototype.requestLoaded=function(){return this.endRequest(function(t){return function(){var e;return 200<=(e=t.xhr.status)&&300>e?t.delegate.requestCompletedWithResponse(t.xhr.responseText,t.xhr.getResponseHeader("Turbolinks-Location")):(t.failed=!0,t.delegate.requestFailedWithStatusCode(t.xhr.status,t.xhr.responseText))}}(this))},n.prototype.requestFailed=function(){return this.endRequest(function(t){return function(){return t.failed=!0,t.delegate.requestFailedWithStatusCode(t.constructor.NETWORK_FAILURE)}}(this))},n.prototype.requestTimedOut=function(){return this.endRequest(function(t){return function(){return t.failed=!0,t.delegate.requestFailedWithStatusCode(t.constructor.TIMEOUT_FAILURE)}}(this))},n.prototype.requestCanceled=function(){return this.endRequest()},
n.prototype.notifyApplicationBeforeRequestStart=function(){return t.dispatch("turbolinks:request-start",{data:{url:this.url,xhr:this.xhr}})},n.prototype.notifyApplicationAfterRequestEnd=function(){return t.dispatch("turbolinks:request-end",{data:{url:this.url,xhr:this.xhr}})},n.prototype.createXHR=function(){return this.xhr=new XMLHttpRequest,this.xhr.open("GET",this.url,!0),this.xhr.timeout=1e3*this.constructor.timeout,this.xhr.setRequestHeader("Accept","text/html, application/xhtml+xml"),this.xhr.setRequestHeader("Turbolinks-Referrer",this.referrer),this.xhr.onprogress=this.requestProgressed,this.xhr.onload=this.requestLoaded,this.xhr.onerror=this.requestFailed,this.xhr.ontimeout=this.requestTimedOut,this.xhr.onabort=this.requestCanceled},n.prototype.endRequest=function(t){return this.xhr?(this.notifyApplicationAfterRequestEnd(),null!=t&&t.call(this),this.destroy()):void 0},n.prototype.setProgress=function(t){var e;return this.progress=t,"function"==typeof(e=this.delegate).requestProgressed?e.requestProgressed(this.progress):void 0},n.prototype.destroy=function(){var t;return this.setProgress(1),"function"==typeof(t=this.delegate).requestFinished&&t.requestFinished(),this.delegate=null,this.xhr=null},n}()}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}};t.ProgressBar=function(){function t(){this.trickle=e(this.trickle,this),this.stylesheetElement=this.createStylesheetElement(),this.progressElement=this.createProgressElement()}var n;return n=300,t.defaultCSS=".turbolinks-progress-bar {\n  position: fixed;\n  display: block;\n  top: 0;\n  left: 0;\n  height: 3px;\n  background: #0076ff;\n  z-index: 9999;\n  transition: width "+n+"ms ease-out, opacity "+n/2+"ms "+n/2+"ms ease-in;\n  transform: translate3d(0, 0, 0);\n}",t.prototype.show=function(){return this.visible?void 0:(this.visible=!0,this.installStylesheetElement(),this.installProgressElement(),this.startTrickling())},t.prototype.hide=function(){return this.visible&&!this.hiding?(this.hiding=!0,this.fadeProgressElement(function(t){return function(){return t.uninstallProgressElement(),t.stopTrickling(),t.visible=!1,t.hiding=!1}}(this))):void 0},t.prototype.setValue=function(t){return this.value=t,this.refresh()},t.prototype.installStylesheetElement=function(){return document.head.insertBefore(this.stylesheetElement,document.head.firstChild)},t.prototype.installProgressElement=function(){return this.progressElement.style.width=0,this.progressElement.style.opacity=1,document.documentElement.insertBefore(this.progressElement,document.body),this.refresh()},t.prototype.fadeProgressElement=function(t){return this.progressElement.style.opacity=0,setTimeout(t,1.5*n)},t.prototype.uninstallProgressElement=function(){return this.progressElement.parentNode?document.documentElement.removeChild(this.progressElement):void 0},t.prototype.startTrickling=function(){return null!=this.trickleInterval?this.trickleInterval:this.trickleInterval=setInterval(this.trickle,n)},t.prototype.stopTrickling=function(){return clearInterval(this.trickleInterval),this.trickleInterval=null},t.prototype.trickle=function(){return this.setValue(this.value+Math.random()/100)},t.prototype.refresh=function(){return requestAnimationFrame(function(t){return function(){return t.progressElement.style.width=10+90*t.value+"%"}}(this))},t.prototype.createStylesheetElement=function(){var t;return t=document.createElement("style"),t.type="text/css",t.textContent=this.constructor.defaultCSS,t},t.prototype.createProgressElement=function(){var t;return t=document.createElement("div"),t.className="turbolinks-progress-bar",t},t}()}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}};t.BrowserAdapter=function(){function n(n){this.controller=n,this.showProgressBar=e(this.showProgressBar,this),this.progressBar=new t.ProgressBar}var i,r,o,a;return a=t.HttpRequest,i=a.NETWORK_FAILURE,o=a.TIMEOUT_FAILURE,r=500,n.prototype.visitProposedToLocationWithAction=function(t,e){return this.controller.startVisitToLocationWithAction(t,e)},n.prototype.visitStarted=function(t){return t.issueRequest(),t.changeHistory(),t.loadCachedSnapshot()},n.prototype.visitRequestStarted=function(t){return this.progressBar.setValue(0),t.hasCachedSnapshot()||"restore"!==t.action?this.showProgressBarAfterDelay():this.showProgressBar()},n.prototype.visitRequestProgressed=function(t){return this.progressBar.setValue(t.progress)},n.prototype.visitRequestCompleted=function(t){return t.loadResponse()},n.prototype.visitRequestFailedWithStatusCode=function(t,e){switch(e){case i:case o:return this.reload();default:return t.loadResponse()}},n.prototype.visitRequestFinished=function(){return this.hideProgressBar()},n.prototype.visitCompleted=function(t){return t.followRedirect()},n.prototype.pageInvalidated=function(){return this.reload()},n.prototype.showProgressBarAfterDelay=function(){return this.progressBarTimeout=setTimeout(this.showProgressBar,r)},n.prototype.showProgressBar=function(){return this.progressBar.show()},n.prototype.hideProgressBar=function(){return this.progressBar.hide(),clearTimeout(this.progressBarTimeout)},n.prototype.reload=function(){return window.location.reload()},n}()}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}};t.History=function(){function n(t){this.delegate=t,this.onPageLoad=e(this.onPageLoad,this),this.onPopState=e(this.onPopState,this)}return n.prototype.start=function(){return this.started?void 0:(addEventListener("popstate",this.onPopState,!1),addEventListener("load",this.onPageLoad,!1),this.started=!0)},n.prototype.stop=function(){return this.started?(removeEventListener("popstate",this.onPopState,!1),removeEventListener("load",this.onPageLoad,!1),this.started=!1):void 0},n.prototype.push=function(e,n){return e=t.Location.wrap(e),this.update("push",e,n)},n.prototype.replace=function(e,n){return e=t.Location.wrap(e),this.update("replace",e,n)},n.prototype.onPopState=function(e){var n,i,r,o;return this.shouldHandlePopState()&&(o=null!=(i=e.state)?i.turbolinks:void 0)?(n=t.Location.wrap(window.location),r=o.restorationIdentifier,this.delegate.historyPoppedToLocationWithRestorationIdentifier(n,r)):void 0},n.prototype.onPageLoad=function(){return t.defer(function(t){return function(){return t.pageLoaded=!0}}(this))},n.prototype.shouldHandlePopState=function(){return this.pageIsLoaded()},n.prototype.pageIsLoaded=function(){return this.pageLoaded||"complete"===document.readyState},n.prototype.update=function(t,e,n){var i;return i={turbolinks:{restorationIdentifier:n}},history[t+"State"](i,null,e)},n}()}.call(this),function(){t.Snapshot=function(){function e(t){var e,n;n=t.head,e=t.body,this.head=null!=n?n:document.createElement("head"),this.body=null!=e?e:document.createElement("body")}return e.wrap=function(t){return t instanceof this?t:this.fromHTML(t)},e.fromHTML=function(t){var e;return e=document.createElement("html"),e.innerHTML=t,this.fromElement(e)},e.fromElement=function(t){return new this({head:t.querySelector("head"),body:t.querySelector("body")})},e.prototype.clone=function(){return new e({head:this.head.cloneNode(!0),body:this.body.cloneNode(!0)})},e.prototype.getRootLocation=function(){var e,n;return n=null!=(e=this.getSetting("root"))?e:"/",new t.Location(n)},e.prototype.getCacheControlValue=function(){return this.getSetting("cache-control")},e.prototype.hasAnchor=function(t){try{return null!=this.body.querySelector("[id='"+t+"']")}catch(e){}},e.prototype.isPreviewable=function(){return"no-preview"!==this.getCacheControlValue()},e.prototype.isCacheable=function(){return"no-cache"!==this.getCacheControlValue()},e.prototype.getSetting=function(t){var e,n;return n=this.head.querySelectorAll("meta[name='turbolinks-"+t+"']"),null!=(e=n[n.length-1])?e.getAttribute("content"):void 0},e}()}.call(this),function(){var e=[].slice;t.Renderer=function(){function t(){}var n;return t.render=function(){var t,n,i,r;return i=arguments[0],n=arguments[1],t=3<=arguments.length?e.call(arguments,2):[],r=function(t,e,n){n.prototype=t.prototype;var i=new n,r=t.apply(i,e);return Object(r)===r?r:i}(this,t,function(){}),r.delegate=i,r.render(n),r},t.prototype.renderView=function(t){return this.delegate.viewWillRender(this.newBody),t(),this.delegate.viewRendered(this.newBody)},t.prototype.invalidateView=function(){return this.delegate.viewInvalidated()},t.prototype.createScriptElement=function(t){var e;return"false"===t.getAttribute("data-turbolinks-eval")?t:(e=document.createElement("script"),e.textContent=t.textContent,n(e,t),e)},n=function(t,e){var n,i,r,o,a,s,c;for(s=[],n=0,i=(o=e.attributes).length;i>n;n++)a=o[n],r=a.name,c=a.value,s.push(t.setAttribute(r,c));return s},t}()}.call(this),function(){t.HeadDetails=function(){function t(t){var e,n,o,a,s,c;for(this.element=t,this.elements={},o=0,s=(c=this.element.childNodes).length;s>o;o++)(n=c[o]).nodeType===Node.ELEMENT_NODE&&(a=n.outerHTML,(null!=(e=this.elements)[a]?e[a]:e[a]={type:r(n),tracked:i(n),elements:[]}).elements.push(n))}var e,n,i,r;return t.prototype.hasElementWithKey=function(t){return t in this.elements},t.prototype.getTrackedElementSignature=function(){var t,e;return function(){var n,i;n=this.elements,i=[];for(t in n)(e=n[t].tracked)&&i.push(t);return i}.call(this).join("")},t.prototype.getScriptElementsNotInDetails=function(t){return this.getElementsMatchingTypeNotInDetails("script",t)},t.prototype.getStylesheetElementsNotInDetails=function(t){return this.getElementsMatchingTypeNotInDetails("stylesheet",t)},t.prototype.getElementsMatchingTypeNotInDetails=function(t,e){var n,i,r,o,a,s;r=this.elements,a=[];for(i in r)o=r[i],s=o.type,n=o.elements,s!==t||e.hasElementWithKey(i)||a.push(n[0]);return a},t.prototype.getProvisionalElements=function(){var t,e,n,i,r,o,a;n=[],i=this.elements;for(e in i)r=i[e],a=r.type,o=r.tracked,t=r.elements,null!=a||o?t.length>1&&n.push.apply(n,t.slice(1)):n.push.apply(n,t);return n},r=function(t){return e(t)?"script":n(t)?"stylesheet":void 0},i=function(t){return"reload"===t.getAttribute("data-turbolinks-track")},e=function(t){return"script"===t.tagName.toLowerCase()},n=function(t){var e;return"style"===(e=t.tagName.toLowerCase())||"link"===e&&"stylesheet"===t.getAttribute("rel")},t}()}.call(this),function(){var e=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;t.SnapshotRenderer=function(n){function i(e,n){this.currentSnapshot=e,this.newSnapshot=n,this.currentHeadDetails=new t.HeadDetails(this.currentSnapshot.head),this.newHeadDetails=new t.HeadDetails(this.newSnapshot.head),this.newBody=this.newSnapshot.body}return e(i,n),i.prototype.render=function(t){return this.trackedElementsAreIdentical()?(this.mergeHead(),this.renderView(function(e){return function(){return e.replaceBody(),e.focusFirstAutofocusableElement(),t()}}(this))):this.invalidateView()},i.prototype.mergeHead=function(){return this.copyNewHeadStylesheetElements(),this.copyNewHeadScriptElements(),this.removeCurrentHeadProvisionalElements(),this.copyNewHeadProvisionalElements()},i.prototype.replaceBody=function(){return this.activateBodyScriptElements(),this.importBodyPermanentElements(),this.assignNewBody()},i.prototype.trackedElementsAreIdentical=function(){return this.currentHeadDetails.getTrackedElementSignature()===this.newHeadDetails.getTrackedElementSignature()},i.prototype.copyNewHeadStylesheetElements=function(){var t,e,n,i,r;for(r=[],e=0,n=(i=this.getNewHeadStylesheetElements()).length;n>e;e++)t=i[e],r.push(document.head.appendChild(t));return r},i.prototype.copyNewHeadScriptElements=function(){var t,e,n,i,r;for(r=[],e=0,n=(i=this.getNewHeadScriptElements()).length;n>e;e++)t=i[e],r.push(document.head.appendChild(this.createScriptElement(t)));return r},i.prototype.removeCurrentHeadProvisionalElements=function(){var t,e,n,i,r;for(r=[],e=0,n=(i=this.getCurrentHeadProvisionalElements()).length;n>e;e++)t=i[e],r.push(document.head.removeChild(t));return r},i.prototype.copyNewHeadProvisionalElements=function(){var t,e,n,i,r;for(r=[],e=0,n=(i=this.getNewHeadProvisionalElements()).length;n>e;e++)t=i[e],r.push(document.head.appendChild(t));return r},i.prototype.importBodyPermanentElements=function(){var t,e,n,i,r,o;for(o=[],e=0,n=(i=this.getNewBodyPermanentElements()).length;n>e;e++)r=i[e],(t=this.findCurrentBodyPermanentElement(r))?o.push(r.parentNode.replaceChild(t,r)):o.push(void 0);return o},i.prototype.activateBodyScriptElements=function(){var t,e,n,i,r,o;for(o=[],e=0,n=(i=this.getNewBodyScriptElements()).length;n>e;e++)r=i[e],t=this.createScriptElement(r),o.push(r.parentNode.replaceChild(t,r));return o},i.prototype.assignNewBody=function(){return document.body=this.newBody},i.prototype.focusFirstAutofocusableElement=function(){var t;return null!=(t=this.findFirstAutofocusableElement())?t.focus():void 0},i.prototype.getNewHeadStylesheetElements=function(){return this.newHeadDetails.getStylesheetElementsNotInDetails(this.currentHeadDetails)},i.prototype.getNewHeadScriptElements=function(){return this.newHeadDetails.getScriptElementsNotInDetails(this.currentHeadDetails)},i.prototype.getCurrentHeadProvisionalElements=function(){return this.currentHeadDetails.getProvisionalElements()},i.prototype.getNewHeadProvisionalElements=function(){return this.newHeadDetails.getProvisionalElements()},i.prototype.getNewBodyPermanentElements=function(){return this.newBody.querySelectorAll("[id][data-turbolinks-permanent]")},i.prototype.findCurrentBodyPermanentElement=function(t){return document.body.querySelector("#"+t.id+"[data-turbolinks-permanent]")},i.prototype.getNewBodyScriptElements=function(){return this.newBody.querySelectorAll("script")},i.prototype.findFirstAutofocusableElement=function(){return document.body.querySelector("[autofocus]")},i}(t.Renderer)}.call(this),function(){var e=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},n={}.hasOwnProperty;t.ErrorRenderer=function(t){function n(t){this.html=t}return e(n,t),n.prototype.render=function(t){return this.renderView(function(e){return function(){return e.replaceDocumentHTML(),e.activateBodyScriptElements(),t()}}(this))},n.prototype.replaceDocumentHTML=function(){return document.documentElement.innerHTML=this.html},n.prototype.activateBodyScriptElements=function(){var t,e,n,i,r,o;for(o=[],e=0,n=(i=this.getScriptElements()).length;n>e;e++)r=i[e],t=this.createScriptElement(r),o.push(r.parentNode.replaceChild(t,r));return o},n.prototype.getScriptElements=function(){return document.documentElement.querySelectorAll("script")},n}(t.Renderer)}.call(this),function(){t.View=function(){function e(t){this.delegate=t,this.element=document.documentElement}return e.prototype.getRootLocation=function(){return this.getSnapshot().getRootLocation()},e.prototype.getSnapshot=function(){return t.Snapshot.fromElement(this.element)},e.prototype.render=function(t,e){var n,i,r;return r=t.snapshot,n=t.error,i=t.isPreview,this.markAsPreview(i),null!=r?this.renderSnapshot(r,e):this.renderError(n,e)},e.prototype.markAsPreview=function(t){return t?this.element.setAttribute("data-turbolinks-preview",""):this.element.removeAttribute("data-turbolinks-preview")},e.prototype.renderSnapshot=function(e,n){return t.SnapshotRenderer.render(this.delegate,n,this.getSnapshot(),t.Snapshot.wrap(e))},e.prototype.renderError=function(e,n){return t.ErrorRenderer.render(this.delegate,n,e)},e}()}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}};t.ScrollManager=function(){function n(n){this.delegate=n,this.onScroll=e(this.onScroll,this),this.onScroll=t.throttle(this.onScroll)}return n.prototype.start=function(){return this.started?void 0:(addEventListener("scroll",this.onScroll,!1),this.onScroll(),this.started=!0)},n.prototype.stop=function(){return this.started?(removeEventListener("scroll",this.onScroll,!1),this.started=!1):void 0},n.prototype.scrollToElement=function(t){return t.scrollIntoView()},n.prototype.scrollToPosition=function(t){var e,n;return e=t.x,n=t.y,window.scrollTo(e,n)},n.prototype.onScroll=function(){return this.updatePosition({x:window.pageXOffset,y:window.pageYOffset})},n.prototype.updatePosition=function(t){var e;return this.position=t,null!=(e=this.delegate)?e.scrollPositionChanged(this.position):void 0},n}()}.call(this),function(){t.SnapshotCache=function(){function e(t){this.size=t,this.keys=[],this.snapshots={}}var n;return e.prototype.has=function(t){return n(t)in this.snapshots},e.prototype.get=function(t){var e;if(this.has(t))return e=this.read(t),this.touch(t),e},e.prototype.put=function(t,e){return this.write(t,e),this.touch(t),e},e.prototype.read=function(t){var e;return e=n(t),this.snapshots[e]},e.prototype.write=function(t,e){var i;return i=n(t),this.snapshots[i]=e},e.prototype.touch=function(t){var e,i;return i=n(t),(e=this.keys.indexOf(i))>-1&&this.keys.splice(e,1),this.keys.unshift(i),this.trim()},e.prototype.trim=function(){var t,e,n,i,r;for(r=[],t=0,n=(i=this.keys.splice(this.size)).length;n>t;t++)e=i[t],r.push(delete this.snapshots[e]);return r},n=function(e){return t.Location.wrap(e).toCacheKey()},e}()}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}};t.Visit=function(){function n(n,i,r){this.controller=n,this.action=r,this.performScroll=e(this.performScroll,this),this.identifier=t.uuid(),this.location=t.Location.wrap(i),this.adapter=this.controller.adapter,this.state="initialized",this.timingMetrics={}}var i;return n.prototype.start=function(){return"initialized"===this.state?(this.recordTimingMetric("visitStart"),this.state="started",this.adapter.visitStarted(this)):void 0},n.prototype.cancel=function(){var t;return"started"===this.state?(null!=(t=this.request)&&t.cancel(),this.cancelRender(),this.state="canceled"):void 0},n.prototype.complete=function(){var t;return"started"===this.state?(this.recordTimingMetric("visitEnd"),this.state="completed","function"==typeof(t=this.adapter).visitCompleted&&t.visitCompleted(this),this.controller.visitCompleted(this)):void 0},n.prototype.fail=function(){var t;return"started"===this.state?(this.state="failed","function"==typeof(t=this.adapter).visitFailed?t.visitFailed(this):void 0):void 0},n.prototype.changeHistory=function(){var t,e;return this.historyChanged?void 0:(t=this.location.isEqualTo(this.referrer)?"replace":this.action,e=i(t),this.controller[e](this.location,this.restorationIdentifier),this.historyChanged=!0)},n.prototype.issueRequest=function(){return this.shouldIssueRequest()&&null==this.request?(this.progress=0,this.request=new t.HttpRequest(this,this.location,this.referrer),this.request.send()):void 0},n.prototype.getCachedSnapshot=function(){var t;return!(t=this.controller.getCachedSnapshotForLocation(this.location))||null!=this.location.anchor&&!t.hasAnchor(this.location.anchor)||"restore"!==this.action&&!t.isPreviewable()?void 0:t},n.prototype.hasCachedSnapshot=function(){return null!=this.getCachedSnapshot()},n.prototype.loadCachedSnapshot=function(){var t,e;return(e=this.getCachedSnapshot())?(t=this.shouldIssueRequest(),this.render(function(){var n;return this.cacheSnapshot(),this.controller.render({snapshot:e,isPreview:t},this.performScroll),"function"==typeof(n=this.adapter).visitRendered&&n.visitRendered(this),t?void 0:this.complete()})):void 0},n.prototype.loadResponse=function(){return null!=this.response?this.render(function(){var t,e;return this.cacheSnapshot(),this.request.failed?(this.controller.render({error:this.response},this.performScroll),"function"==typeof(t=this.adapter).visitRendered&&t.visitRendered(this),this.fail()):(this.controller.render({snapshot:this.response},this.performScroll),"function"==typeof(e=this.adapter).visitRendered&&e.visitRendered(this),this.complete())}):void 0},n.prototype.followRedirect=function(){return this.redirectedToLocation&&!this.followedRedirect?(this.location=this.redirectedToLocation,this.controller.replaceHistoryWithLocationAndRestorationIdentifier(this.redirectedToLocation,this.restorationIdentifier),this.followedRedirect=!0):void 0},n.prototype.requestStarted=function(){var t;return this.recordTimingMetric("requestStart"),"function"==typeof(t=this.adapter).visitRequestStarted?t.visitRequestStarted(this):void 0},n.prototype.requestProgressed=function(t){var e;return this.progress=t,"function"==typeof(e=this.adapter).visitRequestProgressed?e.visitRequestProgressed(this):void 0},n.prototype.requestCompletedWithResponse=function(e,n){return this.response=e,null!=n&&(this.redirectedToLocation=t.Location.wrap(n)),this.adapter.visitRequestCompleted(this)},n.prototype.requestFailedWithStatusCode=function(t,e){return this.response=e,this.adapter.visitRequestFailedWithStatusCode(this,t)},n.prototype.requestFinished=function(){var t;return this.recordTimingMetric("requestEnd"),"function"==typeof(t=this.adapter).visitRequestFinished?t.visitRequestFinished(this):void 0},n.prototype.performScroll=function(){return this.scrolled?void 0:("restore"===this.action?this.scrollToRestoredPosition()||this.scrollToTop():this.scrollToAnchor()||this.scrollToTop(),this.scrolled=!0)},n.prototype.scrollToRestoredPosition=function(){var t,e;return null!=(t=null!=(e=this.restorationData)?e.scrollPosition:void 0)?(this.controller.scrollToPosition(t),!0):void 0},n.prototype.scrollToAnchor=function(){return null!=this.location.anchor?(this.controller.scrollToAnchor(this.location.anchor),!0):void 0},n.prototype.scrollToTop=function(){return this.controller.scrollToPosition({x:0,y:0})},n.prototype.recordTimingMetric=function(t){var e;return null!=(e=this.timingMetrics)[t]?e[t]:e[t]=(new Date).getTime()},n.prototype.getTimingMetrics=function(){return t.copyObject(this.timingMetrics)},i=function(t){switch(t){case"replace":return"replaceHistoryWithLocationAndRestorationIdentifier";case"advance":case"restore":return"pushHistoryWithLocationAndRestorationIdentifier"}},n.prototype.shouldIssueRequest=function(){return"restore"!==this.action||!this.hasCachedSnapshot()},n.prototype.cacheSnapshot=function(){return this.snapshotCached?void 0:(this.controller.cacheSnapshot(),this.snapshotCached=!0)},n.prototype.render=function(t){return this.cancelRender(),this.frame=requestAnimationFrame(function(e){return function(){return e.frame=null,t.call(e)}}(this))},n.prototype.cancelRender=function(){return this.frame?cancelAnimationFrame(this.frame):void 0},n}()}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}};t.Controller=function(){function n(){this.clickBubbled=e(this.clickBubbled,this),this.clickCaptured=e(this.clickCaptured,this),this.pageLoaded=e(this.pageLoaded,this),this.history=new t.History(this),this.view=new t.View(this),this.scrollManager=new t.ScrollManager(this),this.restorationData={},this.clearCache()}return n.prototype.start=function(){return t.supported&&!this.started?(addEventListener("click",this.clickCaptured,!0),addEventListener("DOMContentLoaded",this.pageLoaded,!1),this.scrollManager.start(),this.startHistory(),this.started=!0,this.enabled=!0):void 0},n.prototype.disable=function(){return this.enabled=!1},n.prototype.stop=function(){return this.started?(removeEventListener("click",this.clickCaptured,!0),removeEventListener("DOMContentLoaded",this.pageLoaded,!1),this.scrollManager.stop(),this.stopHistory(),this.started=!1):void 0},n.prototype.clearCache=function(){return this.cache=new t.SnapshotCache(10)},n.prototype.visit=function(e,n){var i,r;return null==n&&(n={}),e=t.Location.wrap(e),this.applicationAllowsVisitingLocation(e)?this.locationIsVisitable(e)?(i=null!=(r=n.action)?r:"advance",this.adapter.visitProposedToLocationWithAction(e,i)):window.location=e:void 0},n.prototype.startVisitToLocationWithAction=function(e,n,i){var r;return t.supported?(r=this.getRestorationDataForIdentifier(i),this.startVisit(e,n,{restorationData:r})):window.location=e},n.prototype.startHistory=function(){return this.location=t.Location.wrap(window.location),this.restorationIdentifier=t.uuid(),this.history.start(),this.history.replace(this.location,this.restorationIdentifier)},n.prototype.stopHistory=function(){return this.history.stop()},n.prototype.pushHistoryWithLocationAndRestorationIdentifier=function(e,n){return this.restorationIdentifier=n,this.location=t.Location.wrap(e),this.history.push(this.location,this.restorationIdentifier)},n.prototype.replaceHistoryWithLocationAndRestorationIdentifier=function(e,n){return this.restorationIdentifier=n,this.location=t.Location.wrap(e),this.history.replace(this.location,this.restorationIdentifier)},n.prototype.historyPoppedToLocationWithRestorationIdentifier=function(e,n){var i;return this.restorationIdentifier=n,this.enabled?(i=this.getRestorationDataForIdentifier(this.restorationIdentifier),this.startVisit(e,"restore",{restorationIdentifier:this.restorationIdentifier,restorationData:i,historyChanged:!0}),this.location=t.Location.wrap(e)):this.adapter.pageInvalidated()},n.prototype.getCachedSnapshotForLocation=function(t){var e;return(e=this.cache.get(t))?e.clone():void 0},n.prototype.shouldCacheSnapshot=function(){return this.view.getSnapshot().isCacheable()},n.prototype.cacheSnapshot=function(){var t;return this.shouldCacheSnapshot()?(this.notifyApplicationBeforeCachingSnapshot(),t=this.view.getSnapshot(),this.cache.put(this.lastRenderedLocation,t.clone())):void 0},n.prototype.scrollToAnchor=function(t){var e;return(e=document.getElementById(t))?this.scrollToElement(e):this.scrollToPosition({x:0,y:0})},n.prototype.scrollToElement=function(t){return this.scrollManager.scrollToElement(t)},n.prototype.scrollToPosition=function(t){return this.scrollManager.scrollToPosition(t)},n.prototype.scrollPositionChanged=function(t){var e;return e=this.getCurrentRestorationData(),e.scrollPosition=t},n.prototype.render=function(t,e){return this.view.render(t,e)},n.prototype.viewInvalidated=function(){return this.adapter.pageInvalidated()},n.prototype.viewWillRender=function(t){return this.notifyApplicationBeforeRender(t)},n.prototype.viewRendered=function(){return this.lastRenderedLocation=this.currentVisit.location,this.notifyApplicationAfterRender()},n.prototype.pageLoaded=function(){return this.lastRenderedLocation=this.location,this.notifyApplicationAfterPageLoad()},n.prototype.clickCaptured=function(){return removeEventListener("click",this.clickBubbled,!1),addEventListener("click",this.clickBubbled,!1)},n.prototype.clickBubbled=function(t){var e,n,i;return this.enabled&&this.clickEventIsSignificant(t)&&(n=this.getVisitableLinkForNode(t.target))&&(i=this.getVisitableLocationForLink(n))&&this.applicationAllowsFollowingLinkToLocation(n,i)?(t.preventDefault(),e=this.getActionForLink(n),this.visit(i,{action:e})):void 0},n.prototype.applicationAllowsFollowingLinkToLocation=function(t,e){return!this.notifyApplicationAfterClickingLinkToLocation(t,e).defaultPrevented},n.prototype.applicationAllowsVisitingLocation=function(t){return!this.notifyApplicationBeforeVisitingLocation(t).defaultPrevented},n.prototype.notifyApplicationAfterClickingLinkToLocation=function(e,n){return t.dispatch("turbolinks:click",{target:e,data:{url:n.absoluteURL},cancelable:!0})},n.prototype.notifyApplicationBeforeVisitingLocation=function(e){return t.dispatch("turbolinks:before-visit",{data:{url:e.absoluteURL},cancelable:!0})},n.prototype.notifyApplicationAfterVisitingLocation=function(e){return t.dispatch("turbolinks:visit",{data:{url:e.absoluteURL}})},n.prototype.notifyApplicationBeforeCachingSnapshot=function(){return t.dispatch("turbolinks:before-cache")},n.prototype.notifyApplicationBeforeRender=function(e){return t.dispatch("turbolinks:before-render",{data:{newBody:e}})},n.prototype.notifyApplicationAfterRender=function(){return t.dispatch("turbolinks:render")},n.prototype.notifyApplicationAfterPageLoad=function(e){return null==e&&(e={}),t.dispatch("turbolinks:load",{data:{url:this.location.absoluteURL,timing:e}})},n.prototype.startVisit=function(t,e,n){var i;return null!=(i=this.currentVisit)&&i.cancel(),this.currentVisit=this.createVisit(t,e,n),this.currentVisit.start(),this.notifyApplicationAfterVisitingLocation(t)},n.prototype.createVisit=function(e,n,i){var r,o,a,s,c;return o=null!=i?i:{},s=o.restorationIdentifier,a=o.restorationData,r=o.historyChanged,c=new t.Visit(this,e,n),c.restorationIdentifier=null!=s?s:t.uuid(),c.restorationData=t.copyObject(a),c.historyChanged=r,c.referrer=this.location,c},n.prototype.visitCompleted=function(t){return this.notifyApplicationAfterPageLoad(t.getTimingMetrics())},n.prototype.clickEventIsSignificant=function(t){return!(t.defaultPrevented||t.target.isContentEditable||t.which>1||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)},n.prototype.getVisitableLinkForNode=function(e){return this.nodeIsVisitable(e)?t.closest(e,"a[href]:not([target]):not([download])"):void 0},n.prototype.getVisitableLocationForLink=function(e){var n;return n=new t.Location(e.getAttribute("href")),this.locationIsVisitable(n)?n:void 0},n.prototype.getActionForLink=function(t){var e;return null!=(e=t.getAttribute("data-turbolinks-action"))?e:"advance"},n.prototype.nodeIsVisitable=function(e){var n;return!(n=t.closest(e,"[data-turbolinks]"))||"false"!==n.getAttribute("data-turbolinks")},n.prototype.locationIsVisitable=function(t){return t.isPrefixedBy(this.view.getRootLocation())&&t.isHTML()},n.prototype.getCurrentRestorationData=function(){return this.getRestorationDataForIdentifier(this.restorationIdentifier)},n.prototype.getRestorationDataForIdentifier=function(t){var e;return null!=(e=this.restorationData)[t]?e[t]:e[t]={}},n}()}.call(this),function(){var e,n,i;t.start=function(){return n()?(null==t.controller&&(t.controller=e()),t.controller.start()):void 0},n=function(){return null==window.Turbolinks&&(window.Turbolinks=t),i()},e=function(){var e;return e=new t.Controller,e.adapter=new t.BrowserAdapter(e),e},(i=function(){return window.Turbolinks===t})()&&t.start()}.call(this)}).call(this),"object"==typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd&&define(t)}.call(this),Blacklight=function(){var t=new Array;return{onLoad:function(e){t.push(e)},activate:function(){for(var e=0;e<t.length;e++)t[e].call()},listeners:function(){var t=[];return"undefined"!=typeof Turbolinks&&Turbolinks.supported?Turbolinks.BrowserAdapter?t.push("turbolinks:load"):t.push("page:load","ready"):t.push("ready"),t.join(" ")}}}(),$(document).on(Blacklight.listeners(),function(){Blacklight.activate()}),function(t){Blacklight.do_search_autofocus_fallback=function(){"undefined"!=typeof Modernizer&&Modernizr.autofocus||t("input[autofocus]").focus()},Blacklight.onLoad(function(){Blacklight.do_search_autofocus_fallback()})}(jQuery),function(t){t.fn.bl_checkbox_submit=function(e){return this.each(function(){function n(t){s.prop("checked",t),c.toggleClass("checked",t),t?(r.find("input[name=_method]").val("delete"),u.text(r.attr("data-present"))):(r.find("input[name=_method]").val("put"),u.text(r.attr("data-absent")))}var i=t.extend({},t.fn.bl_checkbox_submit.defaults,e),r=t(this);r.children().hide(),r.find("input[type=submit]").remove(),r.addClass("form-horizontal");var o=r.attr("data-doc-id")||Math.random(),a=0!=r.find("input[name=_method][value=delete]").size(),s=t('<input type="checkbox">').addClass(i.css_class).attr("id",i.css_class+"_"+o),c=t("<label>").addClass(i.css_class).attr("for",i.css_class+"_"+o).attr("title",r.attr("title")||""),u=t("<span>");c.append(s),c.append(" "),c.append(u);var l=t("<div class='checkbox' />").addClass(i.css_class).append(c);r.append(l),n(a),s.click(function(){return u.text(r.attr("data-inprogress")),c.attr("disabled","disabled"),s.attr("disabled","disabled"),t.ajax({url:r.attr("action"),dataType:"json",type:r.attr("method").toUpperCase(),data:r.serialize(),error:function(){alert("Error"),n(a),c.removeAttr("disabled"),s.removeAttr("disabled")},success:function(t,e,o){0!=o.status?(n(a=!a),c.removeAttr("disabled"),s.removeAttr("disabled"),i.success.call(r,a,o.responseJSON)):(alert("Error"),n(a),c.removeAttr("disabled"),s.removeAttr("disabled"))}}),!1})}),this},t.fn.bl_checkbox_submit.defaults={css_class:"bl_checkbox_submit",success:function(){}}}(jQuery),function(t){Blacklight.do_bookmark_toggle_behavior=function(){t(Blacklight.do_bookmark_toggle_behavior.selector).bl_checkbox_submit({css_class:"toggle_bookmark",success:function(e,n){n.bookmarks&&t("[data-role=bookmark-counter]").text(n.bookmarks.count)}})},Blacklight.do_bookmark_toggle_behavior.selector="form.bookmark_toggle",Blacklight.onLoad(function(){Blacklight.do_bookmark_toggle_behavior()})}(jQuery),
Blacklight.ajaxModal===undefined&&(Blacklight.ajaxModal={}),Blacklight.ajaxModal.modalSelector="#ajax-modal",Blacklight.ajaxModal.triggerLinkSelector="a[data-ajax-modal~=trigger], a.lightboxLink,a.more_facets_link,.ajax_modal_launch",Blacklight.ajaxModal.triggerFormSelector="form[data-ajax-modal~=trigger], form.ajax_form",Blacklight.ajaxModal.preserveLinkSelector=Blacklight.ajaxModal.modalSelector+" a[data-ajax-modal~=preserve]",Blacklight.ajaxModal.preserveFormSelector=Blacklight.ajaxModal.modalSelector+" form[data-ajax-modal~=preserve]",Blacklight.ajaxModal.containerSelector="[data-ajax-modal~=container]",Blacklight.ajaxModal.modalCloseSelector="[data-ajax-modal~=close], span.ajax-close-modal",Blacklight.ajaxModal.onFailure=function(){var t="<div class='modal-header'><button type='button' class='close' data-dismiss='modal' aria-hidden='true'>\xd7</button>Network Error</div>";$(Blacklight.ajaxModal.modalSelector).find(".modal-content").html(t),$(Blacklight.ajaxModal.modalSelector).modal("show")},Blacklight.ajaxModal.receiveAjax=function(t){var e=$("<div>").append(jQuery.parseHTML(t)).find(Blacklight.ajaxModal.containerSelector).first();0!==e.length&&(t=e.html()),$(Blacklight.ajaxModal.modalSelector).find(".modal-content").html(t);var n=$.Event("loaded.blacklight.ajax-modal");$(Blacklight.ajaxModal.modalSelector).trigger(n),n.isDefaultPrevented()||$(Blacklight.ajaxModal.modalSelector).modal("show")},Blacklight.ajaxModal.modalAjaxLinkClick=function(t){t.preventDefault(),$.ajax({url:$(this).attr("href")}).fail(Blacklight.ajaxModal.onFailure).done(Blacklight.ajaxModal.receiveAjax)},Blacklight.ajaxModal.modalAjaxFormSubmit=function(t){t.preventDefault(),$.ajax({url:$(this).attr("action"),data:$(this).serialize(),type:$(this).attr("method")}).fail(Blacklight.ajaxModal.onFailure).done(Blacklight.ajaxModal.receiveAjax)},Blacklight.ajaxModal.setup_modal=function(){var t=$.Event("setup.blacklight.ajax-modal");$("body").trigger(t),t.isDefaultPrevented()||($("body").on("click",Blacklight.ajaxModal.triggerLinkSelector+", "+Blacklight.ajaxModal.preserveLinkSelector,Blacklight.ajaxModal.modalAjaxLinkClick),$("body").on("submit",Blacklight.ajaxModal.triggerFormSelector+", "+Blacklight.ajaxModal.preserveFormSelector,Blacklight.ajaxModal.modalAjaxFormSubmit),$("body").on("loaded.blacklight.ajax-modal",Blacklight.ajaxModal.check_close_ajax_modal),$("body ").on("click",Blacklight.ajaxModal.modalSelector+" a[data-dismiss~=modal]",function(t){t.preventDefault()}))},Blacklight.ajaxModal.check_close_ajax_modal=function(t){$(t.target).find(Blacklight.ajaxModal.modalCloseSelector).length&&(modal_flashes=$(this).find(".flash_messages"),$(t.target).modal("hide"),t.preventDefault(),main_flashes=$("#main-flashes"),main_flashes.append(modal_flashes),modal_flashes.fadeIn(500))},Blacklight.onLoad(function(){Blacklight.ajaxModal.setup_modal()}),function(t){Blacklight.do_search_context_behavior=function(){t("a[data-context-href]").on("click.search-context",Blacklight.handleSearchContextMethod)},Blacklight.handleSearchContextMethod=function(e){var n=t(this),i=n.data("context-href"),r="post",o=n.attr("target"),a=t("meta[name=csrf-token]").attr("content"),s=t("meta[name=csrf-param]").attr("content"),c=t('<form method="post" action="'+i+'"></form>'),u='<input name="_method" value="'+r+'" type="hidden" />',l='<input name="redirect" value="'+n.attr("href")+'" type="hidden" />';return(e.metaKey||e.ctrlKey)&&(o="_blank"),s!==undefined&&a!==undefined&&(u+='<input name="'+s+'" value="'+a+'" type="hidden" />'),o&&c.attr("target",o),c.hide().append(u).append(l).appendTo("body"),c.submit(),!1},Blacklight.onLoad(function(){Blacklight.do_search_context_behavior()})}(jQuery),function(t){Blacklight.onLoad(function(){t(document).on("click","a[data-toggle=collapse][href='#'], [data-toggle=collapse] a[href='#']",function(t){t.preventDefault()})})}(jQuery),function(){"use strict"}(jQuery),Blacklight.onLoad(function(){"use strict";$('[data-autocomplete-enabled="true"]').each(function(){var t=$(this);if(!t.hasClass("tt-hint")){var e=t.data().autocompletePath,n=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:e+"?q=%QUERY",wildcard:"%QUERY"}});n.initialize(),t.typeahead({hint:!0,highlight:!0,minLength:2},{name:"terms",displayKey:"term",source:n.ttAdapter()})}})}),function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(t.style[n]!==undefined)return{end:e[n]};return!1}t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;t(this).one("bsTransitionEnd",function(){n=!0});var r=function(){n||t(i).trigger(t.support.transition.end)};return setTimeout(r,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(t){"use strict";function e(e){var n,i=e.attr("data-target")||(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return t(i)}function n(e){return this.each(function(){var n=t(this),r=n.data("bs.collapse"),o=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);!r&&o.toggle&&/show|hide/.test(e)&&(o.toggle=!1),r||n.data("bs.collapse",r=new i(this,o)),"string"==typeof e&&r[e]()})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};i.VERSION="3.3.7",i.TRANSITION_DURATION=350,i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,r=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(r&&r.length&&(e=r.data("bs.collapse"))&&e.transitioning)){var o=t.Event("show.bs.collapse");if(this.$element.trigger(o),!o.isDefaultPrevented()){r&&r.length&&(n.call(r,"hide"),e||r.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return s.call(this);var c=t.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",t.proxy(s,this)).emulateTransitionEnd(i.TRANSITION_DURATION)[a](this.$element[0][c])}}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var r=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!t.support.transition)return r.call(this);this.$element[n](0).one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(i.TRANSITION_DURATION)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(n,i){var r=t(i);this.addAriaAndCollapsedClass(e(r),r)},this)).end()},i.prototype.addAriaAndCollapsedClass=function(t,e){var n=t.hasClass("in");t.attr("aria-expanded",n),e.toggleClass("collapsed",!n).attr("aria-expanded",n)};var r=t.fn.collapse;t.fn.collapse=n,t.fn.collapse.Constructor=i,t.fn.collapse.noConflict=function(){return t.fn.collapse=r,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var r=t(this);r.attr("data-target")||i.preventDefault();var o=e(r),a=o.data("bs.collapse")?"toggle":r.data();n.call(o,a)})}(jQuery),function(t){"use strict";function e(e){var n=e.attr("data-target");n||(n=(n=e.attr("href"))&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent()}function n(n){n&&3===n.which||(t(r).remove(),t(o).each(function(){var i=t(this),r=e(i),o={relatedTarget:this};r.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&t.contains(r[0],n.target)||(r.trigger(n=t.Event("hide.bs.dropdown",o)),n.isDefaultPrevented()||(i.attr("aria-expanded","false"),r.removeClass("open").trigger(t.Event("hidden.bs.dropdown",o)))))}))}function i(e){return this.each(function(){var n=t(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new a(this)),"string"==typeof e&&i[e].call(n)})}var r=".dropdown-backdrop",o='[data-toggle="dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.7",a.prototype.toggle=function(i){var r=t(this);if(!r.is(".disabled, :disabled")){var o=e(r),a=o.hasClass("open");if(n(),!a){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",n);var s={relatedTarget:this};if(o.trigger(i=t.Event("show.bs.dropdown",s)),i.isDefaultPrevented())return;r.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger(t.Event("shown.bs.dropdown",s))}return!1}},a.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var i=t(this);if(n.preventDefault(),n.stopPropagation(),!i.is(".disabled, :disabled")){var r=e(i),a=r.hasClass("open");if(!a&&27!=n.which||a&&27==n.which)return 27==n.which&&r.find(o).trigger("focus"),i.trigger("click");var s=" li:not(.disabled):visible a",c=r.find(".dropdown-menu"+s);if(c.length){var u=c.index(n.target);38==n.which&&u>0&&u--,40==n.which&&u<c.length-1&&u++,~u||(u=0),c.eq(u).trigger("focus")}}}};var s=t.fn.dropdown;t.fn.dropdown=i,t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=s,this},t(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",o,a.prototype.toggle).on("keydown.bs.dropdown.data-api",o,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),r=n.data("bs.alert");r||n.data("bs.alert",r=new i(this)),"string"==typeof e&&r[e].call(n)})}var n='[data-dismiss="alert"]',i=function(e){t(e).on("click",n,this.close)};i.VERSION="3.3.7",i.TRANSITION_DURATION=150,i.prototype.close=function(e){function n(){a.detach().trigger("closed.bs.alert").remove()}var r=t(this),o=r.attr("data-target");o||(o=(o=r.attr("href"))&&o.replace(/.*(?=#[^\s]*$)/,""));var a=t("#"===o?[]:o);e&&e.preventDefault(),a.length||(a=r.closest(".alert")),a.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(a.removeClass("in"),t.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n())};var r=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=r,this},t(document).on("click.bs.alert.data-api",n,i.prototype.close)}(jQuery),function(t){"use strict";function e(e,i){return this.each(function(){var r=t(this),o=r.data("bs.modal"),a=t.extend({},n.DEFAULTS,r.data(),"object"==typeof e&&e);o||r.data("bs.modal",o=new n(this,a)),"string"==typeof e?o[e](i):a.show&&o.show(i)})}var n=function(e,n){this.options=n,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.3.7",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},n.prototype.show=function(e){var i=this,r=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var r=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),r&&i.$element[0].offsetWidth,i.$element.addClass("in"),i.enforceFocus();var o=t.Event("shown.bs.modal",{relatedTarget:e});r?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(o)}).emulateTransitionEnd(n.TRANSITION_DURATION):i.$element.trigger("focus").trigger(o)}))},n.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},n.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},n.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(e){var i=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&r;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+r).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;o?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){i.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):a()}else e&&e()},n.prototype.handleUpdate=function(){this.adjustDialog()},n.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},n.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},n.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},n.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var i=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=n,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i=t(this),r=i.attr("href"),o=t(i.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),a=o.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(r)&&r},o.data(),i.data());i.is("a")&&n.preventDefault(),o.one("show.bs.modal",function(t){t.isDefaultPrevented()||o.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),e.call(o,a,this)})}(jQuery),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(n){return t.Bloodhound=e(n)}):"object"==typeof exports?module.exports=e(require("jquery")):t.Bloodhound=e(jQuery)}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){if(!(i=n.call(null,r,t,e)))return!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){if(i=n.call(null,r,t,e))return!1}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var o,a,s=this,c=arguments;return o=function(){i=null,n||(r=t.apply(s,c))},a=n&&!i,clearTimeout(i),i=setTimeout(o,e),a&&(r=t.apply(s,c)),r}},throttle:function(t,e){var n,i,r,o,a,s;return a=0,s=function(){a=new Date,r=null,o=t.apply(n,i)},function(){var c=new Date,u=e-(c-a);return n=this,i=arguments,u<=0?(clearTimeout(r),r=null,a=c,o=t.apply(n,i)):r||(r=setTimeout(s,u)),o}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n="0.11.1",i=function(){"use strict";function t(t){return(t=e.toStr(t))?t.split(/\s+/):[]}function n(t){return(t=e.toStr(t))?t.split(/\W+/):[]}function i(t){return function(n){return n=e.isArray(n)?n:[].slice.call(arguments,0),function(i){var r=[];return e.each(n,function(n){r=r.concat(t(e.toStr(i[n])))}),r}}}return{nonword:n,whitespace:t,obj:{nonword:i(n),whitespace:i(t)}}}(),r=function(){"use strict";function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function i(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new r(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];if(e)return this.list.moveToFront(e),e.val},reset:function(){this.size=0,this.hash={},this.list=new i}}),e.mixin(i.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),o=function(){"use strict";function n(t,n){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix)),this.ls=n||s,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function o(e){return t.parseJSON(e)}function a(t){var e,n,i=[],r=s.length;for(e=0;e<r;e++)(n=s.key(e)).match(t)&&i.push(n.replace(t,""));return i}var s;try{(s=window.localStorage).setItem("~~~","!"),s.removeItem("~~~")}catch(c){s=null}return e.mixin(n.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(c){"QuotaExceededError"===c.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),o(this.ls.getItem(this._prefix(t)))},set:function(t,n,o){return e.isNumber(o)?this._safeSet(this._ttlKey(t),r(i()+o)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),r(n))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=a(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var n=o(this.ls.getItem(this._ttlKey(t)));return!!(e.isNumber(n)&&i()>n)}}),n}(),a=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=!1===t.cache?new r(0):s}var i=0,o={},a=6,s=new r(10);return n.setMaxPendingRequests=function(t){a=t},n.resetCache=function(){s.reset()},e.mixin(n.prototype,{_fingerprint:function(e){return(e=e||{}).url+e.type+t.param(e.data||{})},_get:function(t,e){function n(t){e(null,t),l._cache.set(c,t)}function r(){e(!0)}function s(){i--,delete o[c],l.onDeckRequestArgs&&(l._get.apply(l,l.onDeckRequestArgs),l.onDeckRequestArgs=null)}var c,u,l=this;c=this._fingerprint(t),this.cancelled||c!==this.lastReq||((u=o[c])?u.done(n).fail(r):i<a?(i++,o[c]=this._send(t).done(n).fail(r).always(s)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,i){var r,o;i=i||t.noop,n=e.isString(n)?{url:n}:n||{},o=this._fingerprint(n),this.cancelled=!1,this.lastReq=o,(r=this._cache.get(o))?i(null,r):this._get(n,i)},cancel:function(){this.cancelled=!0}}),n}(),s=window.SearchIndex=function(){"use strict";function n(n){(n=n||{}).datumTokenizer&&n.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||e.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.matchAnyQueryToken=n.matchAnyQueryToken,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){var t={};return t[c]=[],t[s]={},t}function o(t){for(var e={},n=[],i=0,r=t.length;i<r;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function a(t,e){var n=0,i=0,r=[];t=t.sort(),e=e.sort();for(var o=t.length,a=e.length;n<o&&i<a;)t[n]<e[i]?n++:t[n]>e[i]?i++:(r.push(t[n]),n++,i++);return r}var s="c",c="i";return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var o,a;n.datums[o=n.identify(t)]=t,a=i(n.datumTokenizer(t)),e.each(a,function(t){var e,i,a;for(e=n.trie,i=t.split("");a=i.shift();)(e=e[s][a]||(e[s][a]=r()))[c].push(o)})})},get:function(t){var n=this;return e.map(t,function(t){return n.datums[t]})},search:function(t){var n,r,u=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,o;if(r&&0===r.length&&!u.matchAnyQueryToken)return!1;for(e=u.trie,n=t.split("");e&&(i=n.shift());)e=e[s][i];if(e&&0===n.length)o=e[c].slice(0),r=r?a(r,o):o;else if(!u.matchAnyQueryToken)return r=[],!1}),r?e.map(o(r),function(t){return u.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),c=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new o(t.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(t){function e(){t(!0)}function n(e){t(null,r.transform(e))}var i,r=this;t&&(i=this.prepare(this._settings()),this.transport(i).fail(e).done(n))},clear:function(){return this.storage.clear(),this}}),t}(),u=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.indexResponse=t.indexResponse,this.transport=new a({cache:t.cache,limiter:t.limiter,transport:t.transport})}return e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,e){function n(t,n){e(t?[]:r.transform(n))}var i,r=this;if(e)return t=t||"",i=this.prepare(t,this._settings()),this.transport.get(i,n)},cancelLastRequest:function(){this.transport.cancel()}}),t}(),l=function(){"use strict";function i(i){var r;return i?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null},i=e.isString(i)?{url:i}:i,!(i=e.mixin(r,i)).url&&t.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint=n+i.thumbprint,i.transport=i.transport?s(i.transport):t.ajax,i):null}function r(n){var i;if(n)return i={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},n=e.isString(n)?{url:n}:n,!(n=e.mixin(i,n)).url&&t.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=o(n),n.limiter=a(n),n.transport=n.transport?s(n.transport):t.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n}function o(t){function e(t,e){return e.url=o(e.url,t),e}function n(t,e){return e.url=e.url.replace(a,encodeURIComponent(t)),e}function i(t,e){return e}var r,o,a;return r=t.prepare,o=t.replace,a=t.wildcard,r||(r=o?e:t.wildcard?n:i)}function a(t){function n(t){return function(n){return e.debounce(n,t)}}function i(t){return function(n){return e.throttle(n,t)}}var r,o,a;return r=t.limiter,o=t.rateLimitBy,a=t.rateLimitWait,r||(r=/^throttle$/i.test(o)?i(a):n(a)),r}function s(n){return function(i){function r(t){e.defer(function(){a.resolve(t)})}function o(t){e.defer(function(){a.reject(t)})}var a=t.Deferred();return n(i,r,o),a}}return function(n){var o,a;return o={initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,matchAnyQueryToken:!1,sufficient:5,indexRemote:!1,sorter:null,local:[],prefetch:null,remote:null},!(n=e.mixin(o,n||{})).datumTokenizer&&t.error("datumTokenizer is required"),!n.queryTokenizer&&t.error("queryTokenizer is required"),a=n.sorter,n.sorter=a?function(t){return t.sort(a)}:e.identity,n.local=e.isFunction(n.local)?n.local():n.local,n.prefetch=i(n.prefetch),n.remote=r(n.remote),n}}();return function(){"use strict";function n(t){t=l(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.indexRemote=t.indexRemote,this.local=t.local,this.remote=t.remote?new u(t.remote):null,this.prefetch=t.prefetch?new c(t.prefetch):null,this.index=new s({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),!1!==t.initialize&&this.initialize()}var r;return r=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=r),n},n.tokenizers=i,e.mixin(n.prototype,{__ttAdapter:function(){function t(t,e,i){return n.search(t,e,i)}function e(t,e){return n.search(t,e)}var n=this;return this.remote?t:e},_loadPrefetch:function(){function e(t,e){if(t)return n.reject();r.add(e),r.prefetch.store(r.index.serialize()),n.resolve()}var n,i,r=this;return n=t.Deferred(),this.prefetch?(i=this.prefetch.fromCache())?(this.index.bootstrap(i),n.resolve()):this.prefetch.fromNetwork(e):n.resolve(),n.promise()},_initialize:function(){function t(){e.add(e.local)}var e=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(t),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=e.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,n,i){function r(t){var n=[];e.each(t,function(t){!e.some(o,function(e){return a.identify(t)===a.identify(e)})&&n.push(t)}),a.indexRemote&&a.add(n),i(n)}var o,a=this;return n=n||e.noop,i=i||e.noop,o=this.sorter(this.index.search(t)),n(this.remote?o.slice():o),this.remote&&o.length<this.sufficient?this.remote.get(t,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return a.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}()}),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(0,function(t){var e=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){if(!(i=n.call(null,r,t,e)))return!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){if(i=n.call(null,r,t,e))return!1}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var o,a,s=this,c=arguments;return o=function(){i=null,n||(r=t.apply(s,c))},a=n&&!i,clearTimeout(i),i=setTimeout(o,e),a&&(r=t.apply(s,c)),r}},throttle:function(t,e){var n,i,r,o,a,s;return a=0,s=function(){a=new Date,r=null,o=t.apply(n,i)},function(){var c=new Date,u=e-(c-a);return n=this,i=arguments,u<=0?(clearTimeout(r),r=null,a=c,o=t.apply(n,i)):r||(r=setTimeout(s,u)),o}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n=function(){
"use strict";function t(t){var a,s;return s=e.mixin({},o,t),a={css:r(),classes:s,html:n(s),selectors:i(s)},{css:a.css,html:a.html,classes:a.classes,selectors:a.selectors,mixin:function(t){e.mixin(t,a)}}}function n(t){return{wrapper:'<span class="'+t.wrapper+'"></span>',menu:'<div class="'+t.menu+'"></div>'}}function i(t){var n={};return e.each(t,function(t,e){n[e]="."+t}),n}function r(){var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t}var o={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return t}(),i=function(){"use strict";function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var i,r;return i="typeahead:",r={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},e.mixin(n.prototype,{_trigger:function(e,n){var r;return r=t.Event(i+e),(n=n||[]).unshift(r),this.$el.trigger.apply(this.$el,n),r},before:function(t){var e;return e=[].slice.call(arguments,1),this._trigger("before"+t,e).isDefaultPrevented()},trigger:function(t){var e;this._trigger(t,[].slice.call(arguments,1)),(e=r[t])&&this._trigger(e,[].slice.call(arguments,1))}}),n}(),r=function(){"use strict";function t(t,e,n,i){var r;if(!n)return this;for(e=e.split(c),n=i?s(n,i):n,this._callbacks=this._callbacks||{};r=e.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][t].push(n);return this}function e(e,n,i){return t.call(this,"async",e,n,i)}function n(e,n,i){return t.call(this,"sync",e,n,i)}function i(t){var e;if(!this._callbacks)return this;for(t=t.split(c);e=t.shift();)delete this._callbacks[e];return this}function r(t){var e,n,i,r,a;if(!this._callbacks)return this;for(t=t.split(c),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)r=o(n.sync,this,[e].concat(i)),a=o(n.async,this,[e].concat(i)),r()&&u(a);return this}function o(t,e,n){function i(){for(var i,r=0,o=t.length;!i&&r<o;r+=1)i=!1===t[r].apply(e,n);return!i}return i}function a(){return window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)}}function s(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var c=/\s+/,u=a();return{onSync:n,onAsync:e,off:i,trigger:r}}(),o=function(t){"use strict";function n(t,n,i){for(var r,o=[],a=0,s=t.length;a<s;a++)o.push(e.escapeRegExChars(t[a]));return r=i?"\\b("+o.join("|")+")\\b":"("+o.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function o(e){var n,i,o;return(n=s.exec(e.data))&&(o=t.createElement(r.tagName),r.className&&(o.className=r.className),(i=e.splitText(n.index)).splitText(n[0].length),o.appendChild(i.cloneNode(!0)),e.parentNode.replaceChild(o,i)),!!n}function a(t,e){for(var n,i=3,r=0;r<t.childNodes.length;r++)(n=t.childNodes[r]).nodeType===i?r+=e(n)?1:0:a(n,e)}var s;(r=e.mixin({},i,r)).node&&r.pattern&&(r.pattern=e.isArray(r.pattern)?r.pattern:[r.pattern],s=n(r.pattern,r.caseSensitive,r.wordsOnly),a(r.node,o))}}(window.document),a=function(){"use strict";function n(n,r){(n=n||{}).input||t.error("input is missing"),r.mixin(this),this.$hint=t(n.hint),this.$input=t(n.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=i(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop)}function i(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function o(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function a(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var s;return s={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return e.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,r,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(t){var e=s[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(t,e){var n;switch(t){case"up":case"down":n=!a(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!a(e);break;default:n=!0}return n},_checkLanguageDirection:function(){var t=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==t&&(this.dir=t,this.$hint.attr("dir",t),this.trigger("langDirChanged",t))},_setQuery:function(t,e){var n,i;i=!!(n=o(t,this.query))&&this.query.length!==t.length,this.query=t,e||n?!e&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var t,n,i,r,o=this;return t=e.bind(this._onBlur,this),n=e.bind(this._onFocus,this),i=e.bind(this._onKeydown,this),r=e.bind(this._onInput,this),this.$input.on("blur.tt",t).on("focus.tt",n).on("keydown.tt",i),!e.isMsie()||e.isMsie()>9?this.$input.on("input.tt",r):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){s[t.which||t.keyCode]||e.defer(e.bind(o._onInput,o,t))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(t,e){this.setInputValue(t),this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(t){this.$input.val(t),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n;n=(t=this.getInputValue())!==(e=this.getHint())&&0===e.indexOf(t),!(""!==t&&n&&!this.hasOverflow())&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,i;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:!document.selection||((i=document.selection.createRange()).moveStart("character",-t),t===i.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=t("<div>")}}),n}(),s=function(){"use strict";function n(n,r){(n=n||{}).templates=n.templates||{},n.templates.notFound=n.templates.notFound||n.templates.empty,n.source||t.error("missing source"),n.node||t.error("missing node"),n.name&&!s(n.name)&&t.error("invalid dataset name: "+n.name),r.mixin(this),this.highlight=!!n.highlight,this.name=n.name||u(),this.limit=n.limit||5,this.displayFn=i(n.display||n.displayKey),this.templates=a(n.templates,this.displayFn),this.source=n.source.__ttAdapter?n.source.__ttAdapter():n.source,this.async=e.isUndefined(n.async)?this.source.length>2:!!n.async,this._resetLastSuggestion(),this.$el=t(n.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function i(t){function n(e){return e[t]}return t=t||e.stringify,e.isFunction(t)?t:n}function a(n,i){function r(e){return t("<div>").text(i(e))}return{notFound:n.notFound&&e.templatify(n.notFound),pending:n.pending&&e.templatify(n.pending),header:n.header&&e.templatify(n.header),footer:n.footer&&e.templatify(n.footer),suggestion:n.suggestion||r}}function s(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var c,u;return c={val:"tt-selectable-display",obj:"tt-selectable-object"},u=e.getIdGenerator(),n.extractData=function(e){var n=t(e);return n.data(c.obj)?{val:n.data(c.val)||"",obj:n.data(c.obj)||null}:null},e.mixin(n.prototype,r,{_overwrite:function(t,e){(e=e||[]).length?this._renderSuggestions(t,e):this.async&&this.templates.pending?this._renderPending(t):!this.async&&this.templates.notFound?this._renderNotFound(t):this._empty(),this.trigger("rendered",this.name,e,!1)},_append:function(t,e){(e=e||[]).length&&this.$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(t),this.trigger("rendered",this.name,e,!0)},_renderSuggestions:function(t,e){var n;n=this._getSuggestionsFragment(t,e),this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function(t,e){var n,i;i=(n=this._getSuggestionsFragment(t,e)).children().last(),this.$lastSuggestion.after(n),this.$lastSuggestion=i},_renderPending:function(t){var e=this.templates.pending;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_renderNotFound:function(t){var e=this.templates.notFound;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(n,i){var r,a=this;return r=document.createDocumentFragment(),e.each(i,function(e){var i,o;o=a._injectQuery(n,e),i=t(a.templates.suggestion(o)).data(c.obj,e).data(c.val,a.displayFn(e)).addClass(a.classes.suggestion+" "+a.classes.selectable),r.appendChild(i[0])}),this.highlight&&o({className:this.classes.highlight,node:r,pattern:n}),t(r)},_getFooter:function(t,e){return this.templates.footer?this.templates.footer({query:t,suggestions:e,dataset:this.name}):null},_getHeader:function(t,e){return this.templates.header?this.templates.header({query:t,suggestions:e,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=t()},_injectQuery:function(t,n){return e.isObject(n)?e.mixin({_query:t},n):n},update:function(e){function n(t){a||(a=!0,t=(t||[]).slice(0,r.limit),s=t.length,r._overwrite(e,t),s<r.limit&&r.async&&r.trigger("asyncRequested",e))}function i(n){n=n||[],!o&&s<r.limit&&(r.cancel=t.noop,r._append(e,n.slice(0,r.limit-s)),s+=n.length,r.async&&r.trigger("asyncReceived",e))}var r=this,o=!1,a=!1,s=0;this.cancel(),this.cancel=function(){o=!0,r.cancel=t.noop,r.async&&r.trigger("asyncCanceled",e)},this.source(e,n,i),!a&&n([])},cancel:t.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=t("<div>")}}),n}(),c=function(){"use strict";function n(n,i){function r(e){var n=o.$node.find(e.node).first();return e.node=n.length?n:t("<div>").appendTo(o.$node),new s(e,i)}var o=this;(n=n||{}).node||t.error("node is required"),i.mixin(this),this.$node=t(n.node),this.query=null,this.datasets=e.map(n.datasets,r)}return e.mixin(n.prototype,r,{_onSelectableClick:function(e){this.trigger("selectableClicked",t(e.currentTarget))},_onRendered:function(t,e,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",e,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function t(t){return t.isEmpty()}return e.every(this.datasets,t)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var t=this.getActiveSelectable();t&&t.removeClass(this.classes.cursor)},_ensureVisible:function(t){var e,n,i,r;n=(e=t.position().top)+t.outerHeight(!0),i=this.$node.scrollTop(),r=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),e<0?this.$node.scrollTop(i+e):r<n&&this.$node.scrollTop(i+(n-r))},bind:function(){var t,n=this;return t=e.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,t),e.each(this.datasets,function(t){t.onSync("asyncRequested",n._propagate,n).onSync("asyncCanceled",n._propagate,n).onSync("asyncReceived",n._propagate,n).onSync("rendered",n._onRendered,n).onSync("cleared",n._onCleared,n)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.scrollTop(0),this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(t){this.$node.attr("dir",t)},selectableRelativeToCursor:function(t){var e,n,i,r;return n=this.getActiveSelectable(),e=this._getSelectables(),i=n?e.index(n):-1,r=i+t,r=(r+1)%(e.length+1)-1,-1===(r=r<-1?e.length-1:r)?null:e.eq(r)},setCursor:function(t){this._removeCursor(),(t=t&&t.first())&&(t.addClass(this.classes.cursor),this._ensureVisible(t))},getSelectableData:function(t){return t&&t.length?s.extractData(t):null},getActiveSelectable:function(){var t=this._getSelectables().filter(this.selectors.cursor).first();return t.length?t:null},getTopSelectable:function(){var t=this._getSelectables().first();return t.length?t:null},update:function(t){function n(e){e.update(t)}var i=t!==this.query;return i&&(this.query=t,e.each(this.datasets,n)),i},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function n(t){t.destroy()}this.$node.off(".tt"),this.$node=t("<div>"),e.each(this.datasets,n)}}),n}(),u=function(){"use strict";function t(){c.apply(this,[].slice.call(arguments,0))}var n=c.prototype;return e.mixin(t.prototype,c.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),n.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),n.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(t){return this.$node.css("ltr"===t?this.css.ltr:this.css.rtl),n.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),t}(),l=function(){"use strict";function n(n,r){var o,a,s,c,u,l,h,d,f,p,m;(n=n||{}).input||t.error("missing input"),n.menu||t.error("missing menu"),n.eventBus||t.error("missing event bus"),r.mixin(this),this.eventBus=n.eventBus,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.input=n.input,this.menu=n.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),o=i(this,"activate","open","_onFocused"),a=i(this,"deactivate","_onBlurred"),s=i(this,"isActive","isOpen","_onEnterKeyed"),c=i(this,"isActive","isOpen","_onTabKeyed"),u=i(this,"isActive","_onEscKeyed"),l=i(this,"isActive","open","_onUpKeyed"),h=i(this,"isActive","open","_onDownKeyed"),d=i(this,"isActive","isOpen","_onLeftKeyed"),f=i(this,"isActive","isOpen","_onRightKeyed"),p=i(this,"_openIfActive","_onQueryChanged"),m=i(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",o,this).onSync("blurred",a,this).onSync("enterKeyed",s,this).onSync("tabKeyed",c,this).onSync("escKeyed",u,this).onSync("upKeyed",l,this).onSync("downKeyed",h,this).onSync("leftKeyed",d,this).onSync("rightKeyed",f,this).onSync("queryChanged",p,this).onSync("whitespaceChanged",m,this).onSync("langDirChanged",this._onLangDirChanged,this)}function i(t){var n=[].slice.call(arguments,1);return function(){var i=[].slice.call(arguments);e.each(n,function(e){return t[e].apply(t,i)})}}return e.mixin(n.prototype,{_hacks:function(){var n,i;n=this.input.$input||t("<div>"),i=this.menu.$node||t("<div>"),n.on("blur.tt",function(t){var r,o,a;r=document.activeElement,o=i.is(r),a=i.has(r).length>0,e.isMsie()&&(o||a)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){n.focus()}))}),i.on("mousedown.tt",function(t){t.preventDefault()})},_onSelectableClicked:function(t,e){this.select(e)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(t,e,n,i){this._updateHint(),this.eventBus.trigger("render",n,i,e)},_onAsyncRequested:function(t,e,n){this.eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function(t,e,n){this.eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function(t,e,n){this.eventBus.trigger("asyncreceive",n,e)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())&&this.select(n)&&e.preventDefault()},_onTabKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(t,e){this._minLengthMet(e)?this.menu.update(e):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(t,e){this.dir!==e&&(this.dir=e,this.menu.setLanguageDirection(e))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(t){return(t=e.isString(t)?t:this.input.getQuery()||"").length>=this.minLength},_updateHint:function(){var t,n,i,r,o,s;t=this.menu.getTopSelectable(),n=this.menu.getSelectableData(t),i=this.input.getInputValue(),!n||e.isBlankString(i)||this.input.hasOverflow()?this.input.clearHint():(r=a.normalizeQuery(i),o=e.escapeRegExChars(r),(s=new RegExp("^(?:"+o+")(.+$)","i").exec(n.val))&&this.input.setHint(i+s[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return!!this.isActive()||!(!this.isEnabled()||this.eventBus.before("active"))&&(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return!this.isActive()||!this.eventBus.before("idle")&&(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0)},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(t){this.input.setQuery(e.toStr(t))},getVal:function(){return this.input.getQuery()},select:function(t){var e=this.menu.getSelectableData(t);return!(!e||this.eventBus.before("select",e.obj))&&(this.input.setQuery(e.val,!0),this.eventBus.trigger("select",e.obj),this.close(),!0)},autocomplete:function(t){var e,n;return e=this.input.getQuery(),n=this.menu.getSelectableData(t),!(!(n&&e!==n.val)||this.eventBus.before("autocomplete",n.obj))&&(this.input.setQuery(n.val),this.eventBus.trigger("autocomplete",n.obj),!0)},moveCursor:function(t){var e,n,i,r;return e=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(t),i=this.menu.getSelectableData(n),r=i?i.obj:null,!(this._minLengthMet()&&this.menu.update(e))&&!this.eventBus.before("cursorchange",r)&&(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),n}();!function(){"use strict";function r(e,n){e.each(function(){var e,i=t(this);(e=i.data(m.typeahead))&&n(e,i)})}function o(t,e){return t.clone().addClass(e.classes.hint).removeData().css(e.css.hint).css(h(t)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function s(t,e){t.data(m.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")}),t.addClass(e.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!t.attr("dir")&&t.attr("dir","auto")}catch(n){}return t}function h(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function d(t){var n,i;n=t.data(m.www),i=t.parent().filter(n.selectors.wrapper),e.each(t.data(m.attrs),function(n,i){e.isUndefined(n)?t.removeAttr(i):t.attr(i,n)}),t.removeData(m.typeahead).removeData(m.www).removeData(m.attr).removeClass(n.classes.input),i.length&&(t.detach().insertAfter(i),i.remove())}function f(n){var i,r;return i=e.isJQuery(n)||e.isElement(n),(r=i?t(n).first():[]).length?r:null}var p,m,g;p=t.fn.typeahead,m={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},g={initialize:function(r,h){function d(){var n,d,g,v,y,b,_,x,w,S,k;e.each(h,function(t){t.highlight=!!r.highlight}),n=t(this),d=t(p.html.wrapper),g=f(r.hint),v=f(r.menu),y=!1!==r.hint&&!g,b=!1!==r.menu&&!v,y&&(g=o(n,p)),b&&(v=t(p.html.menu).css(p.css.menu)),g&&g.val(""),n=s(n,p),(y||b)&&(d.css(p.css.wrapper),n.css(y?p.css.input:p.css.inputWithNoHint),n.wrap(d).parent().prepend(y?g:null).append(b?v:null)),k=b?u:c,_=new i({el:n}),x=new a({hint:g,input:n},p),w=new k({node:v,datasets:h},p),S=new l({input:x,menu:w,eventBus:_,minLength:r.minLength},p),n.data(m.www,p),n.data(m.typeahead,S)}var p;return h=e.isArray(h)?h:[].slice.call(arguments,1),r=r||{},p=n(r.classNames),this.each(d)},isEnabled:function(){var t;return r(this.first(),function(e){t=e.isEnabled()}),t},enable:function(){return r(this,function(t){t.enable()}),this},disable:function(){return r(this,function(t){t.disable()}),this},isActive:function(){var t;return r(this.first(),function(e){t=e.isActive()}),t},activate:function(){return r(this,function(t){t.activate()}),this},deactivate:function(){return r(this,function(t){t.deactivate()}),this},isOpen:function(){var t;return r(this.first(),function(e){t=e.isOpen()}),t},open:function(){return r(this,function(t){t.open()}),this},close:function(){return r(this,function(t){t.close()}),this},select:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.select(i)}),n},autocomplete:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.autocomplete(i)}),n},moveCursor:function(t){var e=!1;return r(this.first(),function(n){e=n.moveCursor(t)}),e},val:function(t){var n;return arguments.length?(r(this,function(n){n.setVal(e.toStr(t))}),this):(r(this.first(),function(t){n=t.getVal()}),n)},destroy:function(){return r(this,function(t,e){d(e),t.destroy()}),this}},t.fn.typeahead=function(t){return g[t]?g[t].apply(this,[].slice.call(arguments,1)):g.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=p,this}}()}),$(".no-js").removeClass("no-js").addClass("js"),function(){function t(){}function e(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var i=t.prototype,r=this,o=r.EventEmitter;i.getListeners=function(t){var e,n,i=this._getEvents();if("object"==typeof t){e={};for(n in i)i.hasOwnProperty(n)&&t.test(n)&&(e[n]=i[n])}else e=i[t]||(i[t]=[]);return e},i.flattenListeners=function(t){var e,n=[];for(e=0;t.length>e;e+=1)n.push(t[e].listener);return n},i.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},i.addListener=function(t,n){var i,r=this.getListenersAsObject(t),o="object"==typeof n;for(i in r)r.hasOwnProperty(i)&&-1===e(r[i],n)&&r[i].push(o?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(t){return this.getListeners(t),this},i.defineEvents=function(t){for(var e=0;t.length>e;e+=1)this.defineEvent(t[e]);return this},i.removeListener=function(t,n){var i,r,o=this.getListenersAsObject(t);for(r in o)o.hasOwnProperty(r)&&-1!==(i=e(o[r],n))&&o[r].splice(i,1);return this},i.off=n("removeListener"),i.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},i.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},i.manipulateListeners=function(t,e,n){var i,r,o=t?this.removeListener:this.addListener,a=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(i=n.length;i--;)o.call(this,e,n[i]);else for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&("function"==typeof r?o.call(this,i,r):a.call(this,i,r));return this},i.removeEvent=function(t){var e,n=typeof t,i=this._getEvents();if("string"===n)delete i[t];else if("object"===n)for(e in i)i.hasOwnProperty(e)&&t.test(e)&&delete i[e];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(t,e){var n,i,r,o=this.getListenersAsObject(t);for(r in o)if(o.hasOwnProperty(r))for(i=o[r].length;i--;)!0===(n=o[r][i]).once&&this.removeListener(t,n.listener),n.listener.apply(this,e||[])===this._getOnceReturnValue()&&this.removeListener(t,n.listener);return this},i.trigger=n("emitEvent"),i.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},i.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},i._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},i._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return r.EventEmitter=o,t},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}.call(this),function(t){function e(e){var n=t.event;return n.target=n.target||n.srcElement||e,n}var n=document.documentElement,i=function(){};n.addEventListener?i=function(t,e,n){t.addEventListener(e,n,!1)}:n.attachEvent&&(i=function(t,n,i){t[n+i]=i.handleEvent?function(){var n=e(t);i.handleEvent.call(i,n)}:function(){var n=e(t);i.call(t,n)},t.attachEvent("on"+n,t[n+i])});var r=function(){};n.removeEventListener?r=function(t,e,n){t.removeEventListener(e,n,!1)}:n.detachEvent&&(r=function(t,e,n){t.detachEvent("on"+e,t[e+n]);try{delete t[e+n]}catch(i){t[e+n]=void 0}});var o={bind:i,unbind:r};"function"==typeof define&&define.amd?define("eventie/eventie",o):t.eventie=o}(this),function(t,e){"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(n,i){return e(t,n,i)}):"object"==typeof exports?module.exports=e(t,require("wolfy87-eventemitter"),require("eventie")):t.imagesLoaded=e(t,t.EventEmitter,t.eventie)}(window,function(t,e,n){function i(t,e){for(var n in e)t[n]=e[n];return t}function r(t){return"[object Array]"===d.call(t)}function o(t){var e=[];if(r(t))e=t;else if("number"==typeof t.length)for(var n=0,i=t.length;i>n;n++)e.push(t[n]);else e.push(t);return e}function a(t,e,n){if(!(this instanceof a))return new a(t,e);"string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=o(t),this.options=i({},this.options),"function"==typeof e?n=e:i(this.options,e),n&&this.on("always",n),this.getImages(),u&&(this.jqDeferred=new u.Deferred);var r=this;setTimeout(function(){r.check()})}function s(t){this.img=t}function c(t){this.src=t,f[t]=this}var u=t.jQuery,l=t.console,h=void 0!==l,d=Object.prototype.toString;a.prototype=new e,a.prototype.options={},a.prototype.getImages=function(){this.images=[];for(var t=0,e=this.elements.length;e>t;t++){var n=this.elements[t];"IMG"===n.nodeName&&this.addImage(n);var i=n.nodeType;if(i&&(1===i||9===i||11===i))for(var r=n.querySelectorAll("img"),o=0,a=r.length;a>o;o++){var s=r[o];this.addImage(s)}}},a.prototype.addImage=function(t){var e=new s(t);this.images.push(e)},a.prototype.check=function(){function t(t,r){return e.options.debug&&h&&l.log("confirm",t,r),e.progress(t),++n===i&&e.complete(),!0}var e=this,n=0,i=this.images.length;if(this.hasAnyBroken=!1,i)for(var r=0;i>r;r++){var o=this.images[r];o.on("confirm",t),o.check()}else this.complete()},a.prototype.progress=function(t){this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded;var e=this;setTimeout(function(){e.emit("progress",e,t),e.jqDeferred&&e.jqDeferred.notify&&e.jqDeferred.notify(e,t)})},a.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var e=this;setTimeout(function(){if(e.emit(t,e),e.emit("always",e),e.jqDeferred){var n=e.hasAnyBroken?"reject":"resolve";e.jqDeferred[n](e)}})},u&&(u.fn.imagesLoaded=function(t,e){return new a(this,t,e).jqDeferred.promise(u(this))}),s.prototype=new e,s.prototype.check=function(){var t=f[this.img.src]||new c(this.img.src);if(t.isConfirmed)this.confirm(t.isLoaded,"cached was confirmed");else if(this.img.complete&&void 0!==this.img.naturalWidth)this.confirm(0!==this.img.naturalWidth,"naturalWidth");else{var e=this;t.on("confirm",function(t,n){return e.confirm(t.isLoaded,n),!0}),t.check()}},s.prototype.confirm=function(t,e){this.isLoaded=t,this.emit("confirm",this,e)};var f={};return c.prototype=new e,c.prototype.check=function(){if(!this.isChecked){var t=new Image;n.bind(t,"load",this),n.bind(t,"error",this),t.src=this.src,this.isChecked=!0}},c.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},c.prototype.onload=function(t){this.confirm(!0,"onload"),this.unbindProxyEvents(t)},c.prototype.onerror=function(t){this.confirm(!1,"onerror"),this.unbindProxyEvents(t)},c.prototype.confirm=function(t,e){this.isConfirmed=!0,this.isLoaded=t,this.emit("confirm",this,e)},c.prototype.unbindProxyEvents=function(t){n.unbind(t.target,"load",this),n.unbind(t.target,"error",this)},a}),function(t){function e(){}function n(t){function n(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})}function r(e,n){t.fn[e]=function(r){if("string"==typeof r){for(var a=i.call(arguments,1),s=0,c=this.length;c>s;s++){var u=this[s],l=t.data(u,e);if(l)if(t.isFunction(l[r])&&"_"!==r.charAt(0)){var h=l[r].apply(l,a);if(void 0!==h)return h}else o("no such method '"+r+"' for "+e+" instance");else o("cannot call methods on "+e+" prior to initialization; attempted to call '"+r+"'")}return this}return this.each(function(){var i=t.data(this,e);i?(i.option(r),i._init()):(i=new n(this,r),t.data(this,e,i))})}}if(t){var o="undefined"==typeof console?e:function(t){console.error(t)};return t.bridget=function(t,e){n(e),r(t,e)},t.bridget}}var i=Array.prototype.slice;"function"==typeof define&&define.amd?define("jquery-bridget/jquery.bridget",["jquery"],n):n("object"==typeof exports?require("jquery"):t.jQuery)}(window),function(t){function e(e){var n=t.event;return n.target=n.target||n.srcElement||e,n}var n=document.documentElement,i=function(){};n.addEventListener?i=function(t,e,n){t.addEventListener(e,n,!1)
}:n.attachEvent&&(i=function(t,n,i){t[n+i]=i.handleEvent?function(){var n=e(t);i.handleEvent.call(i,n)}:function(){var n=e(t);i.call(t,n)},t.attachEvent("on"+n,t[n+i])});var r=function(){};n.removeEventListener?r=function(t,e,n){t.removeEventListener(e,n,!1)}:n.detachEvent&&(r=function(t,e,n){t.detachEvent("on"+e,t[e+n]);try{delete t[e+n]}catch(i){t[e+n]=void 0}});var o={bind:i,unbind:r};"function"==typeof define&&define.amd?define("eventie/eventie",o):"object"==typeof exports?module.exports=o:t.eventie=o}(this),function(t){function e(t){"function"==typeof t&&(e.isReady?t():a.push(t))}function n(t){var n="readystatechange"===t.type&&"complete"!==o.readyState;e.isReady||n||i()}function i(){e.isReady=!0;for(var t=0,n=a.length;n>t;t++){(0,a[t])()}}function r(r){return"complete"===o.readyState?i():(r.bind(o,"DOMContentLoaded",n),r.bind(o,"readystatechange",n),r.bind(t,"load",n)),e}var o=t.document,a=[];e.isReady=!1,"function"==typeof define&&define.amd?define("doc-ready/doc-ready",["eventie/eventie"],r):"object"==typeof exports?module.exports=r(require("eventie")):t.docReady=r(t.eventie)}(window),function(){function t(){}function e(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var i=t.prototype,r=this,o=r.EventEmitter;i.getListeners=function(t){var e,n,i=this._getEvents();if(t instanceof RegExp){e={};for(n in i)i.hasOwnProperty(n)&&t.test(n)&&(e[n]=i[n])}else e=i[t]||(i[t]=[]);return e},i.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},i.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},i.addListener=function(t,n){var i,r=this.getListenersAsObject(t),o="object"==typeof n;for(i in r)r.hasOwnProperty(i)&&-1===e(r[i],n)&&r[i].push(o?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(t){return this.getListeners(t),this},i.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},i.removeListener=function(t,n){var i,r,o=this.getListenersAsObject(t);for(r in o)o.hasOwnProperty(r)&&-1!==(i=e(o[r],n))&&o[r].splice(i,1);return this},i.off=n("removeListener"),i.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},i.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},i.manipulateListeners=function(t,e,n){var i,r,o=t?this.removeListener:this.addListener,a=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(i=n.length;i--;)o.call(this,e,n[i]);else for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&("function"==typeof r?o.call(this,i,r):a.call(this,i,r));return this},i.removeEvent=function(t){var e,n=typeof t,i=this._getEvents();if("string"===n)delete i[t];else if(t instanceof RegExp)for(e in i)i.hasOwnProperty(e)&&t.test(e)&&delete i[e];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(t,e){var n,i,r,o=this.getListenersAsObject(t);for(r in o)if(o.hasOwnProperty(r))for(i=o[r].length;i--;)!0===(n=o[r][i]).once&&this.removeListener(t,n.listener),n.listener.apply(this,e||[])===this._getOnceReturnValue()&&this.removeListener(t,n.listener);return this},i.trigger=n("emitEvent"),i.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},i.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},i._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},i._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return r.EventEmitter=o,t},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:r.EventEmitter=t}.call(this),function(t){function e(t){if(t){if("string"==typeof i[t])return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e,r=0,o=n.length;o>r;r++)if(e=n[r]+t,"string"==typeof i[e])return e}}var n="Webkit Moz ms Ms O".split(" "),i=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return e}):"object"==typeof exports?module.exports=e:t.getStyleProperty=e}(window),function(t){function e(t){var e=parseFloat(t);return-1===t.indexOf("%")&&!isNaN(e)&&e}function n(){}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0,n=a.length;n>e;e++){t[a[e]]=0}return t}function r(n){function r(){if(!d){d=!0;var i=t.getComputedStyle;if(u=function(){var t=i?function(t){return i(t,null)}:function(t){return t.currentStyle};return function(e){var n=t(e);return n||o("Style returned "+n+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),n}}(),l=n("boxSizing")){var r=document.createElement("div");r.style.width="200px",r.style.padding="1px 2px 3px 4px",r.style.borderStyle="solid",r.style.borderWidth="1px 2px 3px 4px",r.style[l]="border-box";var a=document.body||document.documentElement;a.appendChild(r);var s=u(r);h=200===e(s.width),a.removeChild(r)}}}function s(t){if(r(),"string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var n=u(t);if("none"===n.display)return i();var o={};o.width=t.offsetWidth,o.height=t.offsetHeight;for(var s=o.isBorderBox=!(!l||!n[l]||"border-box"!==n[l]),d=0,f=a.length;f>d;d++){var p=a[d],m=n[p];m=c(t,m);var g=parseFloat(m);o[p]=isNaN(g)?0:g}var v=o.paddingLeft+o.paddingRight,y=o.paddingTop+o.paddingBottom,b=o.marginLeft+o.marginRight,_=o.marginTop+o.marginBottom,x=o.borderLeftWidth+o.borderRightWidth,w=o.borderTopWidth+o.borderBottomWidth,S=s&&h,k=e(n.width);!1!==k&&(o.width=k+(S?0:v+x));var E=e(n.height);return!1!==E&&(o.height=E+(S?0:y+w)),o.innerWidth=o.width-(v+x),o.innerHeight=o.height-(y+w),o.outerWidth=o.width+b,o.outerHeight=o.height+_,o}}function c(e,n){if(t.getComputedStyle||-1===n.indexOf("%"))return n;var i=e.style,r=i.left,o=e.runtimeStyle,a=o&&o.left;return a&&(o.left=e.currentStyle.left),i.left=n,n=i.pixelLeft,i.left=r,a&&(o.left=a),n}var u,l,h,d=!1;return s}var o="undefined"==typeof console?n:function(t){console.error(t)},a=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],r):"object"==typeof exports?module.exports=r(require("desandro-get-style-property")):t.getSize=r(t.getStyleProperty)}(window),function(t){function e(t,e){return t[a](e)}function n(t){if(!t.parentNode){document.createDocumentFragment().appendChild(t)}}function i(t,e){n(t);for(var i=t.parentNode.querySelectorAll(e),r=0,o=i.length;o>r;r++)if(i[r]===t)return!0;return!1}function r(t,i){return n(t),e(t,i)}var o,a=function(){if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],n=0,i=e.length;i>n;n++){var r=e[n]+"MatchesSelector";if(t[r])return r}}();if(a){var s=e(document.createElement("div"),"div");o=s?e:r}else o=i;"function"==typeof define&&define.amd?define("matches-selector/matches-selector",[],function(){return o}):"object"==typeof exports?module.exports=o:window.matchesSelector=o}(Element.prototype),function(t){function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t){for(var e in t)return!1;return null,!0}function i(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}function r(t,r,o){function s(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}var c=o("transition"),u=o("transform"),l=c&&u,h=!!o("perspective"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[c],f=["transform","transition","transitionDuration","transitionProperty"],p=function(){for(var t={},e=0,n=f.length;n>e;e++){var i=f[e],r=o(i);r&&r!==i&&(t[i]=r)}return t}();e(s.prototype,t.prototype),s.prototype._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},s.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},s.prototype.getSize=function(){this.size=r(this.element)},s.prototype.css=function(t){var e=this.element.style;for(var n in t){e[p[n]||n]=t[n]}},s.prototype.getPosition=function(){var t=a(this.element),e=this.layout.options,n=e.isOriginLeft,i=e.isOriginTop,r=parseInt(t[n?"left":"right"],10),o=parseInt(t[i?"top":"bottom"],10);r=isNaN(r)?0:r,o=isNaN(o)?0:o;var s=this.layout.size;r-=n?s.paddingLeft:s.paddingRight,o-=i?s.paddingTop:s.paddingBottom,this.position.x=r,this.position.y=o},s.prototype.layoutPosition=function(){var t=this.layout.size,e=this.layout.options,n={};e.isOriginLeft?(n.left=this.position.x+t.paddingLeft+"px",n.right=""):(n.right=this.position.x+t.paddingRight+"px",n.left=""),e.isOriginTop?(n.top=this.position.y+t.paddingTop+"px",n.bottom=""):(n.bottom=this.position.y+t.paddingBottom+"px",n.top=""),this.css(n),this.emitEvent("layout",[this])};var m=h?function(t,e){return"translate3d("+t+"px, "+e+"px, 0)"}:function(t,e){return"translate("+t+"px, "+e+"px)"};s.prototype._transitionTo=function(t,e){this.getPosition();var n=this.position.x,i=this.position.y,r=parseInt(t,10),o=parseInt(e,10),a=r===this.position.x&&o===this.position.y;if(this.setPosition(t,e),!a||this.isTransitioning){var s=t-n,c=e-i,u={},l=this.layout.options;s=l.isOriginLeft?s:-s,c=l.isOriginTop?c:-c,u.transform=m(s,c),this.transition({to:u,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},s.prototype.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},s.prototype.moveTo=l?s.prototype._transitionTo:s.prototype.goTo,s.prototype.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10)},s.prototype._nonTransition=function(t){this.css(t.to),t.isCleaning&&this._removeStyles(t.to);for(var e in t.onTransitionEnd)t.onTransitionEnd[e].call(this)},s.prototype._transition=function(t){if(parseFloat(this.layout.options.transitionDuration)){var e=this._transn;for(var n in t.onTransitionEnd)e.onEnd[n]=t.onTransitionEnd[n];for(n in t.to)e.ingProperties[n]=!0,t.isCleaning&&(e.clean[n]=!0);if(t.from){this.css(t.from);this.element.offsetHeight;null}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0}else this._nonTransition(t)};var g=u&&i(u)+",opacity";s.prototype.enableTransition=function(){this.isTransitioning||(this.css({transitionProperty:g,transitionDuration:this.layout.options.transitionDuration}),this.element.addEventListener(d,this,!1))},s.prototype.transition=s.prototype[c?"_transition":"_nonTransition"],s.prototype.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},s.prototype.onotransitionend=function(t){this.ontransitionend(t)};var v={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};s.prototype.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,i=v[t.propertyName]||t.propertyName;if(delete e.ingProperties[i],n(e.ingProperties)&&this.disableTransition(),i in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[i]),i in e.onEnd){e.onEnd[i].call(this),delete e.onEnd[i]}this.emitEvent("transitionEnd",[this])}},s.prototype.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(d,this,!1),this.isTransitioning=!1},s.prototype._removeStyles=function(t){var e={};for(var n in t)e[n]="";this.css(e)};var y={transitionProperty:"",transitionDuration:""};return s.prototype.removeTransitionStyles=function(){this.css(y)},s.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element),this.emitEvent("remove",[this])},s.prototype.remove=function(){if(c&&parseFloat(this.layout.options.transitionDuration)){var t=this;this.on("transitionEnd",function(){return t.removeElem(),!0}),this.hide()}else this.removeElem()},s.prototype.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options;this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0})},s.prototype.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options;this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:{opacity:function(){this.isHidden&&this.css({display:"none"})}}})},s.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},s}var o=t.getComputedStyle,a=o?function(t){return o(t,null)}:function(t){return t.currentStyle};"function"==typeof define&&define.amd?define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property"],r):"object"==typeof exports?module.exports=r(require("wolfy87-eventemitter"),require("get-size"),require("desandro-get-style-property")):(t.Outlayer={},t.Outlayer.Item=r(t.EventEmitter,t.getSize,t.getStyleProperty))}(window),function(t){function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t){return"[object Array]"===h.call(t)}function i(t){var e=[];if(n(t))e=t;else if(t&&"number"==typeof t.length)for(var i=0,r=t.length;r>i;i++)e.push(t[i]);else e.push(t);return e}function r(t,e){var n=f(e,t);-1!==n&&e.splice(n,1)}function o(t){return t.replace(/(.)([A-Z])/g,function(t,e,n){return e+"-"+n}).toLowerCase()}function a(n,a,h,f,p,m){function g(t,n){if("string"==typeof t&&(t=s.querySelector(t)),t&&d(t)){this.element=t,this.options=e({},this.constructor.defaults),this.option(n);var i=++v;this.element.outlayerGUID=i,y[i]=this,this._create(),this.options.isInitLayout&&this.layout()}else c&&c.error("Bad "+this.constructor.namespace+" element: "+t)}var v=0,y={};return g.namespace="outlayer",g.Item=m,g.defaults={containerStyle:{position:"relative"},isInitLayout:!0,isOriginLeft:!0,isOriginTop:!0,isResizeBound:!0,isResizingContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}},e(g.prototype,h.prototype),g.prototype.option=function(t){e(this.options,t)},g.prototype._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),e(this.element.style,this.options.containerStyle),this.options.isResizeBound&&this.bindResize()},g.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)},g.prototype._itemize=function(t){for(var e=this._filterFindItemElements(t),n=this.constructor.Item,i=[],r=0,o=e.length;o>r;r++){var a=new n(e[r],this);i.push(a)}return i},g.prototype._filterFindItemElements=function(t){t=i(t);for(var e=this.options.itemSelector,n=[],r=0,o=t.length;o>r;r++){var a=t[r];if(d(a))if(e){p(a,e)&&n.push(a);for(var s=a.querySelectorAll(e),c=0,u=s.length;u>c;c++)n.push(s[c])}else n.push(a)}return n},g.prototype.getItemElements=function(){for(var t=[],e=0,n=this.items.length;n>e;e++)t.push(this.items[e].element);return t},g.prototype.layout=function(){this._resetLayout(),this._manageStamps();var t=void 0!==this.options.isLayoutInstant?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,t),this._isLayoutInited=!0},g.prototype._init=g.prototype.layout,g.prototype._resetLayout=function(){this.getSize()},g.prototype.getSize=function(){this.size=f(this.element)},g.prototype._getMeasurement=function(t,e){var n,i=this.options[t];i?("string"==typeof i?n=this.element.querySelector(i):d(i)&&(n=i),this[t]=n?f(n)[e]:i):this[t]=0},g.prototype.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},g.prototype._getItemsForLayout=function(t){for(var e=[],n=0,i=t.length;i>n;n++){var r=t[n];r.isIgnored||e.push(r)}return e},g.prototype._layoutItems=function(t,e){function n(){i.emitEvent("layoutComplete",[i,t])}var i=this;if(t&&t.length){this._itemsOn(t,"layout",n);for(var r=[],o=0,a=t.length;a>o;o++){var s=t[o],c=this._getItemLayoutPosition(s);c.item=s,c.isInstant=e||s.isLayoutInstant,r.push(c)}this._processLayoutQueue(r)}else n()},g.prototype._getItemLayoutPosition=function(){return{x:0,y:0}},g.prototype._processLayoutQueue=function(t){for(var e=0,n=t.length;n>e;e++){var i=t[e];this._positionItem(i.item,i.x,i.y,i.isInstant)}},g.prototype._positionItem=function(t,e,n,i){i?t.goTo(e,n):t.moveTo(e,n)},g.prototype._postLayout=function(){this.resizeContainer()},g.prototype.resizeContainer=function(){if(this.options.isResizingContainer){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))}},g.prototype._getContainerSize=l,g.prototype._setContainerMeasure=function(t,e){if(void 0!==t){var n=this.size;n.isBorderBox&&(t+=e?n.paddingLeft+n.paddingRight+n.borderLeftWidth+n.borderRightWidth:n.paddingBottom+n.paddingTop+n.borderTopWidth+n.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},g.prototype._itemsOn=function(t,e,n){function i(){return++r===o&&n.call(a),!0}for(var r=0,o=t.length,a=this,s=0,c=t.length;c>s;s++){t[s].on(e,i)}},g.prototype.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},g.prototype.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},g.prototype.stamp=function(t){if(t=this._find(t)){this.stamps=this.stamps.concat(t);for(var e=0,n=t.length;n>e;e++){var i=t[e];this.ignore(i)}}},g.prototype.unstamp=function(t){if(t=this._find(t))for(var e=0,n=t.length;n>e;e++){var i=t[e];r(i,this.stamps),this.unignore(i)}},g.prototype._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=i(t)):void 0},g.prototype._manageStamps=function(){if(this.stamps&&this.stamps.length){this._getBoundingRect();for(var t=0,e=this.stamps.length;e>t;t++){var n=this.stamps[t];this._manageStamp(n)}}},g.prototype._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},g.prototype._manageStamp=l,g.prototype._getElementOffset=function(t){var e=t.getBoundingClientRect(),n=this._boundingRect,i=f(t);return{left:e.left-n.left-i.marginLeft,top:e.top-n.top-i.marginTop,right:n.right-e.right-i.marginRight,bottom:n.bottom-e.bottom-i.marginBottom}},g.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},g.prototype.bindResize=function(){this.isResizeBound||(n.bind(t,"resize",this),this.isResizeBound=!0)},g.prototype.unbindResize=function(){this.isResizeBound&&n.unbind(t,"resize",this),this.isResizeBound=!1},g.prototype.onresize=function(){function t(){e.resize(),delete e.resizeTimeout}this.resizeTimeout&&clearTimeout(this.resizeTimeout);var e=this;this.resizeTimeout=setTimeout(t,100)},g.prototype.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},g.prototype.needsResizeLayout=function(){var t=f(this.element);return this.size&&t&&t.innerWidth!==this.size.innerWidth},g.prototype.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},g.prototype.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},g.prototype.prepended=function(t){var e=this._itemize(t);if(e.length){var n=this.items.slice(0);this.items=e.concat(n),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(n)}},g.prototype.reveal=function(t){var e=t&&t.length;if(e)for(var n=0;e>n;n++){t[n].reveal()}},g.prototype.hide=function(t){var e=t&&t.length;if(e)for(var n=0;e>n;n++){t[n].hide()}},g.prototype.getItem=function(t){for(var e=0,n=this.items.length;n>e;e++){var i=this.items[e];if(i.element===t)return i}},g.prototype.getItems=function(t){if(t&&t.length){for(var e=[],n=0,i=t.length;i>n;n++){var r=t[n],o=this.getItem(r);o&&e.push(o)}return e}},g.prototype.remove=function(t){t=i(t);var e=this.getItems(t);if(e&&e.length){this._itemsOn(e,"remove",function(){this.emitEvent("removeComplete",[this,e])});for(var n=0,o=e.length;o>n;n++){var a=e[n];a.remove(),r(a,this.items)}}},g.prototype.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="";for(var e=0,n=this.items.length;n>e;e++){this.items[e].destroy()}this.unbindResize();var i=this.element.outlayerGUID;delete y[i],delete this.element.outlayerGUID,u&&u.removeData(this.element,this.constructor.namespace)},g.data=function(t){var e=t&&t.outlayerGUID;return e&&y[e]},g.create=function(t,n){function i(){g.apply(this,arguments)}return Object.create?i.prototype=Object.create(g.prototype):e(i.prototype,g.prototype),i.prototype.constructor=i,i.defaults=e({},g.defaults),e(i.defaults,n),i.prototype.settings={},i.namespace=t,i.data=g.data,i.Item=function(){m.apply(this,arguments)},i.Item.prototype=new m,a(function(){for(var e=o(t),n=s.querySelectorAll(".js-"+e),r="data-"+e+"-options",a=0,l=n.length;l>a;a++){var h,d=n[a],f=d.getAttribute(r);try{h=f&&JSON.parse(f)}catch(p){c&&c.error("Error parsing "+r+" on "+d.nodeName.toLowerCase()+(d.id?"#"+d.id:"")+": "+p);continue}var m=new i(d,h);u&&u.data(d,t,m)}}),u&&u.bridget&&u.bridget(t,i),i},g.Item=m,g}var s=t.document,c=t.console,u=t.jQuery,l=function(){},h=Object.prototype.toString,d="function"==typeof HTMLElement||"object"==typeof HTMLElement?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName},f=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1};"function"==typeof define&&define.amd?define("outlayer/outlayer",["eventie/eventie","doc-ready/doc-ready","eventEmitter/EventEmitter","get-size/get-size","matches-selector/matches-selector","./item"],a):"object"==typeof exports?module.exports=a(require("eventie"),require("doc-ready"),require("wolfy87-eventemitter"),require("get-size"),require("desandro-matches-selector"),require("./item")):t.Outlayer=a(t.eventie,t.docReady,t.EventEmitter,t.getSize,t.matchesSelector,t.Outlayer.Item)}(window),function(t){function e(t,e){var i=t.create("masonry");return i.prototype._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns();var t=this.cols;for(this.colYs=[];t--;)this.colYs.push(0);this.maxY=0},i.prototype.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],n=t&&t.element;this.columnWidth=n&&e(n).outerWidth||this.containerWidth}this.columnWidth+=this.gutter,this.cols=Math.floor((this.containerWidth+this.gutter)/this.columnWidth),this.cols=Math.max(this.cols,1)},i.prototype.getContainerWidth=function(){var t=this.options.isFitWidth?this.element.parentNode:this.element,n=e(t);this.containerWidth=n&&n.innerWidth},i.prototype._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,i=e&&1>e?"round":"ceil",r=Math[i](t.size.outerWidth/this.columnWidth);r=Math.min(r,this.cols);for(var o=this._getColGroup(r),a=Math.min.apply(Math,o),s=n(o,a),c={x:this.columnWidth*s,y:a},u=a+t.size.outerHeight,l=this.cols+1-o.length,h=0;l>h;h++)this.colYs[s+h]=u;return c},i.prototype._getColGroup=function(t){if(2>t)return this.colYs;for(var e=[],n=this.cols+1-t,i=0;n>i;i++){var r=this.colYs.slice(i,i+t);e[i]=Math.max.apply(Math,r)}return e},i.prototype._manageStamp=function(t){var n=e(t),i=this._getElementOffset(t),r=this.options.isOriginLeft?i.left:i.right,o=r+n.outerWidth,a=Math.floor(r/this.columnWidth);a=Math.max(0,a);var s=Math.floor(o/this.columnWidth);s-=o%this.columnWidth?0:1,s=Math.min(this.cols-1,s);for(var c=(this.options.isOriginTop?i.top:i.bottom)+n.outerHeight,u=a;s>=u;u++)this.colYs[u]=Math.max(c,this.colYs[u])},i.prototype._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this.options.isFitWidth&&(t.width=this._getContainerFitWidth()),t},i.prototype._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return(this.cols-t)*this.columnWidth-this.gutter},i.prototype.needsResizeLayout=function(){var t=this.containerWidth;return this.getContainerWidth(),t!==this.containerWidth},i}var n=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var n=0,i=t.length;i>n;n++){if(t[n]===e)return n}return-1};"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],e):"object"==typeof exports?module.exports=e(require("outlayer"),require("get-size")):t.Masonry=e(t.Outlayer,t.getSize)}(window),function(t){var e=function(e,n){this.$element=t(e),this.options=n,this.paused=!1,this.activeIndex=0,this.init=function(){this.$items=this.$element.find(".item")},this.attachEvents(),this.init()};e.prototype={slide:function(e){var n=t(e),i=n.find(".frame");return this.$items.hide(),n.show(),Math.round(n.height()-i.height())/2,this.activeIndex=this.$items.index(e),this.options.autoPlay&&!this.paused&&this.play(),this},play:function(){this.paused=!1,this.interval&&clearInterval(this.interval),this.interval=setInterval(t.proxy(this.next,this),this.options.interval)},pause:function(){return this.paused=!0,this.interval=clearInterval(this.interval),this},startAt:function(t){this.to(t)},next:function(){return this.to("next")},to:function(t){return"next"===t&&(t=this.activeIndex+1),"prev"===t&&(t=this.activeIndex-1),this.slide(this.$items[this.getValidIndex(t)])},getValidIndex:function(t){return(void 0===t||t>this.$items.length-1)&&(t=0),t<0&&(t=this.$items.length-1),t},attachEvents:function(){var e=this.$element.find(".frame img"),n=this;e.on("mouseenter",function(){n.pause()}),e.on("mouseleave",function(){n.options.autoPlay&&n.play()}),t(document).on("click","[data-slide], [data-slide-to]",function(e){e.preventDefault(),pos=parseInt(t(this).attr("data-slide-to"),10)||t(this).attr("data-slide"),"next"!==pos&&"prev"!==pos||n.pause(),n.to(pos)}),t("#slideshow-modal").on("hidden.bs.modal",function(){n.pause()})}},e.DEFAULTS={autoPlay:!0,interval:5e3},t.fn.slideshow=function(n){return this.each(function(){var i=t(this),r=i.data("slideshow"),o=t.extend({},e.DEFAULTS,i.data(),"object"==typeof n&&n);r||i.data("slideshow",r=new e(this,o))})}}(jQuery),Blacklight.onLoad(function(){$("#slideshow").slideshow()}),function(t){t.fn.openseadragon=function(){function e(){return"Openseadragon"+ ++n}var n=0;return t(this).each(function(){var n=t(this);n.addClass("openseadragon-viewer"),void 0===n.attr("id")&&n.attr("id",e());var i=n.data("openseadragon"),r=n.find('source[media="openseadragon"]'),o=t.map(r,function(e){return t(e).data("openseadragon")?t(e).data("openseadragon"):t(e).attr("src")});n.css("height",n.css("height")),n.data("osdViewer",OpenSeadragon(t.extend({id:n.attr("id")},i,{tileSources:o})))}),this}}(jQuery),function(t){function e(){t("picture[data-openseadragon]").openseadragon()}var n="ready";"undefined"!=typeof Turbolinks&&Turbolinks.supported&&(n=Turbolinks.BrowserAdapter?"turbolinks:load":"page:load ready"),t(document).on(n,e)}(jQuery),jQuery.fn.BlacklightMasonry=function(){var t=this;t.length>0&&t.imagesLoaded(function(){t.masonry()})},Blacklight.onLoad(function(){$('[data-behavior="masonry-gallery"]').BlacklightMasonry()}),jQuery,$.fn.oEmbed=function(){return this.each(function(){function t(){$.getJSON(n,function(t){null!==t&&e.html(t.html)})}var e=$(this),n=e.data("embed-url");t()})},Blacklight.onLoad(function(){$("[data-embed-url]").oEmbed()}),function(t){t.version={versionStr:"2.3.0",major:parseInt("2",10),minor:parseInt("3",10),revision:parseInt("0",10)};var e={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},n=Object.prototype.toString,i=Object.prototype.hasOwnProperty;t.isFunction=function(e){return"function"===t.type(e)},t.isArray=Array.isArray||function(e){return"array"===t.type(e)},t.isWindow=function(t){return t&&"object"==typeof t&&"setInterval"in t},t.type=function(t){return null===t||t===undefined?String(t):e[n.call(t)]||"object"},t.isPlainObject=function(e){if(!e||"object"!==OpenSeadragon.type(e)||e.nodeType||t.isWindow(e))return!1;if(e.constructor&&!i.call(e,"constructor")&&!i.call(e.constructor.prototype,"isPrototypeOf"))return!1;var n;for(var r in e)n=r;return n===undefined||i.call(e,n)},t.isEmptyObject=function(t){for(var e in t)return!1;return!0},t.freezeObject=function(e){return Object.freeze?t.freezeObject=Object.freeze:t.freezeObject=function(t){return t},t.freezeObject(e)},t.supportsCanvas=function(){var e=document.createElement("canvas");return!(!t.isFunction(e.getContext)||!e.getContext("2d"))}(),t.isCanvasTainted=function(t){var e=!1;try{t.getContext("2d").getImageData(0,0,1,1)}catch(n){e=!0}return e},t.pixelDensityRatio=function(){if(t.supportsCanvas){var e=document.createElement("canvas").getContext("2d"),n=window.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return Math.max(n,1)/i}return 1}()}(OpenSeadragon),function($){function getOffsetParent(t,e){return e&&t!=document.body?document.body:t.offsetParent}$.extend=function(){var t,e,n,i,r,o,a=arguments[0]||{},s=arguments.length,c=!1,u=1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},u=2),"object"==typeof a||OpenSeadragon.isFunction(a)||(a={}),s===u&&(a=this,--u);u<s;u++)if(null!==(t=arguments[u])||t!==undefined)for(e in t)n=a[e],a!==(i=t[e])&&(c&&i&&(OpenSeadragon.isPlainObject(i)||(r=OpenSeadragon.isArray(i)))?(r?(r=!1,o=n&&OpenSeadragon.isArray(n)?n:[]):o=n&&OpenSeadragon.isPlainObject(n)?n:{},a[e]=OpenSeadragon.extend(c,o,i)):i!==undefined&&(a[e]=i));return a};var isIOSDevice=function(){if("object"!=typeof navigator)return!1;var t=navigator.userAgent;return"string"==typeof t&&(-1!==t.indexOf("iPhone")||-1!==t.indexOf("iPad")||-1!==t.indexOf("iPod"))};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,degrees:0,opacity:1,preload:!1,compositeOperation:null,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",
GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:"#437AB2"},SIGNAL:"----seadragon----",delegate:function(t,e){return function(){var n=arguments;return n===undefined&&(n=[]),e.apply(t,n)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(t){return"string"==typeof t&&(t=document.getElementById(t)),t},getElementPosition:function(t){var e,n,i=new $.Point;for(n=getOffsetParent(t=$.getElement(t),e="fixed"==$.getElementStyle(t).position);n;)i.x+=t.offsetLeft,i.y+=t.offsetTop,e&&(i=i.plus($.getPageScroll())),n=getOffsetParent(t=n,e="fixed"==$.getElementStyle(t).position);return i},getElementOffset:function(t){var e,n,i=(t=$.getElement(t))&&t.ownerDocument,r={top:0,left:0};return i?(e=i.documentElement,typeof t.getBoundingClientRect!=typeof undefined&&(r=t.getBoundingClientRect()),n=i==i.window?i:9===i.nodeType&&(i.defaultView||i.parentWindow),new $.Point(r.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0),r.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0))):new $.Point},getElementSize:function(t){return t=$.getElement(t),new $.Point(t.clientWidth,t.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(t){return(t=$.getElement(t)).currentStyle}:function(t){return t=$.getElement(t),window.getComputedStyle(t,"")},getCssPropertyWithVendorPrefix:function(t){var e={};return $.getCssPropertyWithVendorPrefix=function(t){if(e[t]!==undefined)return e[t];var n=document.createElement("div").style,i=null;if(n[t]!==undefined)i=t;else for(var r=["Webkit","Moz","MS","O","webkit","moz","ms","o"],o=$.capitalizeFirstLetter(t),a=0;a<r.length;a++){var s=r[a]+o;if(n[s]!==undefined){i=s;break}}return e[t]=i,i},$.getCssPropertyWithVendorPrefix(t)},capitalizeFirstLetter:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},positiveModulo:function(t,e){var n=t%e;return n<0&&(n+=e),n},pointInElement:function(t,e){t=$.getElement(t);var n=$.getElementOffset(t),i=$.getElementSize(t);return e.x>=n.x&&e.x<n.x+i.x&&e.y<n.y+i.y&&e.y>=n.y},getEvent:function(t){return $.getEvent=t?function(t){return t}:function(){return window.event},$.getEvent(t)},getMousePosition:function(t){if("number"==typeof t.pageX)$.getMousePosition=function(t){var e=new $.Point;return t=$.getEvent(t),e.x=t.pageX,e.y=t.pageY,e};else{if("number"!=typeof t.clientX)throw new Error("Unknown event mouse position, no known technique.");$.getMousePosition=function(t){var e=new $.Point;return t=$.getEvent(t),e.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop,e}}return $.getMousePosition(t)},getPageScroll:function(){var t=document.documentElement||{},e=document.body||{};if("number"==typeof window.pageXOffset)$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(e.scrollLeft||e.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!t.scrollLeft&&!t.scrollTop)return new $.Point(0,0);$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return $.getPageScroll()},setPageScroll:function(t){if("undefined"!=typeof window.scrollTo)$.setPageScroll=function(t){window.scrollTo(t.x,t.y)};else{var e=$.getPageScroll();if(e.x===t.x&&e.y===t.y)return;document.body.scrollLeft=t.x,document.body.scrollTop=t.y;var n=$.getPageScroll();if(n.x!==e.x&&n.y!==e.y)return void($.setPageScroll=function(t){document.body.scrollLeft=t.x,document.body.scrollTop=t.y});if(document.documentElement.scrollLeft=t.x,document.documentElement.scrollTop=t.y,(n=$.getPageScroll()).x!==e.x&&n.y!==e.y)return void($.setPageScroll=function(t){document.documentElement.scrollLeft=t.x,document.documentElement.scrollTop=t.y});$.setPageScroll=function(){}}return $.setPageScroll(t)},getWindowSize:function(){var t=document.documentElement||{},e=document.body||{};if("number"==typeof window.innerWidth)$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(t.clientWidth||t.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!e.clientWidth&&!e.clientHeight)throw new Error("Unknown window size, no known technique.");$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)}}return $.getWindowSize()},makeCenteredNode:function(t){t=$.getElement(t);var e=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(e[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(e[1].style,{display:"table-row"}),$.extend(e[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),e[0].appendChild(e[1]),e[1].appendChild(e[2]),e[2].appendChild(t),e[0]},makeNeutralElement:function(t){var e=document.createElement(t),n=e.style;return n.background="transparent none",n.border="none",n.margin="0px",n.padding="0px",n.position="static",e},now:function(){return Date.now?$.now=Date.now:$.now=function(){return(new Date).getTime()},$.now()},makeTransparentImage:function(t){return $.makeTransparentImage=function(t){var e=$.makeNeutralElement("img");return e.src=t,e},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(t){var e=$.makeNeutralElement("img"),n=null;return n=$.makeNeutralElement("span"),n.style.display="inline-block",e.onload=function(){n.style.width=n.style.width||e.width+"px",n.style.height=n.style.height||e.height+"px",e.onload=null,e=null},e.src=t,n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"', sizingMethod='scale')",n}),$.makeTransparentImage(t)},setElementOpacity:function(t,e,n){var i;t=$.getElement(t),n&&!$.Browser.alpha&&(e=Math.round(e)),$.Browser.opacity?t.style.opacity=e<1?e:"":e<1?(i="alpha(opacity="+Math.round(100*e)+")",t.style.filter=i):t.style.filter=""},setElementTouchActionNone:function(t){"undefined"!=typeof(t=$.getElement(t)).style.touchAction?t.style.touchAction="none":"undefined"!=typeof t.style.msTouchAction&&(t.style.msTouchAction="none")},addClass:function(t,e){(t=$.getElement(t)).className?-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=" "+e):t.className=e},indexOf:function(t,e,n){return Array.prototype.indexOf?this.indexOf=function(t,e,n){return t.indexOf(e,n)}:this.indexOf=function(t,e,n){var i,r,o=n||0;if(!t)throw new TypeError;if(0===(r=t.length)||o>=r)return-1;for(o<0&&(o=r-Math.abs(o)),i=o;i<r;i++)if(t[i]===e)return i;return-1},this.indexOf(t,e,n)},removeClass:function(t,e){var n,i,r=[];for(n=(t=$.getElement(t)).className.split(/\s+/),i=0;i<n.length;i++)n[i]&&n[i]!==e&&r.push(n[i]);t.className=r.join(" ")},addEvent:function(){if(window.addEventListener)return function(t,e,n,i){(t=$.getElement(t)).addEventListener(e,n,i)};if(window.attachEvent)return function(t,e,n){(t=$.getElement(t)).attachEvent("on"+e,n)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(t,e,n,i){(t=$.getElement(t)).removeEventListener(e,n,i)};if(window.detachEvent)return function(t,e,n){(t=$.getElement(t)).detachEvent("on"+e,n)};throw new Error("No known event model.")}(),cancelEvent:function(t){(t=$.getEvent(t)).preventDefault?$.cancelEvent=function(t){t.preventDefault()}:$.cancelEvent=function(t){(t=$.getEvent(t)).cancel=!0,t.returnValue=!1},$.cancelEvent(t)},stopEvent:function(t){(t=$.getEvent(t)).stopPropagation?$.stopEvent=function(t){t.stopPropagation()}:$.stopEvent=function(t){(t=$.getEvent(t)).cancelBubble=!0},$.stopEvent(t)},createCallback:function(t,e){var n,i=[];for(n=2;n<arguments.length;n++)i.push(arguments[n]);return function(){var n,r=i.concat([]);for(n=0;n<arguments.length;n++)r.push(arguments[n]);return e.apply(t,r)}},getUrlParameter:function(t){var e=URLPARAMS[t];return e||null},getUrlProtocol:function(t){var e=t.match(/^([a-z]+:)\/\//i);return null===e?window.location.protocol:e[1].toLowerCase()},createAjaxRequest:function(t){var e;try{e=!!new ActiveXObject("Microsoft.XMLHTTP")}catch(n){e=!1}if(e)window.XMLHttpRequest?$.createAjaxRequest=function(t){return t?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:$.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");$.createAjaxRequest=function(){return new XMLHttpRequest}}return $.createAjaxRequest(t)},makeAjaxRequest:function(t,e,n){var i,r,o;$.isPlainObject(t)&&(e=t.success,n=t.error,i=t.withCredentials,r=t.headers,o=t.responseType||null,t=t.url);var a=$.getUrlProtocol(t),s=$.createAjaxRequest("file:"===a);if(!$.isFunction(e))throw new Error("makeAjaxRequest requires a success callback");s.onreadystatechange=function(){4==s.readyState&&(s.onreadystatechange=function(){},s.status>=200&&s.status<300||0===s.status&&"http:"!==a&&"https:"!==a?e(s):($.console.log("AJAX request returned %d: %s",s.status,t),$.isFunction(n)&&n(s)))};try{if(s.open("GET",t,!0),o&&(s.responseType=o),r)for(var c in r)r.hasOwnProperty(c)&&r[c]&&s.setRequestHeader(c,r[c]);i&&(s.withCredentials=!0),s.send(null)}catch(h){var u=h.message;if($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10&&"undefined"!=typeof h.number&&-2147024891==h.number&&(u+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),$.console.log("%s while making AJAX request: %s",h.name,u),s.onreadystatechange=function(){},window.XDomainRequest){var l=new XDomainRequest;if(l){l.onload=function(){$.isFunction(e)&&e({responseText:l.responseText,status:200,statusText:"OK"})},l.onerror=function(){$.isFunction(n)&&n({responseText:l.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{l.open("GET",t),l.send()}catch(d){$.isFunction(n)&&n(s,h)}}}else $.isFunction(n)&&n(s,h)}return s},jsonp:function(t){var e,n=t.url,i=document.head||document.getElementsByTagName("head")[0]||document.documentElement,r=t.callbackName||"openseadragon"+$.now(),o=window[r],a="$1"+r+"$2",s=t.param||"callback",c=t.callback;n=n.replace(/(\=)\?(&|$)|\?\?/i,a),n+=(/\?/.test(n)?"&":"?")+s+"="+r,window[r]=function(t){if(o)window[r]=o;else try{delete window[r]}catch(e){}c&&$.isFunction(c)&&c(t)},e=document.createElement("script"),undefined===t.async&&!1===t.async||(e.async="async"),t.scriptCharset&&(e.charset=t.scriptCharset),e.src=n,e.onload=e.onreadystatechange=function(t,n){(n||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,i&&e.parentNode&&i.removeChild(e),e=undefined)},i.insertBefore(e,i.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(t){if(window.DOMParser)$.parseXml=function(t){var e;return e=new DOMParser,e.parseFromString(t,"text/xml")};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");$.parseXml=function(t){var e=null;return e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(t),e}}return $.parseXml(t)},parseJSON:function(string){return window.JSON&&window.JSON.parse?$.parseJSON=window.JSON.parse:$.parseJSON=function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(t){return t=t||"",!!FILEFORMATS[t.toLowerCase()]}}),$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};!function(){var t=navigator.appVersion,e=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(e.substring(e.indexOf("MSIE")+5,e.indexOf(";",e.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(e.indexOf("Firefox")>=0?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(e.substring(e.indexOf("Firefox")+8))):e.indexOf("Safari")>=0?($.Browser.vendor=e.indexOf("Chrome")>=0?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(e.substring(e.substring(0,e.indexOf("Safari")).lastIndexOf("/")+1,e.indexOf("Safari")))):null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(e)&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1)));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(t)}var n,i,r,o=window.location.search.substring(1).split("&");for(r=0;r<o.length;r++)(i=(n=o[r]).indexOf("="))>0&&(URLPARAMS[n.substring(0,i)]=decodeURIComponent(n.substring(i+1)));$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)}();var nullfunction=function(){};$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},function(t){var e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,n=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.msCancelAnimationFrame;if(e&&n)$.requestAnimationFrame=function(){return e.apply(t,arguments)},$.cancelAnimationFrame=function(){return n.apply(t,arguments)};else{var i,r=[],o=[],a=0;$.requestAnimationFrame=function(t){return r.push([++a,t]),i||(i=setInterval(function(){if(r.length){var t=$.now(),e=o;for(o=r,r=e;o.length;)o.shift()[1](t)}else clearInterval(i),i=undefined},20)),a},$.cancelAnimationFrame=function(t){var e,n;for(e=0,n=r.length;e<n;e+=1)if(r[e][0]===t)return void r.splice(e,1);for(e=0,n=o.length;e<n;e+=1)if(o[e][0]===t)return void o.splice(e,1)}}}(window)}(OpenSeadragon),function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():t.OpenSeadragon=e()}(this,function(){return OpenSeadragon}),function(t){var e={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.fullscreenElement},e.requestFullScreen=function(t){return t.requestFullscreen()},e.exitFullScreen=function(){document.exitFullscreen()},e.fullScreenEventName="fullscreenchange",e.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.msFullscreenElement},e.requestFullScreen=function(t){return t.msRequestFullscreen()},e.exitFullScreen=function(){document.msExitFullscreen()},e.fullScreenEventName="MSFullscreenChange",e.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.webkitFullscreenElement},e.requestFullScreen=function(t){return t.webkitRequestFullscreen()},e.exitFullScreen=function(){document.webkitExitFullscreen()},e.fullScreenEventName="webkitfullscreenchange",e.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},e.requestFullScreen=function(t){return t.webkitRequestFullScreen()},e.exitFullScreen=function(){document.webkitCancelFullScreen()},e.fullScreenEventName="webkitfullscreenchange",e.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.mozFullScreenElement},e.requestFullScreen=function(t){return t.mozRequestFullScreen()},e.exitFullScreen=function(){document.mozCancelFullScreen()},e.fullScreenEventName="mozfullscreenchange",e.fullScreenErrorEventName="mozfullscreenerror"),e.isFullScreen=function(){return null!==e.getFullScreenElement()},e.cancelFullScreen=function(){t.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),e.exitFullScreen()},t.extend(t,e)}(OpenSeadragon),function(t){t.EventSource=function(){this.events={}},t.EventSource.prototype={addOnceHandler:function(t,e,n,i){var r=this;i=i||1;var o=0,a=function(n){++o===i&&r.removeHandler(t,a),e(n)};this.addHandler(t,a,n)},addHandler:function(e,n,i){var r=this.events[e];r||(this.events[e]=r=[]),n&&t.isFunction(n)&&(r[r.length]={handler:n,userData:i||null})},removeHandler:function(e,n){var i,r=this.events[e],o=[];if(r&&t.isArray(r)){for(i=0;i<r.length;i++)r[i].handler!==n&&o.push(r[i]);this.events[e]=o}},removeAllHandlers:function(t){if(t)this.events[t]=[];else for(var e in this.events)this.events[e]=[]},getHandler:function(t){var e=this.events[t];return e&&e.length?(e=1===e.length?[e[0]]:Array.apply(null,e),function(t,n){var i,r=e.length;for(i=0;i<r;i++)e[i]&&(n.eventSource=t,n.userData=e[i].userData,e[i].handler(n))}):null},raiseEvent:function(t,e){var n=this.getHandler(t);n&&(e||(e={}),n(this,e))}}}(OpenSeadragon),function(t){function e(e){var n,i=mt[e.hash],r=i.activePointersLists.length;for(n=0;n<r;n++)i.activePointersLists[n].captureCount>0&&(t.removeEvent(t.MouseTracker.captureElement,"mousemove",i.mousemovecaptured,!0),t.removeEvent(t.MouseTracker.captureElement,"mouseup",i.mouseupcaptured,!0),t.removeEvent(t.MouseTracker.captureElement,t.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",i.pointermovecaptured,!0),t.removeEvent(t.MouseTracker.captureElement,t.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",i.pointerupcaptured,!0),t.removeEvent(t.MouseTracker.captureElement,"touchmove",i.touchmovecaptured,!0),t.removeEvent(t.MouseTracker.captureElement,"touchend",i.touchendcaptured,!0),i.activePointersLists[n].captureCount=0);for(n=0;n<r;n++)i.activePointersLists.pop()}function n(n){var i,r,o=mt[n.hash];if(!o.tracking){for(r=0;r<t.MouseTracker.subscribeEvents.length;r++)i=t.MouseTracker.subscribeEvents[r],t.addEvent(n.element,i,o[i],!1);e(n),o.tracking=!0}}function i(n){var i,r,o=mt[n.hash];if(o.tracking){for(r=0;r<t.MouseTracker.subscribeEvents.length;r++)i=t.MouseTracker.subscribeEvents[r],t.removeEvent(n.element,i,o[i],!1);e(n),o.tracking=!1}}function r(e,n){var i=mt[e.hash];if("pointerevent"===n)return{upName:t.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:i.pointerupcaptured,moveName:t.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:i.pointermovecaptured};if("mouse"===n)return{upName:"mouseup",upHandler:i.mouseupcaptured,moveName:"mousemove",moveHandler:i.mousemovecaptured};if("touch"===n)return{upName:"touchend",upHandler:i.touchendcaptured,moveName:"touchmove",moveHandler:i.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function o(e,n,i){var o,a=e.getActivePointersListByType(n);a.captureCount+=i||1,1===a.captureCount&&(t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?e.element.setCapture(!0):(o=r(e,t.MouseTracker.havePointerEvents?"pointerevent":n),gt&&ft(window.top)&&t.addEvent(window.top,o.upName,o.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,o.upName,o.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,o.moveName,o.moveHandler,!0)))}function a(e,n,i){var o,a=e.getActivePointersListByType(n);a.captureCount-=i||1,0===a.captureCount&&(t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?e.element.releaseCapture():(o=r(e,t.MouseTracker.havePointerEvents?"pointerevent":n),gt&&ft(window.top)&&t.removeEvent(window.top,o.upName,o.upHandler,!0),t.removeEvent(t.MouseTracker.captureElement,o.moveName,o.moveHandler,!0),t.removeEvent(t.MouseTracker.captureElement,o.upName,o.upHandler,!0)))}function s(e){var n;if(t.MouseTracker.unprefixedPointerEvents)n=e.pointerType;else switch(e.pointerType){case 2:n="touch";break;case 3:n="pen";break;case 4:n="mouse";break;default:n=""}return n}function c(e){return t.getMousePosition(e)}function u(t,e){return l(c(t),e)}function l(e,n){var i=t.getElementOffset(n);return e.minus(i)}function h(e,n){return new t.Point((e.x+n.x)/2,(e.y+n.y)/2)}function d(e,n){e.clickHandler&&t.cancelEvent(n)}function f(e,n){e.dblClickHandler&&t.cancelEvent(n)}function p(e,n){e.keyDownHandler&&(n=t.getEvent(n),e.keyDownHandler({eventSource:e,keyCode:n.keyCode?n.keyCode:n.charCode,ctrl:n.ctrlKey,shift:n.shiftKey,alt:n.altKey,meta:n.metaKey,originalEvent:n,preventDefaultAction:!1,userData:e.userData})||t.cancelEvent(n))}function m(e,n){e.keyUpHandler&&(n=t.getEvent(n),e.keyUpHandler({eventSource:e,keyCode:n.keyCode?n.keyCode:n.charCode,ctrl:n.ctrlKey,shift:n.shiftKey,alt:n.altKey,meta:n.metaKey,originalEvent:n,preventDefaultAction:!1,userData:e.userData})||t.cancelEvent(n))}function g(e,n){e.keyHandler&&(n=t.getEvent(n),e.keyHandler({eventSource:e,keyCode:n.keyCode?n.keyCode:n.charCode,ctrl:n.ctrlKey,shift:n.shiftKey,alt:n.altKey,meta:n.metaKey,originalEvent:n,preventDefaultAction:!1,userData:e.userData})||t.cancelEvent(n))}function v(e,n){e.focusHandler&&(n=t.getEvent(n),!1===e.focusHandler({eventSource:e,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n))}function y(e,n){e.blurHandler&&(n=t.getEvent(n),!1===e.blurHandler({eventSource:e,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n))}function b(t,e){x(t,e,e)}function _(e,n){var i={target:(n=t.getEvent(n)).target||n.srcElement,type:"wheel",shiftKey:n.shiftKey||!1,clientX:n.clientX,clientY:n.clientY,pageX:n.pageX?n.pageX:n.clientX,pageY:n.pageY?n.pageY:n.clientY,deltaMode:"MozMousePixelScroll"==n.type?0:1,deltaX:0,deltaZ:0};"mousewheel"==t.MouseTracker.wheelEventName?i.deltaY=-n.wheelDelta/t.DEFAULT_SETTINGS.pixelsPerWheelLine:i.deltaY=n.detail,x(e,i,n)}function x(e,n,i){var r=0;r=n.deltaY<0?1:-1,e.scrollHandler&&!1===e.scrollHandler({eventSource:e,pointerType:"mouse",position:u(n,e.element),scroll:r,shift:n.shiftKey,isTouchEvent:!1,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i)}function w(t,e){if(t===e)return!1;for(;e&&e!==t;)e=e.parentNode;return e===t}function S(e,n){E(e,n=t.getEvent(n))}function k(e,n){(n=t.getEvent(n)).currentTarget===n.relatedTarget||w(n.currentTarget,n.relatedTarget)||E(e,n)}function E(e,n){at(e,n,[{id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:c(n),currentTime:t.now()}])}function T(e,n){L(e,n=t.getEvent(n))}function C(e,n){(n=t.getEvent(n)).currentTarget===n.relatedTarget||w(n.currentTarget,n.relatedTarget)||L(e,n)}function L(e,n){st(e,n,[{id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:c(n),currentTime:t.now()}])}function P(e){return t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?1===e?0:2===e?2:4===e?1:-1:e}function A(e,n){ct(e,n=t.getEvent(n),[{id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:c(n),currentTime:t.now()}],P(n.button))&&(t.stopEvent(n),o(e,"mouse")),(e.clickHandler||e.dblClickHandler||e.pressHandler||e.dragHandler||e.dragEndHandler)&&t.cancelEvent(n)}function N(t,e){I(t,e)}function R(e,n){I(e,n),t.stopEvent(n)}function I(e,n){ut(e,n=t.getEvent(n),[{id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:c(n),currentTime:t.now()}],P(n.button))&&a(e,"mouse")}function D(t,e){B(t,e)}function O(e,n){B(e,n),t.stopEvent(n)}function B(e,n){lt(e,n=t.getEvent(n),[{id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:c(n),currentTime:t.now()}])}function M(t,e,n){var i,r=n.getLength(),o=[];if("touch"===n.type||n.contacts>0){for(i=0;i<r;i++)o.push(n.getByIndex(i));o.length>0&&(ut(t,e,o,0),n.captureCount=1,a(t,n.type),st(t,e,o))}}function F(e,n){var i,r,a,s,u=n.changedTouches.length,l=[],h=e.getActivePointersListByType("touch");for(i=t.now(),h.getLength()>n.touches.length-u&&(t.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),M(e,n,h)),r=0;r<u;r++)l.push({id:n.changedTouches[r].identifier,type:"touch",currentPos:c(n.changedTouches[r]),currentTime:i});for(at(e,n,l),r=0;r<pt.length;r++)if(pt[r]!==e&&pt[r].isTracking()&&w(pt[r].element,e.element)){for(s=[],a=0;a<u;a++)s.push({id:n.changedTouches[a].identifier,type:"touch",currentPos:c(n.changedTouches[a]),currentTime:i});at(pt[r],n,s)}ct(e,n,l,0)&&(t.stopEvent(n),o(e,"touch",u)),t.cancelEvent(n)}function z(t,e){H(t,e)}function j(e,n){H(e,n),t.stopEvent(n)}function H(e,n){var i,r,o,s,u=n.changedTouches.length,l=[];for(i=t.now(),r=0;r<u;r++)l.push({id:n.changedTouches[r].identifier,type:"touch",currentPos:c(n.changedTouches[r]),currentTime:i});for(ut(e,n,l,0)&&a(e,"touch",u),st(e,n,l),r=0;r<pt.length;r++)if(pt[r]!==e&&pt[r].isTracking()&&w(pt[r].element,e.element)){for(s=[],o=0;o<u;o++)s.push({id:n.changedTouches[o].identifier,type:"touch",currentPos:c(n.changedTouches[o]),currentTime:i});st(pt[r],n,s)}t.cancelEvent(n)}function $(t,e){q(t,e)}function U(e,n){q(e,n),t.stopEvent(n)}function q(e,n){var i,r=n.changedTouches.length,o=[];for(i=0;i<r;i++)o.push({id:n.changedTouches[i].identifier,type:"touch",currentPos:c(n.changedTouches[i]),currentTime:t.now()});lt(e,n,o),t.cancelEvent(n)}function W(t,e){M(t,e,t.getActivePointersListByType("touch"))}function V(t,e){return e.stopPropagation(),e.preventDefault(),!1}function Z(t,e){return e.stopPropagation(),e.preventDefault(),!1}function G(e,n){n.currentTarget===n.relatedTarget||w(n.currentTarget,n.relatedTarget)||at(e,n,[{id:n.pointerId,type:s(n),isPrimary:n.isPrimary,currentPos:c(n),currentTime:t.now()}])}function K(e,n){n.currentTarget===n.relatedTarget||w(n.currentTarget,n.relatedTarget)||st(e,n,[{id:n.pointerId,type:s(n),isPrimary:n.isPrimary,currentPos:c(n),currentTime:t.now()}])}function X(e,n){var i;ct(e,n,[i={id:n.pointerId,type:s(n),isPrimary:n.isPrimary,currentPos:c(n),currentTime:t.now()}],n.button)&&(t.stopEvent(n),o(e,i.type)),(e.clickHandler||e.dblClickHandler||e.pressHandler||e.dragHandler||e.dragEndHandler||e.pinchHandler)&&t.cancelEvent(n)}function Y(t,e){J(t,e)}function Q(e,n){e.getActivePointersListByType(s(n)).getById(n.pointerId)&&J(e,n),t.stopEvent(n)}function J(e,n){var i;ut(e,n,[i={id:n.pointerId,type:s(n),isPrimary:n.isPrimary,currentPos:c(n),currentTime:t.now()}],n.button)&&a(e,i.type)}function tt(t,e){nt(t,e)}function et(e,n){e.getActivePointersListByType(s(n)).getById(n.pointerId)&&nt(e,n),t.stopEvent(n)}function nt(e,n){lt(e,n,[{id:n.pointerId,type:s(n),isPrimary:n.isPrimary,currentPos:c(n),currentTime:t.now()}])}function it(t,e){ht(t,e,[{id:e.pointerId,type:s(e)}])}function rt(t,e){return e.hasOwnProperty("isPrimary")||(0===t.getLength()?e.isPrimary=!0:e.isPrimary=!1),e.speed=0,e.direction=0,e.contactPos=e.currentPos,e.contactTime=e.currentTime,e.lastPos=e.currentPos,e.lastTime=e.currentTime,t.add(e)}function ot(t,e){var n,i;return t.getById(e.id)?(n=t.removeById(e.id),e.hasOwnProperty("isPrimary")||(i=t.getPrimary())||(i=t.getByIndex(0))&&(i.isPrimary=!0)):n=t.getLength(),n}function at(e,n,i){var r,o,a,s=e.getActivePointersListByType(i[0].type),c=i.length;for(r=0;r<c;r++)o=i[r],(a=s.getById(o.id))?(a.insideElement=!0,a.lastPos=a.currentPos,a.lastTime=a.currentTime,a.currentPos=o.currentPos,a.currentTime=o.currentTime,o=a):(o.captured=!1,o.insideElementPressed=!1,o.insideElement=!0,rt(s,o)),e.enterHandler&&!1===e.enterHandler({eventSource:e,pointerType:o.type,position:l(o.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:o.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===o.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n)}function st(e,n,i){var r,o,a,s=e.getActivePointersListByType(i[0].type),c=i.length;for(r=0;r<c;r++)o=i[r],(a=s.getById(o.id))&&(a.captured?(a.insideElement=!1,a.lastPos=a.currentPos,a.lastTime=a.currentTime,a.currentPos=o.currentPos,a.currentTime=o.currentTime):ot(s,a),o=a),e.exitHandler&&!1===e.exitHandler({eventSource:e,pointerType:o.type,position:l(o.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:!!a&&a.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===o.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n)}function ct(e,n,i,r){var o,a,s,c=mt[e.hash],u=e.getActivePointersListByType(i[0].type),d=i.length;"undefined"!=typeof n.buttons?u.buttons=n.buttons:t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?0===r?u.buttons+=1:1===r?u.buttons+=4:2===r?u.buttons+=2:3===r?u.buttons+=8:4===r?u.buttons+=16:5===r&&(u.buttons+=32):0===r?u.buttons|=1:1===r?u.buttons|=4:2===r?u.buttons|=2:3===r?u.buttons|=8:4===r?u.buttons|=16:5===r&&(u.buttons|=32);var f=e.getActivePointersListsExceptType(i[0].type);for(o=0;o<f.length;o++)M(e,n,f[o]);if(0!==r)return e.nonPrimaryPressHandler&&!1===e.nonPrimaryPressHandler({eventSource:e,pointerType:i[0].type,position:l(i[0].currentPos,e.element),button:r,buttons:u.buttons,isTouchEvent:"touch"===i[0].type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n),!1;for(o=0;o<d;o++)a=i[o],(s=u.getById(a.id))?(s.captured=!0,s.insideElementPressed=!0,s.insideElement=!0,s.contactPos=a.currentPos,s.contactTime=a.currentTime,s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=a.currentPos,s.currentTime=a.currentTime,a=s):(a.captured=!0,a.insideElementPressed=!0,a.insideElement=!0,rt(u,a)),u.addContact(),(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.addPoint(e,a),1===u.contacts?e.pressHandler&&!1===e.pressHandler({eventSource:e,pointerType:a.type,position:l(a.contactPos,e.element),buttons:u.buttons,isTouchEvent:"touch"===a.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n):2===u.contacts&&e.pinchHandler&&"touch"===a.type&&(c.pinchGPoints=u.asArray(),c.lastPinchDist=c.currentPinchDist=c.pinchGPoints[0].currentPos.distanceTo(c.pinchGPoints[1].currentPos),c.lastPinchCenter=c.currentPinchCenter=h(c.pinchGPoints[0].currentPos,c.pinchGPoints[1].currentPos));return!0}function ut(e,n,i,r){var o,a,s,c,u,d,f=mt[e.hash],p=e.getActivePointersListByType(i[0].type),m=i.length,g=!1,v=!1;if("undefined"!=typeof n.buttons?p.buttons=n.buttons:t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?0===r?p.buttons-=1:1===r?p.buttons-=4:2===r?p.buttons-=2:3===r?p.buttons-=8:4===r?p.buttons-=16:5===r&&(p.buttons-=32):0===r?p.buttons^=-2:1===r?p.buttons^=-5:2===r?p.buttons^=-3:3===r?p.buttons^=-9:4===r?p.buttons^=-17:5===r&&(p.buttons^=-33),0!==r){e.nonPrimaryReleaseHandler&&!1===e.nonPrimaryReleaseHandler({eventSource:e,pointerType:i[0].type,position:l(i[0].currentPos,e.element),button:r,buttons:p.buttons,isTouchEvent:"touch"===i[0].type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n);return M(e,n,e.getActivePointersListByType("mouse")),!1}for(s=0;s<m;s++)c=i[s],(u=p.getById(c.id))&&(u.captured&&(u.captured=!1,g=!0,v=!0),u.lastPos=u.currentPos,u.lastTime=u.currentTime,u.currentPos=c.currentPos,u.currentTime=c.currentTime,u.insideElement||ot(p,u),o=u.currentPos,a=u.currentTime,v?(p.removeContact(),(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.removePoint(e,u),0===p.contacts?(e.releaseHandler&&!1===e.releaseHandler({eventSource:e,pointerType:u.type,position:l(o,e.element),buttons:p.buttons,insideElementPressed:u.insideElementPressed,insideElementReleased:u.insideElement,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n),e.dragEndHandler&&!u.currentPos.equals(u.contactPos)&&!1===e.dragEndHandler({eventSource:e,pointerType:u.type,position:l(u.currentPos,e.element),speed:u.speed,direction:u.direction,shift:n.shiftKey,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n),
(e.clickHandler||e.dblClickHandler)&&u.insideElement&&(d=a-u.contactTime<=e.clickTimeThreshold&&u.contactPos.distanceTo(o)<=e.clickDistThreshold,e.clickHandler&&!1===e.clickHandler({eventSource:e,pointerType:u.type,position:l(u.currentPos,e.element),quick:d,shift:n.shiftKey,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n),e.dblClickHandler&&d&&(p.clicks++,1===p.clicks?(f.lastClickPos=o,f.dblClickTimeOut=setTimeout(function(){p.clicks=0},e.dblClickTimeThreshold)):2===p.clicks&&(clearTimeout(f.dblClickTimeOut),p.clicks=0,f.lastClickPos.distanceTo(o)<=e.dblClickDistThreshold&&!1===e.dblClickHandler({eventSource:e,pointerType:u.type,position:l(u.currentPos,e.element),shift:n.shiftKey,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n),f.lastClickPos=null)))):2===p.contacts&&e.pinchHandler&&"touch"===u.type&&(f.pinchGPoints=p.asArray(),f.lastPinchDist=f.currentPinchDist=f.pinchGPoints[0].currentPos.distanceTo(f.pinchGPoints[1].currentPos),f.lastPinchCenter=f.currentPinchCenter=h(f.pinchGPoints[0].currentPos,f.pinchGPoints[1].currentPos))):e.releaseHandler&&!1===e.releaseHandler({eventSource:e,pointerType:u.type,position:l(o,e.element),buttons:p.buttons,insideElementPressed:u.insideElementPressed,insideElementReleased:u.insideElement,isTouchEvent:"touch"===u.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n));return g}function lt(e,n,i){var r,o,a,s,c,u=mt[e.hash],d=e.getActivePointersListByType(i[0].type),f=i.length;for("undefined"!=typeof n.buttons&&(d.buttons=n.buttons),r=0;r<f;r++)o=i[r],(a=d.getById(o.id))?(o.hasOwnProperty("isPrimary")&&(a.isPrimary=o.isPrimary),a.lastPos=a.currentPos,a.lastTime=a.currentTime,a.currentPos=o.currentPos,a.currentTime=o.currentTime):(o.captured=!1,o.insideElementPressed=!1,o.insideElement=!0,rt(d,o));e.stopHandler&&"mouse"===i[0].type&&(clearTimeout(e.stopTimeOut),e.stopTimeOut=setTimeout(function(){dt(e,n,i[0].type)},e.stopDelay)),0===d.contacts?e.moveHandler&&!1===e.moveHandler({eventSource:e,pointerType:i[0].type,position:l(i[0].currentPos,e.element),buttons:d.buttons,isTouchEvent:"touch"===i[0].type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n):1===d.contacts?(e.moveHandler&&(a=d.asArray()[0],!1===e.moveHandler({eventSource:e,pointerType:a.type,position:l(a.currentPos,e.element),buttons:d.buttons,isTouchEvent:"touch"===a.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n)),e.dragHandler&&(c=(a=d.asArray()[0]).currentPos.minus(a.lastPos),!1===e.dragHandler({eventSource:e,pointerType:a.type,position:l(a.currentPos,e.element),buttons:d.buttons,delta:c,speed:a.speed,direction:a.direction,shift:n.shiftKey,isTouchEvent:"touch"===a.type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n))):2===d.contacts&&(e.moveHandler&&(s=d.asArray(),!1===e.moveHandler({eventSource:e,pointerType:s[0].type,position:l(h(s[0].currentPos,s[1].currentPos),e.element),buttons:d.buttons,isTouchEvent:"touch"===s[0].type,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n)),e.pinchHandler&&"touch"===i[0].type&&(c=u.pinchGPoints[0].currentPos.distanceTo(u.pinchGPoints[1].currentPos))!=u.currentPinchDist&&(u.lastPinchDist=u.currentPinchDist,u.currentPinchDist=c,u.lastPinchCenter=u.currentPinchCenter,u.currentPinchCenter=h(u.pinchGPoints[0].currentPos,u.pinchGPoints[1].currentPos),!1===e.pinchHandler({eventSource:e,pointerType:"touch",gesturePoints:u.pinchGPoints,lastCenter:l(u.lastPinchCenter,e.element),center:l(u.currentPinchCenter,e.element),lastDistance:u.lastPinchDist,distance:u.currentPinchDist,shift:n.shiftKey,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n)))}function ht(t,e,n){ut(t,e,n,0),st(t,e,n)}function dt(t,e,n){t.stopHandler&&t.stopHandler({eventSource:t,pointerType:n,position:u(e,t.element),buttons:t.getActivePointersListByType(n).buttons,isTouchEvent:"touch"===n,originalEvent:e,preventDefaultAction:!1,userData:t.userData})}function ft(t){try{return t.addEventListener&&t.removeEventListener}catch(e){return!1}}var pt=[],mt={};t.MouseTracker=function(e){pt.push(this);var n=arguments;t.isPlainObject(e)||(e={element:n[0],clickTimeThreshold:n[1],clickDistThreshold:n[2]}),this.hash=Math.random(),this.element=t.getElement(e.element),this.clickTimeThreshold=e.clickTimeThreshold||t.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=e.clickDistThreshold||t.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=e.dblClickTimeThreshold||t.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=e.dblClickDistThreshold||t.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=e.userData||null,this.stopDelay=e.stopDelay||50,this.enterHandler=e.enterHandler||null,this.exitHandler=e.exitHandler||null,this.pressHandler=e.pressHandler||null,this.nonPrimaryPressHandler=e.nonPrimaryPressHandler||null,this.releaseHandler=e.releaseHandler||null,this.nonPrimaryReleaseHandler=e.nonPrimaryReleaseHandler||null,this.moveHandler=e.moveHandler||null,this.scrollHandler=e.scrollHandler||null,this.clickHandler=e.clickHandler||null,this.dblClickHandler=e.dblClickHandler||null,this.dragHandler=e.dragHandler||null,this.dragEndHandler=e.dragEndHandler||null,this.pinchHandler=e.pinchHandler||null,this.stopHandler=e.stopHandler||null,this.keyDownHandler=e.keyDownHandler||null,this.keyUpHandler=e.keyUpHandler||null,this.keyHandler=e.keyHandler||null,this.focusHandler=e.focusHandler||null,this.blurHandler=e.blurHandler||null;var i=this;mt[this.hash]={click:function(t){d(i,t)},dblclick:function(t){f(i,t)},keydown:function(t){p(i,t)},keyup:function(t){m(i,t)},keypress:function(t){g(i,t)},focus:function(t){v(i,t)},blur:function(t){y(i,t)},wheel:function(t){b(i,t)},mousewheel:function(t){_(i,t)},DOMMouseScroll:function(t){_(i,t)},MozMousePixelScroll:function(t){_(i,t)},mouseenter:function(t){S(i,t)},mouseleave:function(t){T(i,t)},mouseover:function(t){k(i,t)},mouseout:function(t){C(i,t)},mousedown:function(t){A(i,t)},mouseup:function(t){N(i,t)},mouseupcaptured:function(t){R(i,t)},mousemove:function(t){D(i,t)},mousemovecaptured:function(t){O(i,t)},touchstart:function(t){F(i,t)},touchend:function(t){z(i,t)},touchendcaptured:function(t){j(i,t)},touchmove:function(t){$(i,t)},touchmovecaptured:function(t){U(i,t)},touchcancel:function(t){W(i,t)},gesturestart:function(t){V(i,t)},gesturechange:function(t){Z(i,t)},pointerover:function(t){G(i,t)},MSPointerOver:function(t){G(i,t)},pointerout:function(t){K(i,t)},MSPointerOut:function(t){K(i,t)},pointerdown:function(t){X(i,t)},MSPointerDown:function(t){X(i,t)},pointerup:function(t){Y(i,t)},MSPointerUp:function(t){Y(i,t)},pointermove:function(t){tt(i,t)},MSPointerMove:function(t){tt(i,t)},pointercancel:function(t){it(i,t)},MSPointerCancel:function(t){it(i,t)},pointerupcaptured:function(t){Q(i,t)},pointermovecaptured:function(t){et(i,t)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},e.startDisabled||this.setTracking(!0)},t.MouseTracker.prototype={destroy:function(){var t;for(i(this),this.element=null,t=0;t<pt.length;t++)if(pt[t]===this){pt.splice(t,1);break}mt[this.hash]=null,delete mt[this.hash]},isTracking:function(){return mt[this.hash].tracking},setTracking:function(t){return t?n(this):i(this),this},getActivePointersListsExceptType:function(t){for(var e=mt[this.hash],n=[],i=0;i<e.activePointersLists.length;++i)e.activePointersLists[i].type!==t&&n.push(e.activePointersLists[i]);return n},getActivePointersListByType:function(e){var n,i,r=mt[this.hash],o=r.activePointersLists.length;for(n=0;n<o;n++)if(r.activePointersLists[n].type===e)return r.activePointersLists[n];return i=new t.MouseTracker.GesturePointList(e),r.activePointersLists.push(i),i},getActivePointerCount:function(){var t,e=mt[this.hash],n=e.activePointersLists.length,i=0;for(t=0;t<n;t++)i+=e.activePointersLists[t].getLength();return i},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},t.MouseTracker.resetAllMouseTrackers=function(){for(var t=0;t<pt.length;t++)pt[t].isTracking()&&(pt[t].setTracking(!1),pt[t].setTracking(!0))},t.MouseTracker.gesturePointVelocityTracker=function(){var e=[],n=0,i=0,r=function(t,e){return t.hash.toString()+e.type+e.id.toString()},o=function(){var n,r,o,a,s,c,u=e.length,l=t.now();for(a=l-i,i=l,n=0;n<u;n++)(o=(r=e[n]).gPoint).direction=Math.atan2(o.currentPos.y-r.lastPos.y,o.currentPos.x-r.lastPos.x),s=r.lastPos.distanceTo(o.currentPos),r.lastPos=o.currentPos,c=1e3*s/(a+1),o.speed=.75*c+.25*o.speed};return{addPoint:function(a,s){var c=r(a,s);e.push({guid:c,gPoint:s,lastPos:s.currentPos}),1===e.length&&(i=t.now(),n=window.setInterval(o,50))},removePoint:function(t,i){var o,a=r(t,i),s=e.length;for(o=0;o<s;o++)if(e[o].guid===a){e.splice(o,1),0===--s&&window.clearInterval(n);break}}}}(),t.MouseTracker.captureElement=document,t.MouseTracker.wheelEventName=t.Browser.vendor==t.BROWSERS.IE&&t.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll",t.MouseTracker.supportsMouseCapture=function(){var e=document.createElement("div");return t.isFunction(e.setCapture)&&t.isFunction(e.releaseCapture)}(),t.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",t.MouseTracker.wheelEventName],"DOMMouseScroll"==t.MouseTracker.wheelEventName&&t.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||t.Browser.vendor!==t.BROWSERS.IE)?(t.MouseTracker.havePointerEvents=!0,t.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),t.MouseTracker.unprefixedPointerEvents=!0,navigator.maxTouchPoints?t.MouseTracker.maxTouchPoints=navigator.maxTouchPoints:t.MouseTracker.maxTouchPoints=0,t.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(t.MouseTracker.havePointerEvents=!0,t.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),t.MouseTracker.unprefixedPointerEvents=!1,navigator.msMaxTouchPoints?t.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints:t.MouseTracker.maxTouchPoints=0,t.MouseTracker.haveMouseEnter=!1):(t.MouseTracker.havePointerEvents=!1,t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?(t.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),t.MouseTracker.haveMouseEnter=!0):(t.MouseTracker.subscribeEvents.push("mouseover","mouseout"),t.MouseTracker.haveMouseEnter=!1),t.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&t.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&t.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),t.MouseTracker.mousePointerId="legacy-mouse",t.MouseTracker.maxTouchPoints=10),t.MouseTracker.GesturePointList=function(t){this._gPoints=[],this.type=t,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},t.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(t){return this._gPoints.push(t)},removeById:function(t){var e,n=this._gPoints.length;for(e=0;e<n;e++)if(this._gPoints[e].id===t){this._gPoints.splice(e,1);break}return this._gPoints.length},getByIndex:function(t){return t<this._gPoints.length?this._gPoints[t]:null},getById:function(t){var e,n=this._gPoints.length;for(e=0;e<n;e++)if(this._gPoints[e].id===t)return this._gPoints[e];return null},getPrimary:function(){var t,e=this._gPoints.length;for(t=0;t<e;t++)if(this._gPoints[t].isPrimary)return this._gPoints[t];return null},addContact:function(){++this.contacts,this.contacts>1&&("mouse"===this.type||"pen"===this.type)&&(this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};var gt=function(){try{return window.self!==window.top}catch(t){return!0}}()}(OpenSeadragon),function(t){t.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},t.Control=function(e,n,i){var r=e.parentNode;"number"==typeof n&&(t.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),n={anchor:n}),n.attachToViewer="undefined"==typeof n.attachToViewer||n.attachToViewer,this.autoFade="undefined"==typeof n.autoFade||n.autoFade,this.element=e,this.anchor=n.anchor,this.container=i,this.anchor==t.ControlAnchor.ABSOLUTE?(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top="number"==typeof n.top?n.top+"px":n.top,this.wrapper.style.left="number"==typeof n.left?n.left+"px":n.left,this.wrapper.style.height="number"==typeof n.height?n.height+"px":n.height,this.wrapper.style.width="number"==typeof n.width?n.width+"px":n.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==t.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),n.attachToViewer?this.anchor==t.ControlAnchor.TOP_RIGHT||this.anchor==t.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):r.appendChild(this.wrapper)},t.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(e){this.wrapper.style.display=e?this.anchor==t.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(e){this.element[t.SIGNAL]&&t.Browser.vendor==t.BROWSERS.IE?t.setElementOpacity(this.element,e,!0):t.setElementOpacity(this.wrapper,e,!0)}}}(OpenSeadragon),function(t){function e(t,e){var n,i=t.controls;for(n=i.length-1;n>=0;n--)if(i[n].element==e)return n;return-1}t.ControlDock=function(e){var n,i,r=["topleft","topright","bottomright","bottomleft"];for(t.extend(!0,this,{id:"controldock-"+t.now()+"-"+Math.floor(1e6*Math.random()),container:t.makeNeutralElement("div"),controls:[]},e),this.container.onsubmit=function(){return!1},this.element&&(this.element=t.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),i=0;i<r.length;i++)n=r[i],this.controls[n]=t.makeNeutralElement("div"),this.controls[n].style.position="absolute",n.match("left")&&(this.controls[n].style.left="0px"),n.match("right")&&(this.controls[n].style.right="0px"),n.match("top")&&(this.controls[n].style.top="0px"),n.match("bottom")&&(this.controls[n].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},t.ControlDock.prototype={addControl:function(n,i){var r=null;if(!(e(this,n=t.getElement(n))>=0)){switch(i.anchor){case t.ControlAnchor.TOP_RIGHT:r=this.controls.topright,n.style.position="relative",n.style.paddingRight="0px",n.style.paddingTop="0px";break;case t.ControlAnchor.BOTTOM_RIGHT:r=this.controls.bottomright,n.style.position="relative",n.style.paddingRight="0px",n.style.paddingBottom="0px";break;case t.ControlAnchor.BOTTOM_LEFT:r=this.controls.bottomleft,n.style.position="relative",n.style.paddingLeft="0px",n.style.paddingBottom="0px";break;case t.ControlAnchor.TOP_LEFT:r=this.controls.topleft,n.style.position="relative",n.style.paddingLeft="0px",n.style.paddingTop="0px";break;case t.ControlAnchor.ABSOLUTE:r=this.container,n.style.margin="0px",n.style.padding="0px";break;default:case t.ControlAnchor.NONE:r=this.container,n.style.margin="0px",n.style.padding="0px"}this.controls.push(new t.Control(n,i,r)),n.style.display="inline-block"}},removeControl:function(n){var i=e(this,n=t.getElement(n));return i>=0&&(this.controls[i].destroy(),this.controls.splice(i,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var t;for(t=this.controls.length-1;t>=0;t--)if(this.controls[t].isVisible())return!0;return!1},setControlsEnabled:function(t){var e;for(e=this.controls.length-1;e>=0;e--)this.controls[e].setVisible(t);return this}}}(OpenSeadragon),function(t){t.Placement=t.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(t){function e(e){return e=t.getElement(e),new t.Point(0===e.clientWidth?1:e.clientWidth,0===e.clientHeight?1:e.clientHeight)}function n(e,n,i,r,o){function a(t,e){t.ready?r(t):(t.addHandler("ready",function(){r(t)}),t.addHandler("open-failed",function(t){o({message:t.message,source:e})}))}var s=e;if("string"==t.type(n))if(n.match(/^\s*<.*>\s*$/))n=t.parseXml(n);else if(n.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var c=t.parseJSON(n);n=c}catch(u){}setTimeout(function(){if("string"==t.type(n))(n=new t.TileSource({url:n,crossOriginPolicy:i.crossOriginPolicy!==undefined?i.crossOriginPolicy:e.crossOriginPolicy,ajaxWithCredentials:e.ajaxWithCredentials,ajaxHeaders:e.ajaxHeaders,useCanvas:e.useCanvas,success:function(t){r(t.tileSource)}})).addHandler("open-failed",function(t){o(t)});else if(t.isPlainObject(n)||n.nodeType)if(n.crossOriginPolicy!==undefined||i.crossOriginPolicy===undefined&&e.crossOriginPolicy===undefined||(n.crossOriginPolicy=i.crossOriginPolicy!==undefined?i.crossOriginPolicy:e.crossOriginPolicy),n.ajaxWithCredentials===undefined&&(n.ajaxWithCredentials=e.ajaxWithCredentials),n.useCanvas===undefined&&(n.useCanvas=e.useCanvas),t.isFunction(n.getTileUrl)){var c=new t.TileSource(n);c.getTileUrl=n.getTileUrl,r(c)}else{var u=t.TileSource.determineType(s,n);if(!u)return void o({message:"Unable to load TileSource",source:n});a(new u(u.prototype.configure.apply(s,[n])),n)}else a(n,n)})}function i(e,n){if(n instanceof t.Overlay)return n;var i=null;if(n.element)i=t.getElement(n.element);else{var r=n.id?n.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());(i=t.getElement(n.id))||((i=document.createElement("a")).href="#/overlay/"+r),i.id=r,t.addClass(i,n.className?n.className:"openseadragon-overlay")}var o=n.location,a=n.width,s=n.height;if(!o){var c=n.x,u=n.y;if(n.px!==undefined){var l=e.viewport.imageToViewportRectangle(new t.Rect(n.px,n.py,a||0,s||0));c=l.x,u=l.y,a=a!==undefined?l.width:undefined,s=s!==undefined?l.height:undefined}o=new t.Point(c,u)}var h=n.placement;return h&&"string"===t.type(h)&&(h=t.Placement[n.placement.toUpperCase()]),new t.Overlay({element:i,location:o,placement:h,onDraw:n.onDraw,checkResize:n.checkResize,width:a,height:s,rotationMode:n.rotationMode})}function r(t,e){var n;for(n=t.length-1;n>=0;n--)if(t[n].element===e)return n;return-1}function o(e,n){return t.requestAnimationFrame(function(){n(e)})}function a(e){t.requestAnimationFrame(function(){c(e)})}function s(e){e.autoHideControls&&(e.controlsShouldFade=!0,e.controlsFadeBeginTime=t.now()+e.controlsFadeDelay,window.setTimeout(function(){a(e)},e.controlsFadeDelay))}function c(e){var n,i;if(e.controlsShouldFade){for(n=1-(t.now()-e.controlsFadeBeginTime)/e.controlsFadeLength,n=Math.min(1,n),n=Math.max(0,n),i=e.controls.length-1;i>=0;i--)e.controls[i].autoFade&&e.controls[i].setOpacity(n);n>0&&a(e)}}function u(t){var e;for(t.controlsShouldFade=!1,e=t.controls.length-1;e>=0;e--)t.controls[e].setOpacity(1)}function l(){u(this)}function h(){s(this)}function d(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 38:return e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-40))),this.viewport.applyConstraints(),!1;case 40:return e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,40))),this.viewport.applyConstraints(),!1;case 37:return this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-40,0))),this.viewport.applyConstraints(),!1;case 39:return this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(40,0))),this.viewport.applyConstraints(),!1;default:return!0}}function f(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-40))),this.viewport.applyConstraints(),!1;case 115:case 83:return e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,40))),this.viewport.applyConstraints(),!1;case 97:return this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-40,0))),this.viewport.applyConstraints(),!1;case 100:return this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(40,0))),this.viewport.applyConstraints(),!1;default:return!0}}function p(t){document.activeElement==this.canvas||this.canvas.focus();var e={tracker:t.eventSource,position:t.position,quick:t.quick,shift:t.shift,originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction};this.raiseEvent("canvas-click",e),!e.preventDefaultAction&&this.viewport&&t.quick&&this.gestureSettingsByDeviceType(t.pointerType).clickToZoom&&(this.viewport.zoomBy(t.shift?1/this.zoomPerClick:this.zoomPerClick,this.viewport.pointFromPixel(t.position,!0)),this.viewport.applyConstraints())}function m(t){!t.preventDefaultAction&&this.viewport&&this.gestureSettingsByDeviceType(t.pointerType).dblClickToZoom&&(this.viewport.zoomBy(t.shift?1/this.zoomPerClick:this.zoomPerClick,this.viewport.pointFromPixel(t.position,!0)),this.viewport.applyConstraints()),this.raiseEvent("canvas-double-click",{tracker:t.eventSource,position:t.position,shift:t.shift,originalEvent:t.originalEvent})}function g(t){var e,n={tracker:t.eventSource,position:t.position,delta:t.delta,speed:t.speed,direction:t.direction,shift:t.shift,originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction};if(this.raiseEvent("canvas-drag",n),!t.preventDefaultAction&&this.viewport){if(e=this.gestureSettingsByDeviceType(t.pointerType),this.panHorizontal||(t.delta.x=0),this.panVertical||(t.delta.y=0),this.constrainDuringPan){var i=this.viewport.deltaPointsFromPixels(t.delta.negate());this.viewport.centerSpringX.target.value+=i.x,this.viewport.centerSpringY.target.value+=i.y;var r=this.viewport.getBounds(),o=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=i.x,this.viewport.centerSpringY.target.value-=i.y,r.x!=o.x&&(t.delta.x=0),r.y!=o.y&&(t.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(t.delta.negate()),e.flickEnabled&&!this.constrainDuringPan)}}function v(e){if(!e.preventDefaultAction&&this.viewport){var n=this.gestureSettingsByDeviceType(e.pointerType);if(n.flickEnabled&&e.speed>=n.flickMinSpeed){var i=0;this.panHorizontal&&(i=n.flickMomentum*e.speed*Math.cos(e.direction));var r=0;this.panVertical&&(r=n.flickMomentum*e.speed*Math.sin(e.direction));var o=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),a=this.viewport.pointFromPixel(new t.Point(o.x-i,o.y-r));this.viewport.panTo(a,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:e.eventSource,position:e.position,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent})}function y(t){this.raiseEvent("canvas-enter",{tracker:t.eventSource,pointerType:t.pointerType,position:t.position,buttons:t.buttons,pointers:t.pointers,insideElementPressed:t.insideElementPressed,buttonDownAny:t.buttonDownAny,originalEvent:t.originalEvent})}function b(e){window.location!=window.parent.location&&t.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function _(t){this.raiseEvent("canvas-press",{tracker:t.eventSource,pointerType:t.pointerType,position:t.position,insideElementPressed:t.insideElementPressed,insideElementReleased:t.insideElementReleased,originalEvent:t.originalEvent})}function x(t){this.raiseEvent("canvas-release",{tracker:t.eventSource,pointerType:t.pointerType,position:t.position,insideElementPressed:t.insideElementPressed,insideElementReleased:t.insideElementReleased,originalEvent:t.originalEvent})}function w(t){this.raiseEvent("canvas-nonprimary-press",{tracker:t.eventSource,position:t.position,pointerType:t.pointerType,button:t.button,buttons:t.buttons,originalEvent:t.originalEvent})}function S(t){this.raiseEvent("canvas-nonprimary-release",{tracker:t.eventSource,position:t.position,pointerType:t.pointerType,button:t.button,buttons:t.buttons,originalEvent:t.originalEvent})}function k(t){var e,n,i;if(!t.preventDefaultAction&&this.viewport&&((e=this.gestureSettingsByDeviceType(t.pointerType)).pinchToZoom&&(n=this.viewport.pointFromPixel(t.center,!0),i=this.viewport.pointFromPixel(t.lastCenter,!0).minus(n),this.panHorizontal||(i.x=0),this.panVertical||(i.y=0),this.viewport.zoomBy(t.distance/t.lastDistance,n,!0),this.viewport.panBy(i,!0),this.viewport.applyConstraints()),e.pinchRotate)){var r=Math.atan2(t.gesturePoints[0].currentPos.y-t.gesturePoints[1].currentPos.y,t.gesturePoints[0].currentPos.x-t.gesturePoints[1].currentPos.x),o=Math.atan2(t.gesturePoints[0].lastPos.y-t.gesturePoints[1].lastPos.y,t.gesturePoints[0].lastPos.x-t.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(r-o)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:t.eventSource,gesturePoints:t.gesturePoints,lastCenter:t.lastCenter,center:t.center,lastDistance:t.lastDistance,distance:t.distance,shift:t.shift,originalEvent:t.originalEvent}),!1}function E(e){var n,i,r;if(r=t.now(),r-this._lastScrollTime>this.minScrollDeltaTime){if(this._lastScrollTime=r,!e.preventDefaultAction&&this.viewport&&(n=this.gestureSettingsByDeviceType(e.pointerType)).scrollToZoom&&(i=Math.pow(this.zoomPerScroll,e.scroll),this.viewport.zoomBy(i,this.viewport.pointFromPixel(e.position,!0)),this.viewport.applyConstraints()),this.raiseEvent("canvas-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),n&&n.scrollToZoom)return!1}else if((n=this.gestureSettingsByDeviceType(e.pointerType))&&n.scrollToZoom)return!1}function T(t){V[this.hash].mouseInside=!0,u(this),this.raiseEvent("container-enter",{tracker:t.eventSource,position:t.position,buttons:t.buttons,pointers:t.pointers,insideElementPressed:t.insideElementPressed,buttonDownAny:t.buttonDownAny,originalEvent:t.originalEvent})}function C(t){t.pointers<1&&(V[this.hash].mouseInside=!1,V[this.hash].animating||s(this)),this.raiseEvent("container-exit",{tracker:t.eventSource,position:t.position,buttons:t.buttons,pointers:t.pointers,insideElementPressed:t.insideElementPressed,buttonDownAny:t.buttonDownAny,originalEvent:t.originalEvent})}function L(t){P(t),t.isOpen()?t._updateRequestId=o(t,L):t._updateRequestId=!1}function P(t){if(!t._opening){if(t.autoResize){var n=e(t.container),i=V[t.hash].prevContainerSize;if(!n.equals(i)){var r=t.viewport;if(t.preserveImageSizeOnResize){var o=i.x/n.x,a=r.getZoom()*o,c=r.getCenter();r.resize(n,!1),r.zoomTo(a,null,!0),r.panTo(c,!0)}else{var l=r.getBounds();r.resize(n,!0),r.fitBoundsWithConstraints(l,!0)}V[t.hash].prevContainerSize=n,V[t.hash].forceRedraw=!0}}var h=t.viewport.update(),d=t.world.update()||h;h&&t.raiseEvent("viewport-change"),t.referenceStrip&&(d=t.referenceStrip.update(t.viewport)||d),!V[t.hash].animating&&d&&(t.raiseEvent("animation-start"),u(t)),(d||V[t.hash].forceRedraw||t.world.needsDraw())&&(A(t),t._drawOverlays(),t.navigator&&t.navigator.update(t.viewport),V[t.hash].forceRedraw=!1,d&&t.raiseEvent("animation")),V[t.hash].animating&&!d&&(t.raiseEvent("animation-finish"),V[t.hash].mouseInside||s(t)),V[t.hash].animating=d}}function A(t){t.imageLoader.clear(),t.drawer.clear(),t.world.draw(),t.raiseEvent("update-viewport",{})}function N(t,e){return t?t+e:e}function R(){V[this.hash].lastZoomTime=t.now(),V[this.hash].zoomFactor=this.zoomPerSecond,V[this.hash].zooming=!0,O(this)}function I(){V[this.hash].lastZoomTime=t.now(),V[this.hash].zoomFactor=1/this.zoomPerSecond,V[this.hash].zooming=!0,O(this)}function D(){V[this.hash].zooming=!1}function O(e){t.requestAnimationFrame(t.delegate(e,B))}function B(){var e,n,i;V[this.hash].zooming&&this.viewport&&(n=(e=t.now())-V[this.hash].lastZoomTime,i=Math.pow(V[this.hash].zoomFactor,n/1e3),this.viewport.zoomBy(i),this.viewport.applyConstraints(),V[this.hash].lastZoomTime=e,O(this))}function M(){this.viewport&&(V[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function F(){this.viewport&&(V[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function z(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function j(){this.viewport&&this.viewport.goHome()}function H(){this.isFullPage()&&!t.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function $(){if(this.viewport){var t=this.viewport.getRotation();0===t?t=270:t-=90,this.viewport.setRotation(t)}}function U(){if(this.viewport){var t=this.viewport.getRotation();270===t?t=0:t+=90,this.viewport.setRotation(t)}}function q(){var t=this._sequenceIndex-1;this.navPrevNextWrap&&t<0&&(t+=this.tileSources.length),this.goToPage(t)}function W(){var t=this._sequenceIndex+1;this.navPrevNextWrap&&t>=this.tileSources.length&&(t=0),this.goToPage(t)}var V={},Z=1;t.Viewer=function(n){var i,r=arguments,a=this;if(t.isPlainObject(n)||(n={id:r[0],xmlPath:r.length>1?r[1]:undefined,prefixUrl:r.length>2?r[2]:undefined,controls:r.length>3?r[3]:undefined,overlays:r.length>4?r[4]:undefined}),n.config&&(t.extend(!0,n,n.config),delete n.config),t.extend(!0,this,{id:n.id,hash:n.hash||Z++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},t.DEFAULT_SETTINGS,n),"undefined"==typeof this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for("undefined"!=typeof V[this.hash]&&t.console.warn("Hash "+this.hash+" has already been used."),V[this.hash]={fsBoundsDelta:new t.Point(1,1),
prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=t.now(),t.EventSource.call(this),this.addHandler("open-failed",function(e){var n=t.getString("Errors.OpenFailed",e.eventSource,e.message);a._showMessage(n)}),t.ControlDock.call(this,n),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=t.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(t){t.width="100%",t.height="100%",t.overflow="hidden",t.position="absolute",t.top="0px",t.left="0px"}(this.canvas.style),t.setElementTouchActionNone(this.canvas),""!==n.tabIndex&&(this.canvas.tabIndex=n.tabIndex===undefined?0:n.tabIndex),this.container.className="openseadragon-container",function(t){t.width="100%",t.height="100%",t.position="relative",t.overflow="hidden",t.left="0px",t.top="0px",t.textAlign="left"}(this.container.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new t.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:t.delegate(this,d),keyHandler:t.delegate(this,f),clickHandler:t.delegate(this,p),dblClickHandler:t.delegate(this,m),dragHandler:t.delegate(this,g),dragEndHandler:t.delegate(this,v),enterHandler:t.delegate(this,y),exitHandler:t.delegate(this,b),pressHandler:t.delegate(this,_),releaseHandler:t.delegate(this,x),nonPrimaryPressHandler:t.delegate(this,w),nonPrimaryReleaseHandler:t.delegate(this,S),scrollHandler:t.delegate(this,E),pinchHandler:t.delegate(this,k)}),this.outerTracker=new t.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:t.delegate(this,T),exitHandler:t.delegate(this,C)}),this.toolbar&&(this.toolbar=new t.ControlDock({element:this.toolbar})),this.bindStandardControls(),V[this.hash].prevContainerSize=e(this.container),this.world=new t.World({viewer:this}),this.world.addHandler("add-item",function(){a.source=a.world.getItemAt(0).source,V[a.hash].forceRedraw=!0,a._updateRequestId||(a._updateRequestId=o(a,L))}),this.world.addHandler("remove-item",function(){a.world.getItemCount()?a.source=a.world.getItemAt(0).source:a.source=null,V[a.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(){a.viewport&&a.viewport._setContentBounds(a.world.getHomeBounds(),a.world.getContentFactor())}),this.world.addHandler("item-index-change",function(){a.source=a.world.getItemAt(0).source}),this.viewport=new t.Viewport({containerSize:V[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new t.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:n.timeout}),this.tileCache=new t.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new t.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=t.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(i=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(i,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(i=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(i,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new t.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),i=0;i<this.customControls.length;i++)this.addControl(this.customControls[i].id,{anchor:this.customControls[i].anchor});t.requestAnimationFrame(function(){s(a)})},t.extend(t.Viewer.prototype,t.EventSource.prototype,t.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(e){return t.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(e)},openTileSource:function(e){return t.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(e)},open:function(e,n){var r=this;if(this.close(),e){if(this.sequenceMode&&t.isArray(e))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),void 0===n||isNaN(n)||(this.initialPage=n),this.tileSources=e,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),void this._updateSequenceButtons(this._sequenceIndex);if(t.isArray(e)||(e=[e]),e.length){this._opening=!0;for(var o,a=e.length,s=0,c=0,u=function(){if(s+c===a)if(s){!r._firstOpen&&r.preserveViewport||(r.viewport.goHome(!0),r.viewport.update()),r._firstOpen=!1;var t=e[0];if(t.tileSource&&(t=t.tileSource),r.overlays&&!r.preserveOverlays)for(var n=0;n<r.overlays.length;n++)r.currentOverlays[n]=i(r,r.overlays[n]);r._drawOverlays(),r._opening=!1,r.raiseEvent("open",{source:t})}else r._opening=!1,r.raiseEvent("open-failed",o)},l=function(e){t.isPlainObject(e)&&e.tileSource||(e={tileSource:e}),e.index!==undefined&&(t.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete e.index),e.collectionImmediately===undefined&&(e.collectionImmediately=!0);var n=e.success;e.success=function(t){if(s++,e.tileSource.overlays)for(var i=0;i<e.tileSource.overlays.length;i++)r.addOverlay(e.tileSource.overlays[i]);n&&n(t),u()};var i=e.error;e.error=function(t){c++,o||(o=t),i&&i(t),u()},r.addTiledImage(e)},h=0;h<e.length;h++)l(e[h]);return this}}},close:function(){return V[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),V[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(V[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),null!==this._updateRequestId&&(t.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),V[this.hash]=null,delete V[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(t){return this.innerTracker.setTracking(t),this.outerTracker.setTracking(t),this.raiseEvent("mouse-enabled",{enabled:t}),this},areControlsEnabled:function(){var t,e=this.controls.length;for(t=0;t<this.controls.length;t++)e=e&&this.controls[t].isVisibile();return e},setControlsEnabled:function(t){return t?u(this):s(this),this.raiseEvent("controls-enabled",{enabled:t}),this},setDebugMode:function(t){for(var e=0;e<this.world.getItemCount();e++)this.world.getItemAt(e).debugMode=t;this.debugMode=t,this.forceRedraw()},isFullPage:function(){return V[this.hash].fullPage},setFullPage:function(e){var n,i,r=document.body,o=r.style,a=document.documentElement.style,s=this;if(e==this.isFullPage())return this;var c={fullPage:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",c),c.preventDefaultAction)return this;if(e){for(this.elementSize=t.getElementSize(this.element),this.pageScroll=t.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=o.margin,this.docMargin=a.margin,o.margin="0",a.margin="0",this.bodyPadding=o.padding,this.docPadding=a.padding,o.padding="0",a.padding="0",this.bodyWidth=o.width,this.docWidth=a.width,o.width="100%",a.width="100%",this.bodyHeight=o.height,this.docHeight=a.height,o.height="100%",a.height="100%",this.previousBody=[],V[this.hash].prevElementParent=this.element.parentNode,V[this.hash].prevNextSibling=this.element.nextSibling,V[this.hash].prevElementWidth=this.element.style.width,V[this.hash].prevElementHeight=this.element.style.height,n=r.childNodes.length,i=0;i<n;i++)this.previousBody.push(r.childNodes[0]),r.removeChild(r.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,r.appendChild(this.toolbar.element),t.addClass(this.toolbar.element,"fullpage")),t.addClass(this.element,"fullpage"),r.appendChild(this.element),this.element.style.height=t.getWindowSize().y+"px",this.element.style.width=t.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=t.getElementSize(this.element).y-t.getElementSize(this.toolbar.element).y+"px"),V[this.hash].fullPage=!0,t.delegate(this,T)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,o.margin=this.bodyMargin,a.margin=this.docMargin,o.padding=this.bodyPadding,a.padding=this.docPadding,o.width=this.bodyWidth,a.width=this.docWidth,o.height=this.bodyHeight,a.height=this.docHeight,r.removeChild(this.element),n=this.previousBody.length,i=0;i<n;i++)r.appendChild(this.previousBody.shift());t.removeClass(this.element,"fullpage"),V[this.hash].prevElementParent.insertBefore(this.element,V[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(r.removeChild(this.toolbar.element),t.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=V[this.hash].prevElementWidth,this.element.style.height=V[this.hash].prevElementHeight;var u=0,l=function(){t.setPageScroll(s.pageScroll);var e=t.getPageScroll();++u<10&&(e.x!==s.pageScroll.x||e.y!==s.pageScroll.y)&&t.requestAnimationFrame(l)};t.requestAnimationFrame(l),V[this.hash].fullPage=!1,t.delegate(this,C)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:e}),this},setFullScreen:function(e){var n=this;if(!t.supportsFullScreen)return this.setFullPage(e);if(t.isFullScreen()===e)return this;var i={fullScreen:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",i),i.preventDefaultAction)return this;if(e){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var r=function(){var e=t.isFullScreen();e||(t.removeEvent(document,t.fullScreenEventName,r),t.removeEvent(document,t.fullScreenErrorEventName,r),n.setFullPage(!1),n.isFullPage()&&(n.element.style.width=n.fullPageStyleWidth,n.element.style.height=n.fullPageStyleHeight)),n.navigator&&n.viewport&&n.navigator.update(n.viewport),n.raiseEvent("full-screen",{fullScreen:e})};t.addEvent(document,t.fullScreenEventName,r),t.addEvent(document,t.fullScreenErrorEventName,r),t.requestFullScreen(document.body)}else t.exitFullScreen();return this},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(t){return this.container.style.visibility=t?"":"hidden",this.raiseEvent("visible",{visible:t}),this},addTiledImage:function(e){function i(t){for(var n=0;n<a._loadQueue.length;n++)if(a._loadQueue[n]===s){a._loadQueue.splice(n,1);break}0===a._loadQueue.length&&r(s),a.raiseEvent("add-item-failed",t),e.error&&e.error(t)}function r(t){a.collectionMode&&(a.world.arrange({immediately:t.options.collectionImmediately,rows:a.collectionRows,columns:a.collectionColumns,layout:a.collectionLayout,tileSize:a.collectionTileSize,tileMargin:a.collectionTileMargin}),a.world.setAutoRefigureSizes(!0))}function o(){for(var e,n,i;a._loadQueue.length&&(e=a._loadQueue[0]).tileSource;){if(a._loadQueue.splice(0,1),e.options.replace){var o=a.world.getIndexOfItem(e.options.replaceItem);-1!=o&&(e.options.index=o),a.world.removeItem(e.options.replaceItem)}n=new t.TiledImage({viewer:a,source:e.tileSource,viewport:a.viewport,drawer:a.drawer,tileCache:a.tileCache,imageLoader:a.imageLoader,x:e.options.x,y:e.options.y,width:e.options.width,height:e.options.height,fitBounds:e.options.fitBounds,fitBoundsPlacement:e.options.fitBoundsPlacement,clip:e.options.clip,placeholderFillStyle:e.options.placeholderFillStyle,opacity:e.options.opacity,preload:e.options.preload,degrees:e.options.degrees,compositeOperation:e.options.compositeOperation,springStiffness:a.springStiffness,animationTime:a.animationTime,minZoomImageRatio:a.minZoomImageRatio,wrapHorizontal:a.wrapHorizontal,wrapVertical:a.wrapVertical,immediateRender:a.immediateRender,blendTime:a.blendTime,alwaysBlend:a.alwaysBlend,minPixelRatio:a.minPixelRatio,smoothTileEdgesMinZoom:a.smoothTileEdgesMinZoom,iOSDevice:a.iOSDevice,crossOriginPolicy:e.options.crossOriginPolicy,ajaxWithCredentials:e.options.ajaxWithCredentials,loadTilesWithAjax:e.options.loadTilesWithAjax,ajaxHeaders:e.options.ajaxHeaders,debugMode:a.debugMode}),a.collectionMode&&a.world.setAutoRefigureSizes(!1),a.world.addItem(n,{index:e.options.index}),0===a._loadQueue.length&&r(e),1!==a.world.getItemCount()||a.preserveViewport||a.viewport.goHome(!0),a.navigator&&(i=t.extend({},e.options,{replace:!1,originalTiledImage:n,tileSource:e.tileSource}),a.navigator.addTiledImage(i)),e.options.success&&e.options.success({item:n})}}t.console.assert(e,"[Viewer.addTiledImage] options is required"),t.console.assert(e.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),t.console.assert(!e.replace||e.index>-1&&e.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var a=this;e.replace&&(e.replaceItem=a.world.getItemAt(e.index)),this._hideMessage(),e.placeholderFillStyle===undefined&&(e.placeholderFillStyle=this.placeholderFillStyle),e.opacity===undefined&&(e.opacity=this.opacity),e.preload===undefined&&(e.preload=this.preload),e.compositeOperation===undefined&&(e.compositeOperation=this.compositeOperation),e.crossOriginPolicy===undefined&&(e.crossOriginPolicy=e.tileSource.crossOriginPolicy!==undefined?e.tileSource.crossOriginPolicy:this.crossOriginPolicy),e.ajaxWithCredentials===undefined&&(e.ajaxWithCredentials=this.ajaxWithCredentials),e.loadTilesWithAjax===undefined&&(e.loadTilesWithAjax=this.loadTilesWithAjax),e.ajaxHeaders===undefined||null===e.ajaxHeaders?e.ajaxHeaders=this.ajaxHeaders:t.isPlainObject(e.ajaxHeaders)&&t.isPlainObject(this.ajaxHeaders)&&(e.ajaxHeaders=t.extend({},this.ajaxHeaders,e.ajaxHeaders));var s={options:e};t.isArray(e.tileSource)?setTimeout(function(){i({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:e.tileSource,options:e})}):(this._loadQueue.push(s),n(this,e.tileSource,e,function(t){s.tileSource=t,o()},function(t){t.options=e,i(t),o()}))},addSimpleImage:function(e){t.console.assert(e,"[Viewer.addSimpleImage] options is required"),t.console.assert(e.url,"[Viewer.addSimpleImage] options.url is required");var n=t.extend({},e,{tileSource:{type:"image",url:e.url}});delete n.url,this.addTiledImage(n)},addLayer:function(e){var n=this;t.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var i=t.extend({},e,{success:function(t){n.raiseEvent("add-layer",{options:e,drawer:t.item})},error:function(t){n.raiseEvent("add-layer-failed",t)}});return this.addTiledImage(i),this},getLayerAtLevel:function(e){return t.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(e)},getLevelOfLayer:function(e){return t.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(e)},getLayersCount:function(){return t.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(e,n){return t.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(e,n)},removeLayer:function(e){return t.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(e)},forceRedraw:function(){return V[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var e=t.delegate(this,l),n=t.delegate(this,h),i=t.delegate(this,W),r=t.delegate(this,q),o=this.navImages,a=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(a=!1),this.previousButton=new t.Button({element:this.previousButton?t.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.PreviousPage"),srcRest:N(this.prefixUrl,o.previous.REST),srcGroup:N(this.prefixUrl,o.previous.GROUP),srcHover:N(this.prefixUrl,o.previous.HOVER),srcDown:N(this.prefixUrl,o.previous.DOWN),onRelease:r,onFocus:e,onBlur:n}),this.nextButton=new t.Button({element:this.nextButton?t.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.NextPage"),srcRest:N(this.prefixUrl,o.next.REST),srcGroup:N(this.prefixUrl,o.next.GROUP),srcHover:N(this.prefixUrl,o.next.HOVER),srcDown:N(this.prefixUrl,o.next.DOWN),onRelease:i,onFocus:e,onBlur:n}),this.navPrevNextWrap||this.previousButton.disable(),this.tileSources&&this.tileSources.length||this.nextButton.disable(),a&&(this.paging=new t.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:t.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||t.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var e=t.delegate(this,R),n=t.delegate(this,D),i=t.delegate(this,M),r=t.delegate(this,I),o=t.delegate(this,F),a=t.delegate(this,j),s=t.delegate(this,H),c=t.delegate(this,$),u=t.delegate(this,U),d=t.delegate(this,l),f=t.delegate(this,h),p=this.navImages,m=[],g=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton)&&(g=!1),this.showZoomControl&&(m.push(this.zoomInButton=new t.Button({element:this.zoomInButton?t.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomIn"),srcRest:N(this.prefixUrl,p.zoomIn.REST),srcGroup:N(this.prefixUrl,p.zoomIn.GROUP),srcHover:N(this.prefixUrl,p.zoomIn.HOVER),srcDown:N(this.prefixUrl,p.zoomIn.DOWN),onPress:e,onRelease:n,onClick:i,onEnter:e,onExit:n,onFocus:d,onBlur:f})),m.push(this.zoomOutButton=new t.Button({element:this.zoomOutButton?t.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomOut"),srcRest:N(this.prefixUrl,p.zoomOut.REST),srcGroup:N(this.prefixUrl,p.zoomOut.GROUP),srcHover:N(this.prefixUrl,p.zoomOut.HOVER),srcDown:N(this.prefixUrl,p.zoomOut.DOWN),onPress:r,onRelease:n,onClick:o,onEnter:r,onExit:n,onFocus:d,onBlur:f}))),this.showHomeControl&&m.push(this.homeButton=new t.Button({element:this.homeButton?t.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.Home"),srcRest:N(this.prefixUrl,p.home.REST),srcGroup:N(this.prefixUrl,p.home.GROUP),srcHover:N(this.prefixUrl,p.home.HOVER),srcDown:N(this.prefixUrl,p.home.DOWN),onRelease:a,onFocus:d,onBlur:f})),this.showFullPageControl&&m.push(this.fullPageButton=new t.Button({element:this.fullPageButton?t.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.FullPage"),srcRest:N(this.prefixUrl,p.fullpage.REST),srcGroup:N(this.prefixUrl,p.fullpage.GROUP),srcHover:N(this.prefixUrl,p.fullpage.HOVER),srcDown:N(this.prefixUrl,p.fullpage.DOWN),onRelease:s,onFocus:d,onBlur:f})),this.showRotationControl&&(m.push(this.rotateLeftButton=new t.Button({element:this.rotateLeftButton?t.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateLeft"),srcRest:N(this.prefixUrl,p.rotateleft.REST),srcGroup:N(this.prefixUrl,p.rotateleft.GROUP),srcHover:N(this.prefixUrl,p.rotateleft.HOVER),srcDown:N(this.prefixUrl,p.rotateleft.DOWN),onRelease:c,onFocus:d,onBlur:f})),m.push(this.rotateRightButton=new t.Button({element:this.rotateRightButton?t.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateRight"),srcRest:N(this.prefixUrl,p.rotateright.REST),srcGroup:N(this.prefixUrl,p.rotateright.GROUP),srcHover:N(this.prefixUrl,p.rotateright.HOVER),srcDown:N(this.prefixUrl,p.rotateright.DOWN),onRelease:u,onFocus:d,onBlur:f}))),g&&(this.buttons=new t.ButtonGroup({buttons:m,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",t.delegate(this,z)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(t){return this.tileSources&&t>=0&&t<this.tileSources.length&&(this.raiseEvent("page",{page:t}),this._sequenceIndex=t,this._updateSequenceButtons(t),this.open(this.tileSources[t]),this.referenceStrip&&this.referenceStrip.setFocus(t)),this},addOverlay:function(e,n,o,a){var s;if(s=t.isPlainObject(e)?e:{element:e,location:n,placement:o,onDraw:a},e=t.getElement(s.element),r(this.currentOverlays,e)>=0)return this;var c=i(this,s);return this.currentOverlays.push(c),c.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:e,location:s.location,placement:s.placement}),this},updateOverlay:function(e,n,i){var o;return e=t.getElement(e),(o=r(this.currentOverlays,e))>=0&&(this.currentOverlays[o].update(n,i),V[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:e,location:n,placement:i})),this},removeOverlay:function(e){var n;return e=t.getElement(e),(n=r(this.currentOverlays,e))>=0&&(this.currentOverlays[n].destroy(),this.currentOverlays.splice(n,1),V[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:e})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return V[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(e){var n;return e=t.getElement(e),(n=r(this.currentOverlays,e))>=0?this.currentOverlays[n]:null},_updateSequenceButtons:function(t){this.nextButton&&(this.tileSources&&this.tileSources.length-1!==t?this.nextButton.enable():this.navPrevNextWrap||this.nextButton.disable()),this.previousButton&&(t>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(e){this._hideMessage();var n=t.makeNeutralElement("div");n.appendChild(document.createTextNode(e)),this.messageDiv=t.makeCenteredNode(n),t.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var t=this.messageDiv;t&&(t.parentNode.removeChild(t),delete this.messageDiv)},gestureSettingsByDeviceType:function(t){switch(t){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var t,e=this.currentOverlays.length;for(t=0;t<e;t++)this.currentOverlays[t].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new t.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else t.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}})}(OpenSeadragon),function(t){function e(t){t.quick&&this.viewer.viewport&&(this.viewer.viewport.panTo(this.viewport.pointFromPixel(t.position)),this.viewer.viewport.applyConstraints())}function n(t){this.viewer.viewport&&(this.panHorizontal||(t.delta.x=0),this.panVertical||(t.delta.y=0),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(t.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function i(t){t.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function r(t){return this.viewer.raiseEvent("navigator-scroll",{tracker:t.eventSource,position:t.position,scroll:t.scroll,shift:t.shift,originalEvent:t.originalEvent}),!1}function o(t,e){t.style.webkitTransform="rotate("+e+"deg)",t.style.mozTransform="rotate("+e+"deg)",t.style.msTransform="rotate("+e+"deg)",t.style.oTransform="rotate("+e+"deg)",t.style.transform="rotate("+e+"deg)"}t.Navigator=function(a){function s(t){o(h.displayRegionContainer,t),o(h.displayRegion,-t),h.viewport.setRotation(t)}var c,u,l=a.viewer,h=this;if(a.id?(this.element=document.getElementById(a.id),a.controlOptions={anchor:t.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(a.id="navigator-"+t.now(),this.element=t.makeNeutralElement("div"),a.controlOptions={anchor:t.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:a.autoFade},a.position&&("BOTTOM_RIGHT"==a.position?a.controlOptions.anchor=t.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==a.position?a.controlOptions.anchor=t.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==a.position?a.controlOptions.anchor=t.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==a.position?a.controlOptions.anchor=t.ControlAnchor.TOP_LEFT:"ABSOLUTE"==a.position&&(a.controlOptions.anchor=t.ControlAnchor.ABSOLUTE,a.controlOptions.top=a.top,a.controlOptions.left=a.left,a.controlOptions.height=a.height,a.controlOptions.width=a.width))),this.element.id=a.id,this.element.className+=" navigator",a=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.navigatorSizeRatio},a,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:a.autoResize,minZoomImageRatio:1}),a.minPixelRatio=this.minPixelRatio=l.minPixelRatio,t.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new t.Point(1,1),this.totalBorderWidths=new t.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),a.controlOptions.anchor!=t.ControlAnchor.NONE&&function(t,e){t.margin="0px",t.border=e+"px solid #555",t.padding="0px",t.background="#000",t.opacity=.8,t.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=t.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(t,e){t.position="relative",t.top="0px",t.left="0px",t.fontSize="0px",t.overflow="hidden",t.border=e+"px solid #900",t.margin="0px",t.padding="0px",t.background="transparent",t["float"]="left",t.cssFloat="left",t.styleFloat="left",t.zIndex=999999999,t.cursor="default"}(this.displayRegion.style,this.borderWidth),this.displayRegionContainer=t.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",l.addControl(this.element,a.controlOptions),this._resizeWithViewer=a.controlOptions.anchor!=t.ControlAnchor.ABSOLUTE&&a.controlOptions.anchor!=t.ControlAnchor.NONE,this._resizeWithViewer&&(a.width&&a.height?(this.element.style.height="number"==typeof a.height?a.height+"px":a.height,this.element.style.width="number"==typeof a.width?a.width+"px":a.width):(c=t.getElementSize(l.element),this.element.style.height=Math.round(c.y*a.sizeRatio)+"px",this.element.style.width=Math.round(c.x*a.sizeRatio)+"px",this.oldViewerSize=c),u=t.getElementSize(this.element),this.elementArea=u.x*u.y),this.oldContainerSize=new t.Point(0,0),t.Viewer.apply(this,[a]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer),a.navigatorRotate){s(a.viewer.viewport?a.viewer.viewport.getRotation():a.viewer.degrees||0),a.viewer.addHandler("rotate",function(t){s(t.degrees)})}this.innerTracker.destroy(),this.innerTracker=new t.MouseTracker({element:this.element,dragHandler:t.delegate(this,n),clickHandler:t.delegate(this,e),releaseHandler:t.delegate(this,i),scrollHandler:t.delegate(this,r)}),this.addHandler("reset-size",function(){h.viewport&&h.viewport.goHome(!0)}),l.world.addHandler("item-index-change",function(t){window.setTimeout(function(){var e=h.world.getItemAt(t.previousIndex);h.world.setItemIndex(e,t.newIndex)},1)}),l.world.addHandler("remove-item",function(t){var e=t.item,n=h._getMatchingItem(e);n&&h.world.removeItem(n)}),this.update(l.viewport)},t.extend(t.Navigator.prototype,t.EventSource.prototype,t.Viewer.prototype,{updateSize:function(){if(this.viewport){var e=new t.Point(0===this.container.clientWidth?1:this.container.clientWidth,0===this.container.clientHeight?1:this.container.clientHeight);e.equals(this.oldContainerSize)||(this.viewport.resize(e,!0),this.viewport.goHome(!0),this.oldContainerSize=e,this.drawer.clear(),this.world.draw())}},update:function(e){var n,i,r,o,a,s;if(n=t.getElementSize(this.viewer.element),this._resizeWithViewer&&n.x&&n.y&&!n.equals(this.oldViewerSize)&&(this.oldViewerSize=n,this.maintainSizeRatio||!this.elementArea?(i=n.x*this.sizeRatio,r=n.y*this.sizeRatio):(i=Math.sqrt(this.elementArea*(n.x/n.y)),r=this.elementArea/i),this.element.style.width=Math.round(i)+"px",this.element.style.height=Math.round(r)+"px",this.elementArea||(this.elementArea=i*r),this.updateSize()),e&&this.viewport){o=e.getBoundsNoRotate(!0),a=this.viewport.pixelFromPointNoRotate(o.getTopLeft(),!1),
s=this.viewport.pixelFromPointNoRotate(o.getBottomRight(),!1).minus(this.totalBorderWidths);var c=this.displayRegion.style;c.display=this.world.getItemCount()?"block":"none",c.top=Math.round(a.y)+"px",c.left=Math.round(a.x)+"px";var u=Math.abs(a.x-s.x),l=Math.abs(a.y-s.y);c.width=Math.round(Math.max(u,0))+"px",c.height=Math.round(Math.max(l,0))+"px"}},addTiledImage:function(e){var n=this,i=e.originalTiledImage;delete e.original;var r=t.extend({},e,{success:function(t){function e(){n._matchBounds(a,i)}function r(){n._matchOpacity(a,i)}function o(){n._matchCompositeOperation(a,i)}var a=t.item;a._originalForNavigator=i,n._matchBounds(a,i,!0),i.addHandler("bounds-change",e),i.addHandler("clip-change",e),i.addHandler("opacity-change",r),i.addHandler("composite-operation-change",o)}});return t.Viewer.prototype.addTiledImage.apply(this,[r])},_getMatchingItem:function(t){for(var e,n=this.world.getItemCount(),i=0;i<n;i++)if((e=this.world.getItemAt(i))._originalForNavigator===t)return e;return null},_matchBounds:function(t,e,n){var i=e.getBoundsNoRotate();t.setPosition(i.getTopLeft(),n),t.setWidth(i.width,n),t.setRotation(e.getRotation(),n),t.setClip(e.getClip())},_matchOpacity:function(t,e){t.setOpacity(e.opacity)},_matchCompositeOperation:function(t,e){t.setCompositeOperation(e.compositeOperation)}})}(OpenSeadragon),function(t){var e={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right"}};t.extend(t,{getString:function(n){var i,r=n.split("."),o=null,a=arguments,s=e;for(i=0;i<r.length-1;i++)s=s[r[i]]||{};return"string"!=typeof(o=s[r[i]])&&(t.console.log("Untranslated source string:",n),o=""),o.replace(/\{\d+\}/g,function(t){var e=parseInt(t.match(/\d+/),10)+1;return e<a.length?a[e]:""})},setString:function(t,n){var i,r=t.split("."),o=e;for(i=0;i<r.length-1;i++)o[r[i]]||(o[r[i]]={}),o=o[r[i]];o[r[i]]=n}})}(OpenSeadragon),function(t){t.Point=function(t,e){this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0},t.Point.prototype={clone:function(){return new t.Point(this.x,this.y)},plus:function(e){return new t.Point(this.x+e.x,this.y+e.y)},minus:function(e){return new t.Point(this.x-e.x,this.y-e.y)},times:function(e){return new t.Point(this.x*e,this.y*e)},divide:function(e){return new t.Point(this.x/e,this.y/e)},negate:function(){return new t.Point(-this.x,-this.y)},distanceTo:function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},squaredDistanceTo:function(t){return Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)},apply:function(e){return new t.Point(e(this.x),e(this.y))},equals:function(e){return e instanceof t.Point&&this.x===e.x&&this.y===e.y},rotate:function(e,n){n=n||new t.Point(0,0);var i,r;if(e%90==0){switch(t.positiveModulo(e,360)){case 0:i=1,r=0;break;case 90:i=0,r=1;break;case 180:i=-1,r=0;break;case 270:i=0,r=-1}}else{var o=e*Math.PI/180;i=Math.cos(o),r=Math.sin(o)}var a=i*(this.x-n.x)-r*(this.y-n.y)+n.x,s=r*(this.x-n.x)+i*(this.y-n.y)+n.y;return new t.Point(a,s)},toString:function(){return"("+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+")"}}}(OpenSeadragon),function(t){function e(e){var n,i,r=e.responseText,o=e.status;if(!e)throw new Error(t.getString("Errors.Security"));if(200!==e.status&&0!==e.status)throw o=e.status,n=404==o?"Not Found":e.statusText,new Error(t.getString("Errors.Status",o,n));if(r.match(/\s*<.*/))try{i=e.responseXML&&e.responseXML.documentElement?e.responseXML:t.parseXml(r)}catch(a){i=e.responseText}else if(r.match(/\s*[\{\[].*/))try{i=t.parseJSON(r)}catch(a){i=r}else i=r;return i}t.TileSource=function(e){var n,i,r=this,o=arguments;if(n=t.isPlainObject(e)?e:{width:o[0],height:o[1],tileSize:o[2],tileOverlap:o[3],minLevel:o[4],maxLevel:o[5]},t.EventSource.call(this),t.extend(!0,this,n),!this.success)for(i=0;i<arguments.length;i++)if(t.isFunction(arguments[i])){this.success=arguments[i];break}this.success&&this.addHandler("ready",function(t){r.success(t)}),"string"==t.type(arguments[0])&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new t.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=n.width&&n.height?n.width/n.height:1,this.dimensions=new t.Point(n.width,n.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=n.tileOverlap?n.tileOverlap:0,this.minLevel=n.minLevel?n.minLevel:0,this.maxLevel=undefined!==n.maxLevel&&null!==n.maxLevel?n.maxLevel:n.width&&n.height?Math.ceil(Math.log(Math.max(n.width,n.height))/Math.log(2)):0,this.success&&t.isFunction(this.success)&&this.success(this))},t.TileSource.prototype={getTileSize:function(){return t.console.error("[TileSource.getTileSize] is deprecated.Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(t){return this._tileWidth?this._tileWidth:this.getTileSize(t)},getTileHeight:function(t){return this._tileHeight?this._tileHeight:this.getTileSize(t)},getLevelScale:function(t){var e,n={};for(e=0;e<=this.maxLevel;e++)n[e]=1/Math.pow(2,this.maxLevel-e);return this.getLevelScale=function(t){return n[t]},this.getLevelScale(t)},getNumTiles:function(e){var n=this.getLevelScale(e),i=Math.ceil(n*this.dimensions.x/this.getTileWidth(e)),r=Math.ceil(n*this.dimensions.y/this.getTileHeight(e));return new t.Point(i,r)},getPixelRatio:function(e){var n=this.dimensions.times(this.getLevelScale(e)),i=1/n.x,r=1/n.y;return new t.Point(i,r)},getClosestLevel:function(){var t,e;for(t=this.minLevel+1;t<=this.maxLevel&&!((e=this.getNumTiles(t)).x>1||e.y>1);t++);return t-1},getTileAtPoint:function(e,n){var i=n.x>=0&&n.x<=1&&n.y>=0&&n.y<=1/this.aspectRatio;t.console.assert(i,"[TileSource.getTileAtPoint] must be called with a valid point.");var r=this.dimensions.x*this.getLevelScale(e),o=n.x*r,a=n.y*r,s=Math.floor(o/this.getTileWidth(e)),c=Math.floor(a/this.getTileHeight(e));return n.x>=1&&(s=this.getNumTiles(e).x-1),n.y>=1/this.aspectRatio&&(c=this.getNumTiles(e).y-1),new t.Point(s,c)},getTileBounds:function(e,n,i){var r=this.dimensions.times(this.getLevelScale(e)),o=this.getTileWidth(e),a=this.getTileHeight(e),s=0===n?0:o*n-this.tileOverlap,c=0===i?0:a*i-this.tileOverlap,u=o+(0===n?1:2)*this.tileOverlap,l=a+(0===i?1:2)*this.tileOverlap,h=1/r.x;return u=Math.min(u,r.x-s),l=Math.min(l,r.y-c),new t.Rect(s*h,c*h,u*h,l*h)},getImageInfo:function(n){var i,r,o,a,s,c,u,l=this;n&&(u=(c=(s=n.split("/"))[s.length-1]).lastIndexOf("."))>-1&&(s[s.length-1]=c.slice(0,u)),r=function(e){"string"==typeof e&&(e=t.parseXml(e));var i=t.TileSource.determineType(l,e,n);i?((a=i.prototype.configure.apply(l,[e,n])).ajaxWithCredentials===undefined&&(a.ajaxWithCredentials=l.ajaxWithCredentials),o=new i(a),l.ready=!0,l.raiseEvent("ready",{tileSource:o})):l.raiseEvent("open-failed",{message:"Unable to load TileSource",source:n})},n.match(/\.js$/)?(i=n.split("/").pop().replace(".js",""),t.jsonp({url:n,async:!1,callbackName:i,callback:r})):t.makeAjaxRequest({url:n,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(t){var n=e(t);r(n)},error:function(t,e){var i;try{i="HTTP "+t.status+" attempting to load TileSource"}catch(o){var r;r=void 0!==e&&e.toString?e.toString():"Unknown error",i=r+" attempting to load TileSource"}l.raiseEvent("open-failed",{message:i,source:n})}})},supports:function(){return!1},configure:function(){throw new Error("Method not implemented.")},getTileUrl:function(){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(){return{}},tileExists:function(t,e,n){var i=this.getNumTiles(t);return t>=this.minLevel&&t<=this.maxLevel&&e>=0&&n>=0&&e<i.x&&n<i.y}},t.extend(!0,t.TileSource.prototype,t.EventSource.prototype),t.TileSource.determineType=function(e,n,i){var r;for(r in OpenSeadragon)if(r.match(/.+TileSource$/)&&t.isFunction(OpenSeadragon[r])&&t.isFunction(OpenSeadragon[r].prototype.supports)&&OpenSeadragon[r].prototype.supports.call(e,n,i))return OpenSeadragon[r];t.console.error("No TileSource was able to open %s %s",i,n)}}(OpenSeadragon),function(t){function e(e,i){if(!i||!i.documentElement)throw new Error(t.getString("Errors.Xml"));var r,o,a,s,c,u=i.documentElement,l=u.localName||u.tagName,h=i.documentElement.namespaceURI,d=null,f=[];if("Image"==l)try{if((s=u.getElementsByTagName("Size")[0])===undefined&&(s=u.getElementsByTagNameNS(h,"Size")[0]),d={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:u.getAttribute("Url"),Format:u.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(u.getAttribute("Overlap"),10),TileSize:parseInt(u.getAttribute("TileSize"),10),Size:{Height:parseInt(s.getAttribute("Height"),10),Width:parseInt(s.getAttribute("Width"),10)}}},!t.imageFormatSupported(d.Image.Format))throw new Error(t.getString("Errors.ImageFormat",d.Image.Format.toUpperCase()));for((r=u.getElementsByTagName("DisplayRect"))===undefined&&(r=u.getElementsByTagNameNS(h,"DisplayRect")[0]),c=0;c<r.length;c++)(a=(o=r[c]).getElementsByTagName("Rect")[0])===undefined&&(a=o.getElementsByTagNameNS(h,"Rect")[0]),f.push({Rect:{X:parseInt(a.getAttribute("X"),10),Y:parseInt(a.getAttribute("Y"),10),Width:parseInt(a.getAttribute("Width"),10),Height:parseInt(a.getAttribute("Height"),10),MinLevel:parseInt(o.getAttribute("MinLevel"),10),MaxLevel:parseInt(o.getAttribute("MaxLevel"),10)}});return f.length&&(d.Image.DisplayRect=f),n(e,d)}catch(m){throw m instanceof Error?m:new Error(t.getString("Errors.Dzi"))}else{if("Collection"==l)throw new Error(t.getString("Errors.Dzc"));if("Error"==l){var p=u.getElementsByTagName("Message")[0].firstChild.nodeValue;throw new Error(p)}}throw new Error(t.getString("Errors.Dzi"))}function n(e,n){var i,r,o=n.Image,a=o.Url,s=o.Format,c=o.Size,u=o.DisplayRect||[],l=parseInt(c.Width,10),h=parseInt(c.Height,10),d=parseInt(o.TileSize,10),f=parseInt(o.Overlap,10),p=[];for(r=0;r<u.length;r++)i=u[r].Rect,p.push(new t.DisplayRect(parseInt(i.X,10),parseInt(i.Y,10),parseInt(i.Width,10),parseInt(i.Height,10),parseInt(i.MinLevel,10),parseInt(i.MaxLevel,10)));return t.extend(!0,{width:l,height:h,tileSize:d,tileOverlap:f,minLevel:null,maxLevel:null,tilesUrl:a,fileFormat:s,displayRects:p},n)}t.DziTileSource=function(e){var n,i,r,o;if(o=t.isPlainObject(e)?e:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=o.tilesUrl,this.fileFormat=o.fileFormat,this.displayRects=o.displayRects,this.displayRects)for(n=this.displayRects.length-1;n>=0;n--)for(r=(i=this.displayRects[n]).minLevel;r<=i.maxLevel;r++)this._levelRects[r]||(this._levelRects[r]=[]),this._levelRects[r].push(i);t.TileSource.apply(this,[o])},t.extend(t.DziTileSource.prototype,t.TileSource.prototype,{supports:function(t){var e;return t.Image?e=t.Image.xmlns:t.documentElement&&("Image"!=t.documentElement.localName&&"Image"!=t.documentElement.tagName||(e=t.documentElement.namespaceURI)),-1!==(e=(e||"").toLowerCase()).indexOf("schemas.microsoft.com/deepzoom/2008")||-1!==e.indexOf("schemas.microsoft.com/deepzoom/2009")},configure:function(i,r){var o;return o=t.isPlainObject(i)?n(this,i):e(this,i),r&&!o.tilesUrl&&(o.tilesUrl=r.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),-1!=r.search(/\.(dzi|xml|js)\?/)?o.queryParams=r.match(/\?.*/):o.queryParams=""),o},getTileUrl:function(t,e,n){return[this.tilesUrl,t,"/",e,"_",n,".",this.fileFormat,this.queryParams].join("")},tileExists:function(t,e,n){var i,r,o,a,s,c,u,l=this._levelRects[t];if(!l||!l.length)return!0;for(u=l.length-1;u>=0;u--)if(i=l[u],!(t<i.minLevel||t>i.maxLevel)&&(r=this.getLevelScale(t),o=i.x*r,a=i.y*r,s=o+i.width*r,c=a+i.height*r,o=Math.floor(o/this._tileWidth),a=Math.floor(a/this._tileWidth),s=Math.ceil(s/this._tileWidth),c=Math.ceil(c/this._tileWidth),o<=e&&e<s&&a<=n&&n<c))return!0;return!1}})}(OpenSeadragon),function(t){function e(t){return!(-1!=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json"].indexOf(t[0]))||-1!=t.indexOf("sizeByW")}function n(t){for(var e=[],n=0;n<t.sizes.length;n++)e.push({url:t["@id"]+"/full/"+t.sizes[n].width+",/0/default.jpg",width:t.sizes[n].width,height:t.sizes[n].height});return e.sort(function(t,e){return t.width-e.width})}function i(e){if(!e||!e.documentElement)throw new Error(t.getString("Errors.Xml"));var n=e.documentElement,i=null;if("info"==n.tagName)try{return i={},r(n,i),i}catch(o){throw o instanceof Error?o:new Error(t.getString("Errors.IIIF"))}throw new Error(t.getString("Errors.IIIF"))}function r(e,n,i){var o,a;if(3==e.nodeType&&i)(a=e.nodeValue.trim()).match(/^\d*$/)&&(a=Number(a)),n[i]?(t.isArray(n[i])||(n[i]=[n[i]]),n[i].push(a)):n[i]=a;else if(1==e.nodeType)for(o=0;o<e.childNodes.length;o++)r(e.childNodes[o],n,e.nodeName)}t.IIIFTileSource=function(i){if(t.extend(!0,this,i),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(i.tileSizePerScaleFactor={},this.tile_width&&this.tile_height)i.tileWidth=this.tile_width,i.tileHeight=this.tile_height;else if(this.tile_width)i.tileSize=this.tile_width;else if(this.tile_height)i.tileSize=this.tile_height;else if(this.tiles)if(1==this.tiles.length)i.tileWidth=this.tiles[0].width,i.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var r=0;r<this.tiles.length;r++)for(var o=0;o<this.tiles[r].scaleFactors.length;o++){var a=this.tiles[r].scaleFactors[o];this.scale_factors.push(a),i.tileSizePerScaleFactor[a]={width:this.tiles[r].width,height:this.tiles[r].height||this.tiles[r].width}}}else if(e(i.profile)){for(var s=Math.min(this.height,this.width),c=[256,512,1024],u=[],l=0;l<c.length;l++)c[l]<=s&&u.push(c[l]);u.length>0?i.tileSize=Math.max.apply(null,u):i.tileSize=s}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,i.levels=n(this),t.extend(!0,i,{width:i.levels[i.levels.length-1].width,height:i.levels[i.levels.length-1].height,tileSize:Math.max(i.height,i.width),tileOverlap:0,minLevel:0,maxLevel:i.levels.length-1}),this.levels=i.levels):t.console.error("Nothing in the info.json to construct image pyramids from");i.maxLevel||this.emulateLegacyImagePyramid||(this.scale_factors?i.maxLevel=Math.floor(Math.pow(Math.max.apply(null,this.scale_factors),.5)):i.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)))),t.TileSource.apply(this,[i])},t.extend(t.IIIFTileSource.prototype,t.TileSource.prototype,{supports:function(t){return!(!t.protocol||"http://iiif.io/api/image"!=t.protocol)||(!(!t["@context"]||"http://library.stanford.edu/iiif/image-api/1.1/context.json"!=t["@context"]&&"http://iiif.io/api/image/1/context.json"!=t["@context"])||(!(!t.profile||0!==t.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html"))||(!!(t.identifier&&t.width&&t.height)||!(!t.documentElement||"info"!=t.documentElement.tagName||"http://library.stanford.edu/iiif/image-api/ns/"!=t.documentElement.namespaceURI))))},configure:function(e,n){if(t.isPlainObject(e))return e["@context"]?e:(e["@context"]="http://iiif.io/api/image/1.0/context.json",e["@id"]=n.replace("/info.json",""),e);var r=i(e);return r["@context"]="http://iiif.io/api/image/1.0/context.json",r["@id"]=n.replace("/info.xml",""),r},getTileWidth:function(e){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileWidth.call(this,e);var n=Math.pow(2,this.maxLevel-e);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[n]?this.tileSizePerScaleFactor[n].width:this._tileWidth},getTileHeight:function(e){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileHeight.call(this,e);var n=Math.pow(2,this.maxLevel-e);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[n]?this.tileSizePerScaleFactor[n].height:this._tileHeight},getLevelScale:function(e){if(this.emulateLegacyImagePyramid){var n=NaN;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].width/this.levels[this.maxLevel].width),n}return t.TileSource.prototype.getLevelScale.call(this,e)},getNumTiles:function(e){if(this.emulateLegacyImagePyramid){return this.getLevelScale(e)?new t.Point(1,1):new t.Point(0,0)}return t.TileSource.prototype.getNumTiles.call(this,e)},getTileAtPoint:function(e,n){return this.emulateLegacyImagePyramid?new t.Point(0,0):t.TileSource.prototype.getTileAtPoint.call(this,e,n)},getTileUrl:function(t,e,n){if(this.emulateLegacyImagePyramid){var i=null;return this.levels.length>0&&t>=this.minLevel&&t<=this.maxLevel&&(i=this.levels[t].url),i}var r,o,a,s,c,u,l,h,d,f,p,m="0",g=Math.pow(.5,this.maxLevel-t),v=Math.ceil(this.width*g),y=Math.ceil(this.height*g);return r=this.getTileWidth(t),o=this.getTileHeight(t),a=Math.ceil(r/g),s=Math.ceil(o/g),p=this["@context"].indexOf("/1.0/context.json")>-1||this["@context"].indexOf("/1.1/context.json")>-1||this["@context"].indexOf("/1/context.json")>-1?"native.jpg":"default.jpg",v<r&&y<o?(f=v+",",c="full"):(u=e*a,l=n*s,h=Math.min(a,this.width-u),d=Math.min(s,this.height-l),f=Math.ceil(h*g)+",",c=[u,l,h,d].join(",")),[this["@id"],c,f,m,p].join("/")}})}(OpenSeadragon),function(t){t.OsmTileSource=function(e){var n;(n=t.isPlainObject(e)?e:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]}).width&&n.height||(n.width=65572864,n.height=65572864),n.tileSize||(n.tileSize=256,n.tileOverlap=0),n.tilesUrl||(n.tilesUrl="http://tile.openstreetmap.org/"),n.minLevel=8,t.TileSource.apply(this,[n])},t.extend(t.OsmTileSource.prototype,t.TileSource.prototype,{supports:function(t){return t.type&&"openstreetmaps"==t.type},configure:function(t){return t},getTileUrl:function(t,e,n){return this.tilesUrl+(t-8)+"/"+e+"/"+n+".png"}})}(OpenSeadragon),function(t){t.TmsTileSource=function(e){var n;n=t.isPlainObject(e)?e:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var i,r=256*Math.ceil(n.width/256),o=256*Math.ceil(n.height/256);i=r>o?r/256:o/256,n.maxLevel=Math.ceil(Math.log(i)/Math.log(2))-1,n.tileSize=256,n.width=r,n.height=o,t.TileSource.apply(this,[n])},t.extend(t.TmsTileSource.prototype,t.TileSource.prototype,{supports:function(t){return t.type&&"tiledmapservice"==t.type},configure:function(t){return t},getTileUrl:function(t,e,n){var i=this.getNumTiles(t).y-1;return this.tilesUrl+t+"/"+e+"/"+(i-n)+".png"}})}(OpenSeadragon),function(t){t.ZoomifyTileSource=function(t){t.tileSize=256;var e={x:t.width,y:t.height};for(t.imageSizes=[{x:t.width,y:t.height}],t.gridSize=[this._getGridSize(t.width,t.height,t.tileSize)];parseInt(e.x,10)>t.tileSize||parseInt(e.y,10)>t.tileSize;)e.x=Math.floor(e.x/2),e.y=Math.floor(e.y/2),t.imageSizes.push({x:e.x,y:e.y}),t.gridSize.push(this._getGridSize(e.x,e.y,t.tileSize));t.imageSizes.reverse(),t.gridSize.reverse(),t.minLevel=0,t.maxLevel=t.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[t])},t.extend(t.ZoomifyTileSource.prototype,t.TileSource.prototype,{_getGridSize:function(t,e,n){return{x:Math.ceil(t/n),y:Math.ceil(e/n)}},_calculateAbsoluteTileNumber:function(t,e,n){for(var i=0,r={},o=0;o<t;o++)i+=(r=this.gridSize[o]).x*r.y;return r=this.gridSize[t],i+=r.x*n+e},supports:function(t){return t.type&&"zoomifytileservice"==t.type},configure:function(t){return t},getTileUrl:function(t,e,n){var i=0,r=this._calculateAbsoluteTileNumber(t,e,n);return i=Math.floor(r/256),this.tilesUrl+"TileGroup"+i+"/"+t+"-"+e+"-"+n+".jpg"}})}(OpenSeadragon),function(t){function e(e){var n,i,r=[];for(i=0;i<e.length;i++)(n=e[i]).height&&n.width&&n.url?r.push({url:n.url,width:Number(n.width),height:Number(n.height)}):t.console.error("Unsupported image format: %s",n.url?n.url:"<no URL>");return r.sort(function(t,e){return t.height-e.height})}function n(e,n){if(!n||!n.documentElement)throw new Error(t.getString("Errors.Xml"));var r,o,a=n.documentElement,s=a.tagName,c=null,u=[];if("image"==s)try{for(c={type:a.getAttribute("type"),levels:[]},u=a.getElementsByTagName("level"),o=0;o<u.length;o++)r=u[o],c.levels.push({url:r.getAttribute("url"),width:parseInt(r.getAttribute("width"),10),height:parseInt(r.getAttribute("height"),10)});return i(e,c)}catch(l){throw l instanceof Error?l:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==s)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==s)throw new Error("Error: "+n)}throw new Error("Unknown element "+s)}function i(t,e){return e.levels}t.LegacyTileSource=function(n){var i,r,o;t.isArray(n)&&(i={type:"legacy-image-pyramid",levels:n}),i.levels=e(i.levels),i.levels.length>0?(r=i.levels[i.levels.length-1].width,o=i.levels[i.levels.length-1].height):(r=0,o=0,t.console.error("No supported image formats found")),t.extend(!0,i,{width:r,height:o,tileSize:Math.max(o,r),tileOverlap:0,minLevel:0,maxLevel:i.levels.length>0?i.levels.length-1:0}),t.TileSource.apply(this,[i]),this.levels=i.levels},t.extend(t.LegacyTileSource.prototype,t.TileSource.prototype,{supports:function(t){return t.type&&"legacy-image-pyramid"==t.type||t.documentElement&&"legacy-image-pyramid"==t.documentElement.getAttribute("type")},configure:function(e){return t.isPlainObject(e)?i(this,e):n(this,e)},getLevelScale:function(t){var e=NaN;return this.levels.length>0&&t>=this.minLevel&&t<=this.maxLevel&&(e=this.levels[t].width/this.levels[this.maxLevel].width),e},getNumTiles:function(e){return this.getLevelScale(e)?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(t){var e=null;return this.levels.length>0&&t>=this.minLevel&&t<=this.maxLevel&&(e=this.levels[t].url),e}})}(OpenSeadragon),function(t){t.ImageTileSource=function(e){e=t.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},e),t.TileSource.apply(this,[e])},t.extend(t.ImageTileSource.prototype,t.TileSource.prototype,{supports:function(t){return t.type&&"image"===t.type},configure:function(t){return t},getImageInfo:function(e){var n=this._image=new Image,i=this;this.crossOriginPolicy&&(n.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(n.useCredentials=this.ajaxWithCredentials),t.addEvent(n,"load",function(){i.width=Object.prototype.hasOwnProperty.call(n,"naturalWidth")?n.naturalWidth:n.width,i.height=Object.prototype.hasOwnProperty.call(n,"naturalHeight")?n.naturalHeight:n.height,i.aspectRatio=i.width/i.height,i.dimensions=new t.Point(i.width,i.height),i._tileWidth=i.width,i._tileHeight=i.height,i.tileOverlap=0,i.minLevel=0,i.levels=i._buildLevels(),i.maxLevel=i.levels.length-1,i.ready=!0,i.raiseEvent("ready",{tileSource:i})}),t.addEvent(n,"error",function(){i.raiseEvent("open-failed",{message:"Error loading image at "+e,source:e})}),n.src=e},getLevelScale:function(t){var e=NaN;return t>=this.minLevel&&t<=this.maxLevel&&(e=this.levels[t].width/this.levels[this.maxLevel].width),e},getNumTiles:function(e){return this.getLevelScale(e)?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(t){var e=null;return t>=this.minLevel&&t<=this.maxLevel&&(e=this.levels[t].url),e},getContext2D:function(t){var e=null;return t>=this.minLevel&&t<=this.maxLevel&&(e=this.levels[t].context2D),e},_buildLevels:function(){var e=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!t.supportsCanvas||!this.useCanvas)return delete this._image,e;var n=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,i=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,r=document.createElement("canvas"),o=r.getContext("2d");if(r.width=n,r.height=i,o.drawImage(this._image,0,0,n,i),e[0].context2D=o,delete this._image,t.isCanvasTainted(r))return e;for(;n>=2&&i>=2;){n=Math.floor(n/2),i=Math.floor(i/2);var a=document.createElement("canvas"),s=a.getContext("2d");a.width=n,a.height=i,s.drawImage(r,0,0,n,i),e.splice(0,0,{context2D:s,width:n,height:i}),r=a,o=s}return e}})}(OpenSeadragon),function(t){t.TileSourceCollection=function(){t.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(t){function e(e){t.requestAnimationFrame(function(){n(e)})}function n(n){var i;n.shouldFade&&(i=1-(t.now()-n.fadeBeginTime)/n.fadeLength,i=Math.min(1,i),i=Math.max(0,i),n.imgGroup&&t.setElementOpacity(n.imgGroup,i,!0),i>0&&e(n))}function i(n){n.shouldFade=!0,n.fadeBeginTime=t.now()+n.fadeDelay,window.setTimeout(function(){e(n)},n.fadeDelay)}function r(e){e.shouldFade=!1,e.imgGroup&&t.setElementOpacity(e.imgGroup,1,!0)}function o(e,n){e.element.disabled||(n>=t.ButtonState.GROUP&&e.currentState==t.ButtonState.REST&&(r(e),e.currentState=t.ButtonState.GROUP),n>=t.ButtonState.HOVER&&e.currentState==t.ButtonState.GROUP&&(e.imgHover&&(e.imgHover.style.visibility=""),e.currentState=t.ButtonState.HOVER),n>=t.ButtonState.DOWN&&e.currentState==t.ButtonState.HOVER&&(e.imgDown&&(e.imgDown.style.visibility=""),e.currentState=t.ButtonState.DOWN))}function a(e,n){e.element.disabled||(n<=t.ButtonState.HOVER&&e.currentState==t.ButtonState.DOWN&&(e.imgDown&&(e.imgDown.style.visibility="hidden"),e.currentState=t.ButtonState.HOVER),n<=t.ButtonState.GROUP&&e.currentState==t.ButtonState.HOVER&&(e.imgHover&&(e.imgHover.style.visibility="hidden"),e.currentState=t.ButtonState.GROUP),n<=t.ButtonState.REST&&e.currentState==t.ButtonState.GROUP&&(i(e),e.currentState=t.ButtonState.REST))}t.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},t.Button=function(e){var n=this;t.EventSource.call(this),t.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},e),this.element=e.element||t.makeNeutralElement("div"),e.element||(this.imgRest=t.makeTransparentImage(this.srcRest),this.imgGroup=t.makeTransparentImage(this.srcGroup),this.imgHover=t.makeTransparentImage(this.srcHover),this.imgDown=t.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",t.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",t.Browser.vendor==t.BROWSERS.FIREFOX&&t.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=t.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new t.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){e.insideElementPressed?(o(n,t.ButtonState.DOWN),n.raiseEvent("enter",{originalEvent:e.originalEvent})):e.buttonDownAny||o(n,t.ButtonState.HOVER)},focusHandler:function(t){this.enterHandler(t),n.raiseEvent("focus",{originalEvent:t.originalEvent})},exitHandler:function(e){a(n,t.ButtonState.GROUP),e.insideElementPressed&&n.raiseEvent("exit",{originalEvent:e.originalEvent})},blurHandler:function(t){this.exitHandler(t),n.raiseEvent("blur",{originalEvent:t.originalEvent})},pressHandler:function(e){o(n,t.ButtonState.DOWN),n.raiseEvent("press",{originalEvent:e.originalEvent})},releaseHandler:function(e){e.insideElementPressed&&e.insideElementReleased?(a(n,t.ButtonState.HOVER),n.raiseEvent("release",{originalEvent:e.originalEvent})):e.insideElementPressed?a(n,t.ButtonState.GROUP):o(n,t.ButtonState.HOVER)},clickHandler:function(t){t.quick&&n.raiseEvent("click",{originalEvent:t.originalEvent})},keyHandler:function(t){return 13!==t.keyCode||(n.raiseEvent("click",{originalEvent:t.originalEvent}),n.raiseEvent("release",{originalEvent:t.originalEvent}),!1)}}),a(this,t.ButtonState.REST)},t.extend(t.Button.prototype,t.EventSource.prototype,{notifyGroupEnter:function(){o(this,t.ButtonState.GROUP)},notifyGroupExit:function(){a(this,t.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,t.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,t.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}})}(OpenSeadragon),function(t){t.ButtonGroup=function(e){t.extend(!0,this,{buttons:[],clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},e);var n,i=this.buttons.concat([]),r=this;if(this.element=e.element||t.makeNeutralElement("div"),!e.group)for(this.label=t.makeNeutralElement("label"),this.element.style.display="inline-block",this.element.appendChild(this.label),n=0;n<i.length;n++)this.element.appendChild(i[n].element);t.setElementTouchActionNone(this.element),this.tracker=new t.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(){var t;for(t=0;t<r.buttons.length;t++)r.buttons[t].notifyGroupEnter()},exitHandler:function(t){var e;if(!t.insideElementPressed)for(e=0;e<r.buttons.length;e++)r.buttons[e].notifyGroupExit()}})},t.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(t){t.Rect=function(e,n,i,r,o){this.x="number"==typeof e?e:0,this.y="number"==typeof n?n:0,this.width="number"==typeof i?i:0,this.height="number"==typeof r?r:0,this.degrees="number"==typeof o?o:0,this.degrees=t.positiveModulo(this.degrees,360);var a,s;this.degrees>=270?(a=this.getTopRight(),this.x=a.x,this.y=a.y,s=this.height,this.height=this.width,this.width=s,this.degrees-=270):this.degrees>=180?(a=this.getBottomRight(),this.x=a.x,this.y=a.y,this.degrees-=180):this.degrees>=90&&(a=this.getBottomLeft(),this.x=a.x,this.y=a.y,s=this.height,this.height=this.width,this.width=s,this.degrees-=90)},t.Rect.fromSummits=function(e,n,i){var r=e.distanceTo(n),o=e.distanceTo(i),a=n.minus(e),s=Math.atan(a.y/a.x);return a.x<0?s+=Math.PI:a.y<0&&(s+=2*Math.PI),new t.Rect(e.x,e.y,r,o,s/Math.PI*180)},t.Rect.prototype={clone:function(){return new t.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new t.Point(this.x,this.y)},getBottomRight:function(){return new t.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new t.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new t.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new t.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new t.Point(this.width,this.height)},equals:function(e){
return e instanceof t.Rect&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height&&this.degrees===e.degrees},times:function(e){return new t.Rect(this.x*e,this.y*e,this.width*e,this.height*e,this.degrees)},translate:function(e){return new t.Rect(this.x+e.x,this.y+e.y,this.width,this.height,this.degrees)},union:function(e){var n=this.getBoundingBox(),i=e.getBoundingBox(),r=Math.min(n.x,i.x),o=Math.min(n.y,i.y),a=Math.max(n.x+n.width,i.x+i.width),s=Math.max(n.y+n.height,i.y+i.height);return new t.Rect(r,o,a-r,s-o)},intersection:function(e){function n(e,n,r,o){var a=n.minus(e),s=o.minus(r),c=-s.x*a.y+a.x*s.y;if(0===c)return null;var u=(a.x*(e.y-r.y)-a.y*(e.x-r.x))/c,l=(s.x*(e.y-r.y)-s.y*(e.x-r.x))/c;return-i<=u&&u<=1-i&&-i<=l&&l<=1-i?new t.Point(e.x+l*a.x,e.y+l*a.y):null}var i=1e-10,r=[],o=this.getTopLeft();e.containsPoint(o,i)&&r.push(o);var a=this.getTopRight();e.containsPoint(a,i)&&r.push(a);var s=this.getBottomLeft();e.containsPoint(s,i)&&r.push(s);var c=this.getBottomRight();e.containsPoint(c,i)&&r.push(c);var u=e.getTopLeft();this.containsPoint(u,i)&&r.push(u);var l=e.getTopRight();this.containsPoint(l,i)&&r.push(l);var h=e.getBottomLeft();this.containsPoint(h,i)&&r.push(h);var d=e.getBottomRight();this.containsPoint(d,i)&&r.push(d);for(var f=this._getSegments(),p=e._getSegments(),m=0;m<f.length;m++)for(var g=f[m],v=0;v<p.length;v++){var y=p[v],b=n(g[0],g[1],y[0],y[1]);b&&r.push(b)}if(0===r.length)return null;for(var _=r[0].x,x=r[0].x,w=r[0].y,S=r[0].y,k=1;k<r.length;k++){var E=r[k];E.x<_&&(_=E.x),E.x>x&&(x=E.x),E.y<w&&(w=E.y),E.y>S&&(S=E.y)}return new t.Rect(_,w,x-_,S-w)},_getSegments:function(){var t=this.getTopLeft(),e=this.getTopRight(),n=this.getBottomLeft(),i=this.getBottomRight();return[[t,e],[e,i],[i,n],[n,t]]},rotate:function(e,n){if(0===(e=t.positiveModulo(e,360)))return this.clone();n=n||this.getCenter();var i=this.getTopLeft().rotate(e,n),r=this.getTopRight().rotate(e,n).minus(i);r=r.apply(function(t){var e=1e-15;return Math.abs(t)<e?0:t});var o=Math.atan(r.y/r.x);return r.x<0?o+=Math.PI:r.y<0&&(o+=2*Math.PI),new t.Rect(i.x,i.y,this.width,this.height,o/Math.PI*180)},getBoundingBox:function(){if(0===this.degrees)return this.clone();var e=this.getTopLeft(),n=this.getTopRight(),i=this.getBottomLeft(),r=this.getBottomRight(),o=Math.min(e.x,n.x,i.x,r.x),a=Math.max(e.x,n.x,i.x,r.x),s=Math.min(e.y,n.y,i.y,r.y),c=Math.max(e.y,n.y,i.y,r.y);return new t.Rect(o,s,a-o,c-s)},getIntegerBoundingBox:function(){var e=this.getBoundingBox(),n=Math.floor(e.x),i=Math.floor(e.y),r=Math.ceil(e.width+e.x-n),o=Math.ceil(e.height+e.y-i);return new t.Rect(n,i,r,o)},containsPoint:function(t,e){e=e||0;var n=this.getTopLeft(),i=this.getTopRight(),r=this.getBottomLeft(),o=i.minus(n),a=r.minus(n);return(t.x-n.x)*o.x+(t.y-n.y)*o.y>=-e&&(t.x-i.x)*o.x+(t.y-i.y)*o.y<=e&&(t.x-n.x)*a.x+(t.y-n.y)*a.y>=-e&&(t.x-r.x)*a.x+(t.y-r.y)*a.y<=e},toString:function(){return"["+Math.round(100*this.x)/100+", "+Math.round(100*this.y)/100+", "+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+", "+Math.round(100*this.degrees)/100+"deg]"}}}(OpenSeadragon),function(t){function e(e){var n=Number(this.element.style.marginLeft.replace("px","")),r=Number(this.element.style.marginTop.replace("px","")),o=Number(this.element.style.width.replace("px","")),a=Number(this.element.style.height.replace("px","")),s=t.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?-e.delta.x>0?n>-(o-s.x)&&(this.element.style.marginLeft=n+2*e.delta.x+"px",i(this,s.x,n+2*e.delta.x)):-e.delta.x<0&&n<0&&(this.element.style.marginLeft=n+2*e.delta.x+"px",i(this,s.x,n+2*e.delta.x)):-e.delta.y>0?r>-(a-s.y)&&(this.element.style.marginTop=r+2*e.delta.y+"px",i(this,s.y,r+2*e.delta.y)):-e.delta.y<0&&r<0&&(this.element.style.marginTop=r+2*e.delta.y+"px",i(this,s.y,r+2*e.delta.y))),!1}function n(e){var n=Number(this.element.style.marginLeft.replace("px","")),r=Number(this.element.style.marginTop.replace("px","")),o=Number(this.element.style.width.replace("px","")),a=Number(this.element.style.height.replace("px","")),s=t.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?e.scroll>0?n>-(o-s.x)&&(this.element.style.marginLeft=n-60*e.scroll+"px",i(this,s.x,n-60*e.scroll)):e.scroll<0&&n<0&&(this.element.style.marginLeft=n-60*e.scroll+"px",i(this,s.x,n-60*e.scroll)):e.scroll<0?r>s.y-a&&(this.element.style.marginTop=r+60*e.scroll+"px",i(this,s.y,r+60*e.scroll)):e.scroll>0&&r<0&&(this.element.style.marginTop=r+60*e.scroll+"px",i(this,s.y,r+60*e.scroll))),!1}function i(e,n,i){var r,o,a,s,c,u,l;for(r="horizontal"==e.scroll?e.panelWidth:e.panelHeight,o=Math.ceil(n/r)+5,u=o=(o=(a=Math.ceil((Math.abs(i)+n)/r)+1)-o)<0?0:o;u<a&&u<e.panels.length;u++)if(!(l=e.panels[u]).activePanel){var h,d=e.viewer.tileSources[u];h=d.referenceStripThumbnailUrl?{type:"image",url:d.referenceStripThumbnailUrl}:d,(s=new t.Viewer({id:l.id,tileSources:[h],element:l,navigatorSizeRatio:e.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0})).displayRegion=t.makeNeutralElement("div"),s.displayRegion.id=l.id+"-displayregion",s.displayRegion.className="displayregion",(c=s.displayRegion.style).position="relative",c.top="0px",c.left="0px",c.fontSize="0px",c.overflow="hidden",c["float"]="left",c.cssFloat="left",c.styleFloat="left",c.zIndex=999999999,c.cursor="default",c.width=e.panelWidth-4+"px",c.height=e.panelHeight-4+"px",s.displayRegion.innerTracker=new t.MouseTracker({element:s.displayRegion,startDisabled:!0}),l.getElementsByTagName("div")[0].appendChild(s.displayRegion),e.miniViewers[l.id]=s,l.activePanel=!0}}function r(t){var e=t.eventSource.element;return"horizontal"==this.scroll?e.style.marginBottom="0px":e.style.marginLeft="0px",!1}function o(e){var n=e.eventSource.element;return"horizontal"==this.scroll?n.style.marginBottom="-"+t.getElementSize(n).y/2+"px":n.style.marginLeft="-"+t.getElementSize(n).x/2+"px",!1}function a(t){if(t.preventDefaultAction||t.ctrl||t.alt||t.meta)return!0;switch(t.keyCode){case 38:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:case 37:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 39:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}function s(t){if(t.preventDefaultAction||t.ctrl||t.alt||t.meta)return!0;switch(t.keyCode){case 61:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:case 97:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}var c={};t.ReferenceStrip=function(u){var l,h,d,f=this,p=u.viewer,m=t.getElementSize(p.element);for(u.id||(u.id="referencestrip-"+t.now(),this.element=t.makeNeutralElement("div"),this.element.id=u.id,this.element.className="referencestrip"),u=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.referenceStripSizeRatio,position:t.DEFAULT_SETTINGS.referenceStripPosition,scroll:t.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold},u,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),t.extend(this,u),c[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,(h=this.element.style).marginTop="0px",h.marginRight="0px",h.marginBottom="0px",h.marginLeft="0px",h.left="0px",h.bottom="0px",h.border="0px",h.background="#000",h.position="relative",t.setElementTouchActionNone(this.element),t.setElementOpacity(this.element,.8),this.viewer=p,this.innerTracker=new t.MouseTracker({element:this.element,dragHandler:t.delegate(this,e),scrollHandler:t.delegate(this,n),enterHandler:t.delegate(this,r),exitHandler:t.delegate(this,o),keyDownHandler:t.delegate(this,a),keyHandler:t.delegate(this,s)}),u.width&&u.height?(this.element.style.width=u.width+"px",this.element.style.height=u.height+"px",p.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):"horizontal"==u.scroll?(this.element.style.width=m.x*u.sizeRatio*p.tileSources.length+12*p.tileSources.length+"px",this.element.style.height=m.y*u.sizeRatio+"px",p.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=m.y*u.sizeRatio*p.tileSources.length+12*p.tileSources.length+"px",this.element.style.width=m.x*u.sizeRatio+"px",p.addControl(this.element,{anchor:t.ControlAnchor.TOP_LEFT})),this.panelWidth=m.x*this.sizeRatio+8,this.panelHeight=m.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},d=0;d<p.tileSources.length;d++)(l=t.makeNeutralElement("div")).id=this.element.id+"-"+d,l.style.width=f.panelWidth+"px",l.style.height=f.panelHeight+"px",l.style.display="inline",l.style["float"]="left",l.style.cssFloat="left",l.style.styleFloat="left",l.style.padding="2px",t.setElementTouchActionNone(l),l.innerTracker=new t.MouseTracker({element:l,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(e){e.eventSource.dragging=t.now()},releaseHandler:function(e){var n=e.eventSource,i=n.element.id,r=Number(i.split("-")[2]),o=t.now();e.insideElementPressed&&e.insideElementReleased&&n.dragging&&o-n.dragging<n.clickTimeThreshold&&(n.dragging=null,p.goToPage(r))}}),this.element.appendChild(l),l.activePanel=!1,this.panels.push(l);i(this,"vertical"==this.scroll?m.y:m.x,0),this.setFocus(0)},t.extend(t.ReferenceStrip.prototype,t.EventSource.prototype,t.Viewer.prototype,{setFocus:function(e){var n,o=t.getElement(this.element.id+"-"+e),a=t.getElementSize(this.viewer.canvas),s=Number(this.element.style.width.replace("px","")),c=Number(this.element.style.height.replace("px","")),u=-Number(this.element.style.marginLeft.replace("px","")),l=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==o&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=o,this.currentSelected.style.background="#999","horizontal"==this.scroll?(n=Number(e)*(this.panelWidth+3))>u+a.x-this.panelWidth?(n=Math.min(n,s-a.x),this.element.style.marginLeft=-n+"px",i(this,a.x,-n)):n<u&&(n=Math.max(0,n-a.x/2),this.element.style.marginLeft=-n+"px",i(this,a.x,-n)):(n=Number(e)*(this.panelHeight+3))>l+a.y-this.panelHeight?(n=Math.min(n,c-a.y),this.element.style.marginTop=-n+"px",i(this,a.y,-n)):n<l&&(n=Math.max(0,n-a.y/2),this.element.style.marginTop=-n+"px",i(this,a.y,-n)),this.currentPage=e,r.call(this,{eventSource:this.innerTracker}))},update:function(){return!!c[this.id].animating&&(t.console.log("image reference strip update"),!0)},destroy:function(){if(this.miniViewers)for(var t in this.miniViewers)this.miniViewers[t].destroy();this.element&&this.element.parentNode.removeChild(this.element)}})}(OpenSeadragon),function(t){t.DisplayRect=function(e,n,i,r,o,a){t.Rect.apply(this,[e,n,i,r]),this.minLevel=o,this.maxLevel=a},t.extend(t.DisplayRect.prototype,t.Rect.prototype)}(OpenSeadragon),function(t){function e(t,e){return(1-Math.exp(t*-e))/(1-Math.exp(-t))}t.Spring=function(e){var n=arguments;"object"!=typeof e&&(e={initial:n.length&&"number"==typeof n[0]?n[0]:undefined,springStiffness:n.length>1?n[1].springStiffness:5,animationTime:n.length>1?n[1].animationTime:1.5}),t.console.assert("number"==typeof e.springStiffness&&0!==e.springStiffness,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),t.console.assert("number"==typeof e.animationTime&&e.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),e.exponential&&(this._exponential=!0,delete e.exponential),t.extend(!0,this,e),this.current={value:"number"==typeof this.initial?this.initial:this._exponential?0:1,time:t.now()},t.console.assert(!this._exponential||0!==this.current.value,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},t.Spring.prototype={resetTo:function(e){t.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=e,this.start.time=this.target.time=this.current.time=t.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(e){t.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=e,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(e){this.start.value+=e,this.target.value+=e,this._exponential&&(t.console.assert(0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(e){this._exponential=e,this._exponential&&(t.console.assert(0!==this.current.value&&0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=t.now();var n,i;this._exponential?(n=this.start._logValue,i=this.target._logValue):(n=this.start.value,i=this.target.value);var r=this.current.time>=this.target.time?i:n+(i-n)*e(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),o=this.current.value;return this._exponential?this.current.value=Math.exp(r):this.current.value=r,o!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}}}(OpenSeadragon),function(t){function e(e){t.extend(!0,this,{timeout:t.DEFAULT_SETTINGS.timeout,jobId:null},e),this.image=null}function n(t,e,n){t.jobsInProgress--,(!t.jobLimit||t.jobsInProgress<t.jobLimit)&&t.jobQueue.length>0&&(t.jobQueue.shift().start(),t.jobsInProgress++),n(e.image,e.errorMsg,e.request)}e.prototype={errorMsg:null,start:function(){var e=this,n=this.abort;this.image=new Image,this.image.onload=function(){e.finish(!0)},this.image.onabort=this.image.onerror=function(){e.errorMsg="Image load aborted",e.finish(!1)},this.jobId=window.setTimeout(function(){e.errorMsg="Image load exceeded timeout",e.finish(!1)},this.timeout),this.loadWithAjax?(this.request=t.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(t){var n;try{n=new window.Blob([t.response])}catch(a){var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if("TypeError"===a.name&&i){var r=new i;r.append(t.response),n=r.getBlob()}}0===n.size&&(e.errorMsg="Empty image response.",e.finish(!1));var o=(window.URL||window.webkitURL).createObjectURL(n);e.image.src=o},error:function(){e.errorMsg="Image load aborted - XHR error",e.finish(!1)}}),this.abort=function(){e.request.abort(),"function"==typeof n&&n()}):(!1!==this.crossOriginPolicy&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(t){this.image.onload=this.image.onerror=this.image.onabort=null,t||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},t.ImageLoader=function(e){t.extend(!0,this,{jobLimit:t.DEFAULT_SETTINGS.imageLoaderLimit,timeout:t.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},e)},t.ImageLoader.prototype={addJob:function(t){var i=this,r=function(e){n(i,e,t.callback)},o=new e({src:t.src,loadWithAjax:t.loadWithAjax,ajaxHeaders:t.loadWithAjax?t.ajaxHeaders:null,crossOriginPolicy:t.crossOriginPolicy,ajaxWithCredentials:t.ajaxWithCredentials,callback:r,abort:t.abort,timeout:this.timeout});!this.jobLimit||this.jobsInProgress<this.jobLimit?(o.start(),this.jobsInProgress++):this.jobQueue.push(o)},clear:function(){for(var t=0;t<this.jobQueue.length;t++){var e=this.jobQueue[t];"function"==typeof e.abort&&e.abort()}this.jobQueue=[]}}}(OpenSeadragon),function(t){t.Tile=function(t,e,n,i,r,o,a,s,c){this.level=t,this.x=e,this.y=n,this.bounds=i,this.exists=r,this.url=o,this.context2D=a,this.loadWithAjax=s,this.ajaxHeaders=c,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0},t.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(e){this.cacheImageRecord?this.loaded?(this.element||(this.element=t.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=e&&e.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",t.setElementOpacity(this.element,this.opacity)):t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString()):t.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString())},drawCanvas:function(e,n,i,r){var o,a=this.position.times(t.pixelDensityRatio),s=this.size.times(t.pixelDensityRatio);this.context2D||this.cacheImageRecord?(o=this.context2D||this.cacheImageRecord.getRenderedContext(),this.loaded&&o?(e.save(),e.globalAlpha=this.opacity,"number"==typeof i&&1!==i&&(a=a.times(i),s=s.times(i)),r instanceof t.Point&&(a=a.plus(r)),1===e.globalAlpha&&this._hasTransparencyChannel()&&e.clearRect(a.x+1,a.y+1,s.x-2,s.y-2),n({context:e,tile:this,rendered:o}),e.drawImage(o.canvas,0,0,o.canvas.width,o.canvas.height,a.x,a.y,s.x,s.y),e.restore()):t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())):t.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString())},getScaleForEdgeSmoothing:function(){var e;if(this.cacheImageRecord)e=this.cacheImageRecord.getRenderedContext();else{if(!this.context2D)return t.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;e=this.context2D}return e.canvas.width/(this.size.x*t.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(e,n,i){var r=Math.max(1,Math.ceil((i.x-n.x)/2)),o=Math.max(1,Math.ceil((i.y-n.y)/2));return new t.Point(r,o).minus(this.position.times(t.pixelDensityRatio).times(e||1).apply(function(t){return t%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(t){t.OverlayPlacement=t.Placement,t.OverlayRotationMode=t.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),t.Overlay=function(e,n,i){var r;r=t.isPlainObject(e)?e:{element:e,location:n,placement:i},this.element=r.element,this.style=r.element.style,this._init(r)},t.Overlay.prototype={_init:function(e){this.location=e.location,this.placement=e.placement===undefined?t.Placement.TOP_LEFT:e.placement,this.onDraw=e.onDraw,this.checkResize=e.checkResize===undefined||e.checkResize,this.width=e.width===undefined?null:e.width,this.height=e.height===undefined?null:e.height,this.rotationMode=e.rotationMode||t.OverlayRotationMode.EXACT,this.location instanceof t.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=t.Placement.TOP_LEFT),this.scales=null!==this.width&&null!==this.height,this.bounds=new t.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(e,n){var i=t.Placement.properties[this.placement];i&&(i.isHorizontallyCentered?e.x-=n.x/2:i.isRight&&(e.x-=n.x),i.isVerticallyCentered?e.y-=n.y/2:i.isBottom&&(e.y-=n.y))},destroy:function(){var e=this.element,n=this.style;e.parentNode&&(e.parentNode.removeChild(e),e.prevElementParent&&(n.display="none",document.body.appendChild(e))),this.onDraw=null,n.top="",n.left="",n.position="",null!==this.width&&(n.width=""),null!==this.height&&(n.height="");var i=t.getCssPropertyWithVendorPrefix("transformOrigin"),r=t.getCssPropertyWithVendorPrefix("transform");i&&r&&(n[i]="",n[r]="")},drawHTML:function(e,n){var i=this.element;i.parentNode!==e&&(i.prevElementParent=i.parentNode,i.prevNextSibling=i.nextSibling,e.appendChild(i),this.style.position="absolute",this.size=t.getElementSize(i));var r=this._getOverlayPositionAndSize(n),o=r.position,a=this.size=r.size,s=r.rotate;if(this.onDraw)this.onDraw(o,a,this.element);else{var c=this.style;c.left=o.x+"px",c.top=o.y+"px",null!==this.width&&(c.width=a.x+"px"),null!==this.height&&(c.height=a.y+"px");var u=t.getCssPropertyWithVendorPrefix("transformOrigin"),l=t.getCssPropertyWithVendorPrefix("transform");u&&l&&(s?(c[u]=this._getTransformOrigin(),c[l]="rotate("+s+"deg)"):(c[u]="",c[l]="")),"none"!==c.display&&(c.display="block")}},_getOverlayPositionAndSize:function(e){var n=e.pixelFromPoint(this.location,!0),i=this._getSizeInPixels(e);this.adjust(n,i);var r=0;if(e.degrees&&this.rotationMode!==t.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX&&null!==this.width&&null!==this.height){var o=new t.Rect(n.x,n.y,i.x,i.y),a=this._getBoundingBox(o,e.degrees);n=a.getTopLeft(),i=a.getSize()}else r=e.degrees;return{position:n,size:i,rotate:r}},_getSizeInPixels:function(e){var n=this.size.x,i=this.size.y;if(null!==this.width||null!==this.height){var r=e.deltaPixelsFromPointsNoRotate(new t.Point(this.width||0,this.height||0),!0);null!==this.width&&(n=r.x),null!==this.height&&(i=r.y)}if(this.checkResize&&(null===this.width||null===this.height)){var o=this.size=t.getElementSize(this.element);null===this.width&&(n=o.x),null===this.height&&(i=o.y)}return new t.Point(n,i)},_getBoundingBox:function(t,e){var n=this._getPlacementPoint(t);return t.rotate(e,n).getBoundingBox()},_getPlacementPoint:function(e){var n=new t.Point(e.x,e.y),i=t.Placement.properties[this.placement];return i&&(i.isHorizontallyCentered?n.x+=e.width/2:i.isRight&&(n.x+=e.width),i.isVerticallyCentered?n.y+=e.height/2:i.isBottom&&(n.y+=e.height)),n},_getTransformOrigin:function(){var e="",n=t.Placement.properties[this.placement];return n?(n.isLeft?e="left":n.isRight&&(e="right"),n.isTop?e+=" top":n.isBottom&&(e+=" bottom"),e):e},update:function(e,n){var i=t.isPlainObject(e)?e:{location:e,placement:n};this._init({location:i.location||this.location,placement:i.placement!==undefined?i.placement:this.placement,onDraw:i.onDraw||this.onDraw,checkResize:i.checkResize||this.checkResize,width:i.width!==undefined?i.width:this.width,height:i.height!==undefined?i.height:this.height,rotationMode:i.rotationMode||this.rotationMode})},getBounds:function(e){t.console.assert(e,"A viewport must now be passed to Overlay.getBounds.");var n=this.width,i=this.height;if(null===n||null===i){var r=e.deltaPointsFromPixelsNoRotate(this.size,!0);null===n&&(n=r.x),null===i&&(i=r.y)}var o=this.location.clone();return this.adjust(o,new t.Point(n,i)),this._adjustBoundsForRotation(e,new t.Rect(o.x,o.y,n,i))},_adjustBoundsForRotation:function(e,n){if(!e||0===e.degrees||this.rotationMode===t.OverlayRotationMode.EXACT)return n;if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX){if(null===this.width||null===this.height)return n;var i=this._getOverlayPositionAndSize(e);return e.viewerElementToViewportRectangle(new t.Rect(i.position.x,i.position.y,i.size.x,i.size.y))}return n.rotate(-e.degrees,this._getPlacementPoint(n))}}}(OpenSeadragon),function(t){t.Drawer=function(e){t.console.assert(e.viewer,"[Drawer] options.viewer is required");var n=arguments;if(t.isPlainObject(e)||(e={source:n[0],viewport:n[1],element:n[2]}),t.console.assert(e.viewport,"[Drawer] options.viewport is required"),t.console.assert(e.element,"[Drawer] options.element is required"),e.source&&t.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=e.viewer,this.viewport=e.viewport,this.debugGridColor=e.debugGridColor||t.DEFAULT_SETTINGS.debugGridColor,e.opacity&&t.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=t.supportsCanvas&&(!this.viewer||this.viewer.useCanvas),this.container=t.getElement(e.element),this.canvas=t.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var i=this._calculateCanvasSize();this.canvas.width=i.x,this.canvas.height=i.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",t.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas)},t.Drawer.prototype={addOverlay:function(e,n,i,r){return t.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(e,n,i,r),this},updateOverlay:function(e,n,i){return t.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(e,n,i),this},removeOverlay:function(e){return t.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(e),this},clearOverlays:function(){return t.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},setOpacity:function(e){t.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var n=this.viewer.world,i=0;i<n.getItemCount();i++)n.getItemAt(i).setOpacity(e);return this},getOpacity:function(){t.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var e=this.viewer.world,n=0,i=0;i<e.getItemCount();i++){var r=e.getItemAt(i).getOpacity();r>n&&(n=r)}return n},needsUpdate:function(){return t.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return t.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return t.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return t.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var t=this._calculateCanvasSize();if((this.canvas.width!=t.x||this.canvas.height!=t.y)&&(this.canvas.width=t.x,this.canvas.height=t.y,null!==this.sketchCanvas)){var e=this._calculateSketchCanvasSize();this.sketchCanvas.width=e.x,this.sketchCanvas.height=e.y}this._clear()}},_clear:function(t,e){if(this.useCanvas){var n=this._getContext(t);if(e)n.clearRect(e.x,e.y,e.width,e.height);else{var i=n.canvas;n.clearRect(0,0,i.width,i.height)}}},viewportToDrawerRectangle:function(e){var n=this.viewport.pixelFromPointNoRotate(e.getTopLeft(),!0),i=this.viewport.deltaPixelsFromPointsNoRotate(e.getSize(),!0);return new t.Rect(n.x*t.pixelDensityRatio,n.y*t.pixelDensityRatio,i.x*t.pixelDensityRatio,i.y*t.pixelDensityRatio)},drawTile:function(e,n,i,r,o){if(t.console.assert(e,"[Drawer.drawTile] tile is required"),t.console.assert(n,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var a=this._getContext(i);r=r||1,e.drawCanvas(a,n,r,o)}else e.drawHTML(this.canvas)},_getContext:function(t){var e=this.context;if(t){if(null===this.sketchCanvas){this.sketchCanvas=document.createElement("canvas");var n=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=n.x,this.sketchCanvas.height=n.y,this.sketchContext=this.sketchCanvas.getContext("2d"),0===this.viewport.getRotation()){var i=this;this.viewer.addHandler("rotate",function r(){if(0!==i.viewport.getRotation()){i.viewer.removeHandler("rotate",r);var t=i._calculateSketchCanvasSize();i.sketchCanvas.width=t.x,i.sketchCanvas.height=t.y}})}}e=this.sketchContext}return e},saveContext:function(t){this.useCanvas&&this._getContext(t).save()},restoreContext:function(t){this.useCanvas&&this._getContext(t).restore()},setClip:function(t,e){if(this.useCanvas){var n=this._getContext(e);n.beginPath(),n.rect(t.x,t.y,t.width,t.height),n.clip()}},drawRectangle:function(t,e,n){if(this.useCanvas){var i=this._getContext(n);i.save(),i.fillStyle=e,i.fillRect(t.x,t.y,t.width,t.height),i.restore()}},blendSketch:function(e,n,i,r){var o=e;if(t.isPlainObject(o)||(o={opacity:e,scale:n,translate:i,compositeOperation:r}),this.useCanvas&&this.sketchCanvas){e=o.opacity,r=o.compositeOperation;var a=o.bounds;if(this.context.save(),this.context.globalAlpha=e,r&&(this.context.globalCompositeOperation=r),a)a.x<0&&(a.width+=a.x,a.x=0),a.x+a.width>this.canvas.width&&(a.width=this.canvas.width-a.x),a.y<0&&(a.height+=a.y,a.y=0),a.y+a.height>this.canvas.height&&(a.height=this.canvas.height-a.y),this.context.drawImage(this.sketchCanvas,a.x,a.y,a.width,a.height,a.x,a.y,a.width,a.height);else{n=o.scale||1;var s=(i=o.translate)instanceof t.Point?i:new t.Point(0,0),c=0,u=0;if(i){var l=this.sketchCanvas.width-this.canvas.width,h=this.sketchCanvas.height-this.canvas.height;c=Math.round(l/2),u=Math.round(h/2)}this.context.drawImage(this.sketchCanvas,s.x-c*n,s.y-u*n,(this.canvas.width+2*c)*n,(this.canvas.height+2*u)*n,-c,-u,this.canvas.width+2*c,this.canvas.height+2*u)}this.context.restore()}},drawDebugInfo:function(e,n,i,r){if(this.useCanvas){var o=this.context;o.save(),o.lineWidth=2*t.pixelDensityRatio,o.font="small-caps bold "+13*t.pixelDensityRatio+"px arial",o.strokeStyle=this.debugGridColor,o.fillStyle=this.debugGridColor,0!==this.viewport.degrees&&this._offsetForRotation({degrees:this.viewport.degrees}),r.getRotation(!0)%360!=0&&this._offsetForRotation({degrees:r.getRotation(!0),point:r.viewport.pixelFromPointNoRotate(r._getRotationPoint(!0),!0)}),o.strokeRect(e.position.x*t.pixelDensityRatio,e.position.y*t.pixelDensityRatio,e.size.x*t.pixelDensityRatio,e.size.y*t.pixelDensityRatio);var a=(e.position.x+e.size.x/2)*t.pixelDensityRatio,s=(e.position.y+e.size.y/2)*t.pixelDensityRatio;o.translate(a,s),o.rotate(Math.PI/180*-this.viewport.degrees),o.translate(-a,-s),0===e.x&&0===e.y&&(o.fillText("Zoom: "+this.viewport.getZoom(),e.position.x*t.pixelDensityRatio,(e.position.y-30)*t.pixelDensityRatio),o.fillText("Pan: "+this.viewport.getBounds().toString(),e.position.x*t.pixelDensityRatio,(e.position.y-20)*t.pixelDensityRatio)),o.fillText("Level: "+e.level,(e.position.x+10)*t.pixelDensityRatio,(e.position.y+20)*t.pixelDensityRatio),o.fillText("Column: "+e.x,(e.position.x+10)*t.pixelDensityRatio,(e.position.y+30)*t.pixelDensityRatio),o.fillText("Row: "+e.y,(e.position.x+10)*t.pixelDensityRatio,(e.position.y+40)*t.pixelDensityRatio),o.fillText("Order: "+i+" of "+n,(e.position.x+10)*t.pixelDensityRatio,(e.position.y+50)*t.pixelDensityRatio),
o.fillText("Size: "+e.size.toString(),(e.position.x+10)*t.pixelDensityRatio,(e.position.y+60)*t.pixelDensityRatio),o.fillText("Position: "+e.position.toString(),(e.position.x+10)*t.pixelDensityRatio,(e.position.y+70)*t.pixelDensityRatio),0!==this.viewport.degrees&&this._restoreRotationChanges(),r.getRotation(!0)%360!=0&&this._restoreRotationChanges(),o.restore()}},debugRect:function(e){if(this.useCanvas){var n=this.context;n.save(),n.lineWidth=2*t.pixelDensityRatio,n.strokeStyle=this.debugGridColor,n.fillStyle=this.debugGridColor,n.strokeRect(e.x*t.pixelDensityRatio,e.y*t.pixelDensityRatio,e.width*t.pixelDensityRatio,e.height*t.pixelDensityRatio),n.restore()}},getCanvasSize:function(e){var n=this._getContext(e).canvas;return new t.Point(n.width,n.height)},getCanvasCenter:function(){return new t.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(e){var n=e.point?e.point.times(t.pixelDensityRatio):this.getCanvasCenter(),i=this._getContext(e.useSketch);i.save(),i.translate(n.x,n.y),i.rotate(Math.PI/180*e.degrees),i.translate(-n.x,-n.y)},_restoreRotationChanges:function(t){this._getContext(t).restore()},_calculateCanvasSize:function(){var e=t.pixelDensityRatio,n=this.viewport.getContainerSize();return{x:n.x*e,y:n.y*e}},_calculateSketchCanvasSize:function(){var t=this._calculateCanvasSize();if(0===this.viewport.getRotation())return t;var e=Math.ceil(Math.sqrt(t.x*t.x+t.y*t.y));return{x:e,y:e}}}}(OpenSeadragon),function(t){t.Viewport=function(e){var n=arguments;n.length&&n[0]instanceof t.Point&&(e={containerSize:n[0],contentSize:n[1],config:n[2]}),e.config&&(t.extend(!0,e,e.config),delete e.config),this._margins=t.extend({left:0,top:0,right:0,bottom:0},e.margins||{}),delete e.margins,t.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:t.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:t.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:t.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:t.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:t.DEFAULT_SETTINGS.maxZoomLevel,degrees:t.DEFAULT_SETTINGS.degrees,homeFillsViewer:t.DEFAULT_SETTINGS.homeFillsViewer},e),this._updateContainerInnerSize(),this.centerSpringX=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new t.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new t.Rect(0,0,1,1),1),this.goHome(!0),this.update()},t.Viewport.prototype={resetContentSize:function(e){return t.console.assert(e,"[Viewport.resetContentSize] contentSize is required"),t.console.assert(e instanceof t.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),t.console.assert(e.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),t.console.assert(e.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new t.Rect(0,0,1,e.y/e.x),e.x),this},setHomeBounds:function(e,n){t.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(e,n)},_setContentBounds:function(e,n){t.console.assert(e,"[Viewport._setContentBounds] bounds is required"),t.console.assert(e instanceof t.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),t.console.assert(e.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),t.console.assert(e.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=e.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(n),this._contentBounds=e.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(n),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:n,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var t=this._contentAspectRatio/this.getAspectRatio();return(this.homeFillsViewer?t>=1?t:1:t>=1?1:t)/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var e=this._contentBounds.getCenter(),n=1/this.getHomeZoom(),i=n/this.getAspectRatio();return new t.Rect(e.x-n/2,e.y-i/2,n,i)},goHome:function(t){return this.viewer&&this.viewer.raiseEvent("home",{immediately:t}),this.fitBounds(this.getHomeBounds(),t)},getMinZoom:function(){var t=this.getHomeZoom();return this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*t},getMaxZoom:function(){var t=this.maxZoomLevel;return t||(t=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,t/=this._contentBounds.width),Math.max(t,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new t.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return t.extend({},this._margins)},setMargins:function(e){t.console.assert("object"===t.type(e),"[Viewport.setMargins] margins must be an object"),this._margins=t.extend({left:0,top:0,right:0,bottom:0},e),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(t){return this.getBoundsNoRotate(t).rotate(-this.getRotation())},getBoundsNoRotate:function(e){var n=this.getCenter(e),i=1/this.getZoom(e),r=i/this.getAspectRatio();return new t.Rect(n.x-i/2,n.y-r/2,i,r)},getBoundsWithMargins:function(t){return this.getBoundsNoRotateWithMargins(t).rotate(-this.getRotation(),this.getCenter(t))},getBoundsNoRotateWithMargins:function(t){var e=this.getBoundsNoRotate(t),n=this._containerInnerSize.x*this.getZoom(t);return e.x-=this._margins.left/n,e.y-=this._margins.top/n,e.width+=(this._margins.left+this._margins.right)/n,e.height+=(this._margins.top+this._margins.bottom)/n,e},getCenter:function(e){var n,i,r,o,a,s,c,u,l=new t.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),h=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return e?l:this.zoomPoint?(n=this.pixelFromPoint(this.zoomPoint,!0),i=this.getZoom(),r=1/i,o=r/this.getAspectRatio(),a=new t.Rect(l.x-r/2,l.y-o/2,r,o),s=this._pixelFromPoint(this.zoomPoint,a),c=s.minus(n),u=c.divide(this._containerInnerSize.x*i),h.plus(u)):h},getZoom:function(t){return t?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(t){return Math.max(Math.min(t,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(e){var n=new t.Rect(e.x,e.y,e.width,e.height);if(this.wrapHorizontal);else{var i=this.visibilityRatio*n.width,r=n.x+n.width,o=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,a=this._contentBoundsNoRotate.x-r+i,s=o-n.x-i;i>this._contentBoundsNoRotate.width?n.x+=(a+s)/2:s<0?n.x+=s:a>0&&(n.x+=a)}if(this.wrapVertical);else{var c=this.visibilityRatio*n.height,u=n.y+n.height,l=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,h=this._contentBoundsNoRotate.y-u+c,d=l-n.y-c;c>this._contentBoundsNoRotate.height?n.y+=(h+d)/2:d<0?n.y+=d:h>0&&(n.y+=h)}return n},_raiseConstraintsEvent:function(t){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:t})},applyConstraints:function(t){var e=this.getZoom(),n=this._applyZoomConstraints(e);e!==n&&this.zoomTo(n,this.zoomPoint,t);var i=this.getBoundsNoRotate(),r=this._applyBoundaryConstraints(i);return this._raiseConstraintsEvent(t),(i.x!==r.x||i.y!==r.y||t)&&this.fitBounds(r.rotate(-this.getRotation()),t),this},ensureVisible:function(t){return this.applyConstraints(t)},_fitBounds:function(e,n){var i=(n=n||{}).immediately||!1,r=n.constraints||!1,o=this.getAspectRatio(),a=e.getCenter(),s=new t.Rect(e.x,e.y,e.width,e.height,e.degrees+this.getRotation()).getBoundingBox();s.getAspectRatio()>=o?s.height=s.width/o:s.width=s.height*o,s.x=a.x-s.width/2,s.y=a.y-s.height/2;var c=1/s.width;if(r){var u=s.getAspectRatio(),l=this._applyZoomConstraints(c);c!==l&&(c=l,s.width=1/c,s.x=a.x-s.width/2,s.height=s.width/u,s.y=a.y-s.height/2),a=(s=this._applyBoundaryConstraints(s)).getCenter(),this._raiseConstraintsEvent(i)}if(i)return this.panTo(a,!0),this.zoomTo(c,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var h=this.getBounds(),d=this.getZoom();if(0===d||Math.abs(c/d-1)<1e-8)return this.zoomTo(c,!0),this.panTo(a,i);var f=(s=s.rotate(-this.getRotation())).getTopLeft().times(c).minus(h.getTopLeft().times(d)).divide(c-d);return this.zoomTo(c,f,i)},fitBounds:function(t,e){return this._fitBounds(t,{immediately:e,constraints:!1})},fitBoundsWithConstraints:function(t,e){return this._fitBounds(t,{immediately:e,constraints:!0})},fitVertically:function(e){var n=new t.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(n,e)},fitHorizontally:function(e){var n=new t.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(n,e)},getConstrainedBounds:function(t){var e;return e=this.getBounds(t),this._applyBoundaryConstraints(e)},panBy:function(e,n){var i=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(i.plus(e),n)},panTo:function(t,e){return e?(this.centerSpringX.resetTo(t.x),this.centerSpringY.resetTo(t.y)):(this.centerSpringX.springTo(t.x),this.centerSpringY.springTo(t.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:t,immediately:e}),this},zoomBy:function(t,e,n){return this.zoomTo(this.zoomSpring.target.value*t,e,n)},zoomTo:function(e,n,i){var r=this;return this.zoomPoint=n instanceof t.Point&&!isNaN(n.x)&&!isNaN(n.y)?n:null,i?this._adjustCenterSpringsForZoomPoint(function(){r.zoomSpring.resetTo(e)}):this.zoomSpring.springTo(e),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:e,refPoint:n,immediately:i}),this},setRotation:function(e){return this.viewer&&this.viewer.drawer.canRotate()?(this.degrees=t.positiveModulo(e,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:e}),this):this},getRotation:function(){return this.degrees},resize:function(t,e){var n,i=this.getBoundsNoRotate(),r=i;return this.containerSize.x=t.x,this.containerSize.y=t.y,this._updateContainerInnerSize(),e&&(n=t.x/this.containerSize.x,r.width=i.width*n,r.height=r.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:t,maintain:e}),this.fitBounds(r,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new t.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var t=this;this._adjustCenterSpringsForZoomPoint(function(){t.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var e=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,e},_adjustCenterSpringsForZoomPoint:function(t){if(this.zoomPoint){var e=this.pixelFromPoint(this.zoomPoint,!0);t();var n=this.pixelFromPoint(this.zoomPoint,!0).minus(e),i=this.deltaPointsFromPixels(n,!0);this.centerSpringX.shiftBy(i.x),this.centerSpringY.shiftBy(i.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else t()},deltaPixelsFromPointsNoRotate:function(t,e){return t.times(this._containerInnerSize.x*this.getZoom(e))},deltaPixelsFromPoints:function(t,e){return this.deltaPixelsFromPointsNoRotate(t.rotate(this.getRotation()),e)},deltaPointsFromPixelsNoRotate:function(t,e){return t.divide(this._containerInnerSize.x*this.getZoom(e))},deltaPointsFromPixels:function(t,e){return this.deltaPointsFromPixelsNoRotate(t,e).rotate(-this.getRotation())},pixelFromPointNoRotate:function(t,e){return this._pixelFromPointNoRotate(t,this.getBoundsNoRotate(e))},pixelFromPoint:function(t,e){return this._pixelFromPoint(t,this.getBoundsNoRotate(e))},_pixelFromPointNoRotate:function(e,n){return e.minus(n.getTopLeft()).times(this._containerInnerSize.x/n.width).plus(new t.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(t,e){return this._pixelFromPointNoRotate(t.rotate(this.getRotation(),this.getCenter(!0)),e)},pointFromPixelNoRotate:function(e,n){var i=this.getBoundsNoRotate(n);return e.minus(new t.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/i.width).plus(i.getTopLeft())},pointFromPixel:function(t,e){return this.pointFromPixelNoRotate(t,e).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(e,n){var i=this._contentBoundsNoRotate.width;return new t.Point(e*this._contentSizeNoRotate.x/i,n*this._contentSizeNoRotate.x/i)},viewportToImageCoordinates:function(e,n){if(e instanceof t.Point)return this.viewportToImageCoordinates(e.x,e.y);if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)t.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(1===i){return this.viewer.world.getItemAt(0).viewportToImageCoordinates(e,n,!0)}}return this._viewportToImageDelta(e-this._contentBoundsNoRotate.x,n-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(e,n){var i=this._contentBoundsNoRotate.width;return new t.Point(e/this._contentSizeNoRotate.x*i,n/this._contentSizeNoRotate.x*i)},imageToViewportCoordinates:function(e,n){if(e instanceof t.Point)return this.imageToViewportCoordinates(e.x,e.y);if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)t.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(1===i){return this.viewer.world.getItemAt(0).imageToViewportCoordinates(e,n,!0)}}var r=this._imageToViewportDelta(e,n);return r.x+=this._contentBoundsNoRotate.x,r.y+=this._contentBoundsNoRotate.y,r},imageToViewportRectangle:function(e,n,i,r){var o=e;if(o instanceof t.Rect||(o=new t.Rect(e,n,i,r)),this.viewer){var a=this.viewer.world.getItemCount();if(a>1)t.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(1===a){return this.viewer.world.getItemAt(0).imageToViewportRectangle(e,n,i,r,!0)}}var s=this.imageToViewportCoordinates(o.x,o.y),c=this._imageToViewportDelta(o.width,o.height);return new t.Rect(s.x,s.y,c.x,c.y,o.degrees)},viewportToImageRectangle:function(e,n,i,r){var o=e;if(o instanceof t.Rect||(o=new t.Rect(e,n,i,r)),this.viewer){var a=this.viewer.world.getItemCount();if(a>1)t.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(1===a){return this.viewer.world.getItemAt(0).viewportToImageRectangle(e,n,i,r,!0)}}var s=this.viewportToImageCoordinates(o.x,o.y),c=this._viewportToImageDelta(o.width,o.height);return new t.Rect(s.x,s.y,c.x,c.y,o.degrees)},viewerElementToImageCoordinates:function(t){var e=this.pointFromPixel(t,!0);return this.viewportToImageCoordinates(e)},imageToViewerElementCoordinates:function(t){var e=this.imageToViewportCoordinates(t);return this.pixelFromPoint(e,!0)},windowToImageCoordinates:function(e){t.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var n=e.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(n)},imageToWindowCoordinates:function(e){t.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");return this.imageToViewerElementCoordinates(e).plus(t.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(t){return this.pointFromPixel(t,!0)},viewportToViewerElementCoordinates:function(t){return this.pixelFromPoint(t,!0)},viewerElementToViewportRectangle:function(e){return t.Rect.fromSummits(this.pointFromPixel(e.getTopLeft(),!0),this.pointFromPixel(e.getTopRight(),!0),this.pointFromPixel(e.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(e){return t.Rect.fromSummits(this.pixelFromPoint(e.getTopLeft(),!0),this.pixelFromPoint(e.getTopRight(),!0),this.pixelFromPoint(e.getBottomLeft(),!0))},windowToViewportCoordinates:function(e){t.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var n=e.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(n)},viewportToWindowCoordinates:function(e){t.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");return this.viewportToViewerElementCoordinates(e).plus(t.getElementPosition(this.viewer.element))},viewportToImageZoom:function(e){if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)t.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(1===n){return this.viewer.world.getItemAt(0).viewportToImageZoom(e)}}var i=this._contentSizeNoRotate.x;return e*(this._containerInnerSize.x/i*this._contentBoundsNoRotate.width)},imageToViewportZoom:function(e){if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)t.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(1===n){return this.viewer.world.getItemAt(0).imageToViewportZoom(e)}}return e*(this._contentSizeNoRotate.x/this._containerInnerSize.x/this._contentBoundsNoRotate.width)}}}(OpenSeadragon),function(t){function e(t,e,i,r,o,a,s,c,u){var l=s.getBoundingBox().getTopLeft(),h=s.getBoundingBox().getBottomRight();t.viewer&&t.viewer.raiseEvent("update-level",{tiledImage:t,havedrawn:e,level:r,opacity:o,visibility:a,drawArea:s,topleft:l,bottomright:h,currenttime:c,best:u}),d(t.coverage,r),d(t.loadingCoverage,r);for(var f=t._getCornerTiles(r,l,h),p=f.topLeft,m=f.bottomRight,g=t.source.getNumTiles(r),v=t.viewport.pixelFromPoint(t.viewport.getCenter()),y=p.x;y<=m.x;y++)for(var b=p.y;b<=m.y;b++){if(!t.wrapHorizontal&&!t.wrapVertical){var _=t.source.getTileBounds(r,y,b);if(null===s.intersection(_))continue}u=n(t,i,e,y,b,r,o,a,v,g,c,u)}return u}function n(t,e,n,r,o,u,d,p,m,g,v,y){var b=i(r,o,u,t,t.source,t.tilesMatrix,v,g,t._worldWidthCurrent,t._worldHeightCurrent),_=n;t.viewer&&t.viewer.raiseEvent("update-tile",{tiledImage:t,tile:b}),h(t.coverage,u,r,o,!1);var x=b.loaded||b.loading||l(t.loadingCoverage,u,r,o);if(h(t.loadingCoverage,u,r,o,x),!b.exists)return y;if(e&&!_&&(l(t.coverage,u,r,o)?h(t.coverage,u,r,o,!0):_=!0),!_)return y;if(s(b,t.source.tileOverlap,t.viewport,m,p,t),!b.loaded)if(b.context2D)a(t,b);else{var w=t._tileCache.getImageRecord(b.cacheKey);if(w){a(t,b,w.getImage())}}if(b.loaded){c(t,b,r,o,u,d,v)&&(t._needsDraw=!0)}else b.loading?t._tilesLoading++:x||(y=f(y,b));return y}function i(e,n,i,r,o,a,s,c,u,l){var h,d,f,p,m,g,v,y;return a[i]||(a[i]={}),a[i][e]||(a[i][e]={}),a[i][e][n]||(h=(c.x+e%c.x)%c.x,d=(c.y+n%c.y)%c.y,f=o.getTileBounds(i,h,d),p=o.tileExists(i,h,d),m=o.getTileUrl(i,h,d),r.loadTilesWithAjax?(g=o.getTileAjaxHeaders(i,h,d),t.isPlainObject(r.ajaxHeaders)&&(g=t.extend({},r.ajaxHeaders,g))):g=null,v=o.getContext2D?o.getContext2D(i,h,d):undefined,f.x+=(e-h)/c.x,f.y+=l/u*((n-d)/c.y),a[i][e][n]=new t.Tile(i,e,n,f,p,m,v,r.loadTilesWithAjax,g)),y=a[i][e][n],y.lastTouchTime=s,y}function r(t,e,n){e.loading=!0,t._imageLoader.addJob({src:e.url,loadWithAjax:e.loadWithAjax,ajaxHeaders:e.ajaxHeaders,crossOriginPolicy:t.crossOriginPolicy,ajaxWithCredentials:t.ajaxWithCredentials,callback:function(i,r,a){o(t,e,n,i,r,a)},abort:function(){e.loading=!1}})}function o(e,n,i,r,o,s){if(!r)return t.console.log("Tile %s failed to load: %s - error: %s",n,n.url,o),e.viewer.raiseEvent("tile-load-failed",{tile:n,tiledImage:e,time:i,message:o,tileRequest:s}),n.loading=!1,void(n.exists=!1);if(i<e.lastResetTime)return t.console.log("Ignoring tile %s loaded before reset: %s",n,n.url),void(n.loading=!1);var c=function(){var t=e.source.getClosestLevel();a(e,n,r,t,s)};e._midDraw?window.setTimeout(c,1):c()}function a(t,e,n,i,r){function o(){return s++,a}function a(){0===--s&&(e.loading=!1,e.loaded=!0,e.context2D||t._tileCache.cacheTile({image:n,tile:e,cutoff:i,tiledImage:t}),t._needsDraw=!0)}var s=0;t.viewer.raiseEvent("tile-loaded",{tile:e,tiledImage:t,tileRequest:r,image:n,getCompletionCallback:o}),o()()}function s(e,n,i,r,o,a){var s=e.bounds.getTopLeft();s.x*=a._scaleSpring.current.value,s.y*=a._scaleSpring.current.value,s.x+=a._xSpring.current.value,s.y+=a._ySpring.current.value;var c=e.bounds.getSize();c.x*=a._scaleSpring.current.value,c.y*=a._scaleSpring.current.value;var u=i.pixelFromPointNoRotate(s,!0),l=i.pixelFromPointNoRotate(s,!1),h=i.deltaPixelsFromPointsNoRotate(c,!0),d=i.deltaPixelsFromPointsNoRotate(c,!1),f=l.plus(d.divide(2)),p=r.squaredDistanceTo(f);n||(h=h.plus(new t.Point(1,1))),e.position=u,e.size=h,e.squaredDistance=p,e.visibility=o}function c(t,e,n,i,r,o,a){var s,c,u=1e3*t.blendTime;if(e.blendStart||(e.blendStart=a),s=a-e.blendStart,c=u?Math.min(1,s/u):1,t.alwaysBlend&&(c*=o),e.opacity=c,t.lastDrawn.push(e),1==c)h(t.coverage,r,n,i,!0),t._hasOpaqueTile=!0;else if(s<u)return!0;return!1}function u(t,e,n,i){var r,o,a,s;if(!t[e])return!1;if(n===undefined||i===undefined){r=t[e];for(a in r)if(r.hasOwnProperty(a)){o=r[a];for(s in o)if(o.hasOwnProperty(s)&&!o[s])return!1}return!0}return t[e][n]===undefined||t[e][n][i]===undefined||!0===t[e][n][i]}function l(t,e,n,i){return n===undefined||i===undefined?u(t,e+1):u(t,e+1,2*n,2*i)&&u(t,e+1,2*n,2*i+1)&&u(t,e+1,2*n+1,2*i)&&u(t,e+1,2*n+1,2*i+1)}function h(e,n,i,r,o){e[n]?(e[n][i]||(e[n][i]={}),e[n][i][r]=o):t.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",n)}function d(t,e){t[e]={}}function f(t,e){return t?e.visibility>t.visibility?e:e.visibility==t.visibility&&e.squaredDistance<t.squaredDistance?e:t:e}function p(e,n){if(0!==e.opacity&&0!==n.length){var i,r,o=n[0],a=e.opacity<1||e.compositeOperation&&"source-over"!==e.compositeOperation||!e._isBottomItem()&&o._hasTransparencyChannel(),s=e.viewport.getZoom(!0),c=e.viewportToImageZoom(s);n.length>1&&c>e.smoothTileEdgesMinZoom&&!e.iOSDevice&&e.getRotation(!0)%360==0&&t.supportsCanvas&&(a=!0,i=o.getScaleForEdgeSmoothing(),r=o.getTranslationForEdgeSmoothing(i,e._drawer.getCanvasSize(!1),e._drawer.getCanvasSize(!0)));var u;a&&(i||(u=e.viewport.viewportToViewerElementRectangle(e.getClippedBounds(!0)).getIntegerBoundingBox().times(t.pixelDensityRatio)),e._drawer._clear(!0,u)),i||(0!==e.viewport.degrees&&e._drawer._offsetForRotation({degrees:e.viewport.degrees,useSketch:a}),e.getRotation(!0)%360!=0&&e._drawer._offsetForRotation({degrees:e.getRotation(!0),point:e.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),useSketch:a}));var l=!1;if(e._clip){e._drawer.saveContext(a);var h=e.imageToViewportRectangle(e._clip,!0);h=h.rotate(-e.getRotation(!0),e._getRotationPoint(!0));var d=e._drawer.viewportToDrawerRectangle(h);i&&(d=d.times(i)),r&&(d=d.translate(r)),e._drawer.setClip(d,a),l=!0}if(e.placeholderFillStyle&&!1===e._hasOpaqueTile){var f=e._drawer.viewportToDrawerRectangle(e.getBounds(!0));i&&(f=f.times(i)),r&&(f=f.translate(r));var p=null;p="function"==typeof e.placeholderFillStyle?e.placeholderFillStyle(e,e._drawer.context):e.placeholderFillStyle,e._drawer.drawRectangle(f,p,a)}for(var g=n.length-1;g>=0;g--)o=n[g],e._drawer.drawTile(o,e._drawingHandler,a,i,r),o.beingDrawn=!0,e.viewer&&e.viewer.raiseEvent("tile-drawn",{tiledImage:e,tile:o});l&&e._drawer.restoreContext(a),i||(e.getRotation(!0)%360!=0&&e._drawer._restoreRotationChanges(a),0!==e.viewport.degrees&&e._drawer._restoreRotationChanges(a)),a&&(i&&(0!==e.viewport.degrees&&e._drawer._offsetForRotation({degrees:e.viewport.degrees,useSketch:!1}),e.getRotation(!0)%360!=0&&e._drawer._offsetForRotation({degrees:e.getRotation(!0),point:e.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),useSketch:!1})),e._drawer.blendSketch({opacity:e.opacity,scale:i,translate:r,compositeOperation:e.compositeOperation,bounds:u}),i&&(e.getRotation(!0)%360!=0&&e._drawer._restoreRotationChanges(!1),0!==e.viewport.degrees&&e._drawer._restoreRotationChanges(!1))),m(e,n)}}function m(e,n){if(e.debugMode)for(var i=n.length-1;i>=0;i--){var r=n[i];try{e._drawer.drawDebugInfo(r,n.length,i,e)}catch(o){t.console.error(o)}}}t.TiledImage=function(e){var n=this;t.console.assert(e.tileCache,"[TiledImage] options.tileCache is required"),t.console.assert(e.drawer,"[TiledImage] options.drawer is required"),t.console.assert(e.viewer,"[TiledImage] options.viewer is required"),t.console.assert(e.imageLoader,"[TiledImage] options.imageLoader is required"),t.console.assert(e.source,"[TiledImage] options.source is required"),t.console.assert(!e.clip||e.clip instanceof t.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),t.EventSource.call(this),this._tileCache=e.tileCache,delete e.tileCache,this._drawer=e.drawer,delete e.drawer,this._imageLoader=e.imageLoader,delete e.imageLoader,e.clip instanceof t.Rect&&(this._clip=e.clip.clone()),delete e.clip;var i=e.x||0;delete e.x;var r=e.y||0;delete e.y,this.normHeight=e.source.dimensions.y/e.source.dimensions.x,this.contentAspectX=e.source.dimensions.x/e.source.dimensions.y;var o=1;e.width?(o=e.width,delete e.width,e.height&&(t.console.error("specifying both width and height to a tiledImage is not supported"),delete e.height)):e.height&&(o=e.height/this.normHeight,delete e.height);var a=e.fitBounds;delete e.fitBounds;var s=e.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete e.fitBoundsPlacement;var c=e.degrees||0;delete e.degrees,t.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,immediateRender:t.DEFAULT_SETTINGS.immediateRender,blendTime:t.DEFAULT_SETTINGS.blendTime,alwaysBlend:t.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:t.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:t.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:t.DEFAULT_SETTINGS.iOSDevice,debugMode:t.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:t.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:t.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:t.DEFAULT_SETTINGS.placeholderFillStyle,opacity:t.DEFAULT_SETTINGS.opacity,preload:t.DEFAULT_SETTINGS.preload,compositeOperation:t.DEFAULT_SETTINGS.compositeOperation},e),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new t.Spring({initial:i,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new t.Spring({initial:r,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new t.Spring({initial:o,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new t.Spring({initial:c,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),a&&this.fitBounds(a,s,!0),this._drawingHandler=function(e){n.viewer.raiseEvent("tile-drawing",t.extend({tiledImage:n},e))}},t.extend(t.TiledImage.prototype,t.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(t){t!==this._fullyLoaded&&(this._fullyLoaded=t,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=t.now(),this._needsDraw=!0},update:function(){var t=this._xSpring.update(),e=this._ySpring.update(),n=this._scaleSpring.update(),i=this._degreesSpring.update();return!!(t||e||n||i)&&(this._updateForScale(),this._needsDraw=!0,!0)},draw:function(){(0!==this.opacity||this._preload)&&(this._midDraw=!0,this._updateViewport(),this._midDraw=!1)},destroy:function(){this.reset()},getBounds:function(t){return this.getBoundsNoRotate(t).rotate(this.getRotation(t),this._getRotationPoint(t))},getBoundsNoRotate:function(e){return e?new t.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new t.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return t.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(e){var n=this.getBoundsNoRotate(e);if(this._clip){var i=(e?this._worldWidthCurrent:this._worldWidthTarget)/this.source.dimensions.x,r=this._clip.times(i);n=new t.Rect(n.x+r.x,n.y+r.y,r.width,r.height)}return n.rotate(this.getRotation(e),this._getRotationPoint(e))},getContentSize:function(){return new t.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(e,n,i){var r=i?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(e*(this.source.dimensions.x/r),n*(this.source.dimensions.y*this.contentAspectX/r))},viewportToImageCoordinates:function(e,n,i){var r;return e instanceof t.Point?(i=n,r=e):r=new t.Point(e,n),r=r.rotate(-this.getRotation(i),this._getRotationPoint(i)),i?this._viewportToImageDelta(r.x-this._xSpring.current.value,r.y-this._ySpring.current.value):this._viewportToImageDelta(r.x-this._xSpring.target.value,r.y-this._ySpring.target.value)},_imageToViewportDelta:function(e,n,i){var r=i?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(e/this.source.dimensions.x*r,n/this.source.dimensions.y/this.contentAspectX*r)},imageToViewportCoordinates:function(e,n,i){e instanceof t.Point&&(i=n,n=e.y,e=e.x);var r=this._imageToViewportDelta(e,n);return i?(r.x+=this._xSpring.current.value,r.y+=this._ySpring.current.value):(r.x+=this._xSpring.target.value,r.y+=this._ySpring.target.value),r.rotate(this.getRotation(i),this._getRotationPoint(i))},imageToViewportRectangle:function(e,n,i,r,o){var a=e;a instanceof t.Rect?o=n:a=new t.Rect(e,n,i,r);var s=this.imageToViewportCoordinates(a.getTopLeft(),o),c=this._imageToViewportDelta(a.width,a.height,o);return new t.Rect(s.x,s.y,c.x,c.y,a.degrees+this.getRotation(o))},viewportToImageRectangle:function(e,n,i,r,o){var a=e;e instanceof t.Rect?o=n:a=new t.Rect(e,n,i,r);var s=this.viewportToImageCoordinates(a.getTopLeft(),o),c=this._viewportToImageDelta(a.width,a.height,o);return new t.Rect(s.x,s.y,c.x,c.y,a.degrees-this.getRotation(o))},viewerElementToImageCoordinates:function(t){var e=this.viewport.pointFromPixel(t,!0);return this.viewportToImageCoordinates(e)},imageToViewerElementCoordinates:function(t){var e=this.imageToViewportCoordinates(t);return this.viewport.pixelFromPoint(e,!0)},windowToImageCoordinates:function(t){var e=t.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(e)},imageToWindowCoordinates:function(t){return this.imageToViewerElementCoordinates(t).plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(e){var n=this._scaleSpring.current.value;return e=e.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new t.Rect((e.x-this._xSpring.current.value)/n,(e.y-this._ySpring.current.value)/n,e.width/n,e.height/n,e.degrees)},viewportToImageZoom:function(t){return this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x*t},imageToViewportZoom:function(t){return t/(this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x)},setPosition:function(t,e){var n=this._xSpring.target.value===t.x&&this._ySpring.target.value===t.y;if(e){
if(n&&this._xSpring.current.value===t.x&&this._ySpring.current.value===t.y)return;this._xSpring.resetTo(t.x),this._ySpring.resetTo(t.y),this._needsDraw=!0}else{if(n)return;this._xSpring.springTo(t.x),this._ySpring.springTo(t.y),this._needsDraw=!0}n||this._raiseBoundsChange()},setWidth:function(t,e){this._setScale(t,e)},setHeight:function(t,e){this._setScale(t/this.normHeight,e)},fitBounds:function(e,n,i){n=n||t.Placement.CENTER;var r=t.Placement.properties[n],o=this.contentAspectX,a=0,s=0,c=1,u=1;if(this._clip&&(o=this._clip.getAspectRatio(),c=this._clip.width/this.source.dimensions.x,u=this._clip.height/this.source.dimensions.y,e.getAspectRatio()>o?(a=this._clip.x/this._clip.height*e.height,s=this._clip.y/this._clip.height*e.height):(a=this._clip.x/this._clip.width*e.width,s=this._clip.y/this._clip.width*e.width)),e.getAspectRatio()>o){var l=e.height/u,h=0;r.isHorizontallyCentered?h=(e.width-e.height*o)/2:r.isRight&&(h=e.width-e.height*o),this.setPosition(new t.Point(e.x-a+h,e.y-s),i),this.setHeight(l,i)}else{var d=e.width/c,f=0;r.isVerticallyCentered?f=(e.height-e.width/o)/2:r.isBottom&&(f=e.height-e.width/o),this.setPosition(new t.Point(e.x-a,e.y-s+f),i),this.setWidth(d,i)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(e){t.console.assert(!e||e instanceof t.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),e instanceof t.Rect?this._clip=e.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(t){t!==this.opacity&&(this.opacity=t,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(t){this._preload=!!t,this._needsDraw=!0},getRotation:function(t){return t?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(t,e){this._degreesSpring.target.value===t&&this._degreesSpring.isAtTargetValue()||(e?this._degreesSpring.resetTo(t):this._degreesSpring.springTo(t),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(t){return this.getBoundsNoRotate(t).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(t){t!==this.compositeOperation&&(this.compositeOperation=t,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(t,e){var n=this._scaleSpring.target.value===t;if(e){if(n&&this._scaleSpring.current.value===t)return;this._scaleSpring.resetTo(t),this._updateForScale(),this._needsDraw=!0}else{if(n)return;this._scaleSpring.springTo(t),this._updateForScale(),this._needsDraw=!0}n||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var t=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),e=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,n=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(e/this.minPixelRatio)/Math.log(2))));return t=Math.min(t,n),{lowestLevel:t,highestLevel:n}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){this.lastDrawn.pop().beingDrawn=!1}var n=this.viewport,i=this._viewportToTiledImageRectangle(n.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var o=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(null===(i=i.intersection(o)))return}for(var a=this._getLevelsInterval(),s=a.lowestLevel,c=a.highestLevel,l=null,h=!1,d=t.now(),f=c;f>=s;f--){var m=!1,g=n.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(f),!0).x*this._scaleSpring.current.value;if(f===s||!h&&g>=this.minPixelRatio)m=!0,h=!0;else if(!h)continue;var v=n.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(f),!1).x*this._scaleSpring.current.value,y=n.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,b=this.immediateRender?1:y;if(l=e(this,h,m,f,Math.min(1,(g-.5)/.5),b/Math.abs(b-v),i,d,l),u(this.coverage,f))break}p(this,this.lastDrawn),l&&!l.context2D?(r(this,l,d),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(0===this._tilesLoading)},_getCornerTiles:function(e,n,i){var r,o;this.wrapHorizontal?(r=t.positiveModulo(n.x,1),o=t.positiveModulo(i.x,1)):(r=Math.max(0,n.x),o=Math.min(1,i.x));var a,s,c=1/this.source.aspectRatio;this.wrapVertical?(a=t.positiveModulo(n.y,c),s=t.positiveModulo(i.y,c)):(a=Math.max(0,n.y),s=Math.min(c,i.y));var u=this.source.getTileAtPoint(e,new t.Point(r,a)),l=this.source.getTileAtPoint(e,new t.Point(o,s)),h=this.source.getNumTiles(e);return this.wrapHorizontal&&(u.x+=h.x*Math.floor(n.x),l.x+=h.x*Math.floor(i.x)),this.wrapVertical&&(u.y+=h.y*Math.floor(n.y/c),l.y+=h.y*Math.floor(i.y/c)),{topLeft:u,bottomRight:l}}})}(OpenSeadragon),function(t){var e=function(e){t.console.assert(e,"[TileCache.cacheTile] options is required"),t.console.assert(e.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(e.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=e.tile,this.tiledImage=e.tiledImage},n=function(e){t.console.assert(e,"[ImageRecord] options is required"),t.console.assert(e.image,"[ImageRecord] options.image is required"),this._image=e.image,this._tiles=[]};n.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var t=document.createElement("canvas");t.width=this._image.width,t.height=this._image.height,this._renderedContext=t.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(e){t.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=e},addTile:function(e){t.console.assert(e,"[ImageRecord.addTile] tile is required"),this._tiles.push(e)},removeTile:function(e){for(var n=0;n<this._tiles.length;n++)if(this._tiles[n]===e)return void this._tiles.splice(n,1);t.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",e)},getTileCount:function(){return this._tiles.length}},t.TileCache=function(e){e=e||{},this._maxImageCacheCount=e.maxImageCacheCount||t.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},t.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(i){t.console.assert(i,"[TileCache.cacheTile] options is required"),t.console.assert(i.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(i.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),t.console.assert(i.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var r=i.cutoff||0,o=this._tilesLoaded.length,a=this._imagesLoaded[i.tile.cacheKey];if(a||(t.console.assert(i.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),a=this._imagesLoaded[i.tile.cacheKey]=new n({image:i.image}),this._imagesLoadedCount++),a.addTile(i.tile),i.tile.cacheImageRecord=a,this._imagesLoadedCount>this._maxImageCacheCount){for(var s,c,u,l,h,d,f=null,p=-1,m=null,g=this._tilesLoaded.length-1;g>=0;g--)(s=(d=this._tilesLoaded[g]).tile).level<=r||s.beingDrawn||(f?(l=s.lastTouchTime,c=f.lastTouchTime,h=s.level,u=f.level,(l<c||l==c&&h>u)&&(f=s,p=g,m=d)):(f=s,p=g,m=d));f&&p>=0&&(this._unloadTile(m),o=p)}this._tilesLoaded[o]=new e({tile:i.tile,tiledImage:i.tiledImage})},clearTilesFor:function(e){t.console.assert(e,"[TileCache.clearTilesFor] tiledImage is required");for(var n,i=0;i<this._tilesLoaded.length;++i)(n=this._tilesLoaded[i]).tiledImage===e&&(this._unloadTile(n),this._tilesLoaded.splice(i,1),i--)},getImageRecord:function(e){return t.console.assert(e,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[e]},_unloadTile:function(e){t.console.assert(e,"[TileCache._unloadTile] tileRecord is required");var n=e.tile,i=e.tiledImage;n.unload(),n.cacheImageRecord=null;var r=this._imagesLoaded[n.cacheKey];r.removeTile(n),r.getTileCount()||(r.destroy(),delete this._imagesLoaded[n.cacheKey],this._imagesLoadedCount--),i.viewer.raiseEvent("tile-unloaded",{tile:n,tiledImage:i})}}}(OpenSeadragon),function(t){t.World=function(e){var n=this;t.console.assert(e.viewer,"[World] options.viewer is required"),t.EventSource.call(this),this.viewer=e.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(){n._autoRefigureSizes?n._figureSizes():n._needsSizesFigured=!0},this._figureSizes()},t.extend(t.World.prototype,t.EventSource.prototype,{addItem:function(e,n){if(t.console.assert(e,"[World.addItem] item is required"),t.console.assert(e instanceof t.TiledImage,"[World.addItem] only TiledImages supported at this time"),(n=n||{}).index!==undefined){var i=Math.max(0,Math.min(this._items.length,n.index));this._items.splice(i,0,e)}else this._items.push(e);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,e.addHandler("bounds-change",this._delegatedFigureSizes),e.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:e})},getItemAt:function(e){return t.console.assert(e!==undefined,"[World.getItemAt] index is required"),this._items[e]},getIndexOfItem:function(e){return t.console.assert(e,"[World.getIndexOfItem] item is required"),t.indexOf(this._items,e)},getItemCount:function(){return this._items.length},setItemIndex:function(e,n){t.console.assert(e,"[World.setItemIndex] item is required"),t.console.assert(n!==undefined,"[World.setItemIndex] index is required");var i=this.getIndexOfItem(e);if(n>=this._items.length)throw new Error("Index bigger than number of layers.");n!==i&&-1!==i&&(this._items.splice(i,1),this._items.splice(n,0,e),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:e,previousIndex:i,newIndex:n}))},removeItem:function(e){t.console.assert(e,"[World.removeItem] item is required");var n=t.indexOf(this._items,e);-1!==n&&(e.removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy(),this._items.splice(n,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(e))},removeAll:function(){this.viewer._cancelPendingImages();var t,e;for(e=0;e<this._items.length;e++)(t=this._items[e]).removeHandler("bounds-change",this._delegatedFigureSizes),t.removeHandler("clip-change",this._delegatedFigureSizes),t.destroy();var n=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,e=0;e<n.length;e++)t=n[e],this._raiseRemoveItem(t)},resetItems:function(){for(var t=0;t<this._items.length;t++)this._items[t].reset()},update:function(){for(var t=!1,e=0;e<this._items.length;e++)t=this._items[e].update()||t;return t},draw:function(){for(var t=0;t<this._items.length;t++)this._items[t].draw();this._needsDraw=!1},needsDraw:function(){for(var t=0;t<this._items.length;t++)if(this._items[t].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(t){this._autoRefigureSizes=t,t&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(e){var n,i=(e=e||{}).immediately||!1,r=e.layout||t.DEFAULT_SETTINGS.collectionLayout,o=e.rows||t.DEFAULT_SETTINGS.collectionRows,a=e.columns||t.DEFAULT_SETTINGS.collectionColumns,s=e.tileSize||t.DEFAULT_SETTINGS.collectionTileSize,c=s+(e.tileMargin||t.DEFAULT_SETTINGS.collectionTileMargin);n=!e.rows&&a?a:Math.ceil(this._items.length/o);var u,l,h,d,f,p=0,m=0;this.setAutoRefigureSizes(!1);for(var g=0;g<this._items.length;g++)g&&g%n==0&&("horizontal"===r?(m+=c,p=0):(p+=c,m=0)),d=(h=(l=(u=this._items[g]).getBounds()).width>l.height?s:s*(l.width/l.height))*(l.height/l.width),f=new t.Point(p+(s-h)/2,m+(s-d)/2),u.setPosition(f,i),u.setWidth(h,i),"horizontal"===r?p+=c:m+=c;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var e=this._homeBounds?this._homeBounds.clone():null,n=this._contentSize?this._contentSize.clone():null,i=this._contentFactor||0;if(this._items.length){var r=this._items[0],o=r.getBounds();this._contentFactor=r.getContentSize().x/o.width;for(var a=r.getClippedBounds().getBoundingBox(),s=a.x,c=a.y,u=a.x+a.width,l=a.y+a.height,h=1;h<this._items.length;h++)o=(r=this._items[h]).getBounds(),this._contentFactor=Math.max(this._contentFactor,r.getContentSize().x/o.width),a=r.getClippedBounds().getBoundingBox(),s=Math.min(s,a.x),c=Math.min(c,a.y),u=Math.max(u,a.x+a.width),l=Math.max(l,a.y+a.height);this._homeBounds=new t.Rect(s,c,u-s,l-c),this._contentSize=new t.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new t.Rect(0,0,1,1),this._contentSize=new t.Point(1,1),this._contentFactor=1;this._contentFactor===i&&this._homeBounds.equals(e)&&this._contentSize.equals(n)||this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(t){this.raiseEvent("remove-item",{item:t})}})}(OpenSeadragon),function(){function t(t){function e(e,n,i,r,o,a){for(;o>=0&&o<a;o+=t){var s=r?r[o]:o;i=n(i,e[s],s,e)}return i}return function(n,i,r,o){i=b(i,o,4);var a=!T(n)&&y.keys(n),s=(a||n).length,c=t>0?0:s-1;return arguments.length<3&&(r=n[a?a[c]:c],c+=t),e(n,i,r,a,c,s)}}function e(t){return function(e,n,i){n=_(n,i);for(var r=E(e),o=t>0?0:r-1;o>=0&&o<r;o+=t)if(n(e[o],o,e))return o;return-1}}function n(t,e,n){return function(i,r,o){var a=0,s=E(i);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return o=n(i,r),i[o]===r?o:-1;if(r!=r)return(o=e(l.call(i,a,s),y.isNaN))>=0?o+a:-1;for(o=t>0?a:s-1;o>=0&&o<s;o+=t)if(i[o]===r)return o;return-1}}function i(t,e){var n=N.length,i=t.constructor,r=y.isFunction(i)&&i.prototype||s,o="constructor";for(y.has(t,o)&&!y.contains(e,o)&&e.push(o);n--;)(o=N[n])in t&&t[o]!==r[o]&&!y.contains(e,o)&&e.push(o)}var r=this,o=r._,a=Array.prototype,s=Object.prototype,c=Function.prototype,u=a.push,l=a.slice,h=s.toString,d=s.hasOwnProperty,f=Array.isArray,p=Object.keys,m=c.bind,g=Object.create,v=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=y),exports._=y):r._=y,y.VERSION="1.8.3";var b=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}},_=function(t,e,n){return null==t?y.identity:y.isFunction(t)?b(t,e,n):y.isObject(t)?y.matcher(t):y.property(t)};y.iteratee=function(t,e){return _(t,e,Infinity)};var x=function(t,e){return function(n){var i=arguments.length;if(i<2||null==n)return n;for(var r=1;r<i;r++)for(var o=arguments[r],a=t(o),s=a.length,c=0;c<s;c++){var u=a[c];e&&void 0!==n[u]||(n[u]=o[u])}return n}},w=function(t){if(!y.isObject(t))return{};if(g)return g(t);v.prototype=t;var e=new v;return v.prototype=null,e},S=function(t){return function(e){return null==e?void 0:e[t]}},k=Math.pow(2,53)-1,E=S("length"),T=function(t){var e=E(t);return"number"==typeof e&&e>=0&&e<=k};y.each=y.forEach=function(t,e,n){e=b(e,n);var i,r;if(T(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var o=y.keys(t);for(i=0,r=o.length;i<r;i++)e(t[o[i]],o[i],t)}return t},y.map=y.collect=function(t,e,n){e=_(e,n);for(var i=!T(t)&&y.keys(t),r=(i||t).length,o=Array(r),a=0;a<r;a++){var s=i?i[a]:a;o[a]=e(t[s],s,t)}return o},y.reduce=y.foldl=y.inject=t(1),y.reduceRight=y.foldr=t(-1),y.find=y.detect=function(t,e,n){var i;if(void 0!==(i=T(t)?y.findIndex(t,e,n):y.findKey(t,e,n))&&-1!==i)return t[i]},y.filter=y.select=function(t,e,n){var i=[];return e=_(e,n),y.each(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i},y.reject=function(t,e,n){return y.filter(t,y.negate(_(e)),n)},y.every=y.all=function(t,e,n){e=_(e,n);for(var i=!T(t)&&y.keys(t),r=(i||t).length,o=0;o<r;o++){var a=i?i[o]:o;if(!e(t[a],a,t))return!1}return!0},y.some=y.any=function(t,e,n){e=_(e,n);for(var i=!T(t)&&y.keys(t),r=(i||t).length,o=0;o<r;o++){var a=i?i[o]:o;if(e(t[a],a,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,n,i){return T(t)||(t=y.values(t)),("number"!=typeof n||i)&&(n=0),y.indexOf(t,e,n)>=0},y.invoke=function(t,e){var n=l.call(arguments,2),i=y.isFunction(e);return y.map(t,function(t){var r=i?e:t[e];return null==r?r:r.apply(t,n)})},y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,n){var i,r,o=-Infinity,a=-Infinity;if(null==e&&null!=t)for(var s=0,c=(t=T(t)?t:y.values(t)).length;s<c;s++)(i=t[s])>o&&(o=i);else e=_(e,n),y.each(t,function(t,n,i){((r=e(t,n,i))>a||r===-Infinity&&o===-Infinity)&&(o=t,a=r)});return o},y.min=function(t,e,n){var i,r,o=Infinity,a=Infinity;if(null==e&&null!=t)for(var s=0,c=(t=T(t)?t:y.values(t)).length;s<c;s++)(i=t[s])<o&&(o=i);else e=_(e,n),y.each(t,function(t,n,i){((r=e(t,n,i))<a||r===Infinity&&o===Infinity)&&(o=t,a=r)});return o},y.shuffle=function(t){for(var e,n=T(t)?t:y.values(t),i=n.length,r=Array(i),o=0;o<i;o++)(e=y.random(0,o))!==o&&(r[o]=r[e]),r[e]=n[o];return r},y.sample=function(t,e,n){return null==e||n?(T(t)||(t=y.values(t)),t[y.random(t.length-1)]):y.shuffle(t).slice(0,Math.max(0,e))},y.sortBy=function(t,e,n){return e=_(e,n),y.pluck(y.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")};var C=function(t){return function(e,n,i){var r={};return n=_(n,i),y.each(e,function(i,o){var a=n(i,o,e);t(r,i,a)}),r}};y.groupBy=C(function(t,e,n){y.has(t,n)?t[n].push(e):t[n]=[e]}),y.indexBy=C(function(t,e,n){t[n]=e}),y.countBy=C(function(t,e,n){y.has(t,n)?t[n]++:t[n]=1}),y.toArray=function(t){return t?y.isArray(t)?l.call(t):T(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:T(t)?t.length:y.keys(t).length},y.partition=function(t,e,n){e=_(e,n);var i=[],r=[];return y.each(t,function(t,n,o){(e(t,n,o)?i:r).push(t)}),[i,r]},y.first=y.head=y.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,n){return l.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},y.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},y.compact=function(t){return y.filter(t,y.identity)};var L=function(t,e,n,i){for(var r=[],o=0,a=i||0,s=E(t);a<s;a++){var c=t[a];if(T(c)&&(y.isArray(c)||y.isArguments(c))){e||(c=L(c,e,n));var u=0,l=c.length;for(r.length+=l;u<l;)r[o++]=c[u++]}else n||(r[o++]=c)}return r};y.flatten=function(t,e){return L(t,e,!1)},y.without=function(t){return y.difference(t,l.call(arguments,1))},y.uniq=y.unique=function(t,e,n,i){y.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=_(n,i));for(var r=[],o=[],a=0,s=E(t);a<s;a++){var c=t[a],u=n?n(c,a,t):c;e?(a&&o===u||r.push(c),o=u):n?y.contains(o,u)||(o.push(u),r.push(c)):y.contains(r,c)||r.push(c)}return r},y.union=function(){return y.uniq(L(arguments,!0,!0))},y.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=E(t);i<r;i++){var o=t[i];if(!y.contains(e,o)){for(var a=1;a<n&&y.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},y.difference=function(t){var e=L(arguments,!0,!0,1);return y.filter(t,function(t){return!y.contains(e,t)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(t){for(var e=t&&y.max(t,E).length||0,n=Array(e),i=0;i<e;i++)n[i]=y.pluck(t,i);return n},y.object=function(t,e){for(var n={},i=0,r=E(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},y.findIndex=e(1),y.findLastIndex=e(-1),y.sortedIndex=function(t,e,n,i){for(var r=(n=_(n,i,1))(e),o=0,a=E(t);o<a;){var s=Math.floor((o+a)/2);n(t[s])<r?o=s+1:a=s}return o},y.indexOf=n(1,y.findIndex,y.sortedIndex),y.lastIndexOf=n(-1,y.findLastIndex),y.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;o<i;o++,t+=n)r[o]=t;return r};var P=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var o=w(t.prototype),a=t.apply(o,r);return y.isObject(a)?a:o};y.bind=function(t,e){if(m&&t.bind===m)return m.apply(t,l.call(arguments,1));if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var n=l.call(arguments,2),i=function(){return P(t,i,e,this,n.concat(l.call(arguments)))};return i},y.partial=function(t){var e=l.call(arguments,1),n=function(){for(var i=0,r=e.length,o=Array(r),a=0;a<r;a++)o[a]=e[a]===y?arguments[i++]:e[a];for(;i<arguments.length;)o.push(arguments[i++]);return P(t,n,this,this,o)};return n},y.bindAll=function(t){var e,n,i=arguments.length;if(i<=1)throw new Error("bindAll must be passed function names");for(e=1;e<i;e++)t[n=arguments[e]]=y.bind(t[n],t);return t},y.memoize=function(t,e){var n=function(i){var r=n.cache,o=""+(e?e.apply(this,arguments):i);return y.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n},y.delay=function(t,e){var n=l.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,n){var i,r,o,a=null,s=0;n||(n={});var c=function(){s=!1===n.leading?0:y.now(),a=null,o=t.apply(i,r),a||(i=r=null)};return function(){var u=y.now();s||!1!==n.leading||(s=u);var l=e-(u-s);return i=this,r=arguments,l<=0||l>e?(a&&(clearTimeout(a),a=null),s=u,o=t.apply(i,r),a||(i=r=null)):a||!1===n.trailing||(a=setTimeout(c,l)),o}},y.debounce=function(t,e,n){var i,r,o,a,s,c=function(){var u=y.now()-a;u<e&&u>=0?i=setTimeout(c,e-u):(i=null,n||(s=t.apply(o,r),i||(o=r=null)))};return function(){o=this,r=arguments,a=y.now();var u=n&&!i;return i||(i=setTimeout(c,e)),u&&(s=t.apply(o,r),o=r=null),s}},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},y.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},y.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},y.once=y.partial(y.before,2);var A=!{toString:null}.propertyIsEnumerable("toString"),N=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(t){if(!y.isObject(t))return[];if(p)return p(t);var e=[];for(var n in t)y.has(t,n)&&e.push(n);return A&&i(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var n in t)e.push(n);return A&&i(t,e),e},y.values=function(t){for(var e=y.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},y.mapObject=function(t,e,n){e=_(e,n);for(var i,r=y.keys(t),o=r.length,a={},s=0;s<o;s++)a[i=r[s]]=e(t[i],i,t);return a},y.pairs=function(t){for(var e=y.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},y.invert=function(t){for(var e={},n=y.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},y.functions=y.methods=function(t){var e=[];for(var n in t)y.isFunction(t[n])&&e.push(n);return e.sort()},y.extend=x(y.allKeys),y.extendOwn=y.assign=x(y.keys),y.findKey=function(t,e,n){e=_(e,n);for(var i,r=y.keys(t),o=0,a=r.length;o<a;o++)if(i=r[o],e(t[i],i,t))return i},y.pick=function(t,e,n){var i,r,o={},a=t;if(null==a)return o;y.isFunction(e)?(r=y.allKeys(a),i=b(e,n)):(r=L(arguments,!1,!1,1),i=function(t,e,n){return e in n},a=Object(a));for(var s=0,c=r.length;s<c;s++){var u=r[s],l=a[u];i(l,u,a)&&(o[u]=l)}return o},y.omit=function(t,e,n){if(y.isFunction(e))e=y.negate(e);else{var i=y.map(L(arguments,!1,!1,1),String);e=function(t,e){return!y.contains(i,e)}}return y.pick(t,e,n)},y.defaults=x(y.allKeys,!0),y.create=function(t,e){var n=w(t);return e&&y.extendOwn(n,e),n},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var n=y.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),o=0;o<i;o++){var a=n[o];if(e[a]!==r[a]||!(a in r))return!1}return!0};var R=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var r=h.call(t);if(r!==h.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(y.isFunction(a)&&a instanceof a&&y.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var c=n.length;c--;)if(n[c]===t)return i[c]===e;if(n.push(t),i.push(e),o){if((c=t.length)!==e.length)return!1;for(;c--;)if(!R(t[c],e[c],n,i))return!1}else{var u,l=y.keys(t);if(c=l.length,y.keys(e).length!==c)return!1;for(;c--;)if(u=l[c],!y.has(e,u)||!R(t[u],e[u],n,i))return!1}return n.pop(),i.pop(),!0};y.isEqual=function(t,e){return R(t,e)},y.isEmpty=function(t){return null==t||(T(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=f||function(t){return"[object Array]"===h.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){y["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return y.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&t!==+t},y.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===h.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){return null!=t&&d.call(t,e)},y.noConflict=function(){return r._=o,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=S,y.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,n){var i=Array(Math.max(0,t));e=b(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},D=y.invert(I),O=function(t){var e=function(e){return t[e]},n="(?:"+y.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}};y.escape=O(I),y.unescape=O(D),y.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),y.isFunction(i)?i.call(t):i};var B=0;y.uniqueId=function(t){var e=++B+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},z=/\\|'|\r|\n|\u2028|\u2029/g,j=function(t){return"\\"+F[t]};y.template=function(t,e,n){!e&&n&&(e=n),e=y.defaults({},e,y.templateSettings);var i=RegExp([(e.escape||M).source,(e.interpolate||M).source,(e.evaluate||M).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(i,function(e,n,i,a,s){return o+=t.slice(r,s).replace(z,j),r=s+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(e.variable||"obj","_",o)}catch(u){throw u.source=o,u}var s=function(t){return a.call(this,t,y)},c=e.variable||"obj";return s.source="function("+c+"){\n"+o+"}",s},y.chain=function(t){var e=y(t);return e._chain=!0,e};var H=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){y.each(y.functions(t),function(e){var n=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),H(this,n.apply(y,t))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=a[t];y.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],H(this,n)}}),y.each(["concat","join","slice"],function(t){var e=a[t];y.prototype[t]=function(){return H(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}.call(this),function(t,e){"function"==typeof define&&define.amd?define("eventable",function(){return t.Eventable=e()}):"undefined"!=typeof exports?module.exports=e():t.Eventable=e()}(this,function(){function t(t){var e,n=2;return function(){return--n>0?e=t.apply(this,arguments):t=null,e}}function e(t,e){i[t]=function(t,n,i){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=(new Date).getTime())]=t,"object"==typeof n&&(i=this),t[e](n,i,this),this}}var n=[].slice,i={on:function(t,e,n){if(!o(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});return(this._events[t]||(this._events[t]=[])).push({callback:e,context:n,ctx:n||this}),this},once:function(e,n,i){if(!o(this,"once",e,[n,i])||!n)return this;var r=this,a=t(function(){r.off(e,a),n.apply(this,arguments)});return a._callback=n,this.on(e,a,i)},off:function(t,e,n){var i,r,a,s,c,u,l,h;if(!this._events||!o(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(c=0,u=(s=t?[t]:Object.keys(this._events)).length;c<u;c++)if(t=s[c],a=this._events[t]){if(this._events[t]=i=[],e||n)for(l=0,h=a.length;l<h;l++)r=a[l],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=n.call(arguments,1);if(!o(this,"trigger",t,e))return this;var i=this._events[t],r=this._events.all;return i&&a(i,e),r&&a(r,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var r=!e&&!n;"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t);for(var o in i)i[o].off(e,n,this),r&&delete this._listeners[o];return this}},r=/\s+/,o=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)t[e].apply(t,[o,n[o]].concat(i));return!1}if(r.test(n)){for(var a=n.split(r),s=0,c=a.length;s<c;s++)t[e].apply(t,[a[s]].concat(i));return!1}return!0},a=function(t,e){var n,i=-1,r=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}};return e("listenTo","on"),e("listenToOnce","once"),i.bind=i.on,i.unbind=i.off,i}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SirTrevor=e():t.SirTrevor=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}(function(t){
for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(typeof t[e]){case"function":break;case"object":t[e]=function(e){var n=e.slice(1),i=t[e[0]];return function(t,e,r){i.apply(this,[t,e,r].concat(n))}}(t[e]);break;default:t[e]=t[t[e]]}return t}([function(t,e,n){"use strict";t.exports=n(1),n(280)},function(t,e,n){"use strict";var i=n(2)["default"];n(17),n(18).shim(),n(21),n(22),n(23).polyfill();var r=n(29),o={config:n(68),log:r.log,Locales:n(72),Events:n(73),EventBus:n(75),EditorStore:n(76),Submittable:n(77),FileUploader:n(78),BlockMixins:n(128),BlockPositioner:n(234),BlockReorder:n(237),BlockDeletion:n(238),BlockValidations:n(239),BlockStore:n(240),BlockManager:n(241),SimpleBlock:n(245),Block:n(244),Blocks:n(242),FormatBar:n(269),Editor:n(271),toMarkdown:n(279),toHTML:n(253),setDefaults:function(t){i(o.config.defaults,t||{})},getInstance:r.getInstance,setBlockOptions:function(t,e){var n=o.Blocks[t];void 0!==n&&i(n.prototype,e||{})},runOnAllInstances:function(t){if(o.Editor.prototype.hasOwnProperty(t)){var e=Array.prototype.slice.call(arguments,1);Array.prototype.forEach.call(o.config.instances,function(n){n[t].apply(null,e)})}else o.log("method doesn't exist")}};i(o,n(272)),t.exports=o},function(t,e,n){t.exports={"default":n(3),__esModule:!0}},function(t,e,n){n(4),t.exports=n(7).Object.assign},function(t,e,n){var i=n(5);i(i.S+i.F,"Object",{assign:n(10)})},function(t,e,n){var i=n(6),r=n(7),o=n(8),a="prototype",s=function(t,e,n){var c,u,l,h=t&s.F,d=t&s.G,f=t&s.S,p=t&s.P,m=t&s.B,g=t&s.W,v=d?r:r[e]||(r[e]={}),y=d?i:f?i[e]:(i[e]||{})[a];d&&(n=e);for(c in n)(u=!h&&y&&c in y)&&c in v||(l=u?y[c]:n[c],v[c]=d&&"function"!=typeof y[c]?n[c]:m&&u?o(l,i):g&&y[c]==l?function(t){var e=function(e){return this instanceof t?new t(e):t(e)};return e[a]=t[a],e}(l):p&&"function"==typeof l?o(Function.call,l):l,p&&((v[a]||(v[a]={}))[c]=l))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,t.exports=s},function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t){var e=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=e)},function(t,e,n){var i=n(9);t.exports=function(t,e,n){if(i(t),e===undefined)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(11),r=n(12),o=n(14);t.exports=n(16)(function(){var t=Object.assign,e={},n={},i=Symbol(),r="abcdefghijklmnopqrst";return e[i]=7,r.split("").forEach(function(t){n[t]=t}),7!=t({},e)[i]||Object.keys(t({},n)).join("")!=r})?function(t){for(var e=r(t),n=arguments,a=n.length,s=1,c=i.getKeys,u=i.getSymbols,l=i.isEnum;a>s;)for(var h,d=o(n[s++]),f=u?c(d).concat(u(d)):c(d),p=f.length,m=0;p>m;)l.call(d,h=f[m++])&&(e[h]=d[h]);return e}:Object.assign},function(t){var e=Object;t.exports={create:e.create,getProto:e.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:e.getOwnPropertyDescriptor,setDesc:e.defineProperty,setDescs:e.defineProperties,getKeys:e.keys,getNames:e.getOwnPropertyNames,getSymbols:e.getOwnPropertySymbols,each:[].forEach}},function(t,e,n){var i=n(13);t.exports=function(t){return Object(i(t))}},function(t){t.exports=function(t){if(t==undefined)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var i=n(15);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(){},function(t,e,n){"use strict";var i=n(19),r=function(t){return void 0!==t&&null!==t},o=function(t){if(!r(t))throw new TypeError("target must be an object");var e,n,o,a,s=Object(t);for(e=1;e<arguments.length;++e)for(n=Object(arguments[e]),a=i(n),o=0;o<a.length;++o)s[a[o]]=n[a[o]];return s};o.shim=function(){return Object.assign||(Object.assign=o),Object.assign||o},t.exports=o},function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=Array.prototype.slice,a=n(20),s=Object.prototype.propertyIsEnumerable,c=!s.call({toString:null},"toString"),u=s.call(function(){},"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(t){var e=t.constructor;return e&&e.prototype===t},d={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&i.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{h(window[t])}catch(e){return!0}}catch(e){return!0}return!1}(),p=function(t){if("undefined"==typeof window||!f)return h(t);try{return h(t)}catch(e){return!1}},m=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===r.call(t),o=a(t),s=e&&"[object String]"===r.call(t),h=[];if(!e&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var d=u&&n;if(s&&t.length>0&&!i.call(t,0))for(var f=0;f<t.length;++f)h.push(String(f));if(o&&t.length>0)for(var m=0;m<t.length;++m)h.push(String(m));else for(var g in t)d&&"prototype"===g||!i.call(t,g)||h.push(String(g));if(c)for(var v=p(t),y=0;y<l.length;++y)v&&"constructor"===l[y]||!i.call(t,l[y])||h.push(l[y]);return h};m.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var t=Object.keys;Object.keys=function(e){return t(a(e)?o.call(e):e)}}}else Object.keys=m;return Object.keys||m},t.exports=m},function(t){"use strict";var e=Object.prototype.toString;t.exports=function(t){var n=e.call(t),i="[object Arguments]"===n;return i||(i="[object Array]"!==n&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),i}},function(){!function(){if(!Array.prototype.find){var t=function(t){var e=Object(this),n=e.length<0?0:e.length>>>0;if(0===n)return undefined;if("function"!=typeof t||"[object Function]"!==Object.prototype.toString.call(t))throw new TypeError("Array#find: predicate must be a function");for(var i,r=arguments[1],o=0;o<n;o++)if(i=e[o],t.call(r,i,o,e))return i;return undefined};if(Object.defineProperty)try{Object.defineProperty(Array.prototype,"find",{value:t,configurable:!0,enumerable:!1,writable:!0})}catch(e){}Array.prototype.find||(Array.prototype.find=t)}}()},function(){"use strict";Array.prototype.includes||(Array.prototype.includes=function(t){var e=Object(this),n=parseInt(e.length)||0;if(0===n)return!1;var i,r=parseInt(arguments[1])||0;r>=0?i=r:(i=n+r)<0&&(i=0);for(var o;i<n;){if(o=e[i],t===o||t!=t&&o!=o)return!0;i++}return!1})},function(t,e,n){var i;(function(t,r,o,a){(function(){"use strict";function s(t){return"function"==typeof t||"object"==typeof t&&null!==t}function c(t){return"function"==typeof t}function u(t){return"object"==typeof t&&null!==t}function l(t){Z=t}function h(t){Y=t}function d(){var e=t.nextTick,n=t.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&"0"===n[1]&&"10"===n[2]&&(e=r),function(){e(v)}}function f(){return function(){V(v)}}function p(){var t=0,e=new tt(v),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function m(){var t=new MessageChannel;return t.port1.onmessage=v,function(){t.port2.postMessage(0)}}function g(){return function(){setTimeout(v,1)}}function v(){for(var t=0;t<X;t+=2){(0,it[t])(it[t+1]),it[t]=undefined,it[t+1]=undefined}X=0}function y(){try{var t=n(27);return V=t.runOnLoop||t.runOnContext,f()}catch(e){return g()}}function b(){}function _(){return new TypeError("You cannot resolve a promise with itself")}function x(){return new TypeError("A promises callback cannot return that same promise.")}function w(t){try{return t.then}catch(e){return st.error=e,st}}function S(t,e,n,i){try{t.call(e,n,i)}catch(r){return r}}function k(t,e,n){Y(function(t){var i=!1,r=S(n,e,function(n){i||(i=!0,e!==n?C(t,n):P(t,n))},function(e){i||(i=!0,A(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&r&&(i=!0,A(t,r))},t)}function E(t,e){e._state===ot?P(t,e._result):e._state===at?A(t,e._result):N(e,undefined,function(e){C(t,e)},function(e){A(t,e)})}function T(t,e){if(e.constructor===t.constructor)E(t,e);else{var n=w(e);n===st?A(t,st.error):n===undefined?P(t,e):c(n)?k(t,e,n):P(t,e)}}function C(t,e){t===e?A(t,_()):s(e)?T(t,e):P(t,e)}function L(t){t._onerror&&t._onerror(t._result),R(t)}function P(t,e){t._state===rt&&(t._result=e,t._state=ot,0!==t._subscribers.length&&Y(R,t))}function A(t,e){t._state===rt&&(t._state=at,t._result=e,Y(L,t))}function N(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+ot]=n,r[o+at]=i,0===o&&t._state&&Y(R,t)}function R(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i,r,o=t._result,a=0;a<e.length;a+=3)i=e[a],r=e[a+n],i?O(n,i,r,o):r(o);t._subscribers.length=0}}function I(){this.error=null}function D(t,e){try{return t(e)}catch(n){return ct.error=n,ct}}function O(t,e,n,i){var r,o,a,s,u=c(n);if(u){if((r=D(n,i))===ct?(s=!0,o=r.error,r=null):a=!0,e===r)return void A(e,x())}else r=i,a=!0;e._state!==rt||(u&&a?C(e,r):s?A(e,o):t===ot?P(e,r):t===at&&A(e,r))}function B(t,e){try{e(function(e){C(t,e)},function(e){A(t,e)})}catch(n){A(t,n)}}function M(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(b),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?P(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&P(n.promise,n._result))):A(n.promise,n._validationError())}function F(t){return new ut(this,t).promise}function z(t){function e(t){C(r,t)}function n(t){A(r,t)}var i=this,r=new i(b);if(!K(t))return A(r,new TypeError("You must pass an array to race.")),r;for(var o=t.length,a=0;r._state===rt&&a<o;a++)N(i.resolve(t[a]),undefined,e,n);return r}function j(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(b);return C(n,t),n}function H(t){var e=new this(b);return A(e,t),e}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function q(t){this._id=pt++,this._state=undefined,this._result=undefined,this._subscribers=[],b!==t&&(c(t)||$(),this instanceof q||U(),B(this,t))}function W(){var t;if(void 0!==o)t=o;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;e&&"[object Promise]"===Object.prototype.toString.call(e.resolve())&&!e.cast||(t.Promise=mt)}var V,Z,G,K=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},X=0,Y=({}.toString,function(t,e){it[X]=t,it[X+1]=e,2===(X+=2)&&(Z?Z(v):G())}),Q="undefined"!=typeof window?window:undefined,J=Q||{},tt=J.MutationObserver||J.WebKitMutationObserver,et=void 0!==t&&"[object process]"==={}.toString.call(t),nt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,it=new Array(1e3);G=et?d():tt?p():nt?m():Q===undefined?y():g();var rt=void 0,ot=1,at=2,st=new I,ct=new I;M.prototype._validateInput=function(t){return K(t)},M.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},M.prototype._init=function(){this._result=new Array(this.length)};var ut=M;M.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,i=t._input,r=0;n._state===rt&&r<e;r++)t._eachEntry(i[r],r)},M.prototype._eachEntry=function(t,e){var n=this,i=n._instanceConstructor;u(t)?t.constructor===i&&t._state!==rt?(t._onerror=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(i.resolve(t),e):(n._remaining--,n._result[e]=t)},M.prototype._settledAt=function(t,e,n){var i=this,r=i.promise;r._state===rt&&(i._remaining--,t===at?A(r,n):i._result[e]=n),0===i._remaining&&P(r,i._result)},M.prototype._willSettleAt=function(t,e){var n=this;N(t,undefined,function(t){n._settledAt(ot,e,t)},function(t){n._settledAt(at,e,t)})};var lt=F,ht=z,dt=j,ft=H,pt=0,mt=q;q.all=lt,q.race=ht,q.resolve=dt,q.reject=ft,q._setScheduler=l,q._setAsap=h,q._asap=Y,q.prototype={constructor:q,then:function(t,e){var n=this,i=n._state;if(i===ot&&!t||i===at&&!e)return this;var r=new this.constructor(b),o=n._result;if(i){var a=arguments[i-1];Y(function(){O(i,r,a,o)})}else N(n,r,t,e);return r},"catch":function(t){return this.then(null,t)}};var gt=W,vt={Promise:mt,polyfill:gt};n(28).amd?(i=function(){return vt}.call(e,n,e,a))===undefined||(a.exports=i):void 0!==a&&a.exports?a.exports=vt:void 0!==this&&(this.ES6Promise=vt),gt()}).call(this)}).call(e,n(24),n(25).setImmediate,function(){return this}(),n(26)(t))},function(t){function e(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&n())}function n(){if(!l){var t=o(e);l=!0;for(var n=u.length;n;){for(c=u,u=[];++h<n;)c&&c[h].run();h=-1,n=u.length}c=null,l=!1,a(t)}}function i(t,e){this.fun=t,this.array=e}function r(){}var o,a,s=t.exports={};!function(){try{o=setTimeout}catch(t){o=function(){throw new Error("setTimeout is not defined")}}try{a=clearTimeout}catch(t){a=function(){throw new Error("clearTimeout is not defined")}}}();var c,u=[],l=!1,h=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new i(t,e)),1!==u.length||l||o(n,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=r,s.addListener=r,s.once=r,s.off=r,s.removeListener=r,s.removeAllListeners=r,s.emit=r,s.binding=function(){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,n){(function(t,i){function r(t,e){this._id=t,this._clearFn=e}var o=n(24).nextTick,a=Function.prototype.apply,s=Array.prototype.slice,c={},u=0;e.setTimeout=function(){return new r(a.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(a.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},e.setImmediate="function"==typeof t?t:function(t){var n=u++,i=!(arguments.length<2)&&s.call(arguments,1);return c[n]=!0,o(function(){c[n]&&(i?t.apply(null,i):t.call(null),e.clearImmediate(n))}),n},e.clearImmediate="function"==typeof i?i:function(t){delete c[t]}}).call(e,n(25).setImmediate,n(25).clearImmediate)},function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(){},function(t){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";var i=n(30)["default"],r=n(34),o=n(68),a=n(69),s=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/,c={getInstance:function(t){return r.isUndefined(t)?o.instances[0]:r.isString(t)?o.instances.find(function(e){return e.ID===t}):o.instances[t]},getInstanceBySelection:function(){return c.getInstance(a.getClosest(window.getSelection().anchorNode.parentNode,".st-block").getAttribute("data-instance"))},getBlockBySelection:function(){return c.getInstanceBySelection().findBlockById(a.getClosest(window.getSelection().anchorNode.parentNode,".st-block").id)},log:function(){!r.isUndefined(console)&&o.debug&&console.log.apply(console,arguments)},isURI:function(t){return s.test(t)},titleize:function(t){return null===t?"":(t=String(t).toLowerCase()).replace(/(?:^|\s|-)\S/g,function(t){return t.toUpperCase()})},classify:function(t){return c.titleize(String(t).replace(/[\W_]/g," ")).replace(/\s/g,"")},capitalize:function(t){return t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()},flatten:function(t){var e={};return(Array.isArray(t)?t:i(t)).forEach(function(t){e[t]=!0}),e},underscored:function(t){return t.trim().replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},reverse:function(t){return t.split("").reverse().join("")},toSlug:function(t){return t.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},leftTrim:function(t){return t.replace(/^\s+/,"")}};t.exports=c},function(t,e,n){t.exports={"default":n(31),__esModule:!0}},function(t,e,n){n(32),t.exports=n(7).Object.keys},function(t,e,n){var i=n(12);n(33)("keys",function(t){return function(e){return t(i(e))}})},function(t,e,n){var i=n(5),r=n(7),o=n(16);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],a={};a[t]=e(n),i(i.S+i.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){"use strict";e.isEmpty=n(35),e.isFunction=n(49),e.isObject=n(43),e.isString=n(54),e.isUndefined=n(55),e.result=n(56),e.template=n(57),e.uniqueId=n(67)},function(t,e,n){function i(t){var e=!0;if(!t)return e;var n=l.call(t),i=t.length;return n==s||n==u||n==a||n==c&&"number"==typeof i&&o(t.splice)?!i:(r(t,function(){return e=!1}),e)}var r=n(36),o=n(49),a="[object Arguments]",s="[object Array]",c="[object Object]",u="[object String]",l=Object.prototype.toString;t.exports=i},function(t,e,n){var i=n(37),r=n(52),o=n(44),a=function(t,e,n){var a,s=t,c=s;if(!s)return c;if(!o[typeof s])return c;e=e&&void 0===n?e:i(e,n,3);for(var u=-1,l=o[typeof s]&&r(s),h=l?l.length:0;++u<h;)if(a=l[u],!1===e(s[a],a,t))return c;return c};t.exports=a},function(t,e,n){function i(t,e,n){if("function"!=typeof t)return o;if(void 0===e||!("prototype"in t))return t;var i=t.__bindData__;if(void 0===i&&(s.funcNames&&(i=!t.name),!(i=i||!s.funcDecomp))){var h=l.call(t);s.funcNames||(i=!c.test(h)),i||(i=u.test(h),a(t,i))}if(!1===i||!0!==i&&1&i[1])return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return r(t,e)}var r=n(38),o=n(50),a=n(46),s=n(51),c=/^\s*function[ \n\r\t]+\w/,u=/\bthis\b/,l=Function.prototype.toString;t.exports=i},function(t,e,n){function i(t,e){return arguments.length>2?r(t,17,o(arguments,2),null,e):r(t,1,null,null,e)}var r=n(39),o=n(47);t.exports=i},function(t,e,n){function i(t,e,n,c,h,d){var f=1&e,p=4&e,m=16&e,g=32&e;if(!(2&e)&&!a(t))throw new TypeError;m&&!n.length&&(e&=-17,m=n=!1),g&&!c.length&&(e&=-33,g=c=!1);var v=t&&t.__bindData__;if(v&&!0!==v)return(v=s(v))[2]&&(v[2]=s(v[2])),v[3]&&(v[3]=s(v[3])),!f||1&v[1]||(v[4]=h),!f&&1&v[1]&&(e|=8),!p||4&v[1]||(v[5]=d),m&&u.apply(v[2]||(v[2]=[]),n),g&&l.apply(v[3]||(v[3]=[]),c),v[1]|=e,i.apply(null,v);return(1==e||17===e?r:o)([t,e,n,c,h,d])}var r=n(40),o=n(48),a=n(49),s=n(47),c=[],u=c.push,l=c.unshift;t.exports=i},function(t,e,n){function i(t){function e(){if(i){var t=s(i);c.apply(t,arguments)}if(this instanceof e){var a=r(n.prototype),l=n.apply(a,t||arguments);return o(l)?l:a}return n.apply(u,t||arguments)}var n=t[0],i=t[2],u=t[4];return a(e,t),e}var r=n(41),o=n(43),a=n(46),s=n(47),c=[].push;t.exports=i},function(t,e,n){(function(e){function i(t){return o(t)?a(t):{}}var r=n(42),o=n(43),a=(n(45),r(a=Object.create)&&a);a||(i=function(){function t(){}return function(n){if(o(n)){t.prototype=n;var i=new t;t.prototype=null}return i||e.Object()}}()),t.exports=i}).call(e,function(){return this}())},function(t){function e(t){return"function"==typeof t&&i.test(t)}var n=Object.prototype.toString,i=RegExp("^"+String(n).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");t.exports=e},function(t,e,n){function i(t){return!(!t||!r[typeof t])}var r=n(44);t.exports=i},function(t){var e={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};t.exports=e},function(t){function e(){}t.exports=e},function(t,e,n){var i=n(42),r=n(45),o={configurable:!1,enumerable:!1,value:null,writable:!1},a=function(){try{var t={},e=i(e=Object.defineProperty)&&e,n=e(t,t,t)&&e}catch(r){}return n}(),s=a?function(t,e){o.value=e,a(t,"__bindData__",o)}:r;t.exports=s},function(t){function e(t,e,n){e||(e=0),void 0===n&&(n=t?t.length:0);for(var i=-1,r=n-e||0,o=Array(r<0?0:r);++i<r;)o[i]=t[e+i];return o}t.exports=e},function(t,e,n){function i(t){function e(){var t=p?d:this;if(l){var a=s(l);c.apply(a,arguments)}if((h||g)&&(a||(a=s(arguments)),h&&c.apply(a,h),g&&a.length<f))return u|=16,i([n,v?u:-4&u,a,null,d,f]);if(a||(a=arguments),m&&(n=t[y]),this instanceof e){t=r(n.prototype);var b=n.apply(t,a);return o(b)?b:t}return n.apply(t,a)}var n=t[0],u=t[1],l=t[2],h=t[3],d=t[4],f=t[5],p=1&u,m=2&u,g=4&u,v=8&u,y=n;return a(e,t),e}var r=n(41),o=n(43),a=n(46),s=n(47),c=[].push;t.exports=i},function(t){function e(t){return"function"==typeof t}t.exports=e},function(t){function e(t){return t}t.exports=e},function(t,e,n){(function(e){var i=n(42),r=/\bthis\b/,o={};o.funcDecomp=!i(e.WinRTError)&&r.test(function(){return this}),o.funcNames="string"==typeof Function.name,t.exports=o}).call(e,function(){return this}())},function(t,e,n){var i=n(42),r=n(43),o=n(53),a=i(a=Object.keys)&&a,s=a?function(t){return r(t)?a(t):[]}:o;t.exports=s},function(t,e,n){var i=n(44),r=Object.prototype.hasOwnProperty,o=function(t){var e,n=t,o=[];if(!n)return o;if(!i[typeof t])return o;for(e in n)r.call(n,e)&&o.push(e);return o};t.exports=o},function(t){function e(t){return"string"==typeof t||t&&"object"==typeof t&&i.call(t)==n||!1}var n="[object String]",i=Object.prototype.toString;t.exports=e},function(t){function e(t){return void 0===t}t.exports=e},function(t,e,n){function i(t,e){if(t){var n=t[e];return r(n)?t[e]():n}}var r=n(49);t.exports=i},function(t,e,n){function i(t,e,n){var i=c.imports._.templateSettings||c;t=String(t||""),n=r({},n,i);var g,v=r({},n.imports,i.imports),y=a(v),b=u(v),_=0,x=n.interpolate||p,w="__p += '",S=RegExp((n.escape||p).source+"|"+x.source+"|"+(x===s?f:p).source+"|"+(n.evaluate||p).source+"|$","g");t.replace(S,function(e,n,i,r,a,s){return i||(i=r),w+=t.slice(_,s).replace(m,o),n&&(w+="' +\n__e("+n+") +\n'"),a&&(g=!0,w+="';\n"+a+";\n__p += '"),i&&(w+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),_=s+e.length,e}),w+="';\n";var k=n.variable,E=k;E||(w="with ("+(k="obj")+") {\n"+w+"\n}\n"),w=(g?w.replace(l,""):w).replace(h,"$1").replace(d,"$1;"),w="function("+k+") {\n"+(E?"":k+" || ("+k+" = {});\n")+"var __t, __p = '', __e = _.escape"+(g?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+w+"return __p\n}";try{var T=Function(y,"return "+w).apply(undefined,b)}catch(C){throw C.source=w,C}return e?T(e):(T.source=w,T)}var r=n(58),o=(n(59),n(63)),a=n(52),s=n(64),c=n(65),u=n(66),l=/\b__p \+= '';/g,h=/\b(__p \+=) '' \+/g,d=/(__e\(.*?\)|\b__t\)) \+\n'';/g,f=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,p=/($^)/,m=/['\n\r\t\u2028\u2029\\]/g;t.exports=i},function(t,e,n){var i=n(52),r=n(44),o=function(t,e,n){var o,a=t,s=a;if(!a)return s;for(var c=arguments,u=0,l="number"==typeof n?2:c.length;++u<l;)if((a=c[u])&&r[typeof a])for(var h=-1,d=r[typeof a]&&i(a),f=d?d.length:0;++h<f;)"undefined"==typeof s[o=d[h]]&&(s[o]=a[o]);return s};t.exports=o},function(t,e,n){function i(t){return null==t?"":String(t).replace(o,r)}var r=n(60),o=(n(52),n(62));t.exports=i},function(t,e,n){function i(t){return r[t]}var r=n(61);t.exports=i},function(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};t.exports=e},function(t,e,n){var i=n(61),r=n(52),o=RegExp("["+r(i).join("")+"]","g");t.exports=o},function(t){function e(t){return"\\"+n[t]}var n={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"};t.exports=e},function(t){var e=/<%=([\s\S]+?)%>/g;t.exports=e},function(t,e,n){var i=n(59),r={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:n(64),variable:"",imports:{_:{escape:i}}};t.exports=r},function(t,e,n){function i(t){for(var e=-1,n=r(t),i=n.length,o=Array(i);++e<i;)o[e]=t[n[e]];return o}var r=n(52);t.exports=i},function(t){function e(t){var e=++n;return String(null==t?"":t)+e}var n=0;t.exports=e},function(t){"use strict";var e={html:['<div class="st-block__dropzone">','<svg role="img" class="st-icon"><use xlink:href="<%= config.defaults.iconUrl %>#<%= _.result(block, "icon_name") %>"/></svg>','<p><%= i18n.t("general:drop", { block: "<span>" + _.result(block, "title") + "</span>" }) %>',"</p></div>"].join("\n"),re_render_on_reorder:!1},n={html:['<input type="text" placeholder="<%= i18n.t("general:paste") %>"',' class="st-block__paste-input st-paste-block">'].join("")},i={html:['<div class="st-block__upload-container">','<input type="file" type="st-file-upload">','<button class="st-upload-btn"><%= i18n.t("general:upload") %></button>',"</div>"].join("\n")};t.exports={debug:!1,scribeDebug:!1,skipValidation:!1,version:"0.4.0",language:"en",instances:[],defaults:{defaultType:!1,spinner:{className:"st-spinner",lines:9,length:8,width:3,radius:6,color:"#000",speed:1.4,trail:57,shadow:!1,left:"50%",top:"50%"},Block:{drop_options:e,paste_options:n,upload_options:i},blockLimit:0,blockTypeLimits:{},required:[],uploadUrl:"/attachments",attachmentName:"attachment[name]",attachmentFile:"attachment[file]",attachmentUid:"attachment[uid]",baseImageUrl:"/sir-trevor-uploads/",iconUrl:"../src/icons/sir-trevor-icons.svg",errorsContainer:undefined,convertFromMarkdown:!0,formatBar:{commands:[{name:"Bold",title:"bold",iconName:"fmt-bold",cmd:"bold",keyCode:66,text:"B"},{name:"Italic",title:"italic",iconName:"fmt-italic",cmd:"italic",keyCode:73,text:"i"},{name:"Link",title:"link",iconName:"fmt-link",cmd:"linkPrompt",text:"link"},{name:"Unlink",title:"unlink",iconName:"fmt-unlink",cmd:"unlink",text:"link"},{name:"Heading",title:"heading",iconName:"fmt-heading",cmd:"heading",text:"heading"},{name:"Quote",title:"quote",iconName:"fmt-quote",cmd:"quote",text:"quote"}]},ajaxOptions:{headers:{}}}}},function(t,e,n){"use strict";var i=n(70)["default"],r=n(30)["default"],o=n(34),a=i(null);a.setAttributes=function(t){var e=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];return e.html&&(t.innerHTML=o.result(e,"html"),delete e.html),e.text&&(t.textContent=e.text,delete e.text),r(e).forEach(function(n){t.setAttribute(n,e[n])}),t},a.createElement=function(t){var e=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],n=document.createElement(t);return a.setAttributes(n,e),n},a.insertAfter=function(t,e){e.parentNode.insertBefore(t,e.nextSibling)},a.remove=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},a.replaceWith=function(t,e){a.remove(e),t.parentNode.replaceChild(e,t)},a.hide=function(t){t.style.display="none"},a.show=function(t){t.style.display=""},a.matches=function(t){var e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector||function(t){for(var e=this,n=(e.document||e.ownerDocument).querySelectorAll(t),i=0;n[i]&&n[i]!==e;)i++;return!!n[i]};return function(t,n){return e.call(t,n)}}(Element.prototype),a.getClosest=function(t,e){for(;t&&t!==document.body&&!a.matches(t,e);t=t.parentNode);return t},a.wrap=function(t,e){return e=e||document.createElement("div"),t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e),e.appendChild(t)},a.createDocumentFragmentFromString=function(t){var e=document.createDocumentFragment(),n=document.createElement("div");for(n.innerHTML=t;n.childNodes[0];)e.appendChild(n.childNodes[0]);return e},t.exports=a},function(t,e,n){t.exports={"default":n(71),__esModule:!0}},function(t,e,n){var i=n(11);t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){"use strict";var i=n(30)["default"],r=n(34),o=n(68),a=n(29),s={en:{general:{"delete":"Delete?",drop:"Drag __block__ here",paste:"Or paste URL here",upload:"...or choose a file",close:"close",position:"Position",wait:"Please wait...",link:"Enter a link",yes:"Yes",no:"No"},errors:{title:"You have the following errors:",validation_fail:"__type__ block is invalid",block_empty:"__name__ must not be empty",type_missing:"You must have a block of type __type__",required_type_empty:"A required block type __type__ is empty",load_fail:"There was a problem loading the contents of the document"},blocks:{text:{title:"Text"},list:{title:"List"},quote:{title:"Quote",credit_field:"Credit"},image:{title:"Image",upload_error:"There was a problem with your upload"},video:{title:"Video"},tweet:{title:"Tweet",fetch_error:"There was a problem fetching your tweet"},embedly:{title:"Embedly",fetch_error:"There was a problem fetching your embed",key_missing:"An Embedly API key must be present"},heading:{title:"Heading"}}}};window.i18n===undefined?(a.log("Using i18n stub"),window.i18n={t:function(t,e){var n,a,c,u,l=t.split(":");for(a=s[o.language],u=0;u<l.length;u++)c=l[u],r.isUndefined(a[c])||(a=a[c]);return n=a,r.isString(n)?(n.indexOf("__")>=0&&i(e).forEach(function(t){n=n.replace("__"+t+"__",e[t])}),n):""}}):(a.log("Using i18next"),i18n.init({resStore:s,fallbackLng:o.language,ns:{namespaces:["general","blocks"],defaultNs:"general"}})),t.exports=s},function(t,e,n){"use strict";t.exports=n(74)},function(t,e,n){var i;!function(r,o){(i=function(){return r.Eventable=o()}.call(e,n,e,t))===undefined||(t.exports=i)}(this,function(){function t(t){var e,n=2;return function(){return--n>0?e=t.apply(this,arguments):t=null,e}}function e(t,e){i[t]=function(t,n,i){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=(new Date).getTime())]=t,"object"==typeof n&&(i=this),t[e](n,i,this),this}}var n=[].slice,i={on:function(t,e,n){if(!o(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});return(this._events[t]||(this._events[t]=[])).push({callback:e,context:n,ctx:n||this}),this},once:function(e,n,i){if(!o(this,"once",e,[n,i])||!n)return this;var r=this,a=t(function(){r.off(e,a),n.apply(this,arguments)});return a._callback=n,this.on(e,a,i)},off:function(t,e,n){var i,r,a,s,c,u,l,h;if(!this._events||!o(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(c=0,u=(s=t?[t]:Object.keys(this._events)).length;c<u;c++)if(t=s[c],a=this._events[t]){if(this._events[t]=i=[],e||n)for(l=0,h=a.length;l<h;l++)r=a[l],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=n.call(arguments,1);if(!o(this,"trigger",t,e))return this;var i=this._events[t],r=this._events.all;return i&&a(i,e),r&&a(r,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var r=!e&&!n;"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t);for(var o in i)i[o].off(e,n,this),r&&delete this._listeners[o];return this}},r=/\s+/,o=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)t[e].apply(t,[o,n[o]].concat(i));return!1}if(r.test(n)){for(var a=n.split(r),s=0,c=a.length;s<c;s++)t[e].apply(t,[a[s]].concat(i));return!1}return!0},a=function(t,e){var n,i=-1,r=t.length,o=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,a,s);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}};return e("listenTo","on"),e("listenToOnce","once"),i.bind=i.on,i.unbind=i.off,i})},function(t,e,n){"use strict";var i=n(2)["default"];t.exports=i({},n(73))},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(29),a=function(t,e){this.mediator=e,this.initialize(t?t.trim():"")};i(a.prototype,{initialize:function(t){this.store=this._parseData(t)||{data:[]}},retrieve:function(){return this.store},toString:function(t){return JSON.stringify(this.store,undefined,t)},reset:function(){o.log("Resetting the EditorStore"),this.store={data:[]}},addData:function(t){return this.store.data.push(t),this.store},_parseData:function(t){var e;if(0===t.length)return e;try{
var n=JSON.parse(t);r.isUndefined(n.data)||(e=n)}catch(i){this.mediator.trigger("errors:add",{text:i18n.t("errors:load_fail")}),this.mediator.trigger("errors:render"),console.log("Sorry there has been a problem with parsing the JSON"),console.log(i)}return e}}),t.exports=a},function(t,e,n){"use strict";var i=n(2)["default"],r=n(30)["default"],o=n(29),a=n(75),s=function(t){this.form=t,this.initialize()};i(s.prototype,{initialize:function(){this.submitBtns=this.form.querySelectorAll("input[type='submit']");var t=[];Array.prototype.forEach.call(this.submitBtns,function(e){t.push(e.getAttribute("value"))}),this.submitBtnTitles=t,this.canSubmit=!0,this.globalUploadCount=0,this._bindEvents()},setSubmitButton:function(t,e){Array.prototype.forEach.call(this.submitBtns,function(t){t.setAttribute("value",e)})},resetSubmitButton:function(){var t=this.submitBtnTitles;Array.prototype.forEach.call(this.submitBtns,function(e,n){e.setAttribute("value",t[n])})},onUploadStart:function(){this.globalUploadCount++,o.log("onUploadStart called "+this.globalUploadCount),1===this.globalUploadCount&&this._disableSubmitButton()},onUploadStop:function(){this.globalUploadCount=this.globalUploadCount<=0?0:this.globalUploadCount-1,o.log("onUploadStop called "+this.globalUploadCount),0===this.globalUploadCount&&this._enableSubmitButton()},onError:function(){o.log("onError called"),this.canSubmit=!1},_disableSubmitButton:function(t){this.setSubmitButton(null,t||i18n.t("general:wait")),Array.prototype.forEach.call(this.submitBtns,function(t){t.setAttribute("disabled","disabled"),t.classList.add("disabled")})},_enableSubmitButton:function(){this.resetSubmitButton(),Array.prototype.forEach.call(this.submitBtns,function(t){t.removeAttribute("disabled"),t.classList.remove("disabled")})},_events:{disableSubmitButton:"_disableSubmitButton",enableSubmitButton:"_enableSubmitButton",setSubmitButton:"setSubmitButton",resetSubmitButton:"resetSubmitButton",onError:"onError",onUploadStart:"onUploadStart",onUploadStop:"onUploadStop"},_bindEvents:function(){r(this._events).forEach(function(t){a.on(t,this[this._events[t]],this)},this)}}),t.exports=s},function(t,e,n){"use strict";var i=n(34),r=n(68),o=n(29),a=n(79),s=n(75);t.exports=function(t,e,n,c){var u=[t.blockID,(new Date).getTime(),"raw"].join("-"),l=new FormData,h=t.attachmentName||r.defaults.attachmentName,d=t.attachmentFile||r.defaults.attachmentFile,f=t.attachmentUid||r.defaults.attachmentUid;l.append(h,e.name),l.append(d,e),l.append(f,u),s.trigger("onUploadStart",l),t.resetMessages();var p=function(e){o.log("Upload callback called"),s.trigger("onUploadStop",e),!i.isUndefined(n)&&i.isFunction(n)&&n.apply(t,arguments,e),t.removeQueuedItem(u)},m=function(e,n,r){o.log("Upload callback error called"),s.trigger("onUploadStop",undefined,r,n,e),!i.isUndefined(c)&&i.isFunction(c)&&c.call(t,n),t.removeQueuedItem(u)},g=t.uploadUrl||r.defaults.uploadUrl,v=a.fetch(g,{body:l,method:"POST",dataType:"json"});return t.addQueuedItem(u,v),v.then(p)["catch"](m),v}},function(t,e,n){"use strict";var i=n(70)["default"],r=n(2)["default"];n(80);var o=n(81),a=n(82),s=n(68),c=i(null);c.fetch=function(t){var e,n=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];return e=(n=r({},s.defaults.ajaxOptions,n)).jsonp?o(t).promise:fetch(t,n).then(function(t){return"json"===n.dataType?t.json():t.text()}),a(e)},t.exports=c},function(){!function(){"use strict";function t(t){if("string"!=typeof t&&(t=t.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function e(t){return"string"!=typeof t&&(t=t.toString()),t}function n(t){this.map={},t instanceof n?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function i(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function r(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function o(t){var e=new FileReader;return e.readAsArrayBuffer(t),r(e)}function a(t){var e=new FileReader;return e.readAsText(t),r(e)}function s(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(f.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(f.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else{if(t)throw new Error("unsupported BodyInit type");this._bodyText=""}},f.blob?(this.blob=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(o)},this.text=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return a(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=i(this);return t||Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(t){var e=t.toUpperCase();return p.indexOf(e)>-1?e:t}function u(t,e){if(e=e||{},this.url=t,this.credentials=e.credentials||"omit",this.headers=new n(e.headers),this.method=c(e.method||"GET"),this.mode=e.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(e.body)}function l(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}}),e}function h(t){var e=new n;return t.getAllResponseHeaders().trim().split("\n").forEach(function(t){var n=t.trim().split(":"),i=n.shift().trim(),r=n.join(":").trim();e.append(i,r)}),e}function d(t,e){e||(e={}),this._initBody(t),this.type="default",this.url=null,this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof n?e.headers:new n(e.headers),this.url=e.url||""}if(!self.fetch){n.prototype.append=function(n,i){n=t(n),i=e(i);var r=this.map[n];r||(r=[],this.map[n]=r),r.push(i)},n.prototype["delete"]=function(e){delete this.map[t(e)]},n.prototype.get=function(e){var n=this.map[t(e)];return n?n[0]:null},n.prototype.getAll=function(e){return this.map[t(e)]||[]},n.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},n.prototype.set=function(n,i){this.map[t(n)]=[e(i)]},n.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(i){t.call(e,i,n,this)},this)},this)};var f={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self},p=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];s.call(u.prototype),s.call(d.prototype),self.Headers=n,self.Request=u,self.Response=d,self.fetch=function(t,e){var n;return n=u.prototype.isPrototypeOf(t)&&!e?t:new u(t,e),new Promise(function(t,e){function i(){return"responseURL"in r?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):void 0}var r=new XMLHttpRequest;r.onload=function(){var n=1223===r.status?204:r.status;if(n<100||n>599)e(new TypeError("Network request failed"));else{var o={status:n,statusText:r.statusText,headers:h(r),url:i()},a="response"in r?r.response:r.responseText;t(new d(a,o))}},r.onerror=function(){e(new TypeError("Network request failed"))},r.open(n.method,n.url,!0),"include"===n.credentials&&(r.withCredentials=!0),"responseType"in r&&f.blob&&(r.responseType="blob"),n.headers.forEach(function(t,e){r.setRequestHeader(e,t)}),r.send("undefined"==typeof n._bodyInit?null:n._bodyInit)})},self.fetch.polyfill=!0}}()},function(t){var e=0,n=function(t,n){var i,r,o,a,s,c=(n=n||{}).prefix||"__jp",u=n.param||"callback",l=n.timeout?n.timeout:15e3,h=document.getElementsByTagName("script")[0]||document.head,d=function(){},f=c+e++;return o=function(){i&&i.parentNode&&i.parentNode.removeChild(i),window[f]=d,r&&clearTimeout(r)},s=new Promise(function(e,n){l&&(r=setTimeout(function(){o(),n(new Error("Timeout"))},l)),window[f]=function(t){o(),e(t)},t=(t+=(~t.indexOf("?")?"&":"?")+u+"="+encodeURIComponent(f)).replace("?&","?"),(i=document.createElement("script")).src=t,h.parentNode.insertBefore(i,h),a=function(){window[f]&&(o(),n(new Error("Canceled")))}}),{promise:s,cancel:a}};t.exports=n},function(t,e,n){"use strict";var i=n(83)["default"],r=function(t){var e,n,r=new i(function(t,i){e=t,n=i});return t.then(function(t){r.cancelled||e(t)},function(t){r.cancelled||n(t)}),r.cancel=function(){this.cancelled=!0},r};t.exports=r},function(t,e,n){t.exports={"default":n(84),__esModule:!0}},function(t,e,n){n(85),n(86),n(102),n(107),t.exports=n(7).Promise},function(){},function(t,e,n){"use strict";var i=n(87)(!0);n(89)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:undefined,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){var i=n(88),r=n(13);t.exports=function(t){return function(e,n){var o,a,s=String(r(e)),c=i(n),u=s.length;return c<0||c>=u?t?"":undefined:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):o:t?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},function(t){var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:e)(t)}},function(t,e,n){"use strict";var i=n(90),r=n(5),o=n(91),a=n(92),s=n(95),c=n(96),u=n(97),l=n(98),h=n(11).getProto,d=n(99)("iterator"),f=!([].keys&&"next"in[].keys()),p="@@iterator",m="keys",g="values",v=function(){return this};t.exports=function(t,e,n,y,b,_,x){u(n,e,y);var w,S,k=function(t){if(!f&&t in L)return L[t];switch(t){case m:case g:return function(){return new n(this,t)}}return function(){return new n(this,t)}},E=e+" Iterator",T=b==g,C=!1,L=t.prototype,P=L[d]||L[p]||b&&L[b],A=P||k(b);if(P){var N=h(A.call(new t));l(N,E,!0),!i&&s(L,p)&&a(N,d,v),T&&P.name!==g&&(C=!0,A=function(){return P.call(this)})}if(i&&!x||!f&&!C&&L[d]||a(L,d,A),c[e]=A,c[E]=v,b)if(w={values:T?A:k(g),keys:_?A:k(m),entries:T?k("entries"):A},x)for(S in w)S in L||o(L,S,w[S]);else r(r.P+r.F*(f||C),e,w);return w}},function(t){t.exports=!0},function(t,e,n){t.exports=n(92)},function(t,e,n){var i=n(11),r=n(93);t.exports=n(94)?function(t,e,n){return i.setDesc(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){t.exports=!n(16)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t){t.exports={}},function(t,e,n){"use strict";var i=n(11),r=n(93),o=n(98),a={};n(92)(a,n(99)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i.create(a,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var i=n(11).setDesc,r=n(95),o=n(99)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){var i=n(100)("wks"),r=n(101),o=n(6).Symbol;t.exports=function(t){return i[t]||(i[t]=o&&o[t]||(o||r)("Symbol."+t))}},function(t,e,n){var i=n(6),r="__core-js_shared__",o=i[r]||(i[r]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t){var e=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(t===undefined?"":t,")_",(++e+n).toString(36))}},function(t,e,n){n(103);var i=n(96);i.NodeList=i.HTMLCollection=i.Array},function(t,e,n){"use strict";var i=n(104),r=n(105),o=n(96),a=n(106);t.exports=n(89)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=undefined,r(1)):"keys"==e?r(0,n):"values"==e?r(0,t[n]):r(0,[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t){t.exports=function(){}},function(t){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var i=n(14),r=n(13);t.exports=function(t){return i(r(t))}},function(t,e,n){"use strict";var i,r=n(11),o=n(90),a=n(6),s=n(8),c=n(108),u=n(5),l=n(109),h=n(110),d=n(9),f=n(111),p=n(112),m=n(117).set,g=n(118),v=n(99)("species"),y=n(119),b=n(120),_="Promise",x=a.process,w="process"==c(x),S=a[_],k=function(t){var e=new S(function(){});return t&&(e.constructor=Object),S.resolve(e)===e},E=function(){function t(e){var n=new S(e);return m(n,t.prototype),n}var e=!1;try{if(e=S&&S.resolve&&k(),m(t,S),t.prototype=r.create(S.prototype,{constructor:{value:t}}),t.resolve(5).then(function(){})instanceof t||(e=!1),e&&n(94)){var i=!1;S.resolve(r.setDesc({},"then",{get:function(){i=!0}})),e=i}}catch(o){e=!1}return e}(),T=function(t,e){return!(!o||t!==S||e!==i)||g(t,e)},C=function(t){var e=h(t)[v];return e!=undefined?e:t},L=function(t){var e;return!(!l(t)||"function"!=typeof(e=t.then))&&e},P=function(t){var e,n;this.promise=new t(function(t,i){if(e!==undefined||n!==undefined)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=d(e),this.reject=d(n)},A=function(t){try{t()}catch(e){return{error:e}}},N=function(t,e){if(!t.n){t.n=!0;var n=t.c;b(function(){for(var i=t.v,r=1==t.s,o=0,s=function(e){var n,o,a=r?e.ok:e.fail,s=e.resolve,c=e.reject;try{a?(r||(t.h=!0),(n=!0===a?i:a(i))===e.promise?c(TypeError("Promise-chain cycle")):(o=L(n))?o.call(n,s,c):s(n)):c(i)}catch(u){c(u)}};n.length>o;)s(n[o++]);n.length=0,t.n=!1,e&&setTimeout(function(){var e,n,r=t.p;R(r)&&(w?x.emit("unhandledRejection",i,r):(e=a.onunhandledrejection)?e({promise:r,reason:i}):(n=a.console)&&n.error&&n.error("Unhandled promise rejection",i)),t.a=undefined},1)})}},R=function(t){var e,n=t._d,i=n.a||n.c,r=0;if(n.h)return!1;for(;i.length>r;)if((e=i[r++]).fail||!R(e.promise))return!1;return!0},I=function(t){var e=this;e.d||(e.d=!0,(e=e.r||e).v=t,e.s=2,e.a=e.c.slice(),N(e,!0))},D=function(t){var e,n=this;if(!n.d){n.d=!0,n=n.r||n;try{if(n.p===t)throw TypeError("Promise can't be resolved itself");(e=L(t))?b(function(){var i={r:n,d:!1};try{e.call(t,s(D,i,1),s(I,i,1))}catch(r){I.call(i,r)}}):(n.v=t,n.s=1,N(n,!1))}catch(i){I.call({r:n,d:!1},i)}}};E||(S=function(t){d(t);var e=this._d={p:f(this,S,_),c:[],a:undefined,s:0,d:!1,v:undefined,h:!1,n:!1};try{t(s(D,e,1),s(I,e,1))}catch(n){I.call(e,n)}},n(125)(S.prototype,{then:function(t,e){var n=new P(y(this,S)),i=n.promise,r=this._d;return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,r.c.push(n),r.a&&r.a.push(n),r.s&&N(r,!1),i},"catch":function(t){return this.then(undefined,t)}})),u(u.G+u.W+u.F*!E,{Promise:S}),n(98)(S,_),n(126)(_),i=n(7)[_],u(u.S+u.F*!E,_,{reject:function(t){var e=new P(this);return(0,e.reject)(t),e.promise}}),u(u.S+u.F*(!E||k(!0)),_,{resolve:function(t){if(t instanceof S&&T(t.constructor,this))return t;var e=new P(this);return(0,e.resolve)(t),e.promise}}),u(u.S+u.F*!(E&&n(127)(function(t){S.all(t)["catch"](function(){})})),_,{all:function(t){var e=C(this),n=new P(e),i=n.resolve,o=n.reject,a=[],s=A(function(){p(t,!1,a.push,a);var n=a.length,s=Array(n);n?r.each.call(a,function(t,r){var a=!1;e.resolve(t).then(function(t){a||(a=!0,s[r]=t,--n||i(s))},o)}):i(s)});return s&&o(s.error),n.promise},race:function(t){var e=C(this),n=new P(e),i=n.reject,r=A(function(){p(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r&&i(r.error),n.promise}})},function(t,e,n){var i=n(15),r=n(99)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,a;return t===undefined?"Undefined":null===t?"Null":"string"==typeof(n=(e=Object(t))[r])?n:o?i(e):"Object"==(a=i(e))&&"function"==typeof e.callee?"Arguments":a}},function(t){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(109);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError(n+": use the 'new' operator!");return t}},function(t,e,n){var i=n(8),r=n(113),o=n(114),a=n(110),s=n(115),c=n(116);t.exports=function(t,e,n,u){var l,h,d,f=c(t),p=i(n,u,e?2:1),m=0;if("function"!=typeof f)throw TypeError(t+" is not iterable!");if(o(f))for(l=s(t.length);l>m;m++)e?p(a(h=t[m])[0],h[1]):p(t[m]);else for(d=f.call(t);!(h=d.next()).done;)r(d,p,h.value,e)}},function(t,e,n){var i=n(110);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(a){var o=t["return"];throw o!==undefined&&i(o.call(t)),a}}},function(t,e,n){var i=n(96),r=n(99)("iterator"),o=Array.prototype;t.exports=function(t){return t!==undefined&&(i.Array===t||o[r]===t)}},function(t,e,n){var i=n(88),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){var i=n(108),r=n(99)("iterator"),o=n(96);t.exports=n(7).getIteratorMethod=function(t){if(t!=undefined)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){var i=n(11).getDesc,r=n(109),o=n(110),a=function(t,e){if(o(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(8)(Function.call,i(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(o){e=!0}return function(t,n){return a(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):undefined),check:a}},function(t){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var i=n(110),r=n(9),o=n(99)("species");t.exports=function(t,e){var n,a=i(t).constructor;return a===undefined||(n=i(a)[o])==undefined?e:r(n)}},function(t,e,n){var i,r,o,a=n(6),s=n(121).set,c=a.MutationObserver||a.WebKitMutationObserver,u=a.process,l=a.Promise,h="process"==n(15)(u),d=function(){var t,e,n;for(h&&(t=u.domain)&&(u.domain=null,t.exit());i;)e=i.domain,n=i.fn,e&&e.enter(),n(),e&&e.exit(),i=i.next;r=undefined,t&&t.enter()};if(h)o=function(){u.nextTick(d)};else if(c){var f=1,p=document.createTextNode("");new c(d).observe(p,{characterData:!0}),o=function(){p.data=f=-f}}else o=l&&l.resolve?function(){l.resolve().then(d)}:function(){s.call(a,d)};t.exports=function(t){var e={fn:t,next:undefined,domain:h&&u.domain};r&&(r.next=e),i||(i=e,o()),r=e}},function(t,e,n){var i,r,o,a=n(8),s=n(122),c=n(123),u=n(124),l=n(6),h=l.process,d=l.setImmediate,f=l.clearImmediate,p=l.MessageChannel,m=0,g={},v="onreadystatechange",y=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},b=function(t){y.call(t.data)};d&&f||(d=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++m]=function(){s("function"==typeof t?t:Function(t),e)},i(m),m},f=function(t){delete g[t]},"process"==n(15)(h)?i=function(t){h.nextTick(a(y,t,1))}:p?(o=(r=new p).port2,r.port1.onmessage=b,i=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(i=function(t){l.postMessage(t+"","*")},l.addEventListener("message",b,!1)):i=v in u("script")?function(t){c.appendChild(u("script"))[v]=function(){c.removeChild(this),y.call(t)}}:function(t){setTimeout(a(y,t,1),0)}),t.exports={set:d,clear:f}},function(t){t.exports=function(t,e,n){var i=n===undefined;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){t.exports=n(6).document&&document.documentElement},function(t,e,n){var i=n(109),r=n(6).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){var i=n(91);t.exports=function(t,e){for(var n in e)i(t,n,e[n]);return t}},function(t,e,n){"use strict";var i=n(7),r=n(11),o=n(94),a=n(99)("species");t.exports=function(t){var e=i[t];o&&e&&!e[a]&&r.setDesc(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i=n(99)("iterator"),r=!1;try{var o=[7][i]();o["return"]=function(){r=!0},Array.from(o,function(){throw 2})}catch(a){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],s=o[i]();s.next=function(){n=!0},o[i]=function(){return s},t(o)}catch(a){}return n}},function(t,e,n){"use strict";t.exports={Ajaxable:n(129),Controllable:n(130),Droppable:n(132),Fetchable:n(134),Pastable:n(135),Uploadable:n(136),MultiEditable:n(137),Textable:n(229)}},function(t,e,n){"use strict";var i=n(29);t.exports={mixinName:"Ajaxable",ajaxable:!0,initializeAjaxable:function(){this._queued=[]},addQueuedItem:function(t,e){i.log("Adding queued item for "+this.blockID+" called "+t),this._queued.push({name:t,deferred:e})},removeQueuedItem:function(t){i.log("Removing queued item for "+this.blockID+" called "+t),this._queued=this._queued.filter(function(e){return e.name!==t})},hasItemsInQueue:function(){return this._queued.length>0},resolveAllInQueue:function(){this._queued.forEach(function(t){i.log("Aborting queued request: "+t.name),t.deferred.cancel()},this)}}},function(t,e,n){"use strict";var i=n(30)["default"],r=n(29),o=n(68),a=n(69),s=n(131);t.exports={mixinName:"Controllable",initializeControllable:function(){r.log("Adding controllable to block "+this.blockID),this.inner.classList.add("st-block__inner--controllable"),this.control_ui=a.createElement("div",{"class":"st-block__control-ui"}),i(this.controls).forEach(function(t){this.addUiControl(t,this.controls[t].bind(this))},this),this.inner.appendChild(this.control_ui)},getControlTemplate:function(t){return a.createElement("a",{"data-icon":t,"class":"st-icon st-block-control-ui-btn st-block-control-ui-btn--"+t,html:'<svg role="img" class="st-icon">\n                  <use xlink:href="'+o.defaults.iconUrl+"#"+t+'"/>\n                </svg>'})},addUiControl:function(t,e){var n=this;this.control_ui.appendChild(this.getControlTemplate(t)),s.delegate(this.control_ui,".st-block-control-ui-btn--"+t,"click",function(i){n.selectUiControl(t),e(i)})},selectUiControl:function(t){var e=this,n="st-block-control-ui-btn--selected";i(this.controls).forEach(function(t){e.getControlUiBtn(t).classList.remove(n)}),this.getControlUiBtn(t).classList.add(n)},getControlUiBtn:function(t){return this.control_ui.querySelector(".st-block-control-ui-btn--"+t)}}},function(t,e,n){"use strict";var i=n(69),r=function(t,e){for(var n,i={},r={shared:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),mouseEvent:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),keyEvent:"char charCode key keyCode".split(" ")},o=/^key/,a=/^(?:mouse|pointer|contextmenu|drag|drop)|click/.test(t.type)?r.shared.concat(r.mouseEvent):o.test(t.type)?r.shared.concat(r.keyEvent):r.shared,s=0;s<a.length;s++)i[n=a[s]]=t[n];return i.currentTarget=e,i.originalEvent=t,i.preventDefault=function(){this.originalEvent&&this.originalEvent.preventDefault()},i.stopPropagation=function(){this.originalEvent&&this.originalEvent.stopPropagation()},i};t.exports.delegate=function(t,e,n,o){var a=!(arguments.length<=4||arguments[4]===undefined)&&arguments[4];t.addEventListener(n,function(n){for(var a=n.target;a&&a!==t;a=a.parentNode)if(i.matches(a,e)){o.call(a,r(n,a));break}a=null},a)}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(68),a=n(29),s=n(69),c=n(133),u=n(75);t.exports={mixinName:"Droppable",valid_drop_file_types:["File","Files","text/plain","text/uri-list"],requireInputs:!0,initializeDroppable:function(){a.log("Adding droppable to block "+this.blockID),this.drop_options=i({},o.defaults.Block.drop_options,this.drop_options),s.hide(this.editor),this.inputs.insertAdjacentHTML("beforeend",r.template(this.drop_options.html,{block:this,_:r,config:o})),c.dropArea(this.inputs.lastElementChild).addEventListener("drop",this._handleDrop.bind(this)),this.el.classList.add("st-block--droppable"),this.inner.classList.add("st-block__inner--droppable"),this._setupKeyEvents()},_handleDrop:function(t){t.preventDefault(),t.stopPropagation();var e=t.target,n=[].slice.call(t.dataTransfer.types);e.classList.remove("st-dropzone--dragover"),n&&n.some(function(t){return this.valid_drop_file_types.includes(t)},this)&&this.onDrop(t.dataTransfer),u.trigger("block:content:dropped",this.blockID)},focus:function(){this.inner.focus()},_setupKeyEvents:function(){var t=this;this.inner.setAttribute("tabindex",0),this.inner.addEventListener("keyup",function(e){if(e.target===t.inner)switch(e.keyCode){case 13:t.mediator.trigger("block:create","Text",null,t.el);break;case 8:return void t.onDeleteClick.call(t,new CustomEvent("click"))}})}}},function(t){"use strict";function e(t){t.preventDefault(),t.stopPropagation()}function n(t){t.dataTransfer.dropEffect="copy",t.currentTarget.classList.add("st-drag-over"),t.preventDefault(),t.stopPropagation()}function i(t){t.currentTarget.classList.remove("st-drag-over"),t.preventDefault(),t.stopPropagation()}t.exports={dropArea:function(t){return t.addEventListener("dragenter",e),t.addEventListener("dragover",n),t.addEventListener("dragleave",i),t},noDropArea:function(t){return t.removeEventListener("dragenter"),t.removeEventListener("dragover"),t.removeEventListener("dragleave"),t}}},function(t,e,n){"use strict";var i=n(34),r=n(79);t.exports={mixinName:"Fetchable",initializeFetchable:function(){this.withMixin(n(129))},fetch:function(t,e,n,o){function a(t,e){t.call(this,e),this.removeQueuedItem(s)}var s=i.uniqueId(this.blockID+"_fetch"),c=r.fetch(t,e);return this.resetMessages(),this.addQueuedItem(s,c),i.isUndefined(n)||c.then(a.bind(this,n)),i.isUndefined(o)||c["catch"](a.bind(this,o)),c}}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(68),a=n(29);t.exports={mixinName:"Pastable",requireInputs:!0,initializePastable:function(){var t=this;a.log("Adding pastable to block "+this.blockID),this.paste_options=i({},o.defaults.Block.paste_options,this.paste_options),this.inputs.insertAdjacentHTML("beforeend",r.template(this.paste_options.html,this)),Array.prototype.forEach.call(this.$(".st-paste-block"),function(e){e.addEventListener("click",function(){var t=document.createEvent("HTMLEvents");t.initEvent("select",!0,!1),this.dispatchEvent(t)}),e.addEventListener("paste",t._handleContentPaste),e.addEventListener("submit",t._handleContentPaste)})}}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(68),a=n(29),s=n(78);t.exports={mixinName:"Uploadable",uploadsCount:0,requireInputs:!0,initializeUploadable:function(){a.log("Adding uploadable to block "+this.blockID),this.withMixin(n(129)),this.upload_options=i({},o.defaults.Block.upload_options,this.upload_options),this.inputs.insertAdjacentHTML("beforeend",r.template(this.upload_options.html,this)),Array.prototype.forEach.call(this.inputs.querySelectorAll("button"),function(t){t.addEventListener("click",function(t){t.preventDefault()})}),Array.prototype.forEach.call(this.inputs.querySelectorAll("input"),function(t){t.addEventListener("change",function(t){this.onDrop(t.currentTarget)}.bind(this))}.bind(this))},uploader:function(t,e,n){return s(this,t,e,n)}}},function(t,e,n){"use strict";var i=n(34),r=n(138);t.exports={mixinName:"MultiEditable",initializeMultiEditable:function(){this.editors={}},newTextEditor:function(t,e){var n,o,a;(o=t.tagName===undefined)?((a=document.createElement("div")).innerHTML=t,n=a.querySelector(".st-block__editor")):n=t;var s=i.uniqueId("editor-");n.setAttribute("data-editorId",s),n.addEventListener("keyup",this.getSelectionForFormatter),n.addEventListener("mouseup",this.getSelectionForFormatter);var c=i.isFunction(this.configureScribe)?this.configureScribe.bind(this):null,u=r.initScribeInstance(n,this.scribeOptions,c);u.setContent(e);var l={node:o?a.removeChild(a.firstChild):n,el:n,scribe:u,id:s};return this.editors[s]=l,l},getCurrentTextEditor:function(){var t=document.activeElement.getAttribute("data-editorId"),e=this.getTextEditor(t);return e&&(this.currentEditor=e),this.currentEditor},appendToTextEditor:function(t,e){var n=this.getTextEditor(t).scribe,i=new n.api.Selection,r=i.range.cloneRange(),o=n.el.lastChild;r.setStartAfter(o),r.collapse(!0),i.selection.removeAllRanges(),i.selection.addRange(r),e&&n.insertHTML(e)},getCurrentScribeInstance:function(){return this.getCurrentTextEditor().scribe},getTextEditor:function(t){return this.editors[t]},removeTextEditor:function(t){delete this.editors[t]},execTextBlockCommand:function(t){return r.execTextBlockCommand(this.getCurrentScribeInstance(),t)},queryTextBlockCommandState:function(t){return r.queryTextBlockCommandState(this.getCurrentScribeInstance(),t)}}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(139),a=n(68),s=n(206),c=n(207),u=n(208),l={p:!0,a:{href:!0,target:"_blank",rel:!0},i:!0,b:!0,strong:!0,em:!0};t.exports={initScribeInstance:function(t,e,n){e=e||{};var h={debug:a.scribeDebug},d=l;r.isObject(e)&&(h=i(h,e));var f=new o(t,h);return e.hasOwnProperty("tags")&&(d=i(l,e.tags)),f.use(s()),f.use(c()),f.use(u({tags:d})),r.isFunction(n)&&n.call(this,f),f},execTextBlockCommand:function(t,e){if(r.isUndefined(t))throw"No Scribe instance found to query command";var n=t.getCommand(e);return t.el.focus(),n.execute()},queryTextBlockCommandState:function(t,e){if(r.isUndefined(t))throw"No Scribe instance found to query command";var n=t.getCommand(e);return(new t.api.Selection).range&&n.queryState()}}},function(t,e,n){var i,r;i=[n(162),n(192),n(171),n(176),n(179),n(187),n(140),n(200),n(201),n(167),n(165),n(202)],(r=function(t,e,n,i,r,o,a,s,c,u,l,h){"use strict";function d(u,d){c.call(this),this.el=u,this.commands={},this.options=h.checkOptions(d),this.commandPatches={},this._plainTextFormatterFactory=new f,this._htmlFormatterFactory=new p,this.api=new o(this),this.Immutable=l;var m=a(this);this.transactionManager=new m,this.undoManager=!1,this.options.undo.enabled&&(this.options.undo.manager?this.undoManager=this.options.undo.manager:this.undoManager=new s(this.options.undo.limit,this.el),this._merge=!1,this._forceMerge=!1,this._mergeTimer=0,this._lastItem={content:""}),this.setHTML(this.getHTML()),this.el.setAttribute("contenteditable",!0),this.el.addEventListener("input",function(){this.transactionManager.run()}.bind(this),!1);var g=l.OrderedSet(this.options.defaultPlugins).sort(h.sortByPlugin("setRootPElement")).filter(h.filterByBlockLevelMode(this.allowsBlockElements())).map(function(e){return t[e]}),v=l.List(this.options.defaultFormatters).filter(function(t){return!!n[t]}).map(function(t){return n[t]}),y=l.List.of(r.events),b=l.List(this.options.defaultCommandPatches).map(function(t){return r.commands[t]}),_=l.List.of("indent","insertList","outdent","redo","subscript","superscript","undo").map(function(t){return e[t]});l.List().concat(g,v,y,b,_).forEach(function(t){this.use(t())}.bind(this)),this.use(i())}function f(){this.formatters=l.List()}function p(){this.formatters={sanitize:l.List(),normalize:l.List(),"export":l.List()}}return d.prototype=Object.create(c.prototype),d.prototype.node=u,d.prototype.element=d.prototype.node,d.prototype.use=function(t){return t(this),this},d.prototype.setHTML=function(t,e){this._lastItem.content=t,e&&(this._skipFormatters=!0),this.el.innerHTML!==t&&(this.el.innerHTML=t)},d.prototype.getHTML=function(){return this.el.innerHTML},d.prototype.getContent=function(){return this._htmlFormatterFactory.formatForExport(this.getHTML().replace(/<br>$/,""))},d.prototype.getTextContent=function(){return this.el.textContent},d.prototype.pushHistory=function(){var t=this;if(t.options.undo.enabled){var e=t._lastItem.content.replace(/<em [^>]*class="scribe-marker"[^>]*>[^<]*?<\/em>/g,"");if(t.getHTML()!==e){var n=new t.api.Selection;n.placeMarkers();var i=t.getHTML();n.removeMarkers();var r=t.undoManager.item(t.undoManager.position);return(t._merge||t._forceMerge)&&r&&t._lastItem==r[0]?t._lastItem.content=i:(t._lastItem={previousItem:t._lastItem,content:i,scribe:t,execute:function(){},undo:function(){this.scribe.restoreFromHistory(this.previousItem)},redo:function(){this.scribe.restoreFromHistory(this)}},t.undoManager.transact(t._lastItem,!1)),clearTimeout(t._mergeTimer),t._merge=!0,t._mergeTimer=setTimeout(function(){t._merge=!1},t.options.undo.interval),!0}}return!1},d.prototype.getCommand=function(t){return this.commands[t]||this.commandPatches[t]||new this.api.Command(t)},d.prototype.restoreFromHistory=function(t){this._lastItem=t,this.setHTML(t.content,!0);(new this.api.Selection).selectMarkers(),this.trigger("content-changed")},d.prototype.allowsBlockElements=function(){return this.options.allowBlockElements},d.prototype.setContent=function(t){this.allowsBlockElements()||(t+="<br>"),
this.setHTML(t),this.trigger("content-changed")},d.prototype.insertPlainText=function(t){this.insertHTML("<p>"+this._plainTextFormatterFactory.format(t)+"</p>")},d.prototype.insertHTML=function(t){this.getCommand("insertHTML").execute(this._htmlFormatterFactory.format(t))},d.prototype.isDebugModeEnabled=function(){return this.options.debug},d.prototype.registerHTMLFormatter=function(t,e){this._htmlFormatterFactory.formatters[t]=this._htmlFormatterFactory.formatters[t].push(e)},d.prototype.registerPlainTextFormatter=function(t){this._plainTextFormatterFactory.formatters=this._plainTextFormatterFactory.formatters.push(t)},f.prototype.format=function(t){return this.formatters.reduce(function(t,e){return e(t)},t)},p.prototype=Object.create(f.prototype),p.prototype.constructor=p,p.prototype.format=function(t){return this.formatters.sanitize.concat(this.formatters.normalize).reduce(function(t,e){return e(t)},t)},p.prototype.formatForExport=function(t){return this.formatters["export"].reduce(function(t,e){return e(t)},t)},d}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(141)],(r=function(t){"use strict";return function(e){function n(){this.history=[]}return t(n.prototype,{start:function(){this.history.push(1)},end:function(){this.history.pop(),0===this.history.length&&(e.pushHistory(),e.trigger("content-changed"))},run:function(t,n){this.start();try{t&&t()}finally{e._forceMerge=!0===n,this.end(),e._forceMerge=!1}}}),n}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(142),n(158)],(r=function(t,e){return e(t)}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(143),n(144)],(r=function(t,e){function n(n,i,r){var o=e(i);if(!r)return t(i,n,o);for(var a=-1,s=o.length;++a<s;){var c=o[a],u=n[c],l=r(u,i[c],c,n,i);(l==l?l===u:u!=u)&&(void 0!==u||c in n)||(n[c]=l)}return n}return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t,e,n){n||(n=e,e={});for(var i=-1,r=n.length;++i<r;){var o=n[i];e[o]=t[o]}return e}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(145),n(146),n(150),n(151)],(r=function(t,e,n,i){var r=e(r=Object.keys)&&r;return r?function(e){if(e)var o=e.constructor,a=e.length;return"function"==typeof o&&o.prototype===e||"function"!=typeof e&&a&&t(a)?i(e):n(e)?r(e):[]}:i}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=e}var e=Math.pow(2,53)-1;return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(147),n(149)],(r=function(t,e){function n(t){return null!=t&&(s.call(t)==i?c.test(a.call(t)):e(t)&&r.test(t)||!1)}var i="[object Function]",r=/^\[object .+?Constructor\]$/,o=Object.prototype,a=Function.prototype.toString,s=o.toString,c=RegExp("^"+t(s).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(148)],(r=function(t){function e(e){return(e=t(e))&&i.test(e)?e.replace(n,"\\$&"):e}var n=/[.*+?^${}()|[\]\/\\]/g,i=RegExp(n.source);return e}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t){return"string"==typeof t?t:null==t?"":t+""}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e){var n,i;n=[],(i=function(){function t(t){return t&&"object"==typeof t||!1}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e){var n,i;n=[],(i=function(){function t(t){var e=typeof t;return"function"==e||t&&"object"==e||!1}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(152),n(153),n(154),n(145),n(155),n(156)],(r=function(t,e,n,i,r,o){function a(a){for(var c=r(a),u=c.length,l=u&&a.length,h=l&&i(l)&&(e(a)||o.nonEnumArgs&&t(a)),d=-1,f=[];++d<u;){var p=c[d];(h&&n(p,l)||s.call(a,p))&&f.push(p)}return f}var s=Object.prototype.hasOwnProperty;return a}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(145),n(149)],(r=function(t,e){function n(n){var a=e(n)?n.length:i;return t(a)&&o.call(n)==r||!1}var i,r="[object Arguments]",o=Object.prototype.toString;return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(145),n(146),n(149)],(r=function(t,e,n){var i="[object Array]",r=Object.prototype.toString,o=e(o=Array.isArray)&&o;return o||function(e){return n(e)&&t(e.length)&&r.call(e)==i||!1}}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t,n){return t=+t,n=null==n?e:n,t>-1&&t%1==0&&t<n}var e=Math.pow(2,53)-1;return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(152),n(153),n(154),n(145),n(150),n(156)],(r=function(t,e,n,i,r,o){function a(a){if(null==a)return[];r(a)||(a=Object(a));var c=a.length;c=c&&i(c)&&(e(a)||o.nonEnumArgs&&t(a))&&c||0;for(var u=a.constructor,l=-1,h="function"==typeof u&&u.prototype===a,d=Array(c),f=c>0;++l<c;)d[l]=l+"";for(var p in a)f&&n(p,c)||"constructor"==p&&(h||!s.call(a,p))||d.push(p);return d}var s=Object.prototype.hasOwnProperty;return a}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(146),n(157)],(r=function(t,e){var n=/\bthis\b/,i=Object.prototype,r=(r=e.window)&&r.document,o=i.propertyIsEnumerable,a={};return function(){a.funcDecomp=!t(e.WinRTError)&&n.test(function(){return this}),a.funcNames="string"==typeof Function.name;try{a.dom=11===r.createDocumentFragment().nodeType}catch(i){a.dom=!1}try{a.nonEnumArgs=!o.call(arguments,1)}catch(i){a.nonEnumArgs=!0}}(0,0),a}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;(function(t,n){i=[],(r=function(){var i={"function":!0,object:!0},r=i[typeof e]&&e&&!e.nodeType&&e,o=i[typeof t]&&t&&!t.nodeType&&t,a=r&&o&&"object"==typeof n&&n,s=i[typeof window]&&window;return a||s!==(this&&this.window)&&s||this}.apply(e,i))===undefined||(t.exports=r)}).call(e,n(26)(t),function(){return this}())},function(t,e,n){var i,r;i=[n(159),n(161)],(r=function(t,e){function n(n){return function(){var i=arguments,r=i.length,o=i[0];if(r<2||null==o)return o;var a=i[r-2],s=i[r-1],c=i[3];r>3&&"function"==typeof a?(a=t(a,s,5),r-=2):r-=(a=r>2&&"function"==typeof s?s:null)?1:0,c&&e(i[1],i[2],c)&&(a=3==r?null:a,r=2);for(var u=0;++u<r;){var l=i[u];l&&n(o,l,a)}return o}}return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(160)],(r=function(t){function e(e,n,i){if("function"!=typeof e)return t;if(void 0===n)return e;switch(i){case 1:return function(t){return e.call(n,t)};case 3:return function(t,i,r){return e.call(n,t,i,r)};case 4:return function(t,i,r,o){return e.call(n,t,i,r,o)};case 5:return function(t,i,r,o,a){return e.call(n,t,i,r,o,a)}}return function(){return e.apply(n,arguments)}}return e}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t){return t}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(154),n(145),n(150)],(r=function(t,e,n){function i(i,r,o){if(!n(o))return!1;var a=typeof r;if("number"==a)var s=o.length,c=e(s)&&t(r,s);else c="string"==a&&r in o;if(c){var u=o[r];return i==i?i===u:u!=u}return!1}return i}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(163),n(164),n(166),n(170)],(r=function(t,e,n,i){"use strict";return{setRootPElement:t,enforcePElements:e,ensureSelectableContainers:n,inlineElementsMode:i}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){""===t.getHTML().trim()&&t.setContent("<p><br></p>")}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(165)],(r=function(t){"use strict";return function(){return function(e){function n(e){var n=0;t.List(e.childNodes).filter(function(t){return t.nodeType===Node.TEXT_NODE||!r.isBlockElement(t)}).groupBy(function(t,e,i){return 0===e||t.previousSibling===i.get(e-1)?n:n+=1}).forEach(function(t){r.wrap(t.toArray(),document.createElement("p"))})}function i(t){for(var e,i=0;e=t.children[i++];)"BLOCKQUOTE"===e.tagName&&n(e)}var r=e.node;e.registerHTMLFormatter("normalize",function(t){var e=document.createElement("div");return e.innerHTML=t,n(e),i(e),e.innerHTML})}}}.apply(e,i))===undefined||(t.exports=r)},function(t){!function(e,n){t.exports=n()}(0,function(){"use strict";function t(t,e){e&&(t.prototype=Object.create(e.prototype)),t.prototype.constructor=t}function e(t){return o(t)?t:P(t)}function n(t){return a(t)?t:A(t)}function i(t){return s(t)?t:N(t)}function r(t){return o(t)&&!c(t)?t:R(t)}function o(t){return!(!t||!t[un])}function a(t){return!(!t||!t[ln])}function s(t){return!(!t||!t[hn])}function c(t){return a(t)||s(t)}function u(t){return!(!t||!t[dn])}function l(t){return t.value=!1,t}function h(t){t&&(t.value=!0)}function d(){}function f(t,e){e=e||0;for(var n=Math.max(0,t.length-e),i=new Array(n),r=0;r<n;r++)i[r]=t[r+e];return i}function p(t){return t.size===undefined&&(t.size=t.__iterate(g)),t.size}function m(t,e){if("number"!=typeof e){var n=e>>>0;if(""+n!==e||4294967295===n)return NaN;e=n}return e<0?p(t)+e:e}function g(){return!0}function v(t,e,n){return(0===t||n!==undefined&&t<=-n)&&(e===undefined||n!==undefined&&e>=n)}function y(t,e){return _(t,e,0)}function b(t,e){return _(t,e,e)}function _(t,e,n){return t===undefined?n:t<0?Math.max(0,e+t):e===undefined?t:Math.min(e,t)}function x(t){this.next=t}function w(t,e,n,i){var r=0===t?e:1===t?n:[e,n];return i?i.value=r:i={value:r,done:!1},i}function S(){return{value:undefined,done:!0}}function k(t){return!!C(t)}function E(t){return t&&"function"==typeof t.next}function T(t){var e=C(t);return e&&e.call(t)}function C(t){var e=t&&(Sn&&t[Sn]||t[kn]);if("function"==typeof e)return e}function L(t){return t&&"number"==typeof t.length}function P(t){return null===t||t===undefined?F():o(t)?t.toSeq():H(t)}function A(t){return null===t||t===undefined?F().toKeyedSeq():o(t)?a(t)?t.toSeq():t.fromEntrySeq():z(t)}function N(t){return null===t||t===undefined?F():o(t)?a(t)?t.entrySeq():t.toIndexedSeq():j(t)}function R(t){return(null===t||t===undefined?F():o(t)?a(t)?t.entrySeq():t:j(t)).toSetSeq()}function I(t){this._array=t,this.size=t.length}function D(t){var e=Object.keys(t);this._object=t,this._keys=e,this.size=e.length}function O(t){this._iterable=t,this.size=t.length||t.size}function B(t){this._iterator=t,this._iteratorCache=[]}function M(t){return!(!t||!t[Tn])}function F(){return Cn||(Cn=new I([]))}function z(t){var e=Array.isArray(t)?new I(t).fromEntrySeq():E(t)?new B(t).fromEntrySeq():k(t)?new O(t).fromEntrySeq():"object"==typeof t?new D(t):undefined;if(!e)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+t);return e}function j(t){var e=$(t);if(!e)throw new TypeError("Expected Array or iterable object of values: "+t);return e}function H(t){var e=$(t)||"object"==typeof t&&new D(t);if(!e)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+t);return e}function $(t){return L(t)?new I(t):E(t)?new B(t):k(t)?new O(t):undefined}function U(t,e,n,i){var r=t._cache;if(r){for(var o=r.length-1,a=0;a<=o;a++){var s=r[n?o-a:a];if(!1===e(s[1],i?s[0]:a,t))return a+1}return a}return t.__iterateUncached(e,n)}function q(t,e,n,i){var r=t._cache;if(r){var o=r.length-1,a=0;return new x(function(){var t=r[n?o-a:a];return a++>o?S():w(e,i?t[0]:a-1,t[1])})}return t.__iteratorUncached(e,n)}function W(t,e){return e?V(e,t,"",{"":t}):Z(t)}function V(t,e,n,i){return Array.isArray(e)?t.call(i,n,N(e).map(function(n,i){return V(t,n,i,e)})):G(e)?t.call(i,n,A(e).map(function(n,i){return V(t,n,i,e)})):e}function Z(t){return Array.isArray(t)?N(t).map(Z).toList():G(t)?A(t).map(Z).toMap():t}function G(t){return t&&(t.constructor===Object||t.constructor===undefined)}function K(t,e){if(t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1;if("function"==typeof t.valueOf&&"function"==typeof e.valueOf){if(t=t.valueOf(),e=e.valueOf(),t===e||t!=t&&e!=e)return!0;if(!t||!e)return!1}return!("function"!=typeof t.equals||"function"!=typeof e.equals||!t.equals(e))}function X(t,e){if(t===e)return!0;if(!o(e)||t.size!==undefined&&e.size!==undefined&&t.size!==e.size||t.__hash!==undefined&&e.__hash!==undefined&&t.__hash!==e.__hash||a(t)!==a(e)||s(t)!==s(e)||u(t)!==u(e))return!1;if(0===t.size&&0===e.size)return!0;var n=!c(t);if(u(t)){var i=t.entries();return e.every(function(t,e){var r=i.next().value;return r&&K(r[1],t)&&(n||K(r[0],e))})&&i.next().done}var r=!1;if(t.size===undefined)if(e.size===undefined)"function"==typeof t.cacheResult&&t.cacheResult();else{r=!0;var l=t;t=e,e=l}var h=!0,d=e.__iterate(function(e,i){if(n?!t.has(e):r?!K(e,t.get(i,vn)):!K(t.get(i,vn),e))return h=!1,!1});return h&&t.size===d}function Y(t,e){if(!(this instanceof Y))return new Y(t,e);if(this._value=t,this.size=e===undefined?Infinity:Math.max(0,e),0===this.size){if(Ln)return Ln;Ln=this}}function Q(t,e){if(!t)throw new Error(e)}function J(t,e,n){if(!(this instanceof J))return new J(t,e,n);if(Q(0!==n,"Cannot step a Range by 0"),t=t||0,e===undefined&&(e=Infinity),n=n===undefined?1:Math.abs(n),e<t&&(n=-n),this._start=t,this._end=e,this._step=n,this.size=Math.max(0,Math.ceil((e-t)/n-1)+1),0===this.size){if(Pn)return Pn;Pn=this}}function tt(){throw TypeError("Abstract")}function et(){}function nt(){}function it(){}function rt(t){return t>>>1&1073741824|3221225471&t}function ot(t){if(!1===t||null===t||t===undefined)return 0;if("function"==typeof t.valueOf&&(!1===(t=t.valueOf())||null===t||t===undefined))return 0;if(!0===t)return 1;var e=typeof t;if("number"===e){var n=0|t;for(n!==t&&(n^=4294967295*t);t>4294967295;)n^=t/=4294967295;return rt(n)}if("string"===e)return t.length>Mn?at(t):st(t);if("function"==typeof t.hashCode)return t.hashCode();if("object"===e)return ct(t);if("function"==typeof t.toString)return st(t.toString());throw new Error("Value type "+e+" cannot be hashed.")}function at(t){var e=jn[t];return e===undefined&&(e=st(t),zn===Fn&&(zn=0,jn={}),zn++,jn[t]=e),e}function st(t){for(var e=0,n=0;n<t.length;n++)e=31*e+t.charCodeAt(n)|0;return rt(e)}function ct(t){var e;if(Dn&&(e=An.get(t))!==undefined)return e;if((e=t[Bn])!==undefined)return e;if(!In){if((e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Bn])!==undefined)return e;if((e=ut(t))!==undefined)return e}if(e=++On,1073741824&On&&(On=0),Dn)An.set(t,e);else{if(Rn!==undefined&&!1===Rn(t))throw new Error("Non-extensible objects are not allowed as keys.");if(In)Object.defineProperty(t,Bn,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(t.propertyIsEnumerable!==undefined&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Bn]=e;else{if(t.nodeType===undefined)throw new Error("Unable to set a non-enumerable property on object.");t[Bn]=e}}return e}function ut(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}function lt(t){Q(t!==Infinity,"Cannot perform this action with an infinite size.")}function ht(t){return null===t||t===undefined?wt():dt(t)&&!u(t)?t:wt().withMutations(function(e){var i=n(t);lt(i.size),i.forEach(function(t,n){return e.set(n,t)})})}function dt(t){return!(!t||!t[Hn])}function ft(t,e){this.ownerID=t,this.entries=e}function pt(t,e,n){this.ownerID=t,this.bitmap=e,this.nodes=n}function mt(t,e,n){this.ownerID=t,this.count=e,this.nodes=n}function gt(t,e,n){this.ownerID=t,this.keyHash=e,this.entries=n}function vt(t,e,n){this.ownerID=t,this.keyHash=e,this.entry=n}function yt(t,e,n){this._type=e,this._reverse=n,this._stack=t._root&&_t(t._root)}function bt(t,e){return w(t,e[0],e[1])}function _t(t,e){return{node:t,index:0,__prev:e}}function xt(t,e,n,i){var r=Object.create($n);return r.size=t,r._root=e,r.__ownerID=n,r.__hash=i,r.__altered=!1,r}function wt(){return Un||(Un=xt(0))}function St(t,e,n){var i,r;if(t._root){var o=l(yn),a=l(bn);if(i=kt(t._root,t.__ownerID,0,undefined,e,n,o,a),!a.value)return t;r=t.size+(o.value?n===vn?-1:1:0)}else{if(n===vn)return t;r=1,i=new ft(t.__ownerID,[[e,n]])}return t.__ownerID?(t.size=r,t._root=i,t.__hash=undefined,t.__altered=!0,t):i?xt(r,i):wt()}function kt(t,e,n,i,r,o,a,s){return t?t.update(e,n,i,r,o,a,s):o===vn?t:(h(s),h(a),new vt(e,i,[r,o]))}function Et(t){return t.constructor===vt||t.constructor===gt}function Tt(t,e,n,i,r){if(t.keyHash===i)return new gt(e,i,[t.entry,r]);var o,a=(0===n?t.keyHash:t.keyHash>>>n)&gn,s=(0===n?i:i>>>n)&gn;return new pt(e,1<<a|1<<s,a===s?[Tt(t,e,n+pn,i,r)]:(o=new vt(e,i,r),a<s?[t,o]:[o,t]))}function Ct(t,e,n,i){t||(t=new d);for(var r=new vt(t,ot(n),[n,i]),o=0;o<e.length;o++){var a=e[o];r=r.update(t,0,undefined,a[0],a[1])}return r}function Lt(t,e,n,i){for(var r=0,o=0,a=new Array(n),s=0,c=1,u=e.length;s<u;s++,c<<=1){var l=e[s];l!==undefined&&s!==i&&(r|=c,a[o++]=l)}return new pt(t,r,a)}function Pt(t,e,n,i,r){for(var o=0,a=new Array(mn),s=0;0!==n;s++,n>>>=1)a[s]=1&n?e[o++]:undefined;return a[i]=r,new mt(t,o+1,a)}function At(t,e,i){for(var r=[],a=0;a<i.length;a++){var s=i[a],c=n(s);o(s)||(c=c.map(function(t){return W(t)})),r.push(c)}return It(t,e,r)}function Nt(t,e){return t&&t.mergeDeep&&o(e)?t.mergeDeep(e):K(t,e)?t:e}function Rt(t){return function(e,n,i){if(e&&e.mergeDeepWith&&o(n))return e.mergeDeepWith(t,n);var r=t(e,n,i);return K(e,r)?e:r}}function It(t,e,n){return 0===(n=n.filter(function(t){return 0!==t.size})).length?t:0!==t.size||t.__ownerID||1!==n.length?t.withMutations(function(t){for(var i=e?function(n,i){t.update(i,vn,function(t){return t===vn?n:e(t,n,i)})}:function(e,n){t.set(n,e)},r=0;r<n.length;r++)n[r].forEach(i)}):t.constructor(n[0])}function Dt(t,e,n,i){var r=t===vn,o=e.next();if(o.done){var a=r?n:t,s=i(a);return s===a?t:s}Q(r||t&&t.set,"invalid keyPath");var c=o.value,u=r?vn:t.get(c,vn),l=Dt(u,e,n,i);return l===u?t:l===vn?t.remove(c):(r?wt():t).set(c,l)}function Ot(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),t=t+(t>>4)&252645135,t+=t>>8,127&(t+=t>>16)}function Bt(t,e,n,i){var r=i?t:f(t);return r[e]=n,r}function Mt(t,e,n,i){var r=t.length+1;if(i&&e+1===r)return t[e]=n,t;for(var o=new Array(r),a=0,s=0;s<r;s++)s===e?(o[s]=n,a=-1):o[s]=t[s+a];return o}function Ft(t,e,n){var i=t.length-1;if(n&&e===i)return t.pop(),t;for(var r=new Array(i),o=0,a=0;a<i;a++)a===e&&(o=1),r[a]=t[a+o];return r}function zt(t){var e=qt();if(null===t||t===undefined)return e;if(jt(t))return t;var n=i(t),r=n.size;return 0===r?e:(lt(r),r>0&&r<mn?Ut(0,r,pn,null,new Ht(n.toArray())):e.withMutations(function(t){t.setSize(r),n.forEach(function(e,n){return t.set(n,e)})}))}function jt(t){return!(!t||!t[Zn])}function Ht(t,e){this.array=t,this.ownerID=e}function $t(t,e){function n(t,e,n){return 0===e?i(t,n):r(t,e,n)}function i(t,n){var i=n===s?c&&c.array:t&&t.array,r=n>o?0:o-n,u=a-n;return u>mn&&(u=mn),function(){if(r===u)return Xn;var t=e?--u:r++;return i&&i[t]}}function r(t,i,r){var s,c=t&&t.array,u=r>o?0:o-r>>i,l=1+(a-r>>i);return l>mn&&(l=mn),function(){for(;;){if(s){var t=s();if(t!==Xn)return t;s=null}if(u===l)return Xn;var o=e?--l:u++;s=n(c&&c[o],i-pn,r+(o<<i))}}}var o=t._origin,a=t._capacity,s=Yt(a),c=t._tail;return n(t._root,t._level,0)}function Ut(t,e,n,i,r,o,a){var s=Object.create(Gn);return s.size=e-t,s._origin=t,s._capacity=e,s._level=n,s._root=i,s._tail=r,s.__ownerID=o,s.__hash=a,s.__altered=!1,s}function qt(){return Kn||(Kn=Ut(0,0,pn))}function Wt(t,e,n){if((e=m(t,e))!=e)return t;if(e>=t.size||e<0)return t.withMutations(function(t){e<0?Kt(t,e).set(0,n):Kt(t,0,e+1).set(e,n)});e+=t._origin;var i=t._tail,r=t._root,o=l(bn);return e>=Yt(t._capacity)?i=Vt(i,t.__ownerID,0,e,n,o):r=Vt(r,t.__ownerID,t._level,e,n,o),o.value?t.__ownerID?(t._root=r,t._tail=i,t.__hash=undefined,t.__altered=!0,t):Ut(t._origin,t._capacity,t._level,r,i):t}function Vt(t,e,n,i,r,o){var a=i>>>n&gn,s=t&&a<t.array.length;if(!s&&r===undefined)return t;var c;if(n>0){var u=t&&t.array[a],l=Vt(u,e,n-pn,i,r,o);return l===u?t:(c=Zt(t,e),c.array[a]=l,c)}return s&&t.array[a]===r?t:(h(o),c=Zt(t,e),r===undefined&&a===c.array.length-1?c.array.pop():c.array[a]=r,c)}function Zt(t,e){return e&&t&&e===t.ownerID?t:new Ht(t?t.array.slice():[],e)}function Gt(t,e){if(e>=Yt(t._capacity))return t._tail;if(e<1<<t._level+pn){for(var n=t._root,i=t._level;n&&i>0;)n=n.array[e>>>i&gn],i-=pn;return n}}function Kt(t,e,n){e!==undefined&&(e|=0),n!==undefined&&(n|=0);var i=t.__ownerID||new d,r=t._origin,o=t._capacity,a=r+e,s=n===undefined?o:n<0?o+n:r+n;if(a===r&&s===o)return t;if(a>=s)return t.clear();for(var c=t._level,u=t._root,l=0;a+l<0;)u=new Ht(u&&u.array.length?[undefined,u]:[],i),l+=1<<(c+=pn);l&&(a+=l,r+=l,s+=l,o+=l);for(var h=Yt(o),f=Yt(s);f>=1<<c+pn;)u=new Ht(u&&u.array.length?[u]:[],i),c+=pn;var p=t._tail,m=f<h?Gt(t,s-1):f>h?new Ht([],i):p;if(p&&f>h&&a<o&&p.array.length){for(var g=u=Zt(u,i),v=c;v>pn;v-=pn){var y=h>>>v&gn;g=g.array[y]=Zt(g.array[y],i)}g.array[h>>>pn&gn]=p}if(s<o&&(m=m&&m.removeAfter(i,0,s)),a>=f)a-=f,s-=f,c=pn,u=null,m=m&&m.removeBefore(i,0,a);else if(a>r||f<h){for(l=0;u;){var b=a>>>c&gn;if(b!==f>>>c&gn)break;b&&(l+=(1<<c)*b),c-=pn,u=u.array[b]}u&&a>r&&(u=u.removeBefore(i,c,a-l)),u&&f<h&&(u=u.removeAfter(i,c,f-l)),l&&(a-=l,s-=l)}return t.__ownerID?(t.size=s-a,t._origin=a,t._capacity=s,t._level=c,t._root=u,t._tail=m,t.__hash=undefined,t.__altered=!0,t):Ut(a,s,c,u,m)}function Xt(t,e,n){for(var r=[],a=0,s=0;s<n.length;s++){var c=n[s],u=i(c);u.size>a&&(a=u.size),o(c)||(u=u.map(function(t){return W(t)})),r.push(u)}return a>t.size&&(t=t.setSize(a)),It(t,e,r)}function Yt(t){return t<mn?0:t-1>>>pn<<pn}function Qt(t){return null===t||t===undefined?ee():Jt(t)?t:ee().withMutations(function(e){var i=n(t);lt(i.size),i.forEach(function(t,n){return e.set(n,t)})})}function Jt(t){return dt(t)&&u(t)}function te(t,e,n,i){var r=Object.create(Qt.prototype);return r.size=t?t.size:0,r._map=t,r._list=e,r.__ownerID=n,r.__hash=i,r}function ee(){return Yn||(Yn=te(wt(),qt()))}function ne(t,e,n){var i,r,o=t._map,a=t._list,s=o.get(e),c=s!==undefined;if(n===vn){if(!c)return t;a.size>=mn&&a.size>=2*o.size?(i=(r=a.filter(function(t,e){return t!==undefined&&s!==e})).toKeyedSeq().map(function(t){return t[0]}).flip().toMap(),t.__ownerID&&(i.__ownerID=r.__ownerID=t.__ownerID)):(i=o.remove(e),r=s===a.size-1?a.pop():a.set(s,undefined))}else if(c){if(n===a.get(s)[1])return t;i=o,r=a.set(s,[e,n])}else i=o.set(e,a.size),r=a.set(a.size,[e,n]);return t.__ownerID?(t.size=i.size,t._map=i,t._list=r,t.__hash=undefined,t):te(i,r)}function ie(t,e){this._iter=t,this._useKeys=e,this.size=t.size}function re(t){this._iter=t,this.size=t.size}function oe(t){this._iter=t,this.size=t.size}function ae(t){this._iter=t,this.size=t.size}function se(t){var e=Le(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var e=t.reverse.apply(this);return e.flip=function(){return t.reverse()},e},e.has=function(e){return t.includes(e)},e.includes=function(e){return t.has(e)},e.cacheResult=Pe,e.__iterateUncached=function(e,n){var i=this;return t.__iterate(function(t,n){return!1!==e(n,t,i)},n)},e.__iteratorUncached=function(e,n){if(e===wn){var i=t.__iterator(e,n);return new x(function(){var t=i.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t})}return t.__iterator(e===xn?_n:xn,n)},e}function ce(t,e,n){var i=Le(t);return i.size=t.size,i.has=function(e){return t.has(e)},i.get=function(i,r){var o=t.get(i,vn);return o===vn?r:e.call(n,o,i,t)},i.__iterateUncached=function(i,r){var o=this;return t.__iterate(function(t,r,a){return!1!==i(e.call(n,t,r,a),r,o)},r)},i.__iteratorUncached=function(i,r){var o=t.__iterator(wn,r);return new x(function(){var r=o.next();if(r.done)return r;var a=r.value,s=a[0];return w(i,s,e.call(n,a[1],s,t),r)})},i}function ue(t,e){var n=Le(t);return n._iter=t,n.size=t.size,n.reverse=function(){return t},t.flip&&(n.flip=function(){var e=se(t);return e.reverse=function(){return t.flip()},e}),n.get=function(n,i){return t.get(e?n:-1-n,i)},n.has=function(n){return t.has(e?n:-1-n)},n.includes=function(e){return t.includes(e)},n.cacheResult=Pe,n.__iterate=function(e,n){var i=this;return t.__iterate(function(t,n){return e(t,n,i)},!n)},n.__iterator=function(e,n){return t.__iterator(e,!n)},n}function le(t,e,n,i){var r=Le(t);return i&&(r.has=function(i){var r=t.get(i,vn);return r!==vn&&!!e.call(n,r,i,t)},r.get=function(i,r){var o=t.get(i,vn);return o!==vn&&e.call(n,o,i,t)?o:r}),r.__iterateUncached=function(r,o){var a=this,s=0;return t.__iterate(function(t,o,c){if(e.call(n,t,o,c))return s++,r(t,i?o:s-1,a)},o),s},r.__iteratorUncached=function(r,o){var a=t.__iterator(wn,o),s=0;return new x(function(){for(;;){var o=a.next();if(o.done)return o;var c=o.value,u=c[0],l=c[1];if(e.call(n,l,u,t))return w(r,i?u:s++,l,o)}})},r}function he(t,e,n){var i=ht().asMutable();return t.__iterate(function(r,o){i.update(e.call(n,r,o,t),0,function(t){return t+1})}),i.asImmutable()}function de(t,e,n){var i=a(t),r=(u(t)?Qt():ht()).asMutable();t.__iterate(function(o,a){r.update(e.call(n,o,a,t),function(t){return(t=t||[]).push(i?[a,o]:o),t})});var o=Ce(t);return r.map(function(e){return ke(t,o(e))})}function fe(t,e,n,i){var r=t.size;if(e!==undefined&&(e|=0),n!==undefined&&(n|=0),v(e,n,r))return t;var o=y(e,r),a=b(n,r);if(o!=o||a!=a)return fe(t.toSeq().cacheResult(),e,n,i);var s,c=a-o;c==c&&(s=c<0?0:c);var u=Le(t);return u.size=0===s?s:t.size&&s||undefined,!i&&M(t)&&s>=0&&(u.get=function(e,n){return(e=m(this,e))>=0&&e<s?t.get(e+o,n):n}),u.__iterateUncached=function(e,n){var r=this;if(0===s)return 0;if(n)return this.cacheResult().__iterate(e,n);var a=0,c=!0,u=0;return t.__iterate(function(t,n){if(!c||!(c=a++<o))return u++,!1!==e(t,i?n:u-1,r)&&u!==s}),u},u.__iteratorUncached=function(e,n){if(0!==s&&n)return this.cacheResult().__iterator(e,n);var r=0!==s&&t.__iterator(e,n),a=0,c=0;return new x(function(){for(;a++<o;)r.next();if(++c>s)return S();var t=r.next();return i||e===xn?t:e===_n?w(e,c-1,undefined,t):w(e,c-1,t.value[1],t)})},u}function pe(t,e,n){var i=Le(t);return i.__iterateUncached=function(i,r){var o=this;if(r)return this.cacheResult().__iterate(i,r);var a=0;return t.__iterate(function(t,r,s){return e.call(n,t,r,s)&&++a&&i(t,r,o)}),a},i.__iteratorUncached=function(i,r){var o=this;if(r)return this.cacheResult().__iterator(i,r);var a=t.__iterator(wn,r),s=!0;return new x(function(){if(!s)return S();var t=a.next();if(t.done)return t;var r=t.value,c=r[0],u=r[1];return e.call(n,u,c,o)?i===wn?t:w(i,c,u,t):(s=!1,S())})},i}function me(t,e,n,i){var r=Le(t);return r.__iterateUncached=function(r,o){var a=this;if(o)return this.cacheResult().__iterate(r,o);var s=!0,c=0;return t.__iterate(function(t,o,u){if(!s||!(s=e.call(n,t,o,u)))return c++,r(t,i?o:c-1,a)}),c},r.__iteratorUncached=function(r,o){var a=this;if(o)return this.cacheResult().__iterator(r,o);var s=t.__iterator(wn,o),c=!0,u=0;return new x(function(){var t,o,l;do{if((t=s.next()).done)return i||r===xn?t:r===_n?w(r,u++,undefined,t):w(r,u++,t.value[1],t);var h=t.value;o=h[0],l=h[1],c&&(c=e.call(n,l,o,a))}while(c);return r===wn?t:w(r,o,l,t)})},r}function ge(t,e){var i=a(t),r=[t].concat(e).map(function(t){return o(t)?i&&(t=n(t)):t=i?z(t):j(Array.isArray(t)?t:[t]),t}).filter(function(t){return 0!==t.size});if(0===r.length)return t;if(1===r.length){var c=r[0];if(c===t||i&&a(c)||s(t)&&s(c))return c}var u=new I(r);return i?u=u.toKeyedSeq():s(t)||(u=u.toSetSeq()),u=u.flatten(!0),u.size=r.reduce(function(t,e){if(t!==undefined){var n=e.size;if(n!==undefined)return t+n}},0),u}function ve(t,e,n){var i=Le(t);return i.__iterateUncached=function(i,r){function a(t,u){var l=this;t.__iterate(function(t,r){return(!e||u<e)&&o(t)?a(t,u+1):!1===i(t,n?r:s++,l)&&(c=!0),!c},r)}var s=0,c=!1;return a(t,0),s},i.__iteratorUncached=function(i,r){var a=t.__iterator(i,r),s=[],c=0;return new x(function(){for(;a;){var t=a.next();if(!1===t.done){var u=t.value;if(i===wn&&(u=u[1]),e&&!(s.length<e)||!o(u))return n?t:w(i,c++,u,t);s.push(a),a=u.__iterator(i,r)}else a=s.pop()}return S()})},i}function ye(t,e,n){var i=Ce(t);return t.toSeq().map(function(r,o){return i(e.call(n,r,o,t))}).flatten(!0)}function be(t,e){var n=Le(t);return n.size=t.size&&2*t.size-1,n.__iterateUncached=function(n,i){var r=this,o=0;return t.__iterate(function(t){return(!o||!1!==n(e,o++,r))&&!1!==n(t,o++,r)},i),o},n.__iteratorUncached=function(n,i){var r,o=t.__iterator(xn,i),a=0;return new x(function(){return(!r||a%2)&&(r=o.next()).done?r:a%2?w(n,a++,e):w(n,a++,r.value,r)})},n}function _e(t,e,n){e||(e=Ae);var i=a(t),r=0,o=t.toSeq().map(function(e,i){return[i,e,r++,n?n(e,i,t):e]}).toArray();return o.sort(function(t,n){return e(t[3],n[3])||t[2]-n[2]}).forEach(i?function(t,e){o[e].length=2}:function(t,e){o[e]=t[1]}),i?A(o):s(t)?N(o):R(o)}function xe(t,e,n){if(e||(e=Ae),n){var i=t.toSeq().map(function(e,i){return[e,n(e,i,t)]}).reduce(function(t,n){return we(e,t[1],n[1])?n:t});return i&&i[0]}return t.reduce(function(t,n){return we(e,t,n)?n:t})}function we(t,e,n){var i=t(n,e);return 0===i&&n!==e&&(n===undefined||null===n||n!=n)||i>0}function Se(t,n,i){var r=Le(t);return r.size=new I(i).map(function(t){return t.size}).min(),r.__iterate=function(t,e){for(var n,i=this.__iterator(xn,e),r=0;!(n=i.next()).done&&!1!==t(n.value,r++,this););return r},r.__iteratorUncached=function(t,r){var o=i.map(function(t){return t=e(t),T(r?t.reverse():t)}),a=0,s=!1;return new x(function(){var e;return s||(e=o.map(function(t){return t.next()}),s=e.some(function(t){return t.done})),s?S():w(t,a++,n.apply(null,e.map(function(t){return t.value})))})},r}function ke(t,e){return M(t)?e:t.constructor(e)}function Ee(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function Te(t){return lt(t.size),p(t)}function Ce(t){return a(t)?n:s(t)?i:r}function Le(t){return Object.create((a(t)?A:s(t)?N:R).prototype)}function Pe(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):P.prototype.cacheResult.call(this)}function Ae(t,e){return t>e?1:t<e?-1:0}function Ne(t){var n=T(t);if(!n){if(!L(t))throw new TypeError("Expected iterable or array-like: "+t);n=T(e(t))}return n}function Re(t,e){var n,i=function(o){if(o instanceof i)return o;if(!(this instanceof i))return new i(o);if(!n){n=!0;var a=Object.keys(t);Oe(r,a),r.size=a.length,r._name=e,r._keys=a,r._defaultValues=t}this._map=ht(o)},r=i.prototype=Object.create(Qn);return r.constructor=i,i}function Ie(t,e,n){var i=Object.create(Object.getPrototypeOf(t));return i._map=e,i.__ownerID=n,i}function De(t){return t._name||t.constructor.name||"Record"}function Oe(t,e){try{e.forEach(Be.bind(undefined,t))}catch(n){}}function Be(t,e){Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){Q(this.__ownerID,"Cannot set on an immutable record."),this.set(e,t)}})}function Me(t){return null===t||t===undefined?He():Fe(t)&&!u(t)?t:He().withMutations(function(e){var n=r(t);lt(n.size),n.forEach(function(t){return e.add(t)})})}function Fe(t){return!(!t||!t[Jn])}function ze(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function je(t,e){var n=Object.create(ti);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function He(){return ei||(ei=je(wt()))}function $e(t){return null===t||t===undefined?We():Ue(t)?t:We().withMutations(function(e){var n=r(t);lt(n.size),n.forEach(function(t){return e.add(t)})})}function Ue(t){return Fe(t)&&u(t)}function qe(t,e){var n=Object.create(ni);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function We(){return ii||(ii=qe(ee()))}function Ve(t){return null===t||t===undefined?Ke():Ze(t)?t:Ke().unshiftAll(t)}function Ze(t){return!(!t||!t[ri])}function Ge(t,e,n,i){var r=Object.create(oi);return r.size=t,r._head=e,r.__ownerID=n,r.__hash=i,r.__altered=!1,r}function Ke(){return ai||(ai=Ge(0))}function Xe(t,e){var n=function(n){t.prototype[n]=e[n]};return Object.keys(e).forEach(n),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(n),t}function Ye(t,e){return e}function Qe(t,e){return[e,t]}function Je(t){return function(){return!t.apply(this,arguments)}}function tn(t){return function(){return-t.apply(this,arguments)}}function en(t){return"string"==typeof t?JSON.stringify(t):t}function nn(){return f(arguments)}function rn(t,e){return t<e?1:t>e?-1:0}function on(t){if(t.size===Infinity)return 0;var e=u(t),n=a(t),i=e?1:0;return an(t.__iterate(n?e?function(t,e){i=31*i+sn(ot(t),ot(e))|0}:function(t,e){i=i+sn(ot(t),ot(e))|0}:e?function(t){i=31*i+ot(t)|0}:function(t){i=i+ot(t)|0}),i)}function an(t,e){return e=Nn(e,3432918353),e=Nn(e<<15|e>>>-15,461845907),e=Nn(e<<13|e>>>-13,5),e=(e+3864292196|0)^t,e=Nn(e^e>>>16,2246822507),e=Nn(e^e>>>13,3266489909),e=rt(e^e>>>16)}function sn(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}var cn=Array.prototype.slice;t(n,e),t(i,e),t(r,e),e.isIterable=o,e.isKeyed=a,e.isIndexed=s,e.isAssociative=c,e.isOrdered=u,e.Keyed=n,
e.Indexed=i,e.Set=r;var un="@@__IMMUTABLE_ITERABLE__@@",ln="@@__IMMUTABLE_KEYED__@@",hn="@@__IMMUTABLE_INDEXED__@@",dn="@@__IMMUTABLE_ORDERED__@@",fn="delete",pn=5,mn=1<<pn,gn=mn-1,vn={},yn={value:!1},bn={value:!1},_n=0,xn=1,wn=2,Sn="function"==typeof Symbol&&Symbol.iterator,kn="@@iterator",En=Sn||kn;x.prototype.toString=function(){return"[Iterator]"},x.KEYS=_n,x.VALUES=xn,x.ENTRIES=wn,x.prototype.inspect=x.prototype.toSource=function(){return this.toString()},x.prototype[En]=function(){return this},t(P,e),P.of=function(){return P(arguments)},P.prototype.toSeq=function(){return this},P.prototype.toString=function(){return this.__toString("Seq {","}")},P.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},P.prototype.__iterate=function(t,e){return U(this,t,e,!0)},P.prototype.__iterator=function(t,e){return q(this,t,e,!0)},t(A,P),A.prototype.toKeyedSeq=function(){return this},t(N,P),N.of=function(){return N(arguments)},N.prototype.toIndexedSeq=function(){return this},N.prototype.toString=function(){return this.__toString("Seq [","]")},N.prototype.__iterate=function(t,e){return U(this,t,e,!1)},N.prototype.__iterator=function(t,e){return q(this,t,e,!1)},t(R,P),R.of=function(){return R(arguments)},R.prototype.toSetSeq=function(){return this},P.isSeq=M,P.Keyed=A,P.Set=R,P.Indexed=N;var Tn="@@__IMMUTABLE_SEQ__@@";P.prototype[Tn]=!0,t(I,N),I.prototype.get=function(t,e){return this.has(t)?this._array[m(this,t)]:e},I.prototype.__iterate=function(t,e){for(var n=this._array,i=n.length-1,r=0;r<=i;r++)if(!1===t(n[e?i-r:r],r,this))return r+1;return r},I.prototype.__iterator=function(t,e){var n=this._array,i=n.length-1,r=0;return new x(function(){return r>i?S():w(t,r,n[e?i-r++:r++])})},t(D,A),D.prototype.get=function(t,e){return e===undefined||this.has(t)?this._object[t]:e},D.prototype.has=function(t){return this._object.hasOwnProperty(t)},D.prototype.__iterate=function(t,e){for(var n=this._object,i=this._keys,r=i.length-1,o=0;o<=r;o++){var a=i[e?r-o:o];if(!1===t(n[a],a,this))return o+1}return o},D.prototype.__iterator=function(t,e){var n=this._object,i=this._keys,r=i.length-1,o=0;return new x(function(){var a=i[e?r-o:o];return o++>r?S():w(t,a,n[a])})},D.prototype[dn]=!0,t(O,N),O.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var n=T(this._iterable),i=0;if(E(n))for(var r;!(r=n.next()).done&&!1!==t(r.value,i++,this););return i},O.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var n=T(this._iterable);if(!E(n))return new x(S);var i=0;return new x(function(){var e=n.next();return e.done?e:w(t,i++,e.value)})},t(B,N),B.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);for(var n=this._iterator,i=this._iteratorCache,r=0;r<i.length;)if(!1===t(i[r],r++,this))return r;for(var o;!(o=n.next()).done;){var a=o.value;if(i[r]=a,!1===t(a,r++,this))break}return r},B.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var n=this._iterator,i=this._iteratorCache,r=0;return new x(function(){if(r>=i.length){var e=n.next();if(e.done)return e;i[r]=e.value}return w(t,r,i[r++])})};var Cn;t(Y,N),Y.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},Y.prototype.get=function(t,e){return this.has(t)?this._value:e},Y.prototype.includes=function(t){return K(this._value,t)},Y.prototype.slice=function(t,e){var n=this.size;return v(t,e,n)?this:new Y(this._value,b(e,n)-y(t,n))},Y.prototype.reverse=function(){return this},Y.prototype.indexOf=function(t){return K(this._value,t)?0:-1},Y.prototype.lastIndexOf=function(t){return K(this._value,t)?this.size:-1},Y.prototype.__iterate=function(t){for(var e=0;e<this.size;e++)if(!1===t(this._value,e,this))return e+1;return e},Y.prototype.__iterator=function(t){var e=this,n=0;return new x(function(){return n<e.size?w(t,n++,e._value):S()})},Y.prototype.equals=function(t){return t instanceof Y?K(this._value,t._value):X(t)};var Ln;t(J,N),J.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(this._step>1?" by "+this._step:"")+" ]"},J.prototype.get=function(t,e){return this.has(t)?this._start+m(this,t)*this._step:e},J.prototype.includes=function(t){var e=(t-this._start)/this._step;return e>=0&&e<this.size&&e===Math.floor(e)},J.prototype.slice=function(t,e){return v(t,e,this.size)?this:(t=y(t,this.size),(e=b(e,this.size))<=t?new J(0,0):new J(this.get(t,this._end),this.get(e,this._end),this._step))},J.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step==0){var n=e/this._step;if(n>=0&&n<this.size)return n}return-1},J.prototype.lastIndexOf=function(t){return this.indexOf(t)},J.prototype.__iterate=function(t,e){for(var n=this.size-1,i=this._step,r=e?this._start+n*i:this._start,o=0;o<=n;o++){if(!1===t(r,o,this))return o+1;r+=e?-i:i}return o},J.prototype.__iterator=function(t,e){var n=this.size-1,i=this._step,r=e?this._start+n*i:this._start,o=0;return new x(function(){var a=r;return r+=e?-i:i,o>n?S():w(t,o++,a)})},J.prototype.equals=function(t){return t instanceof J?this._start===t._start&&this._end===t._end&&this._step===t._step:X(this,t)};var Pn;t(tt,e),t(et,tt),t(nt,tt),t(it,tt),tt.Keyed=et,tt.Indexed=nt,tt.Set=it;var An,Nn="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){var n=65535&(t|=0),i=65535&(e|=0);return n*i+((t>>>16)*i+n*(e>>>16)<<16>>>0)|0},Rn=Object.isExtensible,In=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}(),Dn="function"==typeof WeakMap;Dn&&(An=new WeakMap);var On=0,Bn="__immutablehash__";"function"==typeof Symbol&&(Bn=Symbol(Bn));var Mn=16,Fn=255,zn=0,jn={};t(ht,et),ht.prototype.toString=function(){return this.__toString("Map {","}")},ht.prototype.get=function(t,e){return this._root?this._root.get(0,undefined,t,e):e},ht.prototype.set=function(t,e){return St(this,t,e)},ht.prototype.setIn=function(t,e){return this.updateIn(t,vn,function(){return e})},ht.prototype.remove=function(t){return St(this,t,vn)},ht.prototype.deleteIn=function(t){return this.updateIn(t,function(){return vn})},ht.prototype.update=function(t,e,n){return 1===arguments.length?t(this):this.updateIn([t],e,n)},ht.prototype.updateIn=function(t,e,n){n||(n=e,e=undefined);var i=Dt(this,Ne(t),e,n);return i===vn?undefined:i},ht.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=undefined,this.__altered=!0,this):wt()},ht.prototype.merge=function(){return At(this,undefined,arguments)},ht.prototype.mergeWith=function(t){return At(this,t,cn.call(arguments,1))},ht.prototype.mergeIn=function(t){var e=cn.call(arguments,1);return this.updateIn(t,wt(),function(t){return"function"==typeof t.merge?t.merge.apply(t,e):e[e.length-1]})},ht.prototype.mergeDeep=function(){return At(this,Nt,arguments)},ht.prototype.mergeDeepWith=function(t){var e=cn.call(arguments,1);return At(this,Rt(t),e)},ht.prototype.mergeDeepIn=function(t){var e=cn.call(arguments,1);return this.updateIn(t,wt(),function(t){return"function"==typeof t.mergeDeep?t.mergeDeep.apply(t,e):e[e.length-1]})},ht.prototype.sort=function(t){return Qt(_e(this,t))},ht.prototype.sortBy=function(t,e){return Qt(_e(this,e,t))},ht.prototype.withMutations=function(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this},ht.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new d)},ht.prototype.asImmutable=function(){return this.__ensureOwner()},ht.prototype.wasAltered=function(){return this.__altered},ht.prototype.__iterator=function(t,e){return new yt(this,t,e)},ht.prototype.__iterate=function(t,e){var n=this,i=0;return this._root&&this._root.iterate(function(e){return i++,t(e[1],e[0],n)},e),i},ht.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?xt(this.size,this._root,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},ht.isMap=dt;var Hn="@@__IMMUTABLE_MAP__@@",$n=ht.prototype;$n[Hn]=!0,$n[fn]=$n.remove,$n.removeIn=$n.deleteIn,ft.prototype.get=function(t,e,n,i){for(var r=this.entries,o=0,a=r.length;o<a;o++)if(K(n,r[o][0]))return r[o][1];return i},ft.prototype.update=function(t,e,n,i,r,o,a){for(var s=r===vn,c=this.entries,u=0,l=c.length;u<l&&!K(i,c[u][0]);u++);var d=u<l;if(d?c[u][1]===r:s)return this;if(h(a),(s||!d)&&h(o),!s||1!==c.length){if(!d&&!s&&c.length>=qn)return Ct(t,c,i,r);var p=t&&t===this.ownerID,m=p?c:f(c);return d?s?u===l-1?m.pop():m[u]=m.pop():m[u]=[i,r]:m.push([i,r]),p?(this.entries=m,this):new ft(t,m)}},pt.prototype.get=function(t,e,n,i){e===undefined&&(e=ot(n));var r=1<<((0===t?e:e>>>t)&gn),o=this.bitmap;return 0==(o&r)?i:this.nodes[Ot(o&r-1)].get(t+pn,e,n,i)},pt.prototype.update=function(t,e,n,i,r,o,a){n===undefined&&(n=ot(i));var s=(0===e?n:n>>>e)&gn,c=1<<s,u=this.bitmap,l=0!=(u&c);if(!l&&r===vn)return this;var h=Ot(u&c-1),d=this.nodes,f=l?d[h]:undefined,p=kt(f,t,e+pn,n,i,r,o,a);if(p===f)return this;if(!l&&p&&d.length>=Wn)return Pt(t,d,u,s,p);if(l&&!p&&2===d.length&&Et(d[1^h]))return d[1^h];if(l&&p&&1===d.length&&Et(p))return p;var m=t&&t===this.ownerID,g=l?p?u:u^c:u|c,v=l?p?Bt(d,h,p,m):Ft(d,h,m):Mt(d,h,p,m);return m?(this.bitmap=g,this.nodes=v,this):new pt(t,g,v)},mt.prototype.get=function(t,e,n,i){e===undefined&&(e=ot(n));var r=(0===t?e:e>>>t)&gn,o=this.nodes[r];return o?o.get(t+pn,e,n,i):i},mt.prototype.update=function(t,e,n,i,r,o,a){n===undefined&&(n=ot(i));var s=(0===e?n:n>>>e)&gn,c=r===vn,u=this.nodes,l=u[s];if(c&&!l)return this;var h=kt(l,t,e+pn,n,i,r,o,a);if(h===l)return this;var d=this.count;if(l){if(!h&&--d<Vn)return Lt(t,u,d,s)}else d++;var f=t&&t===this.ownerID,p=Bt(u,s,h,f);return f?(this.count=d,this.nodes=p,this):new mt(t,d,p)},gt.prototype.get=function(t,e,n,i){for(var r=this.entries,o=0,a=r.length;o<a;o++)if(K(n,r[o][0]))return r[o][1];return i},gt.prototype.update=function(t,e,n,i,r,o,a){n===undefined&&(n=ot(i));var s=r===vn;if(n!==this.keyHash)return s?this:(h(a),h(o),Tt(this,t,e,n,[i,r]));for(var c=this.entries,u=0,l=c.length;u<l&&!K(i,c[u][0]);u++);var d=u<l;if(d?c[u][1]===r:s)return this;if(h(a),(s||!d)&&h(o),s&&2===l)return new vt(t,this.keyHash,c[1^u]);var p=t&&t===this.ownerID,m=p?c:f(c);return d?s?u===l-1?m.pop():m[u]=m.pop():m[u]=[i,r]:m.push([i,r]),p?(this.entries=m,this):new gt(t,this.keyHash,m)},vt.prototype.get=function(t,e,n,i){return K(n,this.entry[0])?this.entry[1]:i},vt.prototype.update=function(t,e,n,i,r,o,a){var s=r===vn,c=K(i,this.entry[0]);return(c?r===this.entry[1]:s)?this:(h(a),s?void h(o):c?t&&t===this.ownerID?(this.entry[1]=r,this):new vt(t,this.keyHash,[i,r]):(h(o),Tt(this,t,e,ot(i),[i,r])))},ft.prototype.iterate=gt.prototype.iterate=function(t,e){for(var n=this.entries,i=0,r=n.length-1;i<=r;i++)if(!1===t(n[e?r-i:i]))return!1},pt.prototype.iterate=mt.prototype.iterate=function(t,e){for(var n=this.nodes,i=0,r=n.length-1;i<=r;i++){var o=n[e?r-i:i];if(o&&!1===o.iterate(t,e))return!1}},vt.prototype.iterate=function(t){return t(this.entry)},t(yt,x),yt.prototype.next=function(){for(var t=this._type,e=this._stack;e;){var n,i=e.node,r=e.index++;if(i.entry){if(0===r)return bt(t,i.entry)}else if(i.entries){if(n=i.entries.length-1,r<=n)return bt(t,i.entries[this._reverse?n-r:r])}else if(n=i.nodes.length-1,r<=n){var o=i.nodes[this._reverse?n-r:r];if(o){if(o.entry)return bt(t,o.entry);e=this._stack=_t(o,e)}continue}e=this._stack=this._stack.__prev}return S()};var Un,qn=mn/4,Wn=mn/2,Vn=mn/4;t(zt,nt),zt.of=function(){return this(arguments)},zt.prototype.toString=function(){return this.__toString("List [","]")},zt.prototype.get=function(t,e){if((t=m(this,t))>=0&&t<this.size){var n=Gt(this,t+=this._origin);return n&&n.array[t&gn]}return e},zt.prototype.set=function(t,e){return Wt(this,t,e)},zt.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},zt.prototype.insert=function(t,e){return this.splice(t,0,e)},zt.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=pn,this._root=this._tail=null,this.__hash=undefined,this.__altered=!0,this):qt()},zt.prototype.push=function(){var t=arguments,e=this.size;return this.withMutations(function(n){Kt(n,0,e+t.length);for(var i=0;i<t.length;i++)n.set(e+i,t[i])})},zt.prototype.pop=function(){return Kt(this,0,-1)},zt.prototype.unshift=function(){var t=arguments;return this.withMutations(function(e){Kt(e,-t.length);for(var n=0;n<t.length;n++)e.set(n,t[n])})},zt.prototype.shift=function(){return Kt(this,1)},zt.prototype.merge=function(){return Xt(this,undefined,arguments)},zt.prototype.mergeWith=function(t){return Xt(this,t,cn.call(arguments,1))},zt.prototype.mergeDeep=function(){return Xt(this,Nt,arguments)},zt.prototype.mergeDeepWith=function(t){var e=cn.call(arguments,1);return Xt(this,Rt(t),e)},zt.prototype.setSize=function(t){return Kt(this,0,t)},zt.prototype.slice=function(t,e){var n=this.size;return v(t,e,n)?this:Kt(this,y(t,n),b(e,n))},zt.prototype.__iterator=function(t,e){var n=0,i=$t(this,e);return new x(function(){var e=i();return e===Xn?S():w(t,n++,e)})},zt.prototype.__iterate=function(t,e){for(var n,i=0,r=$t(this,e);(n=r())!==Xn&&!1!==t(n,i++,this););return i},zt.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Ut(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):(this.__ownerID=t,this)},zt.isList=jt;var Zn="@@__IMMUTABLE_LIST__@@",Gn=zt.prototype;Gn[Zn]=!0,Gn[fn]=Gn.remove,Gn.setIn=$n.setIn,Gn.deleteIn=Gn.removeIn=$n.removeIn,Gn.update=$n.update,Gn.updateIn=$n.updateIn,Gn.mergeIn=$n.mergeIn,Gn.mergeDeepIn=$n.mergeDeepIn,Gn.withMutations=$n.withMutations,Gn.asMutable=$n.asMutable,Gn.asImmutable=$n.asImmutable,Gn.wasAltered=$n.wasAltered,Ht.prototype.removeBefore=function(t,e,n){if(n===e?1<<e:0===this.array.length)return this;var i=n>>>e&gn;if(i>=this.array.length)return new Ht([],t);var r,o=0===i;if(e>0){var a=this.array[i];if((r=a&&a.removeBefore(t,e-pn,n))===a&&o)return this}if(o&&!r)return this;var s=Zt(this,t);if(!o)for(var c=0;c<i;c++)s.array[c]=undefined;return r&&(s.array[i]=r),s},Ht.prototype.removeAfter=function(t,e,n){if(n===(e?1<<e:0)||0===this.array.length)return this;var i=n-1>>>e&gn;if(i>=this.array.length)return this;var r;if(e>0){var o=this.array[i];if((r=o&&o.removeAfter(t,e-pn,n))===o&&i===this.array.length-1)return this}var a=Zt(this,t);return a.array.splice(i+1),r&&(a.array[i]=r),a};var Kn,Xn={};t(Qt,ht),Qt.of=function(){return this(arguments)},Qt.prototype.toString=function(){return this.__toString("OrderedMap {","}")},Qt.prototype.get=function(t,e){var n=this._map.get(t);return n!==undefined?this._list.get(n)[1]:e},Qt.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):ee()},Qt.prototype.set=function(t,e){return ne(this,t,e)},Qt.prototype.remove=function(t){return ne(this,t,vn)},Qt.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},Qt.prototype.__iterate=function(t,e){var n=this;return this._list.__iterate(function(e){return e&&t(e[1],e[0],n)},e)},Qt.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},Qt.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),n=this._list.__ensureOwner(t);return t?te(e,n,t,this.__hash):(this.__ownerID=t,this._map=e,this._list=n,this)},Qt.isOrderedMap=Jt,Qt.prototype[dn]=!0,Qt.prototype[fn]=Qt.prototype.remove;var Yn;t(ie,A),ie.prototype.get=function(t,e){return this._iter.get(t,e)},ie.prototype.has=function(t){return this._iter.has(t)},ie.prototype.valueSeq=function(){return this._iter.valueSeq()},ie.prototype.reverse=function(){var t=this,e=ue(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},ie.prototype.map=function(t,e){var n=this,i=ce(this,t,e);return this._useKeys||(i.valueSeq=function(){return n._iter.toSeq().map(t,e)}),i},ie.prototype.__iterate=function(t,e){var n,i=this;return this._iter.__iterate(this._useKeys?function(e,n){return t(e,n,i)}:(n=e?Te(this):0,function(r){return t(r,e?--n:n++,i)}),e)},ie.prototype.__iterator=function(t,e){if(this._useKeys)return this._iter.__iterator(t,e);var n=this._iter.__iterator(xn,e),i=e?Te(this):0;return new x(function(){var r=n.next();return r.done?r:w(t,e?--i:i++,r.value,r)})},ie.prototype[dn]=!0,t(re,N),re.prototype.includes=function(t){return this._iter.includes(t)},re.prototype.__iterate=function(t,e){var n=this,i=0;return this._iter.__iterate(function(e){return t(e,i++,n)},e)},re.prototype.__iterator=function(t,e){var n=this._iter.__iterator(xn,e),i=0;return new x(function(){var e=n.next();return e.done?e:w(t,i++,e.value,e)})},t(oe,R),oe.prototype.has=function(t){return this._iter.includes(t)},oe.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate(function(e){return t(e,e,n)},e)},oe.prototype.__iterator=function(t,e){var n=this._iter.__iterator(xn,e);return new x(function(){var e=n.next();return e.done?e:w(t,e.value,e.value,e)})},t(ae,A),ae.prototype.entrySeq=function(){return this._iter.toSeq()},ae.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate(function(e){if(e){Ee(e);var i=o(e);return t(i?e.get(1):e[1],i?e.get(0):e[0],n)}},e)},ae.prototype.__iterator=function(t,e){var n=this._iter.__iterator(xn,e);return new x(function(){for(;;){var e=n.next();if(e.done)return e;var i=e.value;if(i){Ee(i);var r=o(i);return w(t,r?i.get(0):i[0],r?i.get(1):i[1],e)}}})},re.prototype.cacheResult=ie.prototype.cacheResult=oe.prototype.cacheResult=ae.prototype.cacheResult=Pe,t(Re,et),Re.prototype.toString=function(){return this.__toString(De(this)+" {","}")},Re.prototype.has=function(t){return this._defaultValues.hasOwnProperty(t)},Re.prototype.get=function(t,e){if(!this.has(t))return e;var n=this._defaultValues[t];return this._map?this._map.get(t,n):n},Re.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var t=this.constructor;return t._empty||(t._empty=Ie(this,wt()))},Re.prototype.set=function(t,e){if(!this.has(t))throw new Error('Cannot set unknown key "'+t+'" on '+De(this));var n=this._map&&this._map.set(t,e);return this.__ownerID||n===this._map?this:Ie(this,n)},Re.prototype.remove=function(t){if(!this.has(t))return this;var e=this._map&&this._map.remove(t);return this.__ownerID||e===this._map?this:Ie(this,e)},Re.prototype.wasAltered=function(){return this._map.wasAltered()},Re.prototype.__iterator=function(t,e){var i=this;return n(this._defaultValues).map(function(t,e){return i.get(e)}).__iterator(t,e)},Re.prototype.__iterate=function(t,e){var i=this;return n(this._defaultValues).map(function(t,e){return i.get(e)}).__iterate(t,e)},Re.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map&&this._map.__ensureOwner(t);return t?Ie(this,e,t):(this.__ownerID=t,this._map=e,this)};var Qn=Re.prototype;Qn[fn]=Qn.remove,Qn.deleteIn=Qn.removeIn=$n.removeIn,Qn.merge=$n.merge,Qn.mergeWith=$n.mergeWith,Qn.mergeIn=$n.mergeIn,Qn.mergeDeep=$n.mergeDeep,Qn.mergeDeepWith=$n.mergeDeepWith,Qn.mergeDeepIn=$n.mergeDeepIn,Qn.setIn=$n.setIn,Qn.update=$n.update,Qn.updateIn=$n.updateIn,Qn.withMutations=$n.withMutations,Qn.asMutable=$n.asMutable,Qn.asImmutable=$n.asImmutable,t(Me,it),Me.of=function(){return this(arguments)},Me.fromKeys=function(t){return this(n(t).keySeq())},Me.prototype.toString=function(){return this.__toString("Set {","}")},Me.prototype.has=function(t){return this._map.has(t)},Me.prototype.add=function(t){return ze(this,this._map.set(t,!0))},Me.prototype.remove=function(t){return ze(this,this._map.remove(t))},Me.prototype.clear=function(){return ze(this,this._map.clear())},Me.prototype.union=function(){var t=cn.call(arguments,0);return 0===(t=t.filter(function(t){return 0!==t.size})).length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations(function(e){for(var n=0;n<t.length;n++)r(t[n]).forEach(function(t){return e.add(t)})}):this.constructor(t[0])},Me.prototype.intersect=function(){var t=cn.call(arguments,0);if(0===t.length)return this;t=t.map(function(t){return r(t)});var e=this;return this.withMutations(function(n){e.forEach(function(e){t.every(function(t){return t.includes(e)})||n.remove(e)})})},Me.prototype.subtract=function(){var t=cn.call(arguments,0);if(0===t.length)return this;t=t.map(function(t){return r(t)});var e=this;return this.withMutations(function(n){e.forEach(function(e){t.some(function(t){return t.includes(e)})&&n.remove(e)})})},Me.prototype.merge=function(){return this.union.apply(this,arguments)},Me.prototype.mergeWith=function(){var t=cn.call(arguments,1);return this.union.apply(this,t)},Me.prototype.sort=function(t){return $e(_e(this,t))},Me.prototype.sortBy=function(t,e){return $e(_e(this,e,t))},Me.prototype.wasAltered=function(){return this._map.wasAltered()},Me.prototype.__iterate=function(t,e){var n=this;return this._map.__iterate(function(e,i){return t(i,i,n)},e)},Me.prototype.__iterator=function(t,e){return this._map.map(function(t,e){return e}).__iterator(t,e)},Me.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):(this.__ownerID=t,this._map=e,this)},Me.isSet=Fe;var Jn="@@__IMMUTABLE_SET__@@",ti=Me.prototype;ti[Jn]=!0,ti[fn]=ti.remove,ti.mergeDeep=ti.merge,ti.mergeDeepWith=ti.mergeWith,ti.withMutations=$n.withMutations,ti.asMutable=$n.asMutable,ti.asImmutable=$n.asImmutable,ti.__empty=He,ti.__make=je;var ei;t($e,Me),$e.of=function(){return this(arguments)},$e.fromKeys=function(t){return this(n(t).keySeq())},$e.prototype.toString=function(){return this.__toString("OrderedSet {","}")},$e.isOrderedSet=Ue;var ni=$e.prototype;ni[dn]=!0,ni.__empty=We,ni.__make=qe;var ii;t(Ve,nt),Ve.of=function(){return this(arguments)},Ve.prototype.toString=function(){return this.__toString("Stack [","]")},Ve.prototype.get=function(t,e){var n=this._head;for(t=m(this,t);n&&t--;)n=n.next;return n?n.value:e},Ve.prototype.peek=function(){return this._head&&this._head.value},Ve.prototype.push=function(){if(0===arguments.length)return this;for(var t=this.size+arguments.length,e=this._head,n=arguments.length-1;n>=0;n--)e={value:arguments[n],next:e};return this.__ownerID?(this.size=t,this._head=e,this.__hash=undefined,this.__altered=!0,this):Ge(t,e)},Ve.prototype.pushAll=function(t){if(0===(t=i(t)).size)return this;lt(t.size);var e=this.size,n=this._head;return t.reverse().forEach(function(t){e++,n={value:t,next:n}}),this.__ownerID?(this.size=e,this._head=n,this.__hash=undefined,this.__altered=!0,this):Ge(e,n)},Ve.prototype.pop=function(){return this.slice(1)},Ve.prototype.unshift=function(){return this.push.apply(this,arguments)},Ve.prototype.unshiftAll=function(t){return this.pushAll(t)},Ve.prototype.shift=function(){return this.pop.apply(this,arguments)},Ve.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=undefined,this.__hash=undefined,this.__altered=!0,this):Ke()},Ve.prototype.slice=function(t,e){if(v(t,e,this.size))return this;var n=y(t,this.size);if(b(e,this.size)!==this.size)return nt.prototype.slice.call(this,t,e);for(var i=this.size-n,r=this._head;n--;)r=r.next;return this.__ownerID?(this.size=i,this._head=r,this.__hash=undefined,this.__altered=!0,this):Ge(i,r)},Ve.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Ge(this.size,this._head,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},Ve.prototype.__iterate=function(t,e){if(e)return this.reverse().__iterate(t);for(var n=0,i=this._head;i&&!1!==t(i.value,n++,this);)i=i.next;return n},Ve.prototype.__iterator=function(t,e){if(e)return this.reverse().__iterator(t);var n=0,i=this._head;return new x(function(){if(i){var e=i.value;return i=i.next,w(t,n++,e)}return S()})},Ve.isStack=Ze;var ri="@@__IMMUTABLE_STACK__@@",oi=Ve.prototype;oi[ri]=!0,oi.withMutations=$n.withMutations,oi.asMutable=$n.asMutable,oi.asImmutable=$n.asImmutable,oi.wasAltered=$n.wasAltered;var ai;e.Iterator=x,Xe(e,{toArray:function(){lt(this.size);var t=new Array(this.size||0);return this.valueSeq().__iterate(function(e,n){t[n]=e}),t},toIndexedSeq:function(){return new re(this)},toJS:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJS?t.toJS():t}).__toJS()},toJSON:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJSON?t.toJSON():t}).__toJS()},toKeyedSeq:function(){return new ie(this,!0)},toMap:function(){return ht(this.toKeyedSeq())},toObject:function(){lt(this.size);var t={};return this.__iterate(function(e,n){t[n]=e}),t},toOrderedMap:function(){return Qt(this.toKeyedSeq())},toOrderedSet:function(){return $e(a(this)?this.valueSeq():this)},toSet:function(){return Me(a(this)?this.valueSeq():this)},toSetSeq:function(){return new oe(this)},toSeq:function(){return s(this)?this.toIndexedSeq():a(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Ve(a(this)?this.valueSeq():this)},toList:function(){return zt(a(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){return ke(this,ge(this,cn.call(arguments,0)))},includes:function(t){return this.some(function(e){return K(e,t)})},entries:function(){return this.__iterator(wn)},every:function(t,e){lt(this.size);var n=!0;return this.__iterate(function(i,r,o){if(!t.call(e,i,r,o))return n=!1,!1}),n},filter:function(t,e){return ke(this,le(this,t,e,!0))},find:function(t,e,n){var i=this.findEntry(t,e);return i?i[1]:n},findEntry:function(t,e){var n;return this.__iterate(function(i,r,o){if(t.call(e,i,r,o))return n=[r,i],!1}),n},findLastEntry:function(t,e){return this.toSeq().reverse().findEntry(t,e)},forEach:function(t,e){return lt(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){lt(this.size),t=t!==undefined?""+t:",";var e="",n=!0;return this.__iterate(function(i){n?n=!1:e+=t,e+=null!==i&&i!==undefined?i.toString():""}),e},keys:function(){return this.__iterator(_n)},map:function(t,e){return ke(this,ce(this,t,e))},reduce:function(t,e,n){lt(this.size);var i,r;return arguments.length<2?r=!0:i=e,this.__iterate(function(e,o,a){r?(r=!1,i=e):i=t.call(n,i,e,o,a)}),i},reduceRight:function(){var t=this.toKeyedSeq().reverse();return t.reduce.apply(t,arguments)},reverse:function(){return ke(this,ue(this,!0))},slice:function(t,e){return ke(this,fe(this,t,e,!0))},some:function(t,e){return!this.every(Je(t),e)},sort:function(t){return ke(this,_e(this,t))},values:function(){return this.__iterator(xn)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==undefined?0===this.size:!this.some(function(){return!0})},count:function(t,e){return p(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return he(this,t,e)},equals:function(t){return X(this,t)},entrySeq:function(){var t=this;if(t._cache)return new I(t._cache);var e=t.toSeq().map(Qe).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(Je(t),e)},findLast:function(t,e,n){return this.toKeyedSeq().reverse().find(t,e,n)},first:function(){return this.find(g)},flatMap:function(t,e){return ke(this,ye(this,t,e))},flatten:function(t){return ke(this,ve(this,t,!0))},fromEntrySeq:function(){return new ae(this)},get:function(t,e){return this.find(function(e,n){return K(n,t)},undefined,e)},getIn:function(t,e){for(var n,i=this,r=Ne(t);!(n=r.next()).done;){var o=n.value;if((i=i&&i.get?i.get(o,vn):vn)===vn)return e}return i},groupBy:function(t,e){return de(this,t,e)},has:function(t){return this.get(t,vn)!==vn},hasIn:function(t){return this.getIn(t,vn)!==vn},isSubset:function(t){return t="function"==typeof t.includes?t:e(t),this.every(function(e){return t.includes(e)})},isSuperset:function(t){return(t="function"==typeof t.isSubset?t:e(t)).isSubset(this)},keySeq:function(){return this.toSeq().map(Ye).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},max:function(t){return xe(this,t)},maxBy:function(t,e){return xe(this,e,t)},min:function(t){return xe(this,t?tn(t):rn)},minBy:function(t,e){return xe(this,e?tn(e):rn,t)},rest:function(){return this.slice(1)},skip:function(t){return this.slice(Math.max(0,t))},skipLast:function(t){return ke(this,this.toSeq().reverse().skip(t).reverse())},skipWhile:function(t,e){return ke(this,me(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(Je(t),e)},sortBy:function(t,e){return ke(this,_e(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return ke(this,this.toSeq().reverse().take(t).reverse())},takeWhile:function(t,e){return ke(this,pe(this,t,e))},takeUntil:function(t,e){return this.takeWhile(Je(t),e)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=on(this))}});var si=e.prototype;si[un]=!0,si[En]=si.values,si.__toJS=si.toArray,si.__toStringMapper=en,si.inspect=si.toSource=function(){return this.toString()},si.chain=si.flatMap,si.contains=si.includes,function(){try{Object.defineProperty(si,"length",{get:function(){if(!e.noLengthWarning){var t;try{throw new Error}catch(n){t=n.stack}if(-1===t.indexOf("_wrapObject"))return console&&console.warn&&console.warn("iterable.length has been deprecated, use iterable.size or iterable.count(). This warning will become a silent error in a future version. "+t),this.size}}})}catch(t){}}(),Xe(n,{flip:function(){return ke(this,se(this))},findKey:function(t,e){var n=this.findEntry(t,e);return n&&n[0]},findLastKey:function(t,e){return this.toSeq().reverse().findKey(t,e)},keyOf:function(t){return this.findKey(function(e){return K(e,t)})},lastKeyOf:function(t){return this.findLastKey(function(e){return K(e,t)})},mapEntries:function(t,e){var n=this,i=0;return ke(this,this.toSeq().map(function(r,o){return t.call(e,[o,r],i++,n)}).fromEntrySeq())},mapKeys:function(t,e){var n=this;return ke(this,this.toSeq().flip().map(function(i,r){return t.call(e,i,r,n)}).flip())}});var ci=n.prototype;ci[ln]=!0,ci[En]=si.entries,ci.__toJS=si.toObject,ci.__toStringMapper=function(t,e){return JSON.stringify(e)+": "+en(t)},Xe(i,{toKeyedSeq:function(){return new ie(this,!1)},filter:function(t,e){return ke(this,le(this,t,e,!1))},findIndex:function(t,e){var n=this.findEntry(t,e);return n?n[0]:-1},indexOf:function(t){var e=this.toKeyedSeq().keyOf(t);return e===undefined?-1:e},lastIndexOf:function(t){var e=this.toKeyedSeq().reverse().keyOf(t);return e===undefined?-1:e},reverse:function(){return ke(this,ue(this,!1))},slice:function(t,e){return ke(this,fe(this,t,e,!1))},splice:function(t,e){var n=arguments.length;if(e=Math.max(0|e,0),0===n||2===n&&!e)return this;t=y(t,t<0?this.count():this.size);var i=this.slice(0,t);return ke(this,1===n?i:i.concat(f(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var n=this.toKeyedSeq().findLastKey(t,e);return n===undefined?-1:n},first:function(){return this.get(0)},flatten:function(t){return ke(this,ve(this,t,!1))},get:function(t,e){return(t=m(this,t))<0||this.size===Infinity||this.size!==undefined&&t>this.size?e:this.find(function(e,n){return n===t},undefined,e)},has:function(t){return(t=m(this,t))>=0&&(this.size!==undefined?this.size===Infinity||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return ke(this,be(this,t))},interleave:function(){var t=[this].concat(f(arguments)),e=Se(this.toSeq(),N.of,t),n=e.flatten(!0);return e.size&&(n.size=e.size*t.length),ke(this,n)},last:function(){return this.get(-1)},skipWhile:function(t,e){return ke(this,me(this,t,e,!1))},zip:function(){return ke(this,Se(this,nn,[this].concat(f(arguments))))},zipWith:function(t){var e=f(arguments);return e[0]=this,ke(this,Se(this,t,e))}}),i.prototype[hn]=!0,i.prototype[dn]=!0,Xe(r,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}}),r.prototype.has=si.includes,Xe(A,n.prototype),Xe(N,i.prototype),Xe(R,r.prototype),Xe(et,n.prototype),Xe(nt,i.prototype),Xe(it,r.prototype);return{Iterable:e,Seq:P,Collection:tt,Map:ht,OrderedMap:Qt,List:zt,Stack:Ve,Set:Me,OrderedSet:$e,Record:Re,Range:J,Repeat:Y,is:K,fromJS:W}})},function(t,e,n){var i,r;i=[n(167),n(165)],(r=function(t,e){"use strict";function n(e){return!!t.isCaretPositionNode(e)||""===e.parentNode.textContent.trim()}function i(e){function o(e){return!!(0===e.children.length&&t.isBlockElement(e)||1===e.children.length&&t.isSelectionMarkerNode(e.children[0]))||!t.isBlockElement(e)&&0===e.children.length&&n(e)}
for(var a=e.firstElementChild;a;)t.isSelectionMarkerNode(a)||(o(a)&&""===a.textContent.trim()&&!r.includes(a.nodeName)?a.appendChild(document.createElement("br")):a.children.length>0&&i(a)),a=a.nextElementSibling}var r=e.Set.of("AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR");return function(){return function(t){t.registerHTMLFormatter("normalize",function(t){var e=document.createElement("div");return e.innerHTML=t,i(e),e.innerHTML})}}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(168),n(169),n(165)],(r=function(t,e,n){"use strict";function i(t){return e.includes(t.nodeName)}function r(e){return t.includes(e.nodeName)}function o(t){return!(t.children.length>1)&&((1!==t.children.length||""===t.textContent.trim())&&(0===t.children.length?""===t.textContent.trim():o(t.children[0])))}function a(t){return t.nodeType===Node.TEXT_NODE}function s(t){return a(t)&&""===t.data}function c(t){return t.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function u(t,e){return t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING}function l(t,e){return function(n){return n.nodeType===t.ELEMENT_NODE&&n.className===e}}function h(t){return l(Node,"scribe-marker")(t)}function d(t){return l(Node,"caret-position")(t)}function f(t){var e=t.firstChild;return e&&"BR"!==e.nodeName?f(e):t}function p(t,e){return e.parentNode.insertBefore(t,e.nextSibling)}function m(t){return t.parentNode.removeChild(t)}function g(t,e,n){function i(t){return e===t}if(!i(t))for(var r=t.parentNode;r&&!i(r);){if(n(r))return r;r=r.parentNode}}function v(t){for(var e=n.List();t=t.nextSibling;)e=e.push(t);return e}function y(t,e){return t[0].parentNode.insertBefore(e,t[0]),t.forEach(function(t){e.appendChild(t)}),e}function b(t,e){for(;e.childNodes.length>0;)t.insertBefore(e.childNodes[0],e);t.removeChild(e)}function _(e){function i(t,e){return window.getComputedStyle(e).lineHeight===t.lineHeight}var r=n.List(e.querySelectorAll(t.map(function(t){return t+'[style*="line-height"]'}).join(",")));r=r.filter(i.bind(null,window.getComputedStyle(e)));var o=n.List();r.forEach(function(t){t.style.lineHeight=null,t.getAttribute("style")||t.removeAttribute("style"),"SPAN"===t.nodeName&&0===t.attributes.length&&(o=o.push(t))}),o.forEach(function(t){b(t.parentNode,t)})}return{isInlineElement:r,isBlockElement:i,isEmptyInlineElement:o,isText:a,isEmptyTextNode:s,isFragment:c,isBefore:u,isSelectionMarkerNode:h,isCaretPositionNode:d,firstDeepestChild:f,insertAfter:p,removeNode:m,getAncestor:g,nextSiblings:v,wrap:y,unwrap:b,removeChromeArtifacts:_,elementHasClass:l}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(165)],(r=function(t){return t.Set.of("B","BIG","I","SMALL","TT","ABBR","ACRONYM","CITE","CODE","DFN","EM","KBD","STRONG","SAMP","VAR","A","BDO","BR","IMG","MAP","OBJECT","Q","SCRIPT","SPAN","SUB","SUP","BUTTON","INPUT","LABEL","SELECT","TEXTAREA")}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(165)],(r=function(t){return t.Set.of("ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","CANVAS","DD","DIV","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TD","TH","TFOOT","UL","VIDEO")}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i;(i=function(){"use strict";function t(t){for(var e=document.createTreeWalker(t,NodeFilter.SHOW_ALL,null,!1);e.nextNode();)if(e.currentNode&&(~["br"].indexOf(e.currentNode.nodeName.toLowerCase())||e.currentNode.length>0))return!0;return!1}return function(){return function(e){e.el.addEventListener("keydown",function(n){if(13===n.keyCode){var i=new e.api.Selection,r=i.range;i.getContaining(function(t){return"LI"===t.nodeName||/^(H[1-6])$/.test(t.nodeName)})||(n.preventDefault(),e.transactionManager.run(function(){"BR"===e.el.lastChild.nodeName&&e.el.removeChild(e.el.lastChild);var n=document.createElement("br");r.insertNode(n),r.collapse(!1);var o=r.cloneRange();o.setEndAfter(e.el.lastChild,0);if(!t(o.cloneContents())){var a=document.createElement("br");r.insertNode(a)}var s=r.cloneRange();s.setStartAfter(n,0),s.setEndAfter(n,0),i.selection.removeAllRanges(),i.selection.addRange(s)}))}}.bind(this)),""===e.getHTML().trim()&&e.setContent("")}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(172),n(173)],(r=function(t,e){"use strict";return{replaceNbspCharsFormatter:t,escapeHtmlCharactersFormatter:e}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=/(\s|&nbsp;)+/g;t.registerHTMLFormatter("export",function(t){return t.replace(e," ")})}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(174)],(r=function(t){"use strict";return function(){return function(e){e.registerPlainTextFormatter(t)}}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(148),n(175)],(r=function(t,e){function n(n){return(n=t(n))&&r.test(n)?n.replace(i,e):n}var i=/[&<>"'`]/g,r=RegExp(i.source);return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t){return e[t]}var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(177),n(165)],(r=function(t,e){"use strict";return function(){return function(n){var i=n.node;n.el.addEventListener("focus",function(){var t=new n.api.Selection;if(t.range){if(n.allowsBlockElements()&&t.range.startContainer===n.el){var e=i.firstDeepestChild(n.el),r=t.range;r.setStart(e,0),r.setEnd(e,0),t.selection.removeAllRanges(),t.selection.addRange(r)}}}.bind(n));var r=function(){if(!n._skipFormatters){var t=new n.api.Selection,e=t.range,i=function(){e&&t.placeMarkers(),n.setHTML(n._htmlFormatterFactory.format(n.getHTML())),t.selectMarkers()}.bind(n);n.transactionManager.run(i)}delete n._skipFormatters}.bind(n);t(n.el,r),n.allowsBlockElements()&&n.el.addEventListener("keydown",function(t){if(13===t.keyCode){var e=new n.api.Selection,i=e.range,r=e.getContaining(function(t){return/^(H[1-6])$/.test(t.nodeName)});if(r&&i.collapsed){var o=i.cloneRange();o.setEndAfter(r,0);""===o.cloneContents().firstChild.textContent&&(t.preventDefault(),n.transactionManager.run(function(){var t=document.createElement("p"),n=document.createElement("br");t.appendChild(n),r.parentNode.insertBefore(t,r.nextElementSibling),i.setStart(t,0),i.setEnd(t,0),e.selection.removeAllRanges(),e.selection.addRange(i)}))}}}),n.allowsBlockElements()&&n.el.addEventListener("keydown",function(t){if(13===t.keyCode||8===t.keyCode){var e=new n.api.Selection;if(e.range.collapsed){var i=e.getContaining(function(t){return"LI"===t.nodeName});if(i&&""===i.textContent.trim()){t.preventDefault();var r=e.getContaining(function(t){return"UL"===t.nodeName||"OL"===t.nodeName}),o=n.getCommand("OL"===r.nodeName?"insertOrderedList":"insertUnorderedList");o.event=t,o.execute()}}}}),n.el.addEventListener("paste",function(t){if(t.clipboardData&&t.clipboardData.types.length>0)t.preventDefault(),e.List(t.clipboardData.types).includes("text/html")?n.insertHTML(t.clipboardData.getData("text/html")):n.insertPlainText(t.clipboardData.getData("text/plain"));else{var i=new n.api.Selection;i.placeMarkers();var r=document.createElement("div");document.body.appendChild(r),r.setAttribute("contenteditable",!0),r.focus(),setTimeout(function(){var t=r.innerHTML;r.parentNode.removeChild(r),i.selectMarkers(),n.el.focus(),n.insertHTML(t)},1)}})}}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(167),n(178)],(r=function(t,e){function n(e){return!t.isEmptyTextNode(e)&&!t.isSelectionMarkerNode(e)}function i(t){return t.some(function(t){return Array.prototype.some.call(t.addedNodes,n)||Array.prototype.some.call(t.removedNodes,n)})}function r(t,e){var n=!1,r=new a(function(t){if(!n&&i(t)){n=!0;try{e()}catch(r){throw r}finally{setTimeout(function(){n=!1},0)}}});return r.observe(t,{childList:!0,subtree:!0}),r}var o="object"==typeof window?window:undefined,a=e.determineMutationObserver(o);return r}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t){return void 0===t?function(){return{observe:function(){}}}:t.MutationObserver||t.WebKitMutationObserver||t.MozMutationObserver}return{determineMutationObserver:t}}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(180),n(181),n(182),n(183),n(184),n(185),n(186)],(r=function(t,e,n,i,r,o,a){"use strict";return{commands:{bold:t,indent:e,insertHTML:n,insertList:i,outdent:r,createLink:o},events:a}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=new t.api.CommandPatch("bold");e.queryEnabled=function(){var e=(new t.api.Selection).getContaining(function(t){return/^(H[1-6])$/.test(t.nodeName)});return t.api.CommandPatch.prototype.queryEnabled.apply(this,arguments)&&!e},t.commandPatches.bold=e}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";var t="\ufeff";return function(){return function(e){var n=new e.api.CommandPatch("indent");n.execute=function(n){e.transactionManager.run(function(){var i=new e.api.Selection,r=i.range;if("P"===r.commonAncestorContainer.nodeName&&"<br>"===r.commonAncestorContainer.innerHTML){var o=document.createTextNode(t);r.insertNode(o),r.setStart(o,0),r.setEnd(o,0),i.selection.removeAllRanges(),i.selection.addRange(r)}e.api.CommandPatch.prototype.execute.call(this,n);var a=(i=new e.api.Selection).getContaining(function(t){return"BLOCKQUOTE"===t.nodeName});a&&a.removeAttribute("style")}.bind(this))},e.commandPatches.indent=n}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e){var n,i;n=[],(i=function(){"use strict";return function(){return function(t){var e=new t.api.CommandPatch("insertHTML"),n=t.node;e.execute=function(e){t.transactionManager.run(function(){t.api.CommandPatch.prototype.execute.call(this,e),n.removeChromeArtifacts(t.el)}.bind(this))},t.commandPatches.insertHTML=e}}}.apply(e,n))===undefined||(t.exports=i)},function(t,e){var n,i;n=[],(i=function(){"use strict";return function(){return function(t){var e=t.node,n=function(e){t.api.CommandPatch.call(this,e)};n.prototype=Object.create(t.api.CommandPatch.prototype),n.prototype.constructor=n,n.prototype.execute=function(n){t.transactionManager.run(function(){if(t.api.CommandPatch.prototype.execute.call(this,n),this.queryState()){var i=new t.api.Selection,r=i.getContaining(function(t){return"OL"===t.nodeName||"UL"===t.nodeName});if(r.nextElementSibling&&0===r.nextElementSibling.childNodes.length&&e.removeNode(r.nextElementSibling),r){var o=r.parentNode;o&&/^(H[1-6]|P)$/.test(o.nodeName)&&(i.placeMarkers(),e.insertAfter(r,o),i.selectMarkers(),2===o.childNodes.length&&e.isEmptyTextNode(o.firstChild)&&e.removeNode(o),0===o.childNodes.length&&e.removeNode(o))}e.removeChromeArtifacts(r)}}.bind(this))},n.prototype.queryState=function(){try{return t.api.CommandPatch.prototype.queryState.apply(this,arguments)}catch(e){if("NS_ERROR_UNEXPECTED"==e.name)return!1;throw e}},t.commandPatches.insertOrderedList=new n("insertOrderedList"),t.commandPatches.insertUnorderedList=new n("insertUnorderedList")}}}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=t.node,n=new t.api.CommandPatch("outdent");n.execute=function(){t.transactionManager.run(function(){var n=new t.api.Selection,i=n.range,r=n.getContaining(function(t){return"BLOCKQUOTE"===t.nodeName});if("BLOCKQUOTE"===i.commonAncestorContainer.nodeName){n.placeMarkers(),n.selectMarkers(!0);var o=i.cloneContents();r.parentNode.insertBefore(o,r),i.deleteContents(),n.selectMarkers(),""===r.textContent&&r.parentNode.removeChild(r)}else{var a=n.getContaining(function(t){return"P"===t.nodeName});if(a){var s=e.nextSiblings(a);if(s.size){for(var c=document.createElement(r.nodeName);s.size;)c.appendChild(s.first()),s=s.shift();r.parentNode.insertBefore(c,r.nextElementSibling)}n.placeMarkers(),r.parentNode.insertBefore(a,r.nextElementSibling),n.selectMarkers(),""===r.innerHTML&&r.parentNode.removeChild(r)}else t.api.CommandPatch.prototype.execute.call(this)}}.bind(this))},t.commandPatches.outdent=n}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=new t.api.CommandPatch("createLink");t.commandPatches.createLink=e,e.execute=function(e){var n=new t.api.Selection;if(n.range.collapsed){var i=document.createElement("a");i.setAttribute("href",e),i.textContent=e,n.range.insertNode(i);var r=document.createRange();r.setStartBefore(i),r.setEndAfter(i),n.selection.removeAllRanges(),n.selection.addRange(r)}else t.api.CommandPatch.prototype.execute.call(this,e)}}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e){var n,i;n=[],(i=function(){"use strict";return function(){return function(t){var e=t.node;t.allowsBlockElements()&&t.el.addEventListener("keyup",function(n){if(8===n.keyCode||46===n.keyCode){var i=new t.api.Selection,r=i.getContaining(function(t){return"P"===t.nodeName});r&&t.transactionManager.run(function(){i.placeMarkers(),e.removeChromeArtifacts(r),i.selectMarkers()},!0)}})}}}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(188),n(189),n(190),n(191)],(r=function(t,e,n,i){"use strict";return function(r){this.CommandPatch=t(r),this.Command=e(r),this.Selection=n(r),this.SimpleCommand=i(this,r)}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i;(i=function(){"use strict";return function(t){function e(t){this.commandName=t}return e.prototype.execute=function(e){t.transactionManager.run(function(){document.execCommand(this.commandName,!1,e||null)}.bind(this))},e.prototype.queryState=function(){return document.queryCommandState(this.commandName)},e.prototype.queryEnabled=function(){return document.queryCommandEnabled(this.commandName)},e}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(t){function e(e){this.commandName=e,this.patch=t.commandPatches[this.commandName]}return e.prototype.execute=function(e){this.patch?this.patch.execute(e):t.transactionManager.run(function(){document.execCommand(this.commandName,!1,e||null)}.bind(this))},e.prototype.queryState=function(){return this.patch?this.patch.queryState():document.queryCommandState(this.commandName)},e.prototype.queryEnabled=function(){return this.patch?this.patch.queryEnabled():document.queryCommandEnabled(this.commandName)},e}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(t){function e(){var t=document.createElement("em");return t.style.display="none",t.classList.add("scribe-marker"),t}function n(t,e){t.insertNode(e),e.nextSibling&&o.isEmptyTextNode(e.nextSibling)&&o.removeNode(e.nextSibling),e.previousSibling&&o.isEmptyTextNode(e.previousSibling)&&o.removeNode(e.previousSibling)}function i(){if(this.selection=r.getSelection(),this.selection.rangeCount&&this.selection.anchorNode){var t=this.selection.anchorNode,e=this.selection.anchorOffset,n=this.selection.focusNode,i=this.selection.focusOffset;if(t===n&&i<e){var a=e;e=i,i=a}else if(o.isBefore(n,t)){var s=t,c=e;t=n,e=i,n=s,i=c}this.range=document.createRange(),this.range.setStart(t,e),this.range.setEnd(n,i)}}var r=t.el.ownerDocument,o=t.node;if(r.compareDocumentPosition(t.el)&Node.DOCUMENT_POSITION_DISCONNECTED){for(var a=t.el.parentNode;a&&o.isFragment(a);)a=a.parentNode;a&&a.getSelection&&(r=a)}return i.prototype.getContaining=function(e){if(this.range){var n=this.range.commonAncestorContainer;return n&&t.el===n||!e(n)?o.getAncestor(n,t.el,e):n}},i.prototype.placeMarkers=function(){var i=this.range;if(i&&document.contains(t.el)&&t.el.contains(i.startContainer)&&t.el.contains(i.endContainer)){if(n(i.cloneRange(),e()),!i.collapsed){var r=i.cloneRange();r.collapse(!1),n(r,e())}this.selection.removeAllRanges(),this.selection.addRange(i)}},i.prototype.getMarkers=function(){return t.el.querySelectorAll("em.scribe-marker")},i.prototype.removeMarkers=function(){Array.prototype.forEach.call(this.getMarkers(),function(t){var e=t.parentNode;o.removeNode(t),e.normalize()})},i.prototype.selectMarkers=function(t){var e=this.getMarkers();if(e.length){var n=document.createRange();n.setStartBefore(e[0]),n.setEndAfter(e.length>=2?e[1]:e[0]),t||this.removeMarkers(),this.selection.removeAllRanges(),this.selection.addRange(n)}},i.prototype.isCaretOnNewLine=function(){var t=this.getContaining(function(t){return"P"===t.nodeName});return!!t&&o.isEmptyInlineElement(t)},i}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(t,e){function n(t,n){e.api.Command.call(this,t),this._nodeName=n}return n.prototype=Object.create(t.Command.prototype),n.prototype.constructor=n,n.prototype.queryState=function(){var t=new e.api.Selection;return e.api.Command.prototype.queryState.call(this)&&!!t.getContaining(function(t){return t.nodeName===this._nodeName}.bind(this))},n}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(193),n(194),n(195),n(196),n(197),n(198),n(199)],(r=function(t,e,n,i,r,o,a){"use strict";return{indent:t,insertList:e,outdent:n,redo:i,subscript:r,superscript:o,undo:a}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=new t.api.Command("indent");e.queryEnabled=function(){var e=(new t.api.Selection).getContaining(function(t){return"UL"===t.nodeName||"OL"===t.nodeName});return t.api.Command.prototype.queryEnabled.call(this)&&t.allowsBlockElements()&&!e},t.commands.indent=e}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(165)],(r=function(t){"use strict";return function(){return function(e){var n=e.node,i=function(t){e.api.Command.call(this,t)};i.prototype=Object.create(e.api.Command.prototype),i.prototype.constructor=i,i.prototype.execute=function(i){function r(t){if(t.size){for(var e=document.createElement(s.nodeName);t.size;)e.appendChild(t.first()),t=t.shift();s.parentNode.insertBefore(e,s.nextElementSibling)}}if(this.queryState()){var o=new e.api.Selection,a=o.range,s=o.getContaining(function(t){return"OL"===t.nodeName||"UL"===t.nodeName}),c=o.getContaining(function(t){return"LI"===t.nodeName});e.transactionManager.run(function(){if(c){r(n.nextSiblings(c)),o.placeMarkers();var e=document.createElement("p");e.innerHTML=c.innerHTML,s.parentNode.insertBefore(e,s.nextElementSibling),c.parentNode.removeChild(c)}else{var i=t.List(s.querySelectorAll("li")).filter(function(t){return a.intersectsNode(t)}),u=i.last();r(n.nextSiblings(u)),o.placeMarkers();var l=document.createDocumentFragment();i.forEach(function(t){var e=document.createElement("p");e.innerHTML=t.innerHTML,l.appendChild(e)}),s.parentNode.insertBefore(l,s.nextElementSibling),i.forEach(function(t){t.parentNode.removeChild(t)})}0===s.childNodes.length&&s.parentNode.removeChild(s),o.selectMarkers()}.bind(this))}else e.api.Command.prototype.execute.call(this,i)},i.prototype.queryEnabled=function(){return e.api.Command.prototype.queryEnabled.call(this)&&e.allowsBlockElements()},e.commands.insertOrderedList=new i("insertOrderedList"),e.commands.insertUnorderedList=new i("insertUnorderedList")}}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=new t.api.Command("outdent");e.queryEnabled=function(){var e=(new t.api.Selection).getContaining(function(t){return"UL"===t.nodeName||"OL"===t.nodeName});return t.api.Command.prototype.queryEnabled.call(this)&&t.allowsBlockElements()&&!e},t.commands.outdent=e}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=new t.api.Command("redo");e.execute=function(){t.undoManager.redo()},e.queryEnabled=function(){return t.undoManager.position>0},t.commands.redo=e,t.options.undo.enabled&&t.el.addEventListener("keydown",function(t){t.shiftKey&&(t.metaKey||t.ctrlKey)&&90===t.keyCode&&(t.preventDefault(),e.execute())})}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=new t.api.Command("subscript");t.commands.subscript=e}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=new t.api.Command("superscript");t.commands.superscript=e}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=new t.api.Command("undo");e.execute=function(){t.undoManager.undo()},e.queryEnabled=function(){return t.undoManager.position<t.undoManager.length},t.commands.undo=e,t.options.undo.enabled&&t.el.addEventListener("keydown",function(t){t.shiftKey||!t.metaKey&&!t.ctrlKey||90!==t.keyCode||(t.preventDefault(),e.execute())})}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(165)],(r=function(t){"use strict";function e(e,n){this._stack=t.List(),this._limit=e,this._fireEvent="undefined"!=typeof CustomEvent&&n&&n.dispatchEvent,this._ush=n,this.position=0,this.length=0}return e.prototype.transact=function(e,n){if(arguments.length<2)throw new TypeError("Not enough arguments to UndoManager.transact.");e.execute(),this.position>0&&this.clearRedo();var i;n&&this.length?(i=this._stack.first().push(e),this._stack=this._stack.shift().unshift(i)):(i=t.List.of(e),this._stack=this._stack.unshift(i),this.length++,this._limit&&this.length>this._limit&&this.clearUndo(this._limit)),this._dispatch("DOMTransaction",i)},e.prototype.undo=function(){if(!(this.position>=this.length)){for(var t=this._stack.get(this.position),e=t.size;e--;)t.get(e).undo();this.position++,this._dispatch("undo",t)}},e.prototype.redo=function(){if(0!==this.position){this.position--;for(var t=this._stack.get(this.position),e=0;e<t.size;e++)t.get(e).redo();this._dispatch("redo",t)}},e.prototype.item=function(t){return t>=0&&t<this.length?this._stack.get(t).toArray():null},e.prototype.clearUndo=function(t){this._stack=this._stack.take(t!==undefined?t:this.position),this.length=this._stack.size},e.prototype.clearRedo=function(){this._stack=this._stack.skip(this.position),this.length=this._stack.size,this.position=0},e.prototype._dispatch=function(t,e){this._fireEvent&&this._ush.dispatchEvent(new CustomEvent(t,{detail:{transactions:e.toArray()},bubbles:!0,cancelable:!1}))},e}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(165)],(r=function(t){"use strict";function e(){this._listeners={}}return e.prototype.on=function(e,n){var i=this._listeners[e]||t.Set();this._listeners[e]=i.add(n)},e.prototype.off=function(e,n){var i=this._listeners[e]||t.Set();this._listeners[e]=n?i["delete"](n):i.clear()},e.prototype.trigger=function(e,n){for(var i=e.split(":");i.length;){var r=i.join(":");(this._listeners[r]||t.Set()).forEach(function(t){t.apply(null,n)}),i.splice(i.length-1,1)}},e}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(203)],(r=function(t){function e(e){var n=e||{};return n.defaultPlugins&&(n.defaultPlugins=n.defaultPlugins.filter(r(s.defaultPlugins))),n.defaultFormatters&&(n.defaultFormatters=n.defaultFormatters.filter(r(s.defaultFormatters))),Object.freeze(t(n,s))}function n(t){return function(e,n){return e===t?-1:n===t?1:0}}function i(t){return function(e){return-1!==(t?o:a).indexOf(e)}}function r(t){return function(e){return-1!==t.indexOf(e)}}var o=["setRootPElement","enforcePElements","ensureSelectableContainers"],a=["inlineElementsMode"],s={allowBlockElements:!0,debug:!1,undo:{manager:!1,enabled:!0,limit:100,interval:250},defaultCommandPatches:["bold","indent","insertHTML","insertList","outdent","createLink"],defaultPlugins:o.concat(a),defaultFormatters:["escapeHtmlCharactersFormatter","replaceNbspCharsFormatter"]};return{defaultOptions:s,checkOptions:e,sortByPlugin:n,filterByBlockLevelMode:i,filterByPluginExists:r}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(204),n(141),n(205)],(r=function(t,e,n){function i(i){if(null==i)return i;var o=t(arguments);return o.push(n),e.apply(r,o)}var r;return i}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e){var n,i;n=[],(i=function(){function t(t,e){return void 0===t?e:t}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){t.registerPlainTextFormatter(function(t){return t.replace(/\n([ \t]*\n)+/g,"</p><p>").replace(/\n/g,"<br>")})}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i;(i=function(){"use strict";return function(){return function(t){var e=new t.api.Command("createLink");e.nodeName="A",e.execute=function(){var e=new t.api.Selection,n=e.range,i=e.getContaining(function(t){return t.nodeName===this.nodeName}.bind(this)),r=i?i.href:"",o=window.prompt("Enter a link.",r);if(i&&(n.selectNode(i),e.selection.removeAllRanges(),e.selection.addRange(n)),o){var a=/^mailto\:/;if(!/^https?\:\/\//.test(o)&&!a.test(o))if(/@/.test(o)){window.confirm("The URL you entered appears to be an email address. Do you want to add the required \u201cmailto:\u201d prefix?")&&(o="mailto:"+o)}else{window.confirm("The URL you entered appears to be a link. Do you want to add the required \u201chttp://\u201d prefix?")&&(o="http://"+o)}t.api.SimpleCommand.prototype.execute.call(this,o)}},e.queryState=function(){return!!(new t.api.Selection).getContaining(function(t){return t.nodeName===this.nodeName}.bind(this))},t.commands.linkPrompt=e}}}.call(e,n,e,t))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(209),n(210),n(222)],(r=function(t,e,n){"use strict";return function(i){var r=e(n(i),{tags:{em:{"class":"scribe-marker"},br:{}}});return function(e){var n=new t(r);e.registerHTMLFormatter("sanitize",n.clean.bind(n))}}}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;!function(o,a){(r="function"==typeof(i=a)?i.call(e,n,e,t):i)===undefined||(t.exports=r)}(0,function(){function t(t){var e=t.tags;if(!Object.keys(e).map(function(t){return typeof e[t]}).every(function(t){return"object"===t||"boolean"===t||"function"===t}))throw new Error("The configuration was invalid");this.config=t}function e(t){return-1!==s.indexOf(t.nodeName)}function n(t){return-1!==c.indexOf(t.nodeName)}function i(t){return document.createTreeWalker(t,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT,null,!1)}function r(t,e,n){return"function"==typeof t.tags[e]?t.tags[e](n):t.tags[e]}function o(t,e){return void 0===e||"boolean"==typeof e&&!e}function a(t,e,n){var i=t.name.toLowerCase();return!0!==e&&("function"==typeof e[i]?!e[i](t.value,n):"undefined"==typeof e[i]||(!1===e[i]||"string"==typeof e[i]&&e[i]!==t.value))}var s=["P","LI","TD","TH","DIV","H1","H2","H3","H4","H5","H6","PRE"],c=["A","B","STRONG","I","EM","SUB","SUP","U","STRIKE"];return t.prototype.clean=function(t){var e=document.createElement("div");return e.innerHTML=t,this._sanitize(e),e.innerHTML},t.prototype._sanitize=function(t){var s=i(t),c=s.firstChild();if(c)do{if(!c._sanitized)if(c.nodeType!==Node.TEXT_NODE){if(c.nodeType===Node.COMMENT_NODE){t.removeChild(c),this._sanitize(t);break}var u,l=n(c);l&&(u=Array.prototype.some.call(c.childNodes,e));var h=!!t.parentNode,d=e(t)&&e(c)&&h,f=c.nodeName.toLowerCase(),p=r(this.config,f,c);if(l&&u||o(c,p)||!this.config.keepNestedBlockElements&&d){if("SCRIPT"!==c.nodeName&&"STYLE"!==c.nodeName)for(;c.childNodes.length>0;)t.insertBefore(c.childNodes[0],c);t.removeChild(c),this._sanitize(t);break}for(var m=0;m<c.attributes.length;m+=1){var g=c.attributes[m];a(g,p,c)&&(c.removeAttribute(g.name),m-=1)}this._sanitize(c),c._sanitized=!0}else if(""===c.data.trim()&&(c.previousElementSibling&&e(c.previousElementSibling)||c.nextElementSibling&&e(c.nextElementSibling))){t.removeChild(c),this._sanitize(t);break}}while(c=s.nextSibling())},t})},function(t,e,n){var i,r;i=[n(211),n(158)],(r=function(t,e){return e(t)}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(212),n(213),n(216),n(153),n(145),n(150),n(149),n(220)],(r=function(t,e,n,i,r,o,a,s){function c(l,h,d,f,p){if(!o(l))return l;var m=r(h.length)&&(i(h)||s(h));return(m?t:e)(h,function(t,e,i){if(a(t))return f||(f=[]),p||(p=[]),n(l,i,e,c,d,f,p);var r=l[e],o=d?d(r,t,e,l,i):u,s=void 0===o;s&&(o=t),!m&&void 0===o||!s&&(o==o?o===r:r!=r)||(l[e]=o)}),l}var u;return c}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t,e){for(var n=-1,i=t.length;++n<i&&!1!==e(t[n],n,t););return t}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){var i,r;i=[n(214),n(144)],(r=function(t,e){function n(n,i){return t(n,i,e)}return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(215)],(r=function(t){function e(e,n,i){for(var r=-1,o=t(e),a=i(e),s=a.length;++r<s;){var c=a[r];if(!1===n(o[c],c,o))break}return e}return e}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(150)],(r=function(t){function e(e){return t(e)?e:Object(e)}return e}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(204),n(152),n(153),n(145),n(217),n(220),n(221)],(r=function(t,e,n,i,r,o,a){function s(s,u,l,h,d,f,p){for(var m=f.length,g=u[l];m--;)if(f[m]==g)return void(s[l]=p[m]);var v=s[l],y=d?d(v,g,l,s,u):c,b=void 0===y;b&&(y=g,i(g.length)&&(n(g)||o(g))?y=n(v)?v:v?t(v):[]:r(g)||e(g)?y=e(v)?a(v):r(v)?v:{}:b=!1),f.push(g),p.push(y),b?s[l]=h(y,g,d,f,p):(y==y?y!==v:v==v)&&(s[l]=y)}var c;return s}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(146),n(218)],(r=function(t,e){var n="[object Object]",i=Object.prototype.toString,r=t(r=Object.getPrototypeOf)&&r;return r?function(o){if(!o||i.call(o)!=n)return!1;var a=o.valueOf,s=t(a)&&(s=r(a))&&r(s);return s?o==s||r(o)==s:e(o)}:e}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(219),n(149)],(r=function(t,e){function n(n){var r;if(!e(n)||a.call(n)!=i||!o.call(n,"constructor")&&"function"==typeof(r=n.constructor)&&!(r instanceof r))return!1;var s;return t(n,function(t,e){s=e}),void 0===s||o.call(n,s)}var i="[object Object]",r=Object.prototype,o=r.hasOwnProperty,a=r.toString;return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(214),n(155)],(r=function(t,e){function n(n,i){return t(n,i,e)}return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(145),n(149)],(r=function(t,e){function n(n){return e(n)&&t(n.length)&&E[T.call(n)]||!1}var i="[object Arguments]",r="[object Array]",o="[object Boolean]",a="[object Date]",s="[object Error]",c="[object Function]",u="[object Map]",l="[object Number]",h="[object Object]",d="[object RegExp]",f="[object Set]",p="[object String]",m="[object WeakMap]",g="[object ArrayBuffer]",v="[object Float64Array]",y="[object Int8Array]",b="[object Int16Array]",_="[object Int32Array]",x="[object Uint8Array]",w="[object Uint8ClampedArray]",S="[object Uint16Array]",k="[object Uint32Array]",E={};E["[object Float32Array]"]=E[v]=E[y]=E[b]=E[_]=E[x]=E[w]=E[S]=E[k]=!0,E[i]=E[r]=E[g]=E[o]=E[a]=E[s]=E[c]=E[u]=E[l]=E[h]=E[d]=E[f]=E[p]=E[m]=!1;var T=Object.prototype.toString;return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(143),n(155)],(r=function(t,e){function n(n){return t(n,e(n))}return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(223),n(159)],(r=function(t,e){function n(n,i,r){return i="function"==typeof i&&e(i,r,1),t(n,!0,i)}return n}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(204),n(212),n(143),n(213),n(227),n(224),n(228),n(153),n(150),n(144)],(r=function(t,e,n,i,r,o,a,s,c,u){function l(d,f,p,m,v,y,_){var x;if(p&&(x=v?p(d,m,v):p(d)),void 0!==x)return x;if(!c(d))return d;var w=s(d);if(w){if(x=r(d),!f)return t(d,x)}else{var S=O.call(d),k=S==g;if(S!=b&&S!=h&&(!k||v))return D[S]?o(d,S,f):v?d:{};if(x=a(k?{}:d),!f)return n(d,x,u(d))}y||(y=[]),_||(_=[]);for(var E=y.length;E--;)if(y[E]==d)return _[E];return y.push(d),_.push(x),(w?e:i)(d,function(t,e){x[e]=l(t,f,p,e,d,y,_)}),x}
var h="[object Arguments]",d="[object Array]",f="[object Boolean]",p="[object Date]",m="[object Error]",g="[object Function]",v="[object Map]",y="[object Number]",b="[object Object]",_="[object RegExp]",x="[object Set]",w="[object String]",S="[object WeakMap]",k="[object ArrayBuffer]",E="[object Float32Array]",T="[object Float64Array]",C="[object Int8Array]",L="[object Int16Array]",P="[object Int32Array]",A="[object Uint8Array]",N="[object Uint8ClampedArray]",R="[object Uint16Array]",I="[object Uint32Array]",D={};D[h]=D[d]=D[k]=D[f]=D[p]=D[E]=D[T]=D[C]=D[L]=D[P]=D[y]=D[b]=D[_]=D[w]=D[A]=D[N]=D[R]=D[I]=!0,D[m]=D[g]=D[v]=D[x]=D[S]=!1;var O=Object.prototype.toString;return l}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(225)],(r=function(t){function e(e,y,b){var _=e.constructor;switch(y){case s:return t(e);case n:case i:return new _(+e);case c:case u:case l:case h:case d:case f:case p:case m:case g:var x=e.buffer;return new _(b?t(x):x,e.byteOffset,e.length);case r:case a:return new _(e);case o:var w=new _(e.source,v.exec(e));w.lastIndex=e.lastIndex}return w}var n="[object Boolean]",i="[object Date]",r="[object Number]",o="[object RegExp]",a="[object String]",s="[object ArrayBuffer]",c="[object Float32Array]",u="[object Float64Array]",l="[object Int8Array]",h="[object Int16Array]",d="[object Int32Array]",f="[object Uint8Array]",p="[object Uint8ClampedArray]",m="[object Uint16Array]",g="[object Uint32Array]",v=/\w*$/;return e}.apply(e,i))===undefined||(t.exports=r)},function(t,e,n){var i,r;i=[n(226),n(146),n(157)],(r=function(t,e,n){function i(t){return o.call(t,0)}var r=e(r=n.ArrayBuffer)&&r,o=e(o=r&&new r(0).slice)&&o,a=Math.floor,s=e(s=n.Uint8Array)&&s,c=function(){try{var t=e(t=n.Float64Array)&&t,i=new t(new r(10),0,1)&&t}catch(o){}return i}(),u=c?c.BYTES_PER_ELEMENT:0;return o||(i=r&&s?function(t){var e=t.byteLength,n=c?a(e/u):0,i=n*u,o=new r(e);if(n){var l=new c(o,0,n);l.set(new c(t,0,n))}return e!=i&&(l=new s(o,i)).set(new s(t,i)),o}:t(null)),i}.apply(e,i))===undefined||(t.exports=r)},function(t,e){var n,i;n=[],(i=function(){function t(t){return function(){return t}}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e){var n,i;n=[],(i=function(){function t(t){var n=t.length,i=new t.constructor(n);return n&&"string"==typeof t[0]&&e.call(t,"index")&&(i.index=t.index,i.input=t.input),i}var e=Object.prototype.hasOwnProperty;return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e){var n,i;n=[],(i=function(){function t(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Object),new e}return t}.apply(e,n))===undefined||(t.exports=i)},function(t,e,n){"use strict";var i=n(230);t.exports={mixinName:"Textable",initializeTextable:function(){this.el.classList.add("st-block--textable")},focusAtEnd:function(){this.focus(),this.selectText()},selectText:function(){var t=document.createRange();this._scribe.allowsBlockElements()?t.setStartAfter(this._scribe.el.firstChild,0):t.selectNodeContents(this._scribe.el),t.collapse(!1);var e=new this._scribe.api.Selection;e.selection.removeAllRanges(),e.selection.addRange(t)},getScribeInnerContent:function(){var t="";if(""!==this._scribe.getTextContent()){var e=document.createElement("div");return e.innerHTML=this.getTextBlockHTML(),(t=e.children&&Array.prototype.slice.call(e.children).reduce(function(t,e){return t+e.innerHTML},"")||e.innerHTML).replace(/^[\s\uFEFF\xA0]+|$/g,"")}return t},getCaretPositionAtEnd:function(){return this.selectText(),i(this._scribe.el)},appendContent:function(t,e){e=e||{};var n=this.getCaretPositionAtEnd(),r=this.getScribeInnerContent();""!==r&&(t=r+t),""===t&&(t="<br>"),this.setTextBlockHTML(t),this.focus(),e.keepCaretPosition&&0!==n.start&&0!==n.end&&i(this._scribe.el,{start:n.start,end:n.end})}}},function(t,e,n){function i(t,e){if(1==arguments.length){if(!a.rangeCount)return;var n={},i=(h=a.getRangeAt(0)).cloneRange();return i.selectNodeContents(t),i.setEnd(h.endContainer,h.endOffset),n.end=i.toString().length,i.setStart(h.startContainer,h.startOffset),n.start=n.end-i.toString().length,n.atStart=0===i.startOffset,n}for(var s,c,u=e.end&&e.end!==e.start,l=0,h=document.createRange(),d=o(t).select(Node.TEXT_NODE).revisit(!1),f=e.start>t.textContent.length?t.textContent.length:e.start,p=e.end>t.textContent.length?t.textContent.length:e.end,m=e.atStart;s=d.next();){var g=l;l+=s.textContent.length;if(!c&&(m?l>f:l>=f)&&(c=!0,h.setStart(s,f-g),!u)){h.collapse(!0),r(t,h);break}if(u&&l>=p){h.setEnd(s,p-g),r(t,h);break}}}function r(t,e){t.focus(),a.removeAllRanges(),a.addRange(e)}var o=n(231),a=window.getSelection();t.exports=i},function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);if(this.node=this.start=this.peeked=t,this.root=e,this.closingTag=!1,this._revisit=!0,this._selects=[],this._rejects=[],t&&this.higher(t))throw new Error("root must be a parent or ancestor to node")}function r(t,e){var n="nextSibling"==t;return function(i,r,a){i=this.compile(i),r=r&&r>0?r:1;for(var s=this.node,c=this.closingTag,u=this._revisit;s;){if(o(n,c)&&s[e])s=s[e],c=!n;else if(1==s.nodeType&&!s[e]&&o(n,c)){if(c=n,!u)continue}else if(s[t])s=s[t],c=!n;else if(s=s.parentNode,c=n,!u)continue;if(!s||this.higher(s,this.root))break;if(i(s)&&this.selects(s,a)&&this.rejects(s,a)){if(--r)continue;return a||(this.node=s),this.closingTag=c,s}}return null}}var o,a;try{o=n(232)}catch(s){o=n(232)}try{a=n(233)}catch(s){a=n(233)}t.exports=i,i.prototype.reset=function(t){return this.node=t||this.start,this},i.prototype.revisit=function(t){return this._revisit=undefined==t||t,this},i.prototype.opening=function(){return 1==this.node.nodeType&&(this.closingTag=!1),this},i.prototype.atOpening=function(){return!this.closingTag},i.prototype.closing=function(){return 1==this.node.nodeType&&(this.closingTag=!0),this},i.prototype.atClosing=function(){return this.closingTag},i.prototype.next=r("nextSibling","firstChild"),i.prototype.previous=i.prototype.prev=r("previousSibling","lastChild"),i.prototype.select=function(t){return t=this.compile(t),this._selects.push(t),this},i.prototype.selects=function(t,e){var n=this._selects,i=n.length;if(!i)return!0;for(var r=0;r<i;r++)if(n[r].call(this,t,e))return!0;return!1},i.prototype.reject=function(t){return t=this.compile(t),this._rejects.push(t),this},i.prototype.rejects=function(t,e){var n=this._rejects,i=n.length;if(!i)return!0;for(var r=0;r<i;r++)if(n[r].call(this,t,e))return!1;return!0},i.prototype.higher=function(t){var e=this.root;if(!e)return!1;for(t=t.parentNode;t&&t!=e;)t=t.parentNode;return t!=e},i.prototype.compile=function(t){switch(typeof t){case"number":return function(e){return t==e.nodeType};case"string":return new Function("node","return "+a(t,"node."));case"function":return t;default:return function(){return!0}}},i.prototype.peak=i.prototype.peek=function(t,e){return 1==arguments.length&&(e=t,t=!0),(e=undefined==e?1:e)?e>0?this.next(t,e,!0):this.prev(t,Math.abs(e),!0):this.node},i.prototype.use=function(t){return t(this),this}},function(t){function e(t,e){return!t!=!e}t.exports=e},function(t){function e(t){return t.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").replace(o,"").match(/[a-zA-Z_]\w*/g)||[]}function n(t,e,n){var i=/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*/g;return t.replace(i,function(t){return"("==t[t.length-1]?n(t):~e.indexOf(t)?n(t):t})}function i(t){for(var e=[],n=0;n<t.length;n++)~e.indexOf(t[n])||e.push(t[n]);return e}function r(t){return function(e){return t+e}}var o=/\b(Array|Date|Object|Math|JSON)\b/g;t.exports=function(t,o){var a=i(e(t));return o&&"string"==typeof o&&(o=r(o)),o?n(t,a,o):a}},function(t,e,n){"use strict";var i=n(2)["default"],r=["<div class='st-block-positioner__inner'>","<span class='st-block-positioner__selected-value'></span>","<select class='st-block-positioner__select'></select>","</div>"].join("\n"),o=function(t,e){this.mediator=e,this.block=t,this._ensureElement(),this._bindFunctions(),this.initialize()};i(o.prototype,n(235),n(236),{total_blocks:0,bound:["onBlockCountChange","onSelectChange","toggle","show","hide"],className:"st-block-positioner",visibleClass:"active",initialize:function(){this.el.insertAdjacentHTML("beforeend",r),this.select=this.$(".st-block-positioner__select")[0],this.select.addEventListener("change",this.onSelectChange),this.mediator.on("block:countUpdate",this.onBlockCountChange)},onBlockCountChange:function(t){t!==this.total_blocks&&(this.total_blocks=t,this.renderPositionList())},onSelectChange:function(){var t=this.select.value;0!==t&&(this.mediator.trigger("block:changePosition",this.block,t,1===t?"before":"after"),this.toggle())},renderPositionList:function(){for(var t="<option value='0'>"+i18n.t("general:position")+"</option>",e=1;e<=this.total_blocks;e++)t+="<option value="+e+">"+e+"</option>";this.select.innerHTML=t},toggle:function(){this.select.value=0,this.el.classList.toggle(this.visibleClass)},show:function(){this.el.classList.add(this.visibleClass)},hide:function(){this.el.classList.remove(this.visibleClass)}}),t.exports=o},function(t){"use strict";t.exports={bound:[],_bindFunctions:function(){this.bound.forEach(function(t){this[t]=this[t].bind(this)},this)}}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(69);t.exports={tagName:"div",className:"sir-trevor__view",attributes:{},$:function(t){return this.el.querySelectorAll(t)},render:function(){return this},destroy:function(){r.isUndefined(this.stopListening)||this.stopListening(),o.remove(this.el)},_ensureElement:function(){if(this.el)this._setElement(this.el);else{var t=i({},r.result(this,"attributes"));this.id&&(t.id=this.id),this.className&&(t["class"]=this.className);var e=o.createElement(this.tagName,t);this._setElement(e)}},_setElement:function(t){return this.el=t,this}}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(133),o=n(75),a=n(69),s=n(68),c=function(t,e){this.block=t,this.blockID=this.block.getAttribute("id"),this.mediator=e,this._ensureElement(),this._bindFunctions(),this.initialize()};i(c.prototype,n(235),n(236),{bound:["onMouseDown","onDragStart","onDragEnd","onDrop"],className:"st-block-ui-btn__reorder",tagName:"a",attributes:function(){return{html:'<svg role="img" class="st-icon">\n                 <use xlink:href="'+s.defaults.iconUrl+'#move"/>\n               </svg>',draggable:"true","data-icon":"move"}},initialize:function(){this.el.addEventListener("mousedown",this.onMouseDown),this.el.addEventListener("dragstart",this.onDragStart),this.el.addEventListener("dragend",this.onDragEnd),r.dropArea(this.block),this.block.addEventListener("drop",this.onDrop)},blockId:function(){return this.block.getAttribute("id")},onMouseDown:function(){o.trigger("block:reorder:down")},onDrop:function(t){t.preventDefault();var e=this.block,n=t.dataTransfer.getData("text/plain"),i=document.querySelector("#"+n);e.id!==n&&a.insertAfter(i,e),this.mediator.trigger("block:rerender",n),o.trigger("block:reorder:dropped",n)},onDragStart:function(t){var e=this.block;this.dragEl=e.cloneNode(!0),this.dragEl.classList.add("st-drag-element"),this.dragEl.style.top=e.offsetTop+"px",this.dragEl.style.left=e.offsetLeft+"px",e.parentNode.appendChild(this.dragEl),t.dataTransfer.setDragImage(this.dragEl,0,0),t.dataTransfer.setData("text/plain",this.blockId()),this.mediator.trigger("block-controls:hide"),o.trigger("block:reorder:dragstart"),e.classList.add("st-block--dragging")},onDragEnd:function(){o.trigger("block:reorder:dragend"),this.block.classList.remove("st-block--dragging"),this.dragEl.parentNode.removeChild(this.dragEl)},render:function(){return this}}),t.exports=c},function(t,e,n){"use strict";var i=n(2)["default"],r=n(68),o=function(){this._ensureElement(),this._bindFunctions()};i(o.prototype,n(235),n(236),{tagName:"a",className:"st-block-ui-btn__delete",attributes:{html:function(){return'<svg role="img" class="st-icon">\n                   <use xlink:href="'+r.defaults.iconUrl+'#cross"/>\n                 </svg>'},"data-icon":"close"}}),t.exports=o},function(t,e,n){"use strict";var i=n(34),r=n(29),o=function(t){var e=t.getAttribute("data-st-name")||t.getAttribute("name");return e||(e="Field"),r.capitalize(e)};t.exports={errors:[],valid:function(){return this.performValidations(),0===this.errors.length},performValidations:function(){this.resetErrors();var t=this.$(".st-required");Array.prototype.forEach.call(t,function(t){this.validateField(t)}.bind(this)),this.validations.forEach(this.runValidator,this),this.el.classList.toggle("st-block--with-errors",this.errors.length>0)},validations:[],validateField:function(t){0===(t.getAttribute("contenteditable")?t.textContent:t.value).length&&this.setError(t,i18n.t("errors:block_empty",{name:o(t)}))},runValidator:function(t){i.isUndefined(this[t])||this[t].call(this)},setError:function(t,e){var n=this.addMessage(e,"st-msg--error");t.classList.add("st-error"),this.errors.push({field:t,reason:e,msg:n})},resetErrors:function(){this.errors.forEach(function(t){t.field.classList.remove("st-error"),t.msg.remove()}),this.messages.classList.remove("st-block__messages--is-visible"),this.errors=[]}}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(29),a=n(75);t.exports={blockStorage:{},createStore:function(t){this.blockStorage={type:o.underscored(this.type),data:t||{}}},save:function(){var t=this._serializeData();r.isEmpty(t)||this.setData(t)},getData:function(){return this.save(),this.blockStorage},getBlockData:function(){return this.save(),this.blockStorage.data},_getData:function(){return this.blockStorage.data},setData:function(t){o.log("Setting data for block "+this.blockID),i(this.blockStorage.data,t||{})},setAndLoadData:function(t){this.setData(t),this.beforeLoadingData()},_serializeData:function(){},loadData:function(){},beforeLoadingData:function(){o.log("loadData for "+this.blockID),a.trigger("editor/block/loadData"),this.loadData(this._getData())},_loadData:function(){o.log("_loadData is deprecated and will be removed in the future. Please use beforeLoadingData instead."),this.beforeLoadingData()},checkAndLoadData:function(){r.isEmpty(this._getData())||this.beforeLoadingData()}}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(30)["default"],o=n(34),a=n(29),s=n(68),c=n(75),u=n(242),l=n(69),h=["convertToMarkdown","convertFromMarkdown","formatBar"],d=function(t){this.options=t.options,this.blockOptions=h.reduce(function(e,n){return e[n]=t.options[n],e},{}),this.instance_scope=t.ID,this.mediator=t.mediator,this.wrapper=t.wrapper,this.blocks=[],this.blockCounts={},this.blockTypes=[],this._setBlocksTypes(),this._setRequired(),this._bindMediatedEvents(),this.initialize()};i(d.prototype,n(235),n(268),n(73),{eventNamespace:"block",mediatedEvents:{create:"createBlock",remove:"removeBlock",rerender:"rerenderBlock",replace:"replaceBlock",focusPrevious:"focusPreviousBlock",focusNext:"focusNextBlock"},initialize:function(){},createBlock:function(t,e,n){if(t=a.classify(t),this.canCreateBlock(t)){var i=new u[t](e,this.instance_scope,this.mediator,this.blockOptions);this.blocks.push(i),this._incrementBlockTypeCount(t),this.renderBlock(i,n),this.triggerBlockCountUpdate(),this.mediator.trigger("block:limitReached",this.blockLimitReached()),c.trigger(e?"block:create:existing":"block:create:new",i),a.log("Block created of type "+t)}},removeBlock:function(t,e){e=i({transposeContent:!1,focusOnPrevious:!1},e);var n=this.findBlockById(t),r=a.classify(n.type),o=this.getPreviousBlock(n),s=this.getNextBlock(n);if(e.transposeContent&&n.textable){if(!o&&1===this.blocks.length)return;if(o&&o.textable)o.appendContent(n.getScribeInnerContent(),{keepCaretPosition:!0});else{if(""!==n.getScribeInnerContent())return;o?o.focusAtEnd():s&&s.focus()}}this.mediator.trigger("block-controls:reset"),this.blocks=this.blocks.filter(function(t){return t.blockID!==n.blockID}),n.remove(),e.focusOnPrevious&&o&&o.focusAtEnd(),this._decrementBlockTypeCount(r),this.triggerBlockCountUpdate(),this.mediator.trigger("block:limitReached",this.blockLimitReached()),c.trigger("block:remove",t)},replaceBlock:function(t,e,n){var i=this.findBlockById(t.id);this.createBlock(e,n||null,t),this.removeBlock(t.id),i.remove()},renderBlock:function(t,e){e?l.insertAfter(t.render().el,e):this.wrapper.appendChild(t.render().el),t.trigger("onRender")},rerenderBlock:function(t){var e=this.findBlockById(t);o.isUndefined(e)||e.isEmpty()||!e.drop_options.re_render_on_reorder||e.beforeLoadingData()},getPreviousBlock:function(t){var e=this.getBlockPosition(t.el);if(!(e<1)){var n=this.wrapper.querySelectorAll(".st-block")[e-1];return this.findBlockById(n.getAttribute("id"))}},getNextBlock:function(t){var e=this.getBlockPosition(t.el);if(!(e<0||e>=this.blocks.length-1))return this.findBlockById(this.wrapper.querySelectorAll(".st-block")[e+1].getAttribute("id"))},getBlockPosition:function(t){return Array.prototype.indexOf.call(this.wrapper.querySelectorAll(".st-block"),t)},focusPreviousBlock:function(t){var e=this.findBlockById(t);if(e.textable){var n=this.getPreviousBlock(e);n&&n.textable&&n.focusAtEnd()}},focusNextBlock:function(t){var e=this.findBlockById(t);if(e&&e.textable){var n=this.getNextBlock(e);n&&n.textable&&n.focus()}},triggerBlockCountUpdate:function(){this.mediator.trigger("block:countUpdate",this.blocks.length)},canCreateBlock:function(t){return this.blockLimitReached()?(a.log("Cannot add any more blocks. Limit reached."),!1):this.isBlockTypeAvailable(t)?!!this.canAddBlockType(t)||(a.log("Block Limit reached for type "+t),!1):(a.log("Block type not available "+t),!1)},validateBlockTypesExist:function(t){if(s.skipValidation||!t)return!1;(this.required||[]).forEach(function(t){if(this.isBlockTypeAvailable(t))if(0===this._getBlockTypeCount(t))a.log("Failed validation on required block type "+t),this.mediator.trigger("errors:add",{text:i18n.t("errors:type_missing",{type:t})});else{if(this.getBlocksByType(t).filter(function(t){return!t.isEmpty()}).length>0)return!1;this.mediator.trigger("errors:add",{text:i18n.t("errors:required_type_empty",{type:t})}),a.log("A required block type "+t+" is empty")}},this)},findBlockById:function(t){return this.blocks.find(function(e){return e.blockID===t})},getBlocksByType:function(t){return this.blocks.filter(function(e){return a.classify(e.type)===t})},getBlocksByIDs:function(t){return this.blocks.filter(function(e){return t.includes(e.blockID)})},blockLimitReached:function(){return 0!==this.options.blockLimit&&this.blocks.length>=this.options.blockLimit},isBlockTypeAvailable:function(t){return this.blockTypes.includes(t)},canAddBlockType:function(t){var e=this._getBlockTypeLimit(t);return!(0!==e&&this._getBlockTypeCount(t)>=e)},_setBlocksTypes:function(){this.blockTypes=this.options.blockTypes||r(u)},_setRequired:function(){this.required=!1,Array.isArray(this.options.required)&&!o.isEmpty(this.options.required)&&(this.required=this.options.required)},_incrementBlockTypeCount:function(t){this.blockCounts[t]=o.isUndefined(this.blockCounts[t])?1:this.blockCounts[t]+1},_decrementBlockTypeCount:function(t){this.blockCounts[t]=o.isUndefined(this.blockCounts[t])?1:this.blockCounts[t]-1},_getBlockTypeCount:function(t){return o.isUndefined(this.blockCounts[t])?0:this.blockCounts[t]},_blockLimitReached:function(){return 0!==this.options.blockLimit&&this.blocks.length>=this.options.blockLimit},_getBlockTypeLimit:function(t){return this.isBlockTypeAvailable(t)?parseInt(o.isUndefined(this.options.blockTypeLimits[t])?0:this.options.blockTypeLimits[t],10):0}}),t.exports=d},function(t,e,n){"use strict";t.exports={Text:n(243),Quote:n(261),Image:n(262),Heading:n(263),List:n(264),Tweet:n(266),Video:n(267)}},function(t,e,n){"use strict";var i=n(244),r=n(253),o=n(254),a=n(258),s=n(259),c=n(260);t.exports=i.extend({type:"text",editorHTML:'<div class="st-text-block" contenteditable="true"></div>',icon_name:"text",textable:!0,toolbarEnabled:!1,configureScribe:function(t){t.use(new o(this)),t.use(new a(this)),t.use(new s(this)),t.use(new c(this)),t.on("content-changed",this.toggleEmptyClass.bind(this))},scribeOptions:{allowBlockElements:!0,tags:{p:!0}},loadData:function(t){this.options.convertFromMarkdown&&"html"!==t.format?this.setTextBlockHTML(r(t.text,this.type)):this.setTextBlockHTML(t.text)},onBlockRender:function(){this.focus(),this.toggleEmptyClass()},toggleEmptyClass:function(){this.el.classList.toggle("st-block--empty",this.isEmpty())},isEmpty:function(){return""===this._scribe.getTextContent()}})},function(t,e,n){"use strict";var i=n(70)["default"],r=n(2)["default"],o=n(34),a=n(138),s=n(68),c=n(29),u=n(69),l=n(131),h=n(128),d=n(245),f=n(237),p=n(238),m=n(234),g=n(75),v=n(251),y=n(252),b=function(){d.apply(this,arguments)};b.prototype=i(d.prototype),b.prototype.constructor=b,r(b.prototype,d.fn,n(239),{bound:["_handleContentPaste","_onFocus","_onBlur","onDrop","onDeleteClick","clearInsertedStyles","getSelectionForFormatter","onBlockRender","onDeleteConfirm","onPositionerClick"],className:"st-block",attributes:function(){return r(d.fn.attributes.call(this))},icon_name:"default",validationFailMsg:function(){return i18n.t("errors:validation_fail",{type:o.isFunction(this.title)?this.title():this.title})},editorHTML:'<div class="st-block__editor"></div>',toolbarEnabled:!0,availableMixins:["droppable","pastable","uploadable","fetchable","ajaxable","controllable","multi_editable","textable"],droppable:!1,pastable:!1,uploadable:!1,fetchable:!1,ajaxable:!1,multi_editable:!1,textable:!1,drop_options:{},paste_options:{},upload_options:{},formattable:!0,supressKeyListeners:!1,_previousSelection:"",initialize:function(){},toMarkdown:function(t){return t},toHTML:function(t){return t},withMixin:function(t){if(o.isObject(t)){var e="initialize"+t.mixinName;o.isUndefined(this[e])&&(r(this,t),this[e]())}},render:function(){if(this.beforeBlockRender(),this._setBlockInner(),this.editor=this.inner.children[0],this.mixinsRequireInputs=!1,this.availableMixins.forEach(function(t){if(this[t]){var e=h[c.classify(t)];!o.isUndefined(e.requireInputs)&&e.requireInputs&&(this.mixinsRequireInputs=!0)}},this),this.mixinsRequireInputs){var t=document.createElement("div");t.classList.add("st-block__inputs"),this.inner.appendChild(t),this.inputs=t}return this.hasTextBlock()&&this._initTextBlocks(),this.availableMixins.forEach(function(t){this[t]&&this.withMixin(h[c.classify(t)])},this),this.formattable&&this._initFormatting(),this._blockPrepare(),this},remove:function(){this.ajaxable&&this.resolveAllInQueue(),u.remove(this.el)},loading:function(){o.isUndefined(this.spinner)||this.ready(),this.spinner=new v(s.defaults.spinner),this.spinner.spin(this.el),this.el.classList.add("st--is-loading")},ready:function(){this.el.classList.remove("st--is-loading"),o.isUndefined(this.spinner)||(this.spinner.stop(),delete this.spinner)},_serializeData:function(){c.log("toData for "+this.blockID);var t={};this.hasTextBlock()&&(t.text=this.getTextBlockHTML(),t.format="html");var e=['input:not([class="st-paste-block"])','textarea:not([class="st-paste-block"])','select:not([class="st-paste-block"])','button:not([class="st-paste-block"])'].join(",");return this.$(e).length>0&&Array.prototype.forEach.call(this.$("input, textarea, select, button"),function(e){var n=e.getAttribute("data-name")||e.getAttribute("name");if(n)if("number"===e.getAttribute("type"))t[n]=parseInt(e.value);else if("checkbox"===e.getAttribute("type")){var i="";e.getAttribute("data-toggle")?(i="off",!0===e.checked&&(i="on")):!0===e.checked&&(i=e.value),t[n]=i}else"radio"===e.getAttribute("type")?!0===e.checked&&(t[n]=e.value):t[n]=e.value}),t},focus:function(){Array.prototype.forEach.call(this.getTextBlock(),function(t){t.focus()})},focusAtEnd:function(){this.focus()},blur:function(){Array.prototype.forEach.call(this.getTextBlock(),function(t){t.blur()})},onFocus:function(){var t=this;Array.prototype.forEach.call(this.getTextBlock(),function(e){e.addEventListener("focus",t._onFocus)})},onBlur:function(){var t=this;Array.prototype.forEach.call(this.getTextBlock(),function(e){e.addEventListener("blur",t._onBlur)})},_onFocus:function(){this.trigger("blockFocus",this.el)},_onBlur:function(){},onBlockRender:function(){this.focus()},onDrop:function(){},onDeleteConfirm:function(t){t.preventDefault(),this.mediator.trigger("block:remove",this.blockID,{focusOnPrevious:!0})},addDeleteControls:function(){var t=this,e=function(e){e.preventDefault(),t.deleteEl.classList.remove("active")};this.ui.insertAdjacentHTML("beforeend",y()),l.delegate(this.el,".js-st-block-confirm-delete","click",this.onDeleteConfirm),l.delegate(this.el,".js-st-block-deny-delete","click",e)},onDeleteClick:function(t){t.preventDefault(),t.stopPropagation(),this.isEmpty()?this.onDeleteConfirm.call(this,new CustomEvent("click")):(this.deleteEl=this.el.querySelector(".st-block__ui-delete-controls"),this.deleteEl.classList.toggle("active"))},onPositionerClick:function(t){t.preventDefault(),this.positioner.toggle()},beforeLoadingData:function(){this.loading(),this.mixinsRequireInputs&&(u.show(this.editor),u.hide(this.inputs)),d.fn.beforeLoadingData.call(this),this.ready()},execTextBlockCommand:function(t){if(o.isUndefined(this._scribe))throw"No Scribe instance found to send a command to";return a.execTextBlockCommand(this._scribe,t)},queryTextBlockCommandState:function(t){if(o.isUndefined(this._scribe))throw"No Scribe instance found to query command";return a.queryTextBlockCommandState(this._scribe,t)},_handleContentPaste:function(t){setTimeout(this.onContentPasted.bind(this,t,t.currentTarget),0)},_getBlockClass:function(){return"st-block--"+this.className},_initUIComponents:function(){this.addDeleteControls(),this.positioner=new m(this.el,this.mediator),this._withUIComponent(this.positioner,".st-block-ui-btn__reorder",this.onPositionerClick),this._withUIComponent(new f(this.el,this.mediator)),this._withUIComponent(new p,".st-block-ui-btn__delete",this.onDeleteClick),this.onFocus(),this.onBlur()},_initFormatting:function(){var t=this;this.options.formatBar&&this.options.formatBar.commands.forEach(function(e){o.isUndefined(e.keyCode)||l.delegate(t.el,".st-text-block","keydown",function(n){(n.metaKey||n.ctrlKey)&&n.keyCode===e.keyCode&&(n.preventDefault(),t.execTextBlockCommand(e.cmd))})})},_initTextBlocks:function(){var t=this;Array.prototype.forEach.call(this.getTextBlock(),function(e){e.addEventListener("keyup",t.getSelectionForFormatter),e.addEventListener("mouseup",t.getSelectionForFormatter),e.addEventListener("DOMNodeInserted",t.clearInsertedStyles)});var e=this.getTextBlock()[0];if(!o.isUndefined(e)&&o.isUndefined(this._scribe)){var n=o.isFunction(this.configureScribe)?this.configureScribe.bind(this):null;this._scribe=a.initScribeInstance(e,this.scribeOptions,n)}},getSelectionForFormatter:function(){var t=this;setTimeout(function(){var e="formatter:"+(""===window.getSelection().toString().trim()?"hide":"position");t.mediator.trigger(e,t),g.trigger(e,t)},1)},clearInsertedStyles:function(t){var e=t.target;o.isUndefined(e.tagName)&&(e=e.parentNode),e.removeAttribute("style")},hasTextBlock:function(){return this.getTextBlock().length>0},getTextBlock:function(){return o.isUndefined(this.text_block)&&(this.text_block=this.$(".st-text-block")),this.text_block},getTextBlockHTML:function(){return this._scribe.getContent()},setTextBlockHTML:function(t){var e=this._scribe.setContent(t),n=this._scribe.node.firstDeepestChild(this._scribe.el);for("#text"===n.nodeName&&(n.textContent=c.leftTrim(n.textContent));this._scribe.el.firstChild&&""===this._scribe.el.firstChild.textContent;)this._scribe.el.removeChild(this._scribe.el.firstChild);for(;this._scribe.el.lastChild&&"BR"===this._scribe.el.lastChild.nodeName;)this._scribe.el.removeChild(this._scribe.el.lastChild);return e},isEmpty:function(){return o.isEmpty(this.getBlockData())}}),b.extend=n(250),t.exports=b},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(29),a=n(69),s=n(131),c=n(237),u=n(246),l=function(t,e,n,i){this.createStore(t),this.blockID=r.uniqueId("st-block-"),this.instanceID=e,this.mediator=n,this.options=i||{},this._ensureElement(),this._bindFunctions(),this.initialize.apply(this,arguments)};i(l.prototype,n(235),n(73),n(236),n(240),{focus:function(){},valid:function(){return!0},className:"st-block",block_template:u,attributes:function(){return{id:this.blockID,"data-type":this.type,"data-instance":this.instanceID}},title:function(){return i18n.t("blocks:"+this.type+":title")||o.titleize(this.type.replace(/[\W_]/g," "))},blockCSSClass:function(){return this.blockCSSClass=o.toSlug(this.type),this.blockCSSClass},type:"","class":function(){return o.classify(this.type)},editorHTML:"",initialize:function(){},onBlockRender:function(){},beforeBlockRender:function(){},_setBlockInner:function(){var t=r.result(this,"editorHTML");this.el.insertAdjacentHTML("beforeend",this.block_template(t)),this.inner=this.el.querySelector(".st-block__inner")},render:function(){return this.beforeBlockRender(),this._setBlockInner(),this._blockPrepare(),this},_blockPrepare:function(){this._initUI(),this._initMessages(),this.checkAndLoadData(),this.el.classList.add("st-item-ready"),this.on("onRender",this.onBlockRender),this.save()},_withUIComponent:function(t,e,n){this.ui.appendChild(t.render().el),e&&n&&s.delegate(this.ui,e,"click",n)},_initUI:function(){var t=a.createElement("div",{"class":"st-block__ui"});this.el.appendChild(t),this.ui=t,this._initUIComponents()},_initMessages:function(){var t=a.createElement("div",{"class":"st-block__messages"});this.inner.insertBefore(t,this.inner.firstChild),this.messages=t},addMessage:function(t,e){return t=a.createElement("span",{html:t,"class":"st-msg "+e}),this.messages.appendChild(t),this.messages.classList.add("st-block__messages--is-visible"),t},resetMessages:function(){this.messages.innerHTML="",this.messages.classList.remove("st-block__messages--is-visible")},_initUIComponents:function(){this._withUIComponent(new c(this.el))}}),l.fn=l.prototype,l.extend=n(250),t.exports=l},function(t,e,n){"use strict";var i=n(247),r=n(248),o=n(249);t.exports=function(t){return"\n    <div class='st-block__inner'>\n      "+t+"\n    </div>\n    "+o()+"\n    "+i()+"\n    "+r()+"\n  "}},function(t,e,n){"use strict";var i=n(68);t.exports=function(){return'\n    <div class="st-block-addition-top">\n      <div class="st-block-addition-top__button" type="button"></div>\n      <div class="st-block-addition-top__icon">\n        <svg role="img" class="st-icon">\n          <use xlink:href="'+i.defaults.iconUrl+'#add-block"/>\n        </svg>\n      </div>\n    </div>\n  '}},function(t,e,n){"use strict";var i=n(68);t.exports=function(){return'\n    <button class="st-block-addition" type="button">\n      <span class="st-block-addition__button">\n        <svg role="img" class="st-icon">\n          <use xlink:href="'+i.defaults.iconUrl+'#plus"/>\n        </svg>\n      </span>\n    </button>\n  '}},function(t,e,n){"use strict";var i=n(68);t.exports=function(){return'\n    <button class="st-block-replacer" type="button">\n      <span class="st-block-replacer__button">\n        <svg role="img" class="st-icon">\n          <use xlink:href="'+i.defaults.iconUrl+'#add-block"/>\n        </svg>\n      </span>\n    </button>\n  '}},function(t,e,n){"use strict";var i=n(2)["default"];t.exports=function(t,e){var n,r=this;n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return r.apply(this,arguments)},i(n,r,e);var o=function(){this.constructor=n};return o.prototype=r.prototype,n.prototype=new o,t&&i(n.prototype,t),n.__super__=r.prototype,n}},function(t,e,n){var i,r;!function(o,a){"object"==typeof t&&t.exports?t.exports=a():(r="function"==typeof(i=a)?i.call(e,n,e,t):i)===undefined||(t.exports=r)}(0,function(){"use strict";function t(t,e){var n,i=document.createElement(t||"div");for(n in e)i[n]=e[n];return i}function e(t){for(var e=1,n=arguments.length;e<n;e++)t.appendChild(arguments[e]);return t}function n(t,e,n,i){var r=["opacity",e,~~(100*t),n,i].join("-"),o=.01+n/i*100,a=Math.max(1-(1-t)/e*(100-o),t),s=u.substring(0,u.indexOf("Animation")).toLowerCase(),c=s&&"-"+s+"-"||"";return d[r]||(l.insertRule("@"+c+"keyframes "+r+"{0%{opacity:"+a+"}"+o+"%{opacity:"+t+"}"+(o+.01)+"%{opacity:1}"+(o+e)%100+"%{opacity:"+t+"}100%{opacity:"+a+"}}",l.cssRules.length),d[r]=1),r}function i(t,e){var n,i,r=t.style;if(e=e.charAt(0).toUpperCase()+e.slice(1),r[e]!==undefined)return e;for(i=0;i<h.length;i++)if(n=h[i]+e,r[n]!==undefined)return n}function r(t,e){for(var n in e)t.style[i(t,n)||n]=e[n];return t}function o(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]===undefined&&(t[i]=n[i])}return t}function a(t,e){return"string"==typeof t?t:t[e%t.length]}function s(t){this.opts=o(t||{},s.defaults,f)}function c(){function n(e,n){
return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}l.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(t,i){function o(){return r(n("group",{coordsize:l+" "+l,coordorigin:-u+" "+-u}),{width:l,height:l})}function s(t,s,c){e(d,e(r(o(),{rotation:360/i.lines*t+"deg",left:~~s}),e(r(n("roundrect",{arcsize:i.corners}),{width:u,height:i.scale*i.width,left:i.scale*i.radius,top:-i.scale*i.width>>1,filter:c}),n("fill",{color:a(i.color,t),opacity:i.opacity}),n("stroke",{opacity:0}))))}var c,u=i.scale*(i.length+i.width),l=2*i.scale*u,h=-(i.width+i.length)*i.scale*2+"px",d=r(o(),{position:"absolute",top:h,left:h});if(i.shadow)for(c=1;c<=i.lines;c++)s(c,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(c=1;c<=i.lines;c++)s(c);return e(t,d)},s.prototype.opacity=function(t,e,n,i){var r=t.firstChild;i=i.shadow&&i.lines||0,r&&e+i<r.childNodes.length&&(r=(r=(r=r.childNodes[e+i])&&r.firstChild)&&r.firstChild)&&(r.opacity=n)}}var u,l,h=["webkit","Moz","ms","O"],d={},f={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};if(s.defaults={},o(s.prototype,{spin:function(e){this.stop();var n=this,i=n.opts,o=n.el=t(null,{className:i.className});if(r(o,{position:i.position,width:0,zIndex:i.zIndex,left:i.left,top:i.top}),e&&e.insertBefore(o,e.firstChild||null),o.setAttribute("role","progressbar"),n.lines(o,n.opts),!u){var a,s=0,c=(i.lines-1)*(1-i.direction)/2,l=i.fps,h=l/i.speed,d=(1-i.opacity)/(h*i.trail/100),f=h/i.lines;!function p(){s++;for(var t=0;t<i.lines;t++)a=Math.max(1-(s+(i.lines-t)*f)%h*d,i.opacity),n.opacity(o,t*i.direction+c,a,i);n.timeout=n.el&&setTimeout(p,~~(1e3/l))}()}return n},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=undefined),this},lines:function(i,o){function s(e,n){return r(t(),{position:"absolute",width:o.scale*(o.length+o.width)+"px",height:o.scale*o.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*l+o.rotate)+"deg) translate("+o.scale*o.radius+"px,0)",borderRadius:(o.corners*o.scale*o.width>>1)+"px"})}for(var c,l=0,h=(o.lines-1)*(1-o.direction)/2;l<o.lines;l++)c=r(t(),{position:"absolute",top:1+~(o.scale*o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:u&&n(o.opacity,o.trail,h+l*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&e(c,r(s("#000","0 0 4px #000"),{top:"2px"})),e(i,e(c,s(a(o.color,l),"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(t,e,n){e<t.childNodes.length&&(t.childNodes[e].style.opacity=n)}}),"undefined"!=typeof document){l=function(){var n=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}();var p=r(t("group"),{behavior:"url(#default#VML)"});!i(p,"transform")&&p.adj?c():u=i(p,"animation")}return s})},function(t){"use strict";t.exports=function(){return'\n    <div class="st-block__ui-delete-controls">\n      <label class="st-block__delete-label">\n        '+i18n.t("general:delete")+"\n      </label>\n      <button class='st-block-ui__confirm js-st-block-confirm-delete' type=\"button\">\n        "+i18n.t("general:yes")+"\n      </button>\n      <button class='st-block-ui__confirm js-st-block-deny-delete' type=\"button\">\n        "+i18n.t("general:no")+"\n      </button>\n    </div>\n  "}},function(t,e,n){"use strict";var i=n(34),r=n(29);t.exports=function(t,e){var o=n(242),a=t,s="Text"===(e=r.classify(e));i.isUndefined(s)&&(s=!1),s&&(a="<p>"+a),a=a.replace(/\[([^\]]+)\]\(([^\)]+)\)/gm,function(t,e,n){return"<a href='"+n+"'>"+e.replace(/\n/g,"")+"</a>"}),a=(a=r.reverse(r.reverse(a).replace(/_(?!\\)((_\\|[^_])*)_(?=$|[^\\])/gm,function(t,e){return">i/<"+e.replace(/\n/g,"").replace(/[\s]+$/,"")+">i<"}).replace(/\*\*(?!\\)((\*\*\\|[^\*\*])*)\*\*(?=$|[^\\])/gm,function(t,e){return">b/<"+e.replace(/\n/g,"").replace(/[\s]+$/,"")+">b<"}))).replace(/^\> (.+)$/gm,"$1");var c;return o.hasOwnProperty(e)&&(c=o[e],!i.isUndefined(c.prototype.toHTML)&&i.isFunction(c.prototype.toHTML)&&(a=c.prototype.toHTML(a))),s&&(a=(a=a.replace(/\n\s*\n/gm,"</p><p>")).replace(/\n/gm,"<br>")),a=a.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\n/g,"<br>").replace(/\*\*/,"").replace(/__/,""),a=a.replace(/\\\*/g,"*").replace(/\\\[/g,"[").replace(/\\\]/g,"]").replace(/\\\_/g,"_").replace(/\\\(/g,"(").replace(/\\\)/g,")").replace(/\\\-/g,"-"),s&&(a+="</p>"),a}},function(t,e,n){"use strict";var i=n(255)["default"],r=n(230),o=function(t){return function(e){var n=function(t){if(null!==t.firstChild){var e=t.firstChild.childNodes[0];e&&"#text"!==e.nodeName&&""===e.innerText&&t.firstChild.removeChild(e)}},o=function(t,e){var i=document.createElement("div");return e?i.appendChild(t.extractContents()):i.appendChild(t.cloneContents()),n(i),i.firstChild&&"#text"!==i.firstChild.nodeName&&(i=i.lastChild),i.innerHTML.trim()},a=function(){var t=(new e.api.Selection).range.cloneRange();return t.setEndAfter(e.el.lastChild,0),t},s=function(){if(""===e.getTextContent())return!0;var t=(new e.api.Selection).range.cloneRange();t.setStartBefore(e.el.firstChild,0);var n=3===t.endContainer.nodeType?t.endContainer.parentNode:t.endContainer;return e.el.firstChild===n&&""===o(t,!1)},c=function(){var t=(new e.api.Selection).range.cloneRange();return t.selectNodeContents(e.el),t.toString().length},u=function(){var t=r(e.el);return c()===t.end&&t.start===t.end},l=function(){var r=document.createElement("div");if(r.appendChild(a().extractContents()),n(r),!e.allowsBlockElements()){var o=document.createElement("div");o.appendChild(r),r=o}if(r.childNodes.length>=1){var s;i(r.childNodes).reverse().forEach(function(e){""!==e.innerText&&(s={format:"html",text:e.innerHTML.trim()},t.mediator.trigger("block:create","Text",s,t.el))})}},h=!1;e.el.addEventListener("keydown",function(n){t.supressKeyListeners||(13!==n.keyCode||n.shiftKey?37!==n.keyCode&&38!==n.keyCode||!s()?8===n.keyCode&&s()?(n.preventDefault(),h=!0):39!==n.keyCode&&40!==n.keyCode||!u()||(n.preventDefault(),t.mediator.trigger("block:focusNext",t.blockID)):(n.preventDefault(),t.mediator.trigger("block:focusPrevious",t.blockID)):(n.preventDefault(),u()?(a().extractContents(),t.mediator.trigger("block:create","Text",null,t.el)):l(),e.allowsBlockElements()&&""===e.getTextContent()&&e.setContent("<p><br></p>")))}),e.el.addEventListener("keyup",function(e){t.supressKeyListeners||8===e.keyCode&&h&&(e.preventDefault(),t.mediator.trigger("block:remove",t.blockID,{transposeContent:!0}),h=!1)})}};t.exports=o},function(t,e,n){t.exports={"default":n(256),__esModule:!0}},function(t,e,n){n(86),n(257),t.exports=n(7).Array.from},function(t,e,n){"use strict";var i=n(8),r=n(5),o=n(12),a=n(113),s=n(114),c=n(115),u=n(116);r(r.S+r.F*!n(127)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,l,h=o(t),d="function"==typeof this?this:Array,f=arguments,p=f.length,m=p>1?f[1]:undefined,g=m!==undefined,v=0,y=u(h);if(g&&(m=i(m,p>2?f[2]:undefined,2)),y==undefined||d==Array&&s(y))for(n=new d(e=c(h.length));e>v;v++)n[v]=g?m(h[v],v):h[v];else for(l=y.call(h),n=new d;!(r=l.next()).done;v++)n[v]=g?a(l,m,[r.value,v],!0):r.value;return n.length=v,n}})},function(t,e,n){"use strict";var i=n(255)["default"],r=function(t){return function(e){var n=new e.api.CommandPatch("insertHTML");n.execute=function(n){var r=this;e.transactionManager.run(function(){e.api.CommandPatch.prototype.execute.call(r,n);var o=document.createElement("div");if(o.innerHTML=e.getContent(),o.childNodes.length>1){var a=i(o.childNodes);e.setContent(a.shift().innerHTML),a.reverse().forEach(function(e){var n={format:"html",text:e.innerHTML};t.mediator.trigger("block:create","Text",n,t.el)}),e.el.focus()}})},e.commandPatches.insertHTML=n}};t.exports=r},function(t){"use strict";var e=function(t){return function(e){var n=new e.api.Command("heading");n.queryEnabled=function(){return t.inline_editable},n.queryState=function(){return"heading"===t.type};var i=function(){return n.queryState()?"Text":"Heading"};n.execute=function(){var e={format:"html",text:t.getScribeInnerContent()};t.mediator.trigger("block:replace",t.el,i(),e)},e.commands.heading=n}};t.exports=e},function(t){"use strict";var e=function(t){return function(e){var n=new e.api.Command("quote");n.queryEnabled=function(){return t.inline_editable},n.queryState=function(){return"quote"===t.type};var i=function(){return n.queryState()?"Text":"Quote"};n.execute=function(){var e={format:"html",text:t.getScribeInnerContent()};t.mediator.trigger("block:replace",t.el,i(),e)},e.commands.quote=n}};t.exports=e},function(t,e,n){"use strict";var i=n(34),r=n(244),o=n(253),a=n(259),s=n(260),c=i.template(['<blockquote class="st-required st-text-block st-text-block--quote" contenteditable="true"></blockquote>','<label class="st-input-label"> <%= i18n.t("blocks:quote:credit_field") %></label>','<input maxlength="140" name="cite" placeholder="<%= i18n.t("blocks:quote:credit_field") %>"',' class="st-input-string js-cite-input" type="text" />'].join("\n"));t.exports=r.extend({type:"quote",icon_name:"quote",textable:!0,toolbarEnabled:!1,editorHTML:function(){return c(this)},configureScribe:function(t){t.use(new a(this)),t.use(new s(this))},loadData:function(t){this.options.convertFromMarkdown&&"html"!==t.format?this.setTextBlockHTML(o(t.text,this.type)):this.setTextBlockHTML(t.text),t.cite&&(this.$(".js-cite-input")[0].value=t.cite)}})},function(t,e,n){"use strict";var i=n(69),r=n(244);t.exports=r.extend({type:"image",droppable:!0,uploadable:!0,icon_name:"image",loadData:function(t){this.editor.innerHTML="",this.editor.appendChild(i.createElement("img",{src:t.file.url}))},onDrop:function(t){var e=t.files[0],n="undefined"!=typeof URL?URL:"undefined"!=typeof webkitURL?webkitURL:null;/image/.test(e.type)&&(this.loading(),i.hide(this.inputs),this.editor.innerHTML="",this.editor.appendChild(i.createElement("img",{src:n.createObjectURL(e)})),i.show(this.editor),this.uploader(e,function(t){this.setData(t),this.ready()},function(){this.addMessage(i18n.t("blocks:image:upload_error")),this.ready()}))}})},function(t,e,n){"use strict";var i=n(244),r=n(253),o=n(254),a=n(259),s=n(260);t.exports=i.extend({type:"heading",editorHTML:'<h2 class="st-required st-text-block st-text-block--heading" contenteditable="true"></h2>',configureScribe:function(t){t.use(new o(this)),t.use(new a(this)),t.use(new s(this)),t.on("content-changed",this.toggleEmptyClass.bind(this))},textable:!0,toolbarEnabled:!1,scribeOptions:{allowBlockElements:!1,tags:{p:!1}},icon_name:"heading",loadData:function(t){this.options.convertFromMarkdown&&"html"!==t.format?this.setTextBlockHTML(r(t.text,this.type)):this.setTextBlockHTML(t.text)},onBlockRender:function(){this.focus(),this.toggleEmptyClass()},toggleEmptyClass:function(){this.el.classList.toggle("st-block--empty",0===this._scribe.getTextContent().length)}})},function(t,e,n){"use strict";var i=n(244),r=n(253),o=n(265);t.exports=i.extend({type:"list",icon_name:"list",multi_editable:!0,scribeOptions:{allowBlockElements:!1,tags:{p:!1}},configureScribe:function(t){t.use(new o(this))},editorHTML:'<ul class="st-list-block__list"></ul>',listItemEditorHTML:'<li class="st-list-block__item"><div class="st-list-block__editor st-block__editor"></div></li>',initialize:function(){this.editorIds=[]},beforeLoadingData:function(){this.setupListVariables(),this.loadData(this._getData())},onBlockRender:function(){this.ul||this.setupListVariables(),this.editorIds.length<1&&this.addListItem()},setupListVariables:function(){this.ul=this.inner.querySelector("ul")},loadData:function(t){var e=this;this.options.convertFromMarkdown&&"html"!==t.format&&(t=this.parseFromMarkdown(t.text)),t.listItems.length?t.listItems.forEach(function(t){e.addListItem(t.content)}):e.addListItem()},parseFromMarkdown:function(t){var e=t.replace(/^ - (.+)$/gm,"$1").split("\n");return e=e.filter(function(t){return t.length}).map(function(t){return{content:r(t,this.type)}}.bind(this)),{listItems:e,format:"html"}},_serializeData:function(){var t={format:"html",listItems:[]};return this.editorIds.forEach(function(e){var n={content:this.getTextEditor(e).scribe.getContent()};t.listItems.push(n)}.bind(this)),t},addListItemAfterCurrent:function(t){this.addListItem(t,this.getCurrentTextEditor())},addListItem:function(t,e){"<br>"===(t=t||"").trim()&&(t="");var n=this.newTextEditor(this.listItemEditorHTML,t);if(e&&this.ul.lastchild!==e.node){var i=e.node.nextSibling;this.ul.insertBefore(n.node,i);var r=this.editorIds.indexOf(e.id)+1;this.editorIds.splice(r,0,n.id)}else this.ul.appendChild(n.node),this.editorIds.push(n.id);!t&&this.focusOn(n)},focusOnNeighbor:function(){var t=this.previousListItem()||this.nextListItem();t&&this.focusOn(t)},focusOn:function(t){var e,n=t.scribe,i=new n.api.Selection,r=n.el.lastChild;i.range&&(e=i.range.cloneRange()),t.el.focus(),e&&(e.setStartAfter(r,1),e.collapse(!1))},focusAtEnd:function(){var t=this.editorIds[this.editorIds.length-1];this.appendToTextEditor(t)},removeCurrentListItem:function(){if(1!==this.editorIds.length){var t=this.getCurrentTextEditor(),e=this.editorIds.indexOf(t.id);this.focusOnNeighbor(t),this.editorIds.splice(e,1),this.ul.removeChild(t.node),this.removeTextEditor(t.id)}},appendToCurrentItem:function(t){this.appendToTextEditor(this.getCurrentTextEditor().id,t)},isLastListItem:function(){return 1===this.editorIds.length},nextListItem:function(){var t=this.editorIds.indexOf(this.getCurrentTextEditor().id),e=this.editorIds[t+1];return e!==undefined?this.getTextEditor(e):null},previousListItem:function(){var t=this.editorIds.indexOf(this.getCurrentTextEditor().id),e=this.editorIds[t-1];return e!==undefined?this.getTextEditor(e):null}})},function(t){"use strict";var e=function(t){return function(e){e.el.addEventListener("keydown",function(n){if(!t.supressKeyListeners){var i,r=function(t){var e=document.createElement("div");return e.appendChild(t.extractContents()),e.innerHTML},o=function(){var t=(new e.api.Selection).range.cloneRange();return t.setEndAfter(e.el.lastChild,0),t},a=function(){return(new e.api.Selection).range.startOffset};13!==n.keyCode||n.shiftKey?8===n.keyCode&&0===a()?(n.preventDefault(),t.isLastListItem()?t.mediator.trigger("block:remove",t.blockID):(i=e.getContent(),t.removeCurrentListItem(),t.appendToCurrentItem(i))):n.keyCode:(n.preventDefault(),0===e.getTextContent().length?(t.removeCurrentListItem(),t.mediator.trigger("block:create","Text",null,t.el)):(i=r(o()),t.addListItemAfterCurrent(i)))}})}};t.exports=e},function(t,e,n){"use strict";var i=n(34),r=n(29),o=n(69),a=n(244),s=i.template(["<blockquote class='twitter-tweet' align='center'>","<p><%= text %></p>","&mdash; <%= user.name %> (@<%= user.screen_name %>)","<a href='<%= status_url %>' data-datetime='<%= created_at %>'><%= created_at %></a>","</blockquote>"].join("\n"));t.exports=a.extend({type:"tweet",icon_name:"tweet",droppable:!0,pastable:!0,fetchable:!0,drop_options:{re_render_on_reorder:!0},fetchUrl:function(t){return"/tweets/?tweet_id="+t},loadData:function(t){i.isUndefined(t.status_url)&&(t.status_url="");var e=this.inner.querySelector("twitterwidget");o.remove(e),this.inner.insertAdjacentHTML("afterbegin",s(t));var n=o.createElement("script",{src:"//platform.twitter.com/widgets.js"});this.inner.appendChild(n)},onContentPasted:function(t){var e=t.target.value;this.handleTwitterDropPaste(e)},handleTwitterDropPaste:function(t){if(this.validTweetUrl(t)){var e=t.match(/[^\/]+$/);i.isEmpty(e)||(this.loading(),e=e[0],this.fetch(this.fetchUrl(e),{dataType:"json"},this.onTweetSuccess,this.onTweetFail))}else r.log("Invalid Tweet URL")},validTweetUrl:function(t){return r.isURI(t)&&-1!==t.indexOf("twitter")&&-1!==t.indexOf("status")},onTweetSuccess:function(t){var e={user:{profile_image_url:t.user.profile_image_url,profile_image_url_https:t.user.profile_image_url_https,screen_name:t.user.screen_name,name:t.user.name},id:t.id_str,text:t.text,created_at:t.created_at,entities:t.entities,status_url:"https://twitter.com/"+t.user.screen_name+"/status/"+t.id_str};this.setAndLoadData(e),this.ready()},onTweetFail:function(){this.addMessage(i18n.t("blocks:tweet:fetch_error")),this.ready()},onDrop:function(t){var e=t.getData("text/plain");this.handleTwitterDropPaste(e)}})},function(t,e,n){"use strict";var i=n(34),r=n(29),o=n(244);t.exports=o.extend({providers:{vimeo:{regex:/(?:http[s]?:\/\/)?(?:www.)?vimeo\.co(?:.+(?:\/)([^\/].*)+$)/,html:'<iframe src="<%= protocol %>//player.vimeo.com/video/<%= remote_id %>?title=0&byline=0" width="580" height="320" frameborder="0"></iframe>'},youtube:{regex:/^.*(?:(?:youtu\.be\/)|(?:youtube\.com)\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*)/,html:'<iframe src="<%= protocol %>//www.youtube.com/embed/<%= remote_id %>" width="580" height="320" frameborder="0" allowfullscreen></iframe>'}},type:"video",droppable:!0,pastable:!0,icon_name:"video",loadData:function(t){if(this.providers.hasOwnProperty(t.source)){var e=this.providers[t.source],n="file:"===window.location.protocol?"http:":window.location.protocol,r=e.square?"with-square-media":"with-sixteen-by-nine-media";this.editor.classList.add("st-block__editor--"+r),this.editor.innerHTML=i.template(e.html,{protocol:n,remote_id:t.remote_id,width:this.editor.style.width})}},onContentPasted:function(t){this.handleDropPaste(t.target.value)},matchVideoProvider:function(t,e,n){var r=t.regex.exec(n);return null==r||i.isUndefined(r[1])?{}:{source:e,remote_id:r[1]}},handleDropPaste:function(t){if(r.isURI(t))for(var e in this.providers)this.providers.hasOwnProperty(e)&&this.setAndLoadData(this.matchVideoProvider(this.providers[e],e,t))},onDrop:function(t){var e=t.getData("text/plain");this.handleDropPaste(e)}})},function(t,e,n){"use strict";var i=n(30)["default"];t.exports={mediatedEvents:{},eventNamespace:null,_bindMediatedEvents:function(){i(this.mediatedEvents).forEach(function(t){var e=this.mediatedEvents[t];t=this.eventNamespace?this.eventNamespace+":"+t:t,this.mediator.on(t,this[e].bind(this))},this)}}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(68),a=n(69),s=n(131),c=n(270),u=function(t,e,n){this.editor=n,this.options=i({},o.defaults.formatBar,t||{}),this.commands=this.options.commands,this.mediator=e,this.isShown=!1,this._ensureElement(),this._bindFunctions(),this._bindMediatedEvents(),this.initialize.apply(this,arguments)};i(u.prototype,n(235),n(268),n(73),n(236),{className:"st-format-bar",bound:["onFormatButtonClick","renderBySelection","hide"],eventNamespace:"formatter",mediatedEvents:{position:"renderBySelection",show:"show",hide:"hide"},initialize:function(){var t=this.commands.reduce(function(t,e){return t+=c(e)},"");this.el.insertAdjacentHTML("beforeend",t),s.delegate(this.el,".st-format-btn","mousedown",this.onFormatButtonClick)},hide:function(){this.block=undefined,this.isShown=!1,this.el.classList.remove("st-format-bar--is-ready"),a.remove(this.el)},show:function(){this.isShown||(this.isShown=!0,this.editor.outer.appendChild(this.el),this.el.classList.add("st-format-bar--is-ready"))},remove:function(){a.remove(this.el)},renderBySelection:function(t){this.block=t,this.highlightSelectedButtons(),this.show(),this.calculatePosition()},calculatePosition:function(){var t=window.getSelection().getRangeAt(0).getBoundingClientRect(),e={},n=this.editor.outer.getBoundingClientRect();e.top=t.top-n.top+"px",e.left=(t.left+t.right)/2-this.el.offsetWidth/2-n.left+"px",this.el.style.top=e.top,this.el.style.left=e.left},highlightSelectedButtons:function(){var t=this;[].forEach.call(this.el.querySelectorAll(".st-format-btn"),function(e){var n=e.getAttribute("data-cmd");e.classList.toggle("st-format-btn--is-active",t.block.queryTextBlockCommandState(n)),e=null})},onFormatButtonClick:function(t){if(t.preventDefault(),t.stopPropagation(),r.isUndefined(this.block))throw"Associated block not found";var e=t.currentTarget.getAttribute("data-cmd");return!r.isUndefined(e)&&(this.block.execTextBlockCommand(e),this.highlightSelectedButtons(),document.activeElement.focus(),!1)}}),t.exports=u},function(t,e,n){"use strict";var i=n(68);t.exports=function(t){var e=t.name,n=(t.text,t.cmd),r=t.iconName;return'\n    <button type="button" class="st-format-btn st-format-btn--'+e+'" data-cmd="'+n+'">\n      <svg role="img" class="st-icon">\n        <use xlink:href="'+i.defaults.iconUrl+"#"+r+'"/>\n      </svg>\n    </button>\n  '}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(30)["default"],o=n(34),a=n(68),s=n(29),c=n(69),u=n(73),l=n(75),h=n(272),d=n(273),f=n(275),p=n(277),m=n(241),g=n(269),v=n(76),y=n(278),b=function(t){this.initialize(t)};i(b.prototype,n(235),n(73),{bound:["onFormSubmit","hideAllTheThings","changeBlockPosition","removeBlockDragOver","blockLimitReached","blockOrderUpdated"],events:{"block:reorder:dragend":"removeBlockDragOver","block:reorder:dropped":"removeBlockDragOver","block:content:dropped":"removeBlockDragOver"},initialize:function(t){if(s.log("Init SirTrevor.Editor"),this.options=i({},a.defaults,t||{}),this.ID=o.uniqueId("st-editor-"),!this._ensureAndSetElements())return!1;!o.isUndefined(this.options.onEditorRender)&&o.isFunction(this.options.onEditorRender)&&(this.onEditorRender=this.options.onEditorRender),this.mediator=i({},u),this._bindFunctions(),a.instances.push(this),this.build(),h.bindFormSubmit(this.form)},build:function(){c.hide(this.el),this.errorHandler=new y(this.outer,this.mediator,this.options.errorsContainer),this.store=new v(this.el.value,this.mediator),this.blockManager=new m(this),this.blockAddition=f.create(this),this.BlockAdditionTop=p.create(this),this.blockControls=d.create(this),this.formatBar=new g(this.options.formatBar,this.mediator,this),this.mediator.on("block:changePosition",this.changeBlockPosition),this.mediator.on("block:limitReached",this.blockLimitReached),this.mediator.on("block:rerender",this.blockOrderUpdated),this.mediator.on("block:create",this.blockOrderUpdated),this.mediator.on("block:remove",this.blockOrderUpdated),this.mediator.on("block:replace",this.blockOrderUpdated),this.dataStore="Please use store.retrieve();",this._setEvents(),window.addEventListener("click",this.hideAllTheThings),document.body.addEventListener("keydown",this.disableBackButton),this.createBlocks(),this.wrapper.classList.add("st-ready"),o.isUndefined(this.onEditorRender)||this.onEditorRender()},createBlocks:function(){var t=this.store.retrieve();t.data.length>0?t.data.forEach(function(t){this.mediator.trigger("block:create",t.type,t.data)},this):!1!==this.options.defaultType&&this.mediator.trigger("block:create",this.options.defaultType,{})},destroy:function(){this.formatBar.destroy(),this.blockAddition.destroy(),this.blockControls.destroy(),this.blockManager.blocks.forEach(function(t){this.mediator.trigger("block:remove",t.blockID)},this),this.mediator.stopListening(),this.stopListening(),a.instances=a.instances.filter(function(t){return t.ID!==this.ID},this),window.removeEventListener("click",this.hideAllTheThings),document.body.removeEventListener("keydown",this.disableBackButton),this.store.reset(),c.replaceWith(this.outer,this.el)},reinitialize:function(t){this.destroy(),this.initialize(t||this.options)},blockLimitReached:function(t){this.wrapper.classList.toggle("st--block-limit-reached",t)},blockOrderUpdated:function(){var t=this.wrapper.querySelectorAll(".st-block")[0],e=!1;if(t){var n=this.blockManager.findBlockById(t.getAttribute("id"));e=n&&n.textable}this._toggleHideTopControls(e)},_toggleHideTopControls:function(t){this.wrapper.classList.toggle("st--hide-top-controls",t)},_setEvents:function(){r(this.events).forEach(function(t){l.on(t,this[this.events[t]],this)},this)},hideAllTheThings:function(){this.blockControls.hide(),this.blockAddition.hide(),null===document.activeElement.getAttribute("contenteditable")&&this.formatBar.hide();var t=".st-block__ui-delete-controls";Array.prototype.forEach.call(this.wrapper.querySelectorAll(t),function(t){t.classList.remove("active")})},store:function(t,e){return s.log("The store method has been removed, please call store[methodName]"),this.store[t].call(this,e||{})},removeBlockDragOver:function(){var t=this.outer.querySelector(".st-drag-over");t&&t.classList.remove("st-drag-over")},changeBlockPosition:function(t,e){e-=1;var n=this.blockManager.getBlockPosition(t),i=this.wrapper.querySelectorAll(".st-block")[e];i&&i.getAttribute("id")!==t.getAttribute("id")&&(this.hideAllTheThings(),n>e?i.parentNode.insertBefore(t,i):c.insertAfter(t,i))},onFormSubmit:function(t){return t=!1!==t,s.log("Handling form submission for Editor "+this.ID),this.mediator.trigger("errors:reset"),this.store.reset(),this.validateBlocks(t),this.blockManager.validateBlockTypesExist(t),this.mediator.trigger("errors:render"),this.el.value=this.store.toString(),this.errorHandler.errors.length},validateBlocks:function(t){var e=this;Array.prototype.forEach.call(this.wrapper.querySelectorAll(".st-block"),function(n){var i=e.blockManager.findBlockById(n.getAttribute("id"));o.isUndefined(i)||e.validateAndSaveBlock(i,t)})},validateAndSaveBlock:function(t,e){if(!a.skipValidation&&e&&!t.valid())return this.mediator.trigger("errors:add",{text:o.result(t,"validationFailMsg")}),void s.log("Block "+t.blockID+" failed validation");if("text"!==t.type||!t.isEmpty()){var n=t.getData();s.log("Adding data for block "+t.blockID+" to block store:",n),this.store.addData(n)}},disableBackButton:function(t){var e=t.target||t.srcElement;if(8===t.keyCode){if(e.getAttribute("contenteditable")||"INPUT"===e.tagName||"TEXTAREA"===e.tagName)return;t.preventDefault()}},findBlockById:function(t){return this.blockManager.findBlockById(t)},getBlocksByType:function(t){return this.blockManager.getBlocksByType(t)},getBlocksByIDs:function(t){return this.blockManager.getBlocksByIDs(t)},getBlockPosition:function(t){return s.log("This method has been moved to blockManager.getBlockPosition()"),this.blockManager.getBlockPosition(t)},_ensureAndSetElements:function(){if(o.isUndefined(this.options.el))return s.log("You must provide an el"),!1;this.el=this.options.el,this.form=c.getClosest(this.el,"form");var t=c.createElement("div",{id:this.ID,"class":"st-outer notranslate",dropzone:"copy link move"}),e=c.createElement("div",{"class":"st-blocks"});return c.wrap(c.wrap(this.el,t),e),this.outer=this.form.querySelector("#"+this.ID),this.wrapper=this.outer.querySelector(".st-blocks"),!0}}),t.exports=b},function(t,e,n){"use strict";var i=n(68),r=n(29),o=n(75),a=n(77),s=!1,c={bindFormSubmit:function(t){s||(new a(t),t.addEventListener("submit",this.onFormSubmit),s=!0)},onBeforeSubmit:function(t){var e=0;return i.instances.forEach(function(n){e+=n.onFormSubmit(t)}),r.log("Total errors: "+e),e},onFormSubmit:function(t){c.onBeforeSubmit()>0&&(o.trigger("onError"),t.preventDefault())}};t.exports=c},function(t,e,n){"use strict";function i(t,e){return e.reduce(function(e,n){return t.hasOwnProperty(n)&&t[n].prototype.toolbarEnabled?e+=s(t[n].prototype):e},"")}function r(){var t=document.createElement("div");t.className="st-block-controls__buttons",t.innerHTML=i.apply(null,arguments);var e=document.createElement("div");return e.className="st-block-controls",e.appendChild(t),e}var o=n(242),a=n(131),s=n(274);t.exports.create=function(t){function e(){t.mediator.trigger("block:replace",c.parentNode,this.getAttribute("data-type"))}function n(t){t.stopPropagation();var e=this.parentNode;e&&i()!==e&&(e.appendChild(c),e.classList.toggle("st-block--controls-active"))}function i(){var t=c.parentNode;if(t)return t.removeChild(c),t.classList.remove("st-block--controls-active"),t}function s(){t=null,c=null}var c=r(o,t.blockManager.blockTypes);return a.delegate(t.wrapper,".st-block-replacer","click",n),a.delegate(t.wrapper,".st-block-controls__button","click",e),{el:c,hide:i,destroy:s}}},function(t,e,n){"use strict";var i=n(68);t.exports=function(t){return'\n    <button class="st-block-controls__button" data-type="'+t.type+'" type="button">\n      <svg role="img" class="st-icon">\n        <use xlink:href="'+i.defaults.iconUrl+"#"+t.icon_name+'"/>\n      </svg>\n      '+t.title()+"\n    </button>\n  "}},function(t,e,n){"use strict";var i=n(133),r=n(75),o=n(69),a=n(131),s=n(276);t.exports.create=function(t){function e(){t.mediator.trigger("block:create","Text",null,this.parentNode.parentNode.id?this.parentNode.parentNode:this.parentNode)}function n(){}function c(){t=null}function u(e){e.preventDefault();var n=l,i=e.dataTransfer.getData("text/plain"),a=document.querySelector("#"+i);n.id!==i&&o.insertAfter(a,n),t.mediator.trigger("block:rerender",i),r.trigger("block:reorder:dropped",i)}t.wrapper.insertAdjacentHTML("beforeend",s());var l=t.wrapper.querySelector(".st-top-controls");return i.dropArea(l),l.addEventListener("drop",u),a.delegate(t.wrapper,".st-block-addition","click",e),{destroy:c,hide:n}}},function(t,e,n){"use strict";var i=n(248);t.exports=function(){return'\n    <div id="st_top" class="st-top-controls">\n      '+i()+"\n    </div>\n  "}},function(t,e,n){"use strict";var i=n(131);t.exports.create=function(t){function e(){t.mediator.trigger("block:create","Text",null,this.parentNode.parentNode.previousSibling)}function n(){}function r(){t=null}return i.delegate(t.wrapper,".st-block-addition-top__button","click",e),i.delegate(t.wrapper,".st-block-addition-top__icon","click",e),{destroy:r,hide:n}}},function(t,e,n){"use strict";var i=n(2)["default"],r=n(34),o=n(69),a=function(t,e,n){this.wrapper=t,this.mediator=e,this.el=n,r.isUndefined(this.el)&&(this._ensureElement(),this.wrapper.insertBefore(this.el,this.wrapper.firstChild)),o.hide(this.el),this._bindFunctions(),this._bindMediatedEvents(),this.initialize()};i(a.prototype,n(235),n(268),n(236),{errors:[],className:"st-errors",eventNamespace:"errors",mediatedEvents:{reset:"reset",add:"addMessage",render:"render"},initialize:function(){var t=document.createElement("ul"),e=document.createElement("p");e.innerHTML=i18n.t("errors:title"),this.el.appendChild(e).appendChild(t),this.list=t},render:function(){if(0===this.errors.length)return!1;this.errors.forEach(this.createErrorItem,this),o.show(this.el)},createErrorItem:function(t){var e=document.createElement("li");e.classList.add("st-errors__msg"),e.innerHTML=t.text,this.list.appendChild(e)},addMessage:function(t){this.errors.push(t)},reset:function(){if(0===this.errors.length)return!1;this.errors=[],this.list.innerHTML="",o.hide(this.el)}}),t.exports=a},function(t,e,n){"use strict";var i=n(34),r=n(29);t.exports=function(t,e){function o(t,e,n){return i.isUndefined(n)&&(n=""),"**"+e.replace(/<(.)?br(.)?>/g,"")+"**"+n}function a(t,e,n){return i.isUndefined(n)&&(n=""),"_"+e.replace(/<(.)?br(.)?>/g,"")+"_"+n}var s=n(242);e=r.classify(e);var c=t;c=(c=c.replace(/&nbsp;/g," ")).replace(/( class=(")?Mso[a-zA-Z]+(")?)/g,"").replace(/<!--(.*?)-->/g,"").replace(/\/\*(.*?)\*\//g,"").replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,"");var u,l,h=["style","script","applet","embed","noframes","noscript"];for(l=0;l<h.length;l++)u=new RegExp("<"+h[l]+".*?"+h[l]+"(.*?)>","gi"),c=c.replace(u,"");c=c.replace(/\*/g,"\\*").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\_/g,"\\_").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\-/g,"\\-");var d=["em","i","strong","b"];for(l=0;l<d.length;l++)u=new RegExp("<"+d[l]+"><br></"+d[l]+">","gi"),c=c.replace(u,"<br>");c=(c=c.replace(/<(\w+)(?:\s+\w+="[^"]+(?:"\$[^"]+"[^"]+)?")*>\s*<\/\1>/gim,"").replace(/\n/gm,"").replace(/<a.*?href=[""'](.*?)[""'].*?>(.*?)<\/a>/gim,function(t,e,n){return"["+n.trim().replace(/<(.)?br(.)?>/g,"")+"]("+e+")"}).replace(/<strong>(?:\s*)(.*?)(\s)*?<\/strong>/gim,o).replace(/<b>(?:\s*)(.*?)(\s*)?<\/b>/gim,o).replace(/<em>(?:\s*)(.*?)(\s*)?<\/em>/gim,a).replace(/<i>(?:\s*)(.*?)(\s*)?<\/i>/gim,a)).replace(/([^<>]+)(<div>)/g,"$1\n$2").replace(/<div><div>/g,"\n<div>").replace(/(?:<div>)([^<>]+)(?:<div>)/g,"$1\n").replace(/(?:<div>)(?:<br>)?([^<>]+)(?:<br>)?(?:<\/div>)/g,"$1\n").replace(/<\/p>/g,"\n\n").replace(/<(.)?br(.)?>/g,"\n").replace(/&lt;/g,"<").replace(/&gt;/g,">");var f;return s.hasOwnProperty(e)&&(f=s[e],!i.isUndefined(f.prototype.toMarkdown)&&i.isFunction(f.prototype.toMarkdown)&&(c=f.prototype.toMarkdown(c))),c=c.replace(/<\/?[^>]+(>|$)/g,"")}},17]))}),function(t,e,n,i){function r(e,i){this.w=t(n),this.el=t(e),this.options=t.extend({},h,i),this.init()}var o="ontouchstart"in e,a=function(){var t=n.createElement("div"),i=n.documentElement;if(!("pointerEvents"in t.style))return!1;t.style.pointerEvents="auto",t.style.pointerEvents="x",i.appendChild(t);var r=e.getComputedStyle&&"auto"===e.getComputedStyle(t,"").pointerEvents;return i.removeChild(t),!!r
}(),s=o?"touchstart":"mousedown",c=o?"touchmove":"mousemove",u=o?"touchend":"mouseup",l=o?"touchcancel":"mouseup",h={listNodeName:"ol",itemNodeName:"li",rootClass:"dd",listClass:"dd-list",itemClass:"dd-item",dragClass:"dd-dragel",handleClass:"dd-handle",collapsedClass:"dd-collapsed",placeClass:"dd-placeholder",noDragClass:"dd-nodrag",noChildrenClass:"dd-nochildren",emptyClass:"dd-empty",expandBtnHTML:'<button data-action="expand" type="button">Expand</button>',collapseBtnHTML:'<button data-action="collapse" type="button">Collapse</button>',group:0,maxDepth:5,threshold:20,reject:[],dropCallback:null,cloneNodeOnDrag:!1,dragOutsideToDelete:!1};r.prototype={init:function(){var n=this;n.reset(),n.el.data("nestable-group",this.options.group),n.placeEl=t('<div class="'+n.options.placeClass+'"/>'),t.each(this.el.find(n.options.itemNodeName),function(e,i){n.setParent(t(i))}),n.el.on("click","button",function(e){if(!n.dragEl&&(o||0===e.button)){var i=t(e.currentTarget),r=i.data("action"),a=i.parent(n.options.itemNodeName);"collapse"===r&&n.collapseItem(a),"expand"===r&&n.expandItem(a)}});var i=function(e){var i=t(e.target);if(n.nestableCopy=i.closest("."+n.options.rootClass).clone(!0),!i.hasClass(n.options.handleClass)){if(i.closest("."+n.options.noDragClass).length)return;i=i.closest("."+n.options.handleClass)}!i.length||n.dragEl||!o&&1!==e.which||o&&1!==e.touches.length||(e.preventDefault(),n.dragStart(o?e.touches[0]:e))},r=function(t){n.dragEl&&(t.preventDefault(),n.dragMove(o?t.touches[0]:t))},a=function(t){n.dragEl&&(t.preventDefault(),n.dragStop(o?t.touches[0]:t))};o?(n.el[0].addEventListener(s,i,!1),e.addEventListener(c,r,!1),e.addEventListener(u,a,!1),e.addEventListener(l,a,!1)):(n.el.on(s,i),n.w.on(c,r),n.w.on(u,a));var h=function(){o?(n.el[0].removeEventListener(s,i,!1),e.removeEventListener(c,r,!1),e.removeEventListener(u,a,!1),e.removeEventListener(l,a,!1)):(n.el.off(s,i),n.w.off(c,r),n.w.off(u,a)),n.el.off("click"),n.el.unbind("destroy-nestable"),n.el.data("nestable",null);var h=n.el[0].getElementsByTagName("button");t(h).remove()};n.el.bind("destroy-nestable",h)},destroy:function(){this.expandAll(),this.el.trigger("destroy-nestable")},serialize:function(){var e=0,n=this;step=function(e,i){var r=[];return e.children(n.options.itemNodeName).each(function(){var e=t(this),o=t.extend({},e.data()),a=e.children(n.options.listNodeName);a.length&&(o.children=step(a,i+1)),r.push(o)}),r};var i;return i=n.el.is(n.options.listNodeName)?n.el:n.el.find(n.options.listNodeName).first(),step(i,e)},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,distX:0,distY:0,dirAx:0,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0},this.moving=!1,this.dragEl=null,this.dragRootEl=null,this.dragDepth=0,this.dragItem=null,this.hasNewRoot=!1,this.pointEl=null,this.sourceRoot=null,this.isOutsideRoot=!1},expandItem:function(t){t.removeClass(this.options.collapsedClass),t.children('[data-action="expand"]').hide(),t.children('[data-action="collapse"]').show(),t.children(this.options.listNodeName).show(),this.el.trigger("expand",[t]),t.trigger("expand")},collapseItem:function(t){t.children(this.options.listNodeName).length&&(t.addClass(this.options.collapsedClass),t.children('[data-action="collapse"]').hide(),t.children('[data-action="expand"]').show(),t.children(this.options.listNodeName).hide()),this.el.trigger("collapse",[t]),t.trigger("collapse")},expandAll:function(){var e=this;e.el.find(e.options.itemNodeName).each(function(){e.expandItem(t(this))})},collapseAll:function(){var e=this;e.el.find(e.options.itemNodeName).each(function(){e.collapseItem(t(this))})},setParent:function(e){e.children(this.options.listNodeName).length&&(e.prepend(t(this.options.expandBtnHTML)),e.prepend(t(this.options.collapseBtnHTML))),(" "+e[0].className+" ").indexOf(" "+h.collapsedClass+" ")>-1?e.children('[data-action="collapse"]').hide():e.children('[data-action="expand"]').hide()},unsetParent:function(t){t.removeClass(this.options.collapsedClass),t.children("[data-action]").remove(),t.children(this.options.listNodeName).remove()},dragStart:function(e){var r=this.mouse,o=t(e.target),a=o.closest("."+this.options.handleClass).closest(this.options.itemNodeName);this.sourceRoot=o.closest("."+this.options.rootClass),this.dragItem=a,this.placeEl.css("height",a.height()),r.offsetX=e.offsetX!==i?e.offsetX:e.pageX-o.offset().left,r.offsetY=e.offsetY!==i?e.offsetY:e.pageY-o.offset().top,r.startX=r.lastX=e.pageX,r.startY=r.lastY=e.pageY,this.dragRootEl=this.el,this.dragEl=t(n.createElement(this.options.listNodeName)).addClass(this.options.listClass+" "+this.options.dragClass),this.dragEl.css("width",a.width()),this.options.cloneNodeOnDrag?a.after(a.clone()):a.after(this.placeEl),a[0].parentNode.removeChild(a[0]),a.appendTo(this.dragEl),t(n.body).append(this.dragEl),this.dragEl.css({left:e.pageX-r.offsetX,top:e.pageY-r.offsetY});var s,c,u=this.dragEl.find(this.options.itemNodeName);for(s=0;s<u.length;s++)(c=t(u[s]).parents(this.options.listNodeName).length)>this.dragDepth&&(this.dragDepth=c)},dragStop:function(){var e=this.dragEl.children(this.options.itemNodeName).first();if(e[0].parentNode.removeChild(e[0]),this.isOutsideRoot&&this.options.dragOutsideToDelete){var n=this.placeEl.parent();this.placeEl.remove(),n.children().length||this.unsetParent(n.parent()),this.dragRootEl.find(this.options.itemNodeName).length||this.dragRootEl.append('<div class="'+this.options.emptyClass+'"/>')}else this.placeEl.replaceWith(e);this.moving||t(this.dragItem).trigger("click");var i,r=!1;for(i=0;i<this.options.reject.length;i++){var o=this.options.reject[i];if(o.rule.apply(this.dragRootEl)){var a=e.clone(!0);this.dragRootEl.html(this.nestableCopy.children().clone(!0)),o.action&&o.action.apply(this.dragRootEl,[a]),r=!0;break}}if(!r){this.dragEl.remove(),this.el.trigger("change");var s=e.parent().parent(),c=null;if(null===s||s.is("."+this.options.rootClass)||(c=s.data("id")),t.isFunction(this.options.dropCallback)){var u={sourceId:e.data("id"),destId:c,sourceEl:e,destParent:s,destRoot:e.closest("."+this.options.rootClass),sourceRoot:this.sourceRoot};this.options.dropCallback.call(this,u)}this.hasNewRoot&&this.dragRootEl.trigger("change"),this.reset()}},dragMove:function(i){var r,o,s,c=this.options,u=this.mouse;this.dragEl.css({left:i.pageX-u.offsetX,top:i.pageY-u.offsetY}),u.lastX=u.nowX,u.lastY=u.nowY,u.nowX=i.pageX,u.nowY=i.pageY,u.distX=u.nowX-u.lastX,u.distY=u.nowY-u.lastY,u.lastDirX=u.dirX,u.lastDirY=u.dirY,u.dirX=0===u.distX?0:u.distX>0?1:-1,u.dirY=0===u.distY?0:u.distY>0?1:-1;var l=Math.abs(u.distX)>Math.abs(u.distY)?1:0;if(!this.moving)return u.dirAx=l,void(this.moving=!0);u.dirAx!==l?(u.distAxX=0,u.distAxY=0):(u.distAxX+=Math.abs(u.distX),0!==u.dirX&&u.dirX!==u.lastDirX&&(u.distAxX=0),u.distAxY+=Math.abs(u.distY),0!==u.dirY&&u.dirY!==u.lastDirY&&(u.distAxY=0)),u.dirAx=l,u.dirAx&&u.distAxX>=c.threshold&&(u.distAxX=0,s=this.placeEl.prev(c.itemNodeName),u.distX>0&&s.length&&!s.hasClass(c.collapsedClass)&&!s.hasClass(c.noChildrenClass)&&(r=s.find(c.listNodeName).last(),this.placeEl.parents(c.listNodeName).length+this.dragDepth<=c.maxDepth&&(r.length?(r=s.children(c.listNodeName).last()).append(this.placeEl):((r=t("<"+c.listNodeName+"/>").addClass(c.listClass)).append(this.placeEl),s.append(r),this.setParent(s)))),u.distX<0&&(this.placeEl.next(c.itemNodeName).length||(o=this.placeEl.parent(),this.placeEl.closest(c.itemNodeName).after(this.placeEl),o.children().length||this.unsetParent(o.parent()))));var h=!1;a||(this.dragEl[0].style.visibility="hidden"),this.pointEl=t(n.elementFromPoint(i.pageX-n.documentElement.scrollLeft,i.pageY-(e.pageYOffset||n.documentElement.scrollTop))),this.dragRootEl.has(this.pointEl).length?(this.isOutsideRoot=!1,this.dragEl[0].style.opacity=1):(this.isOutsideRoot=!0,this.dragEl[0].style.opacity=.5);var d=this.pointEl.closest("."+c.rootClass),f=this.dragRootEl.data("nestable-id")!==d.data("nestable-id");if(this.isOutsideRoot=!d.length,a||(this.dragEl[0].style.visibility="visible"),this.pointEl.hasClass(c.handleClass)&&(this.pointEl=this.pointEl.closest(c.itemNodeName)),1!=c.maxDepth||this.pointEl.hasClass(c.itemClass)||(this.pointEl=this.pointEl.closest("."+c.itemClass)),this.pointEl.hasClass(c.emptyClass))h=!0;else if(!this.pointEl.length||!this.pointEl.hasClass(c.itemClass))return;if(!u.dirAx||f||h){if(f&&c.group!==d.data("nestable-group"))return;if(this.dragDepth-1+this.pointEl.parents(c.listNodeName).length>c.maxDepth)return;var p=i.pageY<this.pointEl.offset().top+this.pointEl.height()/2;o=this.placeEl.parent(),h?((r=t(n.createElement(c.listNodeName)).addClass(c.listClass)).append(this.placeEl),this.pointEl.replaceWith(r)):p?this.pointEl.before(this.placeEl):this.pointEl.after(this.placeEl),o.children().length||this.unsetParent(o.parent()),this.dragRootEl.find(c.itemNodeName).length||this.dragRootEl.append('<div class="'+c.emptyClass+'"/>'),this.dragRootEl=d,f&&(this.hasNewRoot=this.el[0]!==this.dragRootEl[0])}}},t.fn.nestable=function(e){var n=this,i=this,o=function(t){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var n=t||"-";return e()+e()+n+e()+n+e()+n+e()+n+e()+e()+e()};return n.each(function(){var n=t(this).data("nestable");n?"string"==typeof e&&"function"==typeof n[e]&&(i=n[e]()):(t(this).data("nestable",new r(this,e)),t(this).data("nestable-id",o()))}),i||n}}(window.jQuery||window.Zepto,window,document);var LATIN_MAP={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xc6":"AE","\xc7":"C","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xd0":"D","\xd1":"N","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\u0150":"O","\xd8":"O","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\u0170":"U","\xdd":"Y","\xde":"TH","\xdf":"ss","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xe6":"ae","\xe7":"c","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xf0":"d","\xf1":"n","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\u0151":"o","\xf8":"o","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\u0171":"u","\xfd":"y","\xfe":"th","\xff":"y"},LATIN_SYMBOLS_MAP={"\xa9":"(c)"},GREEK_MAP={"\u03b1":"a","\u03b2":"b","\u03b3":"g","\u03b4":"d","\u03b5":"e","\u03b6":"z","\u03b7":"h","\u03b8":"8","\u03b9":"i","\u03ba":"k","\u03bb":"l","\u03bc":"m","\u03bd":"n","\u03be":"3","\u03bf":"o","\u03c0":"p","\u03c1":"r","\u03c3":"s","\u03c4":"t","\u03c5":"y","\u03c6":"f","\u03c7":"x","\u03c8":"ps","\u03c9":"w","\u03ac":"a","\u03ad":"e","\u03af":"i","\u03cc":"o","\u03cd":"y","\u03ae":"h","\u03ce":"w","\u03c2":"s","\u03ca":"i","\u03b0":"y","\u03cb":"y","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039a":"K","\u039b":"L","\u039c":"M","\u039d":"N","\u039e":"3","\u039f":"O","\u03a0":"P","\u03a1":"R","\u03a3":"S","\u03a4":"T","\u03a5":"Y","\u03a6":"F","\u03a7":"X","\u03a8":"PS","\u03a9":"W","\u0386":"A","\u0388":"E","\u038a":"I","\u038c":"O","\u038e":"Y","\u0389":"H","\u038f":"W","\u03aa":"I","\u03ab":"Y"},TURKISH_MAP={"\u015f":"s","\u015e":"S","\u0131":"i","\u0130":"I","\xe7":"c","\xc7":"C","\xfc":"u","\xdc":"U","\xf6":"o","\xd6":"O","\u011f":"g","\u011e":"G"},RUSSIAN_MAP={"\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0451":"yo","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043a":"k","\u043b":"l","\u043c":"m","\u043d":"n","\u043e":"o","\u043f":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044a":"","\u044b":"y","\u044c":"","\u044d":"e","\u044e":"yu","\u044f":"ya","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0401":"Yo","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041a":"K","\u041b":"L","\u041c":"M","\u041d":"N","\u041e":"O","\u041f":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042a":"","\u042b":"Y","\u042c":"","\u042d":"E","\u042e":"Yu","\u042f":"Ya"},UKRAINIAN_MAP={"\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0490":"G","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0491":"g"},CZECH_MAP={"\u010d":"c","\u010f":"d","\u011b":"e","\u0148":"n","\u0159":"r","\u0161":"s","\u0165":"t","\u016f":"u","\u017e":"z","\u010c":"C","\u010e":"D","\u011a":"E","\u0147":"N","\u0158":"R","\u0160":"S","\u0164":"T","\u016e":"U","\u017d":"Z"},POLISH_MAP={"\u0105":"a","\u0107":"c","\u0119":"e","\u0142":"l","\u0144":"n","\xf3":"o","\u015b":"s","\u017a":"z","\u017c":"z","\u0104":"A","\u0106":"C","\u0118":"e","\u0141":"L","\u0143":"N","\xd3":"o","\u015a":"S","\u0179":"Z","\u017b":"Z"},LATVIAN_MAP={"\u0101":"a","\u010d":"c","\u0113":"e","\u0123":"g","\u012b":"i","\u0137":"k","\u013c":"l","\u0146":"n","\u0161":"s","\u016b":"u","\u017e":"z","\u0100":"A","\u010c":"C","\u0112":"E","\u0122":"G","\u012a":"i","\u0136":"k","\u013b":"L","\u0145":"N","\u0160":"S","\u016a":"u","\u017d":"Z"},ALL_DOWNCODE_MAPS=new Array;ALL_DOWNCODE_MAPS[0]=LATIN_MAP,ALL_DOWNCODE_MAPS[1]=LATIN_SYMBOLS_MAP,ALL_DOWNCODE_MAPS[2]=GREEK_MAP,ALL_DOWNCODE_MAPS[3]=TURKISH_MAP,ALL_DOWNCODE_MAPS[4]=RUSSIAN_MAP,ALL_DOWNCODE_MAPS[5]=UKRAINIAN_MAP,ALL_DOWNCODE_MAPS[6]=CZECH_MAP,ALL_DOWNCODE_MAPS[7]=POLISH_MAP,ALL_DOWNCODE_MAPS[8]=LATVIAN_MAP;var Downcoder=new Object;Downcoder.Initialize=function(){if(!Downcoder.map){Downcoder.map={},Downcoder.chars="";for(var t in ALL_DOWNCODE_MAPS){var e=ALL_DOWNCODE_MAPS[t];for(var n in e)Downcoder.map[n]=e[n],Downcoder.chars+=n}Downcoder.regex=new RegExp("["+Downcoder.chars+"]|[^"+Downcoder.chars+"]+","g")}},downcode=function(t){Downcoder.Initialize();var e="",n=t.match(Downcoder.regex);if(n)for(var i=0;i<n.length;i++){if(1==n[i].length){var r=Downcoder.map[n[i]];if(null!=r){e+=r;continue}}e+=n[i]}else e=t;return e},Spotlight=function(){var t=[];return{onLoad:function(e){t.push(e)},activate:function(){for(var e=0;e<t.length;e++)t[e].call()}}}(),Blacklight.onLoad(function(){Spotlight.activate()}),Spotlight.onLoad(function(){SpotlightNestable.init()}),function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.tab");r||i.data("bs.tab",r=new n(this)),"string"==typeof e&&r[e]()})}var n=function(e){this.element=t(e)};n.VERSION="3.3.7",n.TRANSITION_DURATION=150,n.prototype.show=function(){var e=this.element,n=e.closest("ul:not(.dropdown-menu)"),i=e.data("target");if(i||(i=(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var r=n.find(".active:last a"),o=t.Event("hide.bs.tab",{relatedTarget:e[0]}),a=t.Event("show.bs.tab",{relatedTarget:r[0]});if(r.trigger(o),e.trigger(a),!a.isDefaultPrevented()&&!o.isDefaultPrevented()){var s=t(i);this.activate(e.closest("li"),n),this.activate(s,s.parent(),function(){r.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:r[0]})})}}},n.prototype.activate=function(e,i,r){function o(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),s?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),r&&r()}var a=i.find("> .active"),s=r&&t.support.transition&&(a.length&&a.hasClass("fade")||!!i.find("> .fade").length);a.length&&s?a.one("bsTransitionEnd",o).emulateTransitionEnd(n.TRANSITION_DURATION):o(),a.removeClass("in")};var i=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=n,t.fn.tab.noConflict=function(){return t.fn.tab=i,this};var r=function(n){n.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',r).on("click.bs.tab.data-api",'[data-toggle="pill"]',r)}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.tooltip"),o="object"==typeof e&&e;!r&&/destroy|hide/.test(e)||(r||i.data("bs.tooltip",r=new n(this,o)),"string"==typeof e&&r[e]())})}var n=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};n.VERSION="3.3.7",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,n,i){if(this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var r=this.options.trigger.split(" "),o=r.length;o--;){var a=r[o];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focusin",c="hover"==a?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(c+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return(e=t.extend({},this.getDefaults(),this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,i){n[t]!=i&&(e[t]=i)}),e},n.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusin"==e.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState)n.hoverState="in";else{if(clearTimeout(n.timeout),n.hoverState="in",!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)}},n.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},n.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusout"==e.type?"focus":"hover"]=!1),!n.isInStateTrue()){if(clearTimeout(n.timeout),n.hoverState="out",!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)}},n.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var r=this,o=this.tip(),a=this.getUID(this.type);this.setContent(),o.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&o.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,c=/\s?auto?\s?/i,u=c.test(s);u&&(s=s.replace(c,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var l=this.getPosition(),h=o[0].offsetWidth,d=o[0].offsetHeight;if(u){var f=s,p=this.getPosition(this.$viewport);s="bottom"==s&&l.bottom+d>p.bottom?"top":"top"==s&&l.top-d<p.top?"bottom":"right"==s&&l.right+h>p.width?"left":"left"==s&&l.left-h<p.left?"right":s,o.removeClass(f).addClass(s)}var m=this.getCalculatedOffset(s,l,h,d);this.applyPlacement(m,s);var g=function(){var t=r.hoverState;r.$element.trigger("shown.bs."+r.type),r.hoverState=null,"out"==t&&r.leave(r)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",g).emulateTransitionEnd(n.TRANSITION_DURATION):g()}},n.prototype.applyPlacement=function(e,n){var i=this.tip(),r=i[0].offsetWidth,o=i[0].offsetHeight,a=parseInt(i.css("margin-top"),10),s=parseInt(i.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),e.top+=a,e.left+=s,t.offset.setOffset(i[0],t.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),i.addClass("in");var c=i[0].offsetWidth,u=i[0].offsetHeight;"top"==n&&u!=o&&(e.top=e.top+o-u);var l=this.getViewportAdjustedDelta(n,e,c,u);l.left?e.left+=l.left:e.top+=l.top;var h=/top|bottom/.test(n),d=h?2*l.left-r+c:2*l.top-o+u,f=h?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(d,i[0][f],h)},n.prototype.replaceArrow=function(t,e,n){this.arrow().css(n?"left":"top",50*(1-t/e)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},n.prototype.hide=function(e){function i(){"in"!=r.hoverState&&o.detach(),r.$element&&r.$element.removeAttr("aria-describedby").trigger("hidden.bs."+r.type),e&&e()}var r=this,o=t(this.$tip),a=t.Event("hide.bs."+this.type);if(this.$element.trigger(a),!a.isDefaultPrevented())return o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i(),this.hoverState=null,this},n.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(e){var n=(e=e||this.$element)[0],i="BODY"==n.tagName,r=n.getBoundingClientRect();null==r.width&&(r=t.extend({},r,{width:r.right-r.left,height:r.bottom-r.top}));var o=window.SVGElement&&n instanceof window.SVGElement,a=i?{top:0,left:0}:o?null:e.offset(),s={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},c=i?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},r,s,c,a)},n.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},n.prototype.getViewportAdjustedDelta=function(t,e,n,i){var r={top:0,left:0};if(!this.$viewport)return r;var o=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var s=e.top-o-a.scroll,c=e.top+o-a.scroll+i;s<a.top?r.top=a.top-s:c>a.top+a.height&&(r.top=a.top+a.height-c)}else{var u=e.left-o,l=e.left+o+n;u<a.left?r.left=a.left-u:l>a.right&&(r.left=a.left+a.width-l)}return r},n.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},n.prototype.getUID=function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},n.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var n=this;e&&((n=t(e.currentTarget).data("bs."+this.type))||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n))),e?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})};var i=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=n,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.popover"),o="object"==typeof e&&e;!r&&/destroy|hide/.test(e)||(r||i.data("bs.popover",r=new n(this,o)),"string"==typeof e&&r[e]())})}var n=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.3.7",n.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=n,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var i=t(this),r=i.data("bs.carousel"),o=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e),a="string"==typeof e?e:o.slide;r||i.data("bs.carousel",r=new n(this,o)),"number"==typeof e?r.to(e):a?r[a]():o.interval&&r.pause().cycle()})}var n=function(e,n){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};n.VERSION="3.3.7",n.TRANSITION_DURATION=600,n.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},n.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},n.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},n.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},n.prototype.getItemForDirection=function(t,e){var n=this.getItemIndex(e);if(("prev"==t&&0===n||"next"==t&&n==this.$items.length-1)&&!this.options.wrap)return e;var i=(n+("prev"==t?-1:1))%this.$items.length;return this.$items.eq(i)},n.prototype.to=function(t){var e=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",this.$items.eq(t))},n.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},n.prototype.next=function(){if(!this.sliding)return this.slide("next")},n.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},n.prototype.slide=function(e,i){var r=this.$element.find(".item.active"),o=i||this.getItemForDirection(e,r),a=this.interval,s="next"==e?"left":"right",c=this;if(o.hasClass("active"))return this.sliding=!1;var u=o[0],l=t.Event("slide.bs.carousel",{relatedTarget:u,direction:s});if(this.$element.trigger(l),!l.isDefaultPrevented()){if(this.sliding=!0,a&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var h=t(this.$indicators.children()[this.getItemIndex(o)]);h&&h.addClass("active")}var d=t.Event("slid.bs.carousel",{relatedTarget:u,direction:s});return t.support.transition&&this.$element.hasClass("slide")?(o.addClass(e),o[0].offsetWidth,r.addClass(s),o.addClass(s),r.one("bsTransitionEnd",function(){o.removeClass([e,s].join(" ")).addClass("active"),r.removeClass(["active",s].join(" ")),c.sliding=!1,setTimeout(function(){c.$element.trigger(d)},0)}).emulateTransitionEnd(n.TRANSITION_DURATION)):(r.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger(d)),a&&this.cycle(),this}};var i=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=n,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this};var r=function(n){var i,r=t(this),o=t(r.attr("data-target")||(i=r.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""));if(o.hasClass("carousel")){var a=t.extend({},o.data(),r.data()),s=r.attr("data-slide-to");s&&(a.interval=!1),e.call(o,a),s&&o.data("bs.carousel").to(s),n.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",r).on("click.bs.carousel.data-api","[data-slide-to]",r),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var n=t(this);e.call(n,n.data())})})}(jQuery),function(t){"use strict";function e(e,n){this.itemsArray=[],this.$element=t(e),this.$element.hide(),this.isSelect="SELECT"===e.tagName,this.multiple=this.isSelect&&e.hasAttribute("multiple"),this.objectItems=n&&n.itemValue,this.placeholderText=e.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=t('<div class="bootstrap-tagsinput"></div>'),this.$input=t('<input size="'+this.inputSize+'" type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.after(this.$container),this.build(n)}function n(t,e){if("function"!=typeof t[e]){var n=t[e];t[e]=function(t){return t[n]}}}function i(t,e){if("function"!=typeof t[e]){var n=t[e];t[e]=function(){return n}}}function r(t){return t?s.text(t).html():""}function o(t){var e=0;if(document.selection){t.focus();var n=document.selection.createRange();n.moveStart("character",-t.value.length),e=n.text.length}else(t.selectionStart||"0"==t.selectionStart)&&(e=t.selectionStart);return e}var a={tagClass:function(){return"label label-info"},itemValue:function(t){return t?t.toString():t},itemText:function(t){return this.itemValue(t)},freeInput:!0,maxTags:undefined,confirmKeys:[13],onTagExists:function(t,e){e.hide().fadeIn()}};e.prototype={constructor:e,add:function(e,n){var i=this;if(!(i.options.maxTags&&i.itemsArray.length>=i.options.maxTags)&&(!1===e||e)){if("object"==typeof e&&!i.objectItems)throw"Can't add objects when itemValue option is not set";if(!e.toString().match(/^\s*$/)){if(i.isSelect&&!i.multiple&&i.itemsArray.length>0&&i.remove(i.itemsArray[0]),"string"==typeof e&&"INPUT"===this.$element[0].tagName){var o=e.split(",");if(o.length>1){for(var a=0;a<o.length;a++)this.add(o[a],!0);return void(n||i.pushVal())}}var s=i.options.itemValue(e),c=i.options.itemText(e),u=i.options.tagClass(e),l=t.grep(i.itemsArray,function(t){return i.options.itemValue(t)===s})[0];if(l){if(i.options.onTagExists){var h=t(".tag",i.$container).filter(function(){return t(this).data("item")===l});i.options.onTagExists(e,h)}}else{i.itemsArray.push(e);var d=t('<span class="tag '+r(u)+'">'+r(c)+'<span data-role="remove"></span></span>');if(d.data("item",e),
i.findInputWrapper().before(d),d.after(" "),i.isSelect&&!t('option[value="'+escape(s)+'"]',i.$element)[0]){var f=t("<option selected>"+r(c)+"</option>");f.data("item",e),f.attr("value",s),i.$element.append(f)}n||i.pushVal(),i.options.maxTags===i.itemsArray.length&&i.$container.addClass("bootstrap-tagsinput-max"),i.$element.trigger(t.Event("itemAdded",{item:e}))}}}},remove:function(e,n){var i=this;i.objectItems&&(e="object"==typeof e?t.grep(i.itemsArray,function(t){return i.options.itemValue(t)==i.options.itemValue(e)})[0]:t.grep(i.itemsArray,function(t){return i.options.itemValue(t)==e})[0]),e&&(t(".tag",i.$container).filter(function(){return t(this).data("item")===e}).remove(),t("option",i.$element).filter(function(){return t(this).data("item")===e}).remove(),i.itemsArray.splice(t.inArray(e,i.itemsArray),1)),n||i.pushVal(),i.options.maxTags>i.itemsArray.length&&i.$container.removeClass("bootstrap-tagsinput-max"),i.$element.trigger(t.Event("itemRemoved",{item:e}))},removeAll:function(){var e=this;for(t(".tag",e.$container).remove(),t("option",e.$element).remove();e.itemsArray.length>0;)e.itemsArray.pop();e.pushVal(),e.options.maxTags&&!this.isEnabled()&&this.enable()},refresh:function(){var e=this;t(".tag",e.$container).each(function(){var n=t(this),i=n.data("item"),o=e.options.itemValue(i),a=e.options.itemText(i),s=e.options.tagClass(i);if(n.attr("class",null),n.addClass("tag "+r(s)),n.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=r(a),e.isSelect){t("option",e.$element).filter(function(){return t(this).data("item")===i}).attr("value",o)}})},items:function(){return this.itemsArray},pushVal:function(){var e=this,n=t.map(e.items(),function(t){return e.options.itemValue(t).toString()});e.$element.val(n,!0).trigger("change")},build:function(e){var r=this;r.options=t.extend({},a,e);var s=r.options.typeahead||{};r.objectItems&&(r.options.freeInput=!1),n(r.options,"itemValue"),n(r.options,"itemText"),n(r.options,"tagClass"),r.options.source&&(s.source=r.options.source),s.source&&t.fn.typeahead&&(i(s,"source"),r.$input.typeahead({source:function(e,n){function i(t){for(var e=[],i=0;i<t.length;i++){var a=r.options.itemText(t[i]);o[a]=t[i],e.push(a)}n(e)}this.map={};var o=this.map,a=s.source(e);t.isFunction(a.success)?a.success(i):t.when(a).then(i)},updater:function(t){r.add(this.map[t])},matcher:function(t){return-1!==t.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(t){return t.sort()},highlighter:function(t){var e=new RegExp("("+this.query+")","gi");return t.replace(e,"<strong>$1</strong>")}})),r.$container.on("click",t.proxy(function(){r.$input.focus()},r)),r.$container.on("keydown","input",t.proxy(function(e){var n=t(e.target),i=r.findInputWrapper();switch(e.which){case 8:if(0===o(n[0])){var a=i.prev();a&&r.remove(a.data("item"))}break;case 46:if(0===o(n[0])){var s=i.next();s&&r.remove(s.data("item"))}break;case 37:var c=i.prev();0===n.val().length&&c[0]&&(c.before(i),n.focus());break;case 39:var u=i.next();0===n.val().length&&u[0]&&(u.after(i),n.focus());break;default:r.options.freeInput&&t.inArray(e.which,r.options.confirmKeys)>=0&&(r.add(n.val()),n.val(""),e.preventDefault())}n.attr("size",Math.max(this.inputSize,n.val().length))},r)),r.$container.on("click","[data-role=remove]",t.proxy(function(e){r.remove(t(e.target).closest(".tag").data("item"))},r)),r.options.itemValue===a.itemValue&&("INPUT"===r.$element[0].tagName?r.add(r.$element.val()):t("option",r.$element).each(function(){r.add(t(this).attr("value"),!0)}))},destroy:function(){var t=this;t.$container.off("keypress","input"),t.$container.off("click","[role=remove]"),t.$container.remove(),t.$element.removeData("tagsinput"),t.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var e=this.$input[0],n=this.$container[0];e&&e.parentNode!==n;)e=e.parentNode;return t(e)}},t.fn.tagsinput=function(n,i){var r=[];return this.each(function(){var o=t(this).data("tagsinput");if(o){var a=o[n](i);a!==undefined&&r.push(a)}else o=new e(this,n),t(this).data("tagsinput",o),r.push(o),"SELECT"===this.tagName&&t("option",t(this)).attr("selected","selected"),t(this).val(t(this).val())}),"string"==typeof n?r.length>1?r:r[0]:r},t.fn.tagsinput.Constructor=e;var s=t("<div />");t(function(){t("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery),function(t){"use strict";t.fn.serializeJSON=function(e){var n,i,r,o,a,s,c;return s=t.serializeJSON,c=s.optsWithDefaults(e),s.validateOptions(c),i=this.serializeArray(),s.readCheckboxUncheckedValues(i,this,c),n={},t.each(i,function(t,e){r=s.splitInputNameIntoKeysArray(e.name),"skip"!==(o=r.pop())&&(a=s.parseValue(e.value,o,c),c.parseWithFunction&&"_"===o&&(a=c.parseWithFunction(a,e.name)),s.deepSet(n,r,a,c))}),n},t.serializeJSON={defaultOptions:{parseNumbers:!1,parseBooleans:!1,parseNulls:!1,parseAll:!1,parseWithFunction:null,checkboxUncheckedValue:undefined,useIntKeysAsArrayIndex:!1},optsWithDefaults:function(e){var n,i;return null==e&&(e={}),n=t.serializeJSON,i=n.optWithDefaults("parseAll",e),{parseNumbers:i||n.optWithDefaults("parseNumbers",e),parseBooleans:i||n.optWithDefaults("parseBooleans",e),parseNulls:i||n.optWithDefaults("parseNulls",e),parseWithFunction:n.optWithDefaults("parseWithFunction",e),checkboxUncheckedValue:n.optWithDefaults("checkboxUncheckedValue",e),useIntKeysAsArrayIndex:n.optWithDefaults("useIntKeysAsArrayIndex",e)}},optWithDefaults:function(e,n){return!1!==n[e]&&""!==n[e]&&(n[e]||t.serializeJSON.defaultOptions[e])},validateOptions:function(t){var e,n;n=["parseNumbers","parseBooleans","parseNulls","parseAll","parseWithFunction","checkboxUncheckedValue","useIntKeysAsArrayIndex"];for(e in t)if(-1===n.indexOf(e))throw new Error("serializeJSON ERROR: invalid option '"+e+"'. Please use one of "+n.join(","))},parseValue:function(e,n,i){var r;return r=t.serializeJSON,"string"==n?e:"number"==n||i.parseNumbers&&r.isNumeric(e)?Number(e):"boolean"==n||i.parseBooleans&&("true"===e||"false"===e)?-1===["false","null","undefined","","0"].indexOf(e):"null"==n||i.parseNulls&&"null"==e?-1!==["false","null","undefined","","0"].indexOf(e)?null:e:"array"==n||"object"==n?JSON.parse(e):"auto"==n?r.parseValue(e,null,{parseNumbers:!0,parseBooleans:!0,parseNulls:!0}):e},isObject:function(t){return t===Object(t)},isUndefined:function(t){return void 0===t},isValidArrayIndex:function(t){return/^[0-9]+$/.test(String(t))},isNumeric:function(t){return t-parseFloat(t)>=0},splitInputNameIntoKeysArray:function(e){var n,i,r,o,a;return a=t.serializeJSON,o=a.extractTypeFromInputName(e),i=o[0],r=o[1],n=i.split("["),""===(n=t.map(n,function(t){return t.replace(/]/g,"")}))[0]&&n.shift(),n.push(r),n},extractTypeFromInputName:function(e){var n;if(t.serializeJSON,n=e.match(/(.*):([^:]+)$/)){var i=["string","number","boolean","null","array","object","skip","auto"];if(-1!==i.indexOf(n[2]))return[n[1],n[2]];throw new Error("serializeJSON ERROR: Invalid type "+n[2]+" found in input name '"+e+"', please use one of "+i.join(", "))}return[e,"_"]},deepSet:function(e,n,i,r){var o,a,s,c,u,l;if(null==r&&(r={}),(l=t.serializeJSON).isUndefined(e))throw new Error("ArgumentError: param 'o' expected to be an object or array, found undefined");if(!n||0===n.length)throw new Error("ArgumentError: param 'keys' expected to be an array with least one element");o=n[0],1===n.length?""===o?e.push(i):e[o]=i:(a=n[1],""===o&&(u=e[c=e.length-1],o=l.isObject(u)&&(l.isUndefined(u[a])||n.length>2)?c:c+1),l.isUndefined(e[o])&&(""===a?e[o]=[]:r.useIntKeysAsArrayIndex&&l.isValidArrayIndex(a)?e[o]=[]:e[o]={}),s=n.slice(1),l.deepSet(e[o],s,i,r))},readCheckboxUncheckedValues:function(e,n,i){var r,o,a,s;null==i&&(i={}),s=t.serializeJSON,r="input[type=checkbox][name]:not(:checked,[disabled])",n.find(r).add(n.filter(r)).each(function(n,r){o=t(r),(a=o.attr("data-unchecked-value"))?e.push({name:r.name,value:a}):s.isUndefined(i.checkboxUncheckedValue)||e.push({name:r.name,value:i.checkboxUncheckedValue})})}}}(window.jQuery||window.Zepto||window.$),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Clipboard=t()}}(function(){var t;return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return r(n||e)},l,l.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e){function n(t,e){for(;t&&t.nodeType!==i;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}var i=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var r=Element.prototype;r.matches=r.matchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||r.webkitMatchesSelector}e.exports=n},{}],2:[function(t,e){function n(t,e,n,r,o){var a=i.apply(this,arguments);return t.addEventListener(n,a,o),{destroy:function(){t.removeEventListener(n,a,o)}}}function i(t,e,n,i){return function(n){n.delegateTarget=r(n.target,e),n.delegateTarget&&i.call(t,n)}}var r=t("./closest");e.exports=n},{"./closest":1}],3:[function(t,e,n){n.node=function(t){return t!==undefined&&t instanceof HTMLElement&&1===t.nodeType},n.nodeList=function(t){var e=Object.prototype.toString.call(t);return t!==undefined&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||n.node(t[0]))},n.string=function(t){return"string"==typeof t||t instanceof String},n.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},{}],4:[function(t,e){function n(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!a.string(e))throw new TypeError("Second argument must be a String");if(!a.fn(n))throw new TypeError("Third argument must be a Function");if(a.node(t))return i(t,e,n);if(a.nodeList(t))return r(t,e,n);if(a.string(t))return o(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function i(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}function r(t,e,n){return Array.prototype.forEach.call(t,function(t){t.addEventListener(e,n)}),{destroy:function(){Array.prototype.forEach.call(t,function(t){t.removeEventListener(e,n)})}}}function o(t,e,n){return s(document.body,t,e,n)}var a=t("./is"),s=t("delegate");e.exports=n},{"./is":3,delegate:2}],5:[function(t,e){function n(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var i=window.getSelection(),r=document.createRange();r.selectNodeContents(t),i.removeAllRanges(),i.addRange(r),e=i.toString()}return e}e.exports=n},{}],6:[function(t,e){function n(){}n.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){function i(){r.off(t,i),e.apply(n,arguments)}var r=this;return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var o=0,a=i.length;o<a;o++)i[o].fn!==e&&i[o].fn._!==e&&r.push(i[o]);return r.length?n[t]=r:delete n[t],this}},e.exports=n},{}],7:[function(e,n,i){!function(r,o){if("function"==typeof t&&t.amd)t(["module","select"],o);else if(void 0!==i)o(n,e("select"));else{var a={exports:{}};o(a,r.select),r.clipboardAction=a.exports}}(this,function(t,e){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=n(e),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function(){function t(e){i(this,t),this.resolveOptions(e),this.initSelection()}return a(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,r["default"])(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,r["default"])(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(t!==undefined){if(!t||"object"!==(void 0===t?"undefined":o(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=s})},{select:5}],8:[function(e,n,i){!function(r,o){if("function"==typeof t&&t.amd)t(["module","./clipboard-action","tiny-emitter","good-listener"],o);else if(void 0!==i)o(n,e("./clipboard-action"),e("tiny-emitter"),e("good-listener"));else{var a={exports:{}};o(a,r.clipboardAction,r.tinyEmitter,r.goodListener),r.clipboard=a.exports}}(this,function(t,e,n,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function c(t,e){var n="data-clipboard-"+t;if(e.hasAttribute(n))return e.getAttribute(n)}var u=r(e),l=r(n),h=r(i),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),p=function(){function t(e,n){o(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.resolveOptions(n),i.listenClick(e),i}return s(t,l["default"]),f(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===d(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,h["default"])(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new u["default"]({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return c("action",t)}},{key:"defaultTarget",value:function(t){var e=c("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return c("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach(function(t){n=n&&!!document.queryCommandSupported(t)}),n}}]),t}();t.exports=p})},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.L={})}(this,function(t){"use strict";function e(t){var e,n,i,r;for(n=1,i=arguments.length;n<i;n++){r=arguments[n];for(e in r)t[e]=r[e]}return t}function n(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}function i(t){return t._leaflet_id=t._leaflet_id||++me,t._leaflet_id}function r(t,e,n){var i,r,o,a;return a=function(){i=!1,r&&(o.apply(n,r),r=!1)},o=function(){i?r=arguments:(t.apply(n,arguments),setTimeout(a,e),i=!0)}}function o(t,e,n){var i=e[1],r=e[0],o=i-r;return t===i&&n?t:((t-r)%o+o)%o+r}function a(){return!1}function s(t,e){var n=Math.pow(10,e||5);return Math.round(t*n)/n}function c(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function u(t){return c(t).split(/\s+/)}function l(t,e){t.hasOwnProperty("options")||(t.options=t.options?pe(t.options):{});for(var n in e)t.options[n]=e[n];return t.options}function h(t,e,n){var i=[];for(var r in t)i.push(encodeURIComponent(n?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")}function d(t,e){return t.replace(ge,function(t,n){var i=e[n];if(i===undefined)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i})}function f(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function p(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function m(t){var e=+new Date,n=Math.max(0,16-(e-be));return be=e+n,window.setTimeout(t,n)}function g(t,e,i){if(!i||_e!==m)return _e.call(window,n(t,e));t.call(e)}function v(t){t&&xe.call(window,t)}function y(){}function b(t){if(L&&L.Mixin){t=ve(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}function _(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}function x(t,e,n){return t instanceof _?t:ve(t)?new _(t[0],t[1]):t===undefined||null===t?t:"object"==typeof t&&"x"in t&&"y"in t?new _(t.x,t.y):new _(t,e,n)}function w(t,e){if(t)for(var n=e?[t,e]:t,i=0,r=n.length;i<r;i++)this.extend(n[i])}function S(t,e){return!t||t instanceof w?t:new w(t,e)}function k(t,e){if(t)for(var n=e?[t,e]:t,i=0,r=n.length;i<r;i++)this.extend(n[i])}function E(t,e){return t instanceof k?t:new k(t,e)}function T(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,n!==undefined&&(this.alt=+n)}function C(t,e,n){return t instanceof T?t:ve(t)&&"object"!=typeof t[0]?3===t.length?new T(t[0],t[1],t[2]):2===t.length?new T(t[0],t[1]):null:t===undefined||null===t?t:"object"==typeof t&&"lat"in t?new T(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===undefined?null:new T(t,e,n)}function P(t,e,n,i){if(ve(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=i}function A(t,e,n,i){return new P(t,e,n,i)}function N(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function R(t,e){var n,i,r,o,a,s,c="";for(n=0,r=t.length;n<r;n++){for(i=0,o=(a=t[n]).length;i<o;i++)s=a[i],c+=(i?"L":"M")+s.x+" "+s.y;c+=e?un?"z":"x":""}return c||"M0 0"}function I(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}function D(t,e,n,i){return"touchstart"===e?B(t,n,i):"touchmove"===e?H(t,n,i):"touchend"===e&&$(t,n,i),this}function O(t,e,n){var i=t["_leaflet_"+e+n];return"touchstart"===e?t.removeEventListener(dn,i,!1):"touchmove"===e?t.removeEventListener(fn,i,!1):"touchend"===e&&(t.removeEventListener(pn,i,!1),t.removeEventListener(mn,i,!1)),this}function B(t,e,i){var r=n(function(t){if("mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(gn.indexOf(t.target.tagName)<0))return;Q(t)}j(t,e)});t["_leaflet_touchstart"+i]=r,t.addEventListener(dn,r,!1),yn||(document.documentElement.addEventListener(dn,M,!0),document.documentElement.addEventListener(fn,F,!0),document.documentElement.addEventListener(pn,z,!0),document.documentElement.addEventListener(mn,z,!0),yn=!0)}function M(t){vn[t.pointerId]=t,bn++}function F(t){vn[t.pointerId]&&(vn[t.pointerId]=t)}function z(t){delete vn[t.pointerId],bn--}function j(t,e){t.touches=[];for(var n in vn)t.touches.push(vn[n]);t.changedTouches=[t],e(t)}function H(t,e,n){var i=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&j(t,e)};t["_leaflet_touchmove"+n]=i,t.addEventListener(fn,i,!1)}function $(t,e,n){var i=function(t){j(t,e)};t["_leaflet_touchend"+n]=i,t.addEventListener(pn,i,!1),t.addEventListener(mn,i,!1)}function U(t,e,n){function i(t){var e;if(nn){if(!Me||"mouse"===t.pointerType)return;e=bn}else e=t.touches.length;if(!(e>1)){var n=Date.now(),i=n-(o||n);a=t.touches?t.touches[0]:t,s=i>0&&i<=c,o=n}}function r(t){if(s&&!a.cancelBubble){if(nn){if(!Me||"mouse"===t.pointerType)return;var n,i,r={};for(i in a)n=a[i],r[i]=n&&n.bind?n.bind(a):n;a=r}a.type="dblclick",e(a),o=null}}var o,a,s=!1,c=250;return t[wn+_n+n]=i,t[wn+xn+n]=r,t[wn+"dblclick"+n]=e,t.addEventListener(_n,i,!1),t.addEventListener(xn,r,!1),t.addEventListener("dblclick",e,!1),this}function q(t,e){var n=t[wn+_n+e],i=t[wn+xn+e],r=t[wn+"dblclick"+e];return t.removeEventListener(_n,n,!1),t.removeEventListener(xn,i,!1),Me||t.removeEventListener("dblclick",r,!1),this}function W(t,e,n,i){if("object"==typeof e)for(var r in e)Z(t,r,e[r],n);else for(var o=0,a=(e=u(e)).length;o<a;o++)Z(t,e[o],n,i);return this}function V(t,e,n,i){if("object"==typeof e)for(var r in e)G(t,r,e[r],n);else if(e)for(var o=0,a=(e=u(e)).length;o<a;o++)G(t,e[o],n,i);else{for(var s in t[Sn])G(t,s,t[Sn][s]);delete t[Sn]}return this}function Z(t,e,n,r){var o=e+i(n)+(r?"_"+i(r):"");if(t[Sn]&&t[Sn][o])return this;var a=function(e){return n.call(r||t,e||window.event)},s=a;nn&&0===e.indexOf("touch")?D(t,e,a,o):!rn||"dblclick"!==e||!U||nn&&$e?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",a,!1):"mouseenter"===e||"mouseleave"===e?(a=function(e){e=e||window.event,rt(t,e)&&s(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",a,!1)):("click"===e&&ze&&(a=function(t){ot(t,s)}),t.addEventListener(e,a,!1)):"attachEvent"in t&&t.attachEvent("on"+e,a):U(t,a,o),t[Sn]=t[Sn]||{},t[Sn][o]=a}function G(t,e,n,r){var o=e+i(n)+(r?"_"+i(r):""),a=t[Sn]&&t[Sn][o];if(!a)return this;nn&&0===e.indexOf("touch")?O(t,e,o):rn&&"dblclick"===e&&q?q(t,o):"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",a,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,a,!1):"detachEvent"in t&&t.detachEvent("on"+e,a),t[Sn][o]=null}function K(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,it(t),this}function X(t){return Z(t,"mousewheel",K),this}function Y(t){return W(t,"mousedown touchstart dblclick",K),Z(t,"click",nt),this}function Q(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function J(t){return Q(t),K(t),this}function tt(t,e){if(!e)return new _(t.clientX,t.clientY);var n=e.getBoundingClientRect();return new _(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)}function et(t){return Me?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/kn:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function nt(t){En[t.type]=!0}function it(t){var e=En[t.type];return En[t.type]=!1,e}function rt(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(i){return!1}return n!==t}function ot(t,e){var n=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,i=Le&&n-Le;i&&i>100&&i<500||t.target._simulatedClick&&!t._simulated?J(t):(Le=n,e(t))}function at(t){return"string"==typeof t?document.getElementById(t):t}function st(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n}function ct(t,e,n){var i=document.createElement(t);return i.className=e||"",n&&n.appendChild(i),i}function ut(t){var e=t.parentNode;e&&e.removeChild(t)}function lt(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ht(t){var e=t.parentNode;e.lastChild!==t&&e.appendChild(t)}function dt(t){var e=t.parentNode;e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function ft(t,e){if(t.classList!==undefined)return t.classList.contains(e);var n=vt(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function pt(t,e){if(t.classList!==undefined)for(var n=u(e),i=0,r=n.length;i<r;i++)t.classList.add(n[i]);else if(!ft(t,e)){var o=vt(t);gt(t,(o?o+" ":"")+e)}}function mt(t,e){t.classList!==undefined?t.classList.remove(e):gt(t,c((" "+vt(t)+" ").replace(" "+e+" "," ")))}function gt(t,e){t.className.baseVal===undefined?t.className=e:t.className.baseVal=e}function vt(t){return t.className.baseVal===undefined?t.className:t.className.baseVal}function yt(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&bt(t,e)}function bt(t,e){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(r){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}function _t(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function xt(t,e,n){var i=e||new _(0,0);t.style[Cn]=(Ge?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function wt(t,e){t._leaflet_pos=e,Ye?xt(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function St(t){return t._leaflet_pos||new _(0,0)}function kt(){W(window,"dragstart",Q)}function Et(){V(window,"dragstart",Q)}function Tt(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Ct(),Nn=t,Rn=t.style.outline,t.style.outline="none",W(window,"keydown",Ct))}function Ct(){Nn&&(Nn.style.outline=Rn,Nn=undefined,Rn=undefined,V(window,"keydown",Ct))}function Lt(t,e){return new On(t,e)}function Pt(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=Dt(t,n),t=Rt(t,n)}function At(t,e,n){return Math.sqrt(zt(t,e,n,!0))}function Nt(t,e,n){return zt(t,e,n)}function Rt(t,e){var n=t.length,i=new(typeof Uint8Array!=undefined+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,It(t,i,e,0,n-1);var r,o=[];for(r=0;r<n;r++)i[r]&&o.push(t[r]);return o}function It(t,e,n,i,r){var o,a,s,c=0;for(a=i+1;a<=r-1;a++)(s=zt(t[a],t[i],t[r],!0))>c&&(o=a,c=s);c>n&&(e[o]=1,It(t,e,n,i,o),It(t,e,n,o,r))}function Dt(t,e){for(var n=[t[0]],i=1,r=0,o=t.length;i<o;i++)Ft(t[i],t[r])>e&&(n.push(t[i]),r=i);return r<o-1&&n.push(t[o-1]),n}function Ot(t,e,n,i,r){var o,a,s,c=i?Vn:Mt(t,n),u=Mt(e,n);for(Vn=u;;){if(!(c|u))return[t,e];if(c&u)return!1;s=Mt(a=Bt(t,e,o=c||u,n,r),n),o===c?(t=a,c=s):(e=a,u=s)}}function Bt(t,e,n,i,r){var o,a,s=e.x-t.x,c=e.y-t.y,u=i.min,l=i.max;return 8&n?(o=t.x+s*(l.y-t.y)/c,a=l.y):4&n?(o=t.x+s*(u.y-t.y)/c,a=u.y):2&n?(o=l.x,a=t.y+c*(l.x-t.x)/s):1&n&&(o=u.x,a=t.y+c*(u.x-t.x)/s),new _(o,a,r)}function Mt(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function Ft(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}function zt(t,e,n,i){var r,o=e.x,a=e.y,s=n.x-o,c=n.y-a,u=s*s+c*c;return u>0&&((r=((t.x-o)*s+(t.y-a)*c)/u)>1?(o=n.x,a=n.y):r>0&&(o+=s*r,a+=c*r)),s=t.x-o,c=t.y-a,i?s*s+c*c:new _(o,a)}function jt(t){return!ve(t[0])||"object"!=typeof t[0][0]&&"undefined"!=typeof t[0][0]}function Ht(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),jt(t)}function $t(t,e,n){var i,r,o,a,s,c,u,l,h,d=[1,4,2,8];for(r=0,u=t.length;r<u;r++)t[r]._code=Mt(t[r],e);for(a=0;a<4;a++){for(l=d[a],i=[],r=0,o=(u=t.length)-1;r<u;o=r++)s=t[r],c=t[o],s._code&l?c._code&l||((h=Bt(c,s,l,e,n))._code=Mt(h,e),i.push(h)):(c._code&l&&((h=Bt(c,s,l,e,n))._code=Mt(h,e),i.push(h)),i.push(s));t=i}return t}function Ut(t){return new di(t)}function qt(t,e){return new mi(t,e)}function Wt(t,e){return new vi(t,e)}function Vt(t,e,n){return new yi(t,e,n)}function Zt(t,e){return new bi(t,e)}function Gt(t,e){return new _i(t,e)}function Kt(t,e){var n,i,r,o,a="Feature"===t.type?t.geometry:t,s=a?a.coordinates:null,c=[],u=e&&e.pointToLayer,l=e&&e.coordsToLatLng||Xt;if(!s&&!a)return null;switch(a.type){case"Point":return n=l(s),u?u(t,n):new mi(n);case"MultiPoint":for(r=0,o=s.length;r<o;r++)n=l(s[r]),c.push(u?u(t,n):new mi(n));return new li(c);case"LineString":case"MultiLineString":return i=Yt(s,"LineString"===a.type?0:1,l),new bi(i,e);case"Polygon":case"MultiPolygon":return i=Yt(s,"Polygon"===a.type?1:2,l),new _i(i,e);case"GeometryCollection":for(r=0,o=a.geometries.length;r<o;r++){var h=Kt({geometry:a.geometries[r],type:"Feature",properties:t.properties},e);h&&c.push(h)}return new li(c);default:throw new Error("Invalid GeoJSON object.")}}function Xt(t){return new T(t[1],t[0],t[2])}function Yt(t,e,n){for(var i,r=[],o=0,a=t.length;o<a;o++)i=e?Yt(t[o],e-1,n):(n||Xt)(t[o]),r.push(i);return r}function Qt(t,e){return e="number"==typeof e?e:6,t.alt!==undefined?[s(t.lng,e),s(t.lat,e),s(t.alt,e)]:[s(t.lng,e),s(t.lat,e)]}function Jt(t,e,n,i){for(var r=[],o=0,a=t.length;o<a;o++)r.push(e?Jt(t[o],e-1,n,i):Qt(t[o],i));return!e&&n&&r.push(r[0]),r}function te(t,n){return t.feature?e({},t.feature,{geometry:n}):ee(n)}function ee(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}function ne(t,e){return new xi(t,e)}function ie(t,e,n){return new Ti(t,e,n)}function re(t){return new Ri(t)}function oe(t){return new Ii(t)}function ae(t,e){return new Di(t,e)}function se(t,e){
return new Oi(t,e)}function ce(t){return cn?new Mi(t):null}function ue(t){return un||ln?new Hi(t):null}function le(t,e){return new $i(t,e)}function he(){return window.L=Xi,this}var de="1.2.0",fe=Object.freeze;Object.freeze=function(t){return t};var pe=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),me=0,ge=/\{ *([\w_\-]+) *\}/g,ve=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},ye="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",be=0,_e=window.requestAnimationFrame||p("RequestAnimationFrame")||m,xe=window.cancelAnimationFrame||p("CancelAnimationFrame")||p("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)},we=(Object.freeze||Object)({freeze:fe,extend:e,create:pe,bind:n,lastId:me,stamp:i,throttle:r,wrapNum:o,falseFn:a,formatNum:s,trim:c,splitWords:u,setOptions:l,getParamString:h,template:d,isArray:ve,indexOf:f,emptyImageUrl:ye,requestFn:_e,cancelFn:xe,requestAnimFrame:g,cancelAnimFrame:v});y.extend=function(t){var n=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=n.__super__=this.prototype,r=pe(i);r.constructor=n,n.prototype=r;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&"__super__"!==o&&(n[o]=this[o]);return t.statics&&(e(n,t.statics),delete t.statics),t.includes&&(b(t.includes),e.apply(null,[r].concat(t.includes)),delete t.includes),r.options&&(t.options=e(pe(r.options),t.options)),e(r,t),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;t<e;t++)r._initHooks[t].call(this)}},n},y.include=function(t){return e(this.prototype,t),this},y.mergeOptions=function(t){return e(this.prototype.options,t),this},y.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var Se={on:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e);else for(var r=0,o=(t=u(t)).length;r<o;r++)this._on(t[r],e,n);return this},off:function(t,e,n){if(t)if("object"==typeof t)for(var i in t)this._off(i,t[i],e);else for(var r=0,o=(t=u(t)).length;r<o;r++)this._off(t[r],e,n);else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var i=this._events[t];i||(i=[],this._events[t]=i),n===this&&(n=undefined);for(var r={fn:e,ctx:n},o=i,a=0,s=o.length;a<s;a++)if(o[a].fn===e&&o[a].ctx===n)return;o.push(r)},_off:function(t,e,n){var i,r,o;if(this._events&&(i=this._events[t]))if(e){if(n===this&&(n=undefined),i)for(r=0,o=i.length;r<o;r++){var s=i[r];if(s.ctx===n&&s.fn===e)return s.fn=a,this._firingCount&&(this._events[t]=i=i.slice()),void i.splice(r,1)}}else{for(r=0,o=i.length;r<o;r++)i[r].fn=a;delete this._events[t]}},fire:function(t,n,i){if(!this.listens(t,i))return this;var r=e({},n,{type:t,target:this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var a=0,s=o.length;a<s;a++){var c=o[a];c.fn.call(c.ctx||this,r)}this._firingCount--}}return i&&this._propagateEvent(r),this},listens:function(t,e){var n=this._events&&this._events[t];if(n&&n.length)return!0;if(e)for(var i in this._eventParents)if(this._eventParents[i].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var r in t)this.once(r,t[r],e);return this}var o=n(function(){this.off(t,e,i).off(t,o,i)},this);return this.on(t,e,i).on(t,o,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[i(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[i(t)],this},_propagateEvent:function(t){for(var n in this._eventParents)this._eventParents[n].fire(t.type,e({layer:t.target},t),!0)}};Se.addEventListener=Se.on,Se.removeEventListener=Se.clearAllEventListeners=Se.off,Se.addOneTimeEventListener=Se.once,Se.fireEvent=Se.fire,Se.hasEventListeners=Se.listens;var ke=y.extend(Se);_.prototype={clone:function(){return new _(this.x,this.y)},add:function(t){return this.clone()._add(x(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(x(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new _(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new _(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){var e=(t=x(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=x(t)).x===this.x&&t.y===this.y},contains:function(t){return t=x(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+s(this.x)+", "+s(this.y)+")"}},w.prototype={extend:function(t){return t=x(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new _((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new _(this.min.x,this.max.y)},getTopRight:function(){return new _(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof _?x(t):S(t))instanceof w?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=S(t);var e=this.min,n=this.max,i=t.min,r=t.max,o=r.x>=e.x&&i.x<=n.x,a=r.y>=e.y&&i.y<=n.y;return o&&a},overlaps:function(t){t=S(t);var e=this.min,n=this.max,i=t.min,r=t.max,o=r.x>e.x&&i.x<n.x,a=r.y>e.y&&i.y<n.y;return o&&a},isValid:function(){return!(!this.min||!this.max)}},k.prototype={extend:function(t){var e,n,i=this._southWest,r=this._northEast;if(t instanceof T)e=t,n=t;else{if(!(t instanceof k))return t?this.extend(C(t)||E(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return i||r?(i.lat=Math.min(e.lat,i.lat),i.lng=Math.min(e.lng,i.lng),r.lat=Math.max(n.lat,r.lat),r.lng=Math.max(n.lng,r.lng)):(this._southWest=new T(e.lat,e.lng),this._northEast=new T(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,r=Math.abs(e.lng-n.lng)*t;return new k(new T(e.lat-i,e.lng-r),new T(n.lat+i,n.lng+r))},getCenter:function(){return new T((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new T(this.getNorth(),this.getWest())},getSouthEast:function(){return new T(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof T||"lat"in t?C(t):E(t);var e,n,i=this._southWest,r=this._northEast;return t instanceof k?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=r.lat&&e.lng>=i.lng&&n.lng<=r.lng},intersects:function(t){t=E(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>=e.lat&&i.lat<=n.lat,a=r.lng>=e.lng&&i.lng<=n.lng;return o&&a},overlaps:function(t){t=E(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>e.lat&&i.lat<n.lat,a=r.lng>e.lng&&i.lng<n.lng;return o&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=E(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},T.prototype={equals:function(t,e){if(!t)return!1;t=C(t);return Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(e===undefined?1e-9:e)},toString:function(t){return"LatLng("+s(this.lat,t)+", "+s(this.lng,t)+")"},distanceTo:function(t){return Te.distance(this,C(t))},wrap:function(){return Te.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return E([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new T(this.lat,this.lng,this.alt)}};var Ee={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new w(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?o(t.lng,this.wrapLng,!0):t.lng;return new T(this.wrapLat?o(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),i=e.lat-n.lat,r=e.lng-n.lng;if(0===i&&0===r)return t;var o=t.getSouthWest(),a=t.getNorthEast();return new k(new T(o.lat-i,o.lng-r),new T(a.lat-i,a.lng-r))}},Te=e({},Ee,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,r=e.lat*n,o=Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos((e.lng-t.lng)*n);return this.R*Math.acos(Math.min(o,1))}}),Ce={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),r=Math.sin(i*e);return new _(this.R*t.lng*e,this.R*Math.log((1+r)/(1-r))/2)},unproject:function(t){var e=180/Math.PI;return new T((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return new w([-t,-t],[t,t])}()};P.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new _((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var Le,Pe,Ae,Ne,Re=e({},Te,{code:"EPSG:3857",projection:Ce,transformation:function(){var t=.5/(Math.PI*Ce.R);return A(t,.5,-t,.5)}()}),Ie=e({},Re,{code:"EPSG:900913"}),De=document.documentElement.style,Oe="ActiveXObject"in window,Be=Oe&&!document.addEventListener,Me="msLaunchUri"in navigator&&!("documentMode"in document),Fe=I("webkit"),ze=I("android"),je=I("android 2")||I("android 3"),He=!!window.opera,$e=I("chrome"),Ue=I("gecko")&&!Fe&&!He&&!Oe,qe=!$e&&I("safari"),We=I("phantom"),Ve="OTransition"in De,Ze=0===navigator.platform.indexOf("Win"),Ge=Oe&&"transition"in De,Ke="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!je,Xe="MozPerspective"in De,Ye=!window.L_DISABLE_3D&&(Ge||Ke||Xe)&&!Ve&&!We,Qe="undefined"!=typeof orientation||I("mobile"),Je=Qe&&Fe,tn=Qe&&Ke,en=!window.PointerEvent&&window.MSPointerEvent,nn=!(!window.PointerEvent&&!en),rn=!window.L_NO_TOUCH&&(nn||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),on=Qe&&He,an=Qe&&Ue,sn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,cn=!!document.createElement("canvas").getContext,un=!(!document.createElementNS||!N("svg").createSVGRect),ln=!un&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(n){return!1}}(),hn=(Object.freeze||Object)({ie:Oe,ielt9:Be,edge:Me,webkit:Fe,android:ze,android23:je,opera:He,chrome:$e,gecko:Ue,safari:qe,phantom:We,opera12:Ve,win:Ze,ie3d:Ge,webkit3d:Ke,gecko3d:Xe,any3d:Ye,mobile:Qe,mobileWebkit:Je,mobileWebkit3d:tn,msPointer:en,pointer:nn,touch:rn,mobileOpera:on,mobileGecko:an,retina:sn,canvas:cn,svg:un,vml:ln}),dn=en?"MSPointerDown":"pointerdown",fn=en?"MSPointerMove":"pointermove",pn=en?"MSPointerUp":"pointerup",mn=en?"MSPointerCancel":"pointercancel",gn=["INPUT","SELECT","OPTION"],vn={},yn=!1,bn=0,_n=en?"MSPointerDown":nn?"pointerdown":"touchstart",xn=en?"MSPointerUp":nn?"pointerup":"touchend",wn="_leaflet_",Sn="_leaflet_events",kn=Ze&&$e?2*window.devicePixelRatio:Ue?window.devicePixelRatio:1,En={},Tn=(Object.freeze||Object)({on:W,off:V,stopPropagation:K,disableScrollPropagation:X,disableClickPropagation:Y,preventDefault:Q,stop:J,getMousePosition:tt,getWheelDelta:et,fakeStop:nt,skipped:it,isExternalTarget:rt,addListener:W,removeListener:V}),Cn=_t(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),Ln=_t(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Pn="webkitTransition"===Ln||"OTransition"===Ln?Ln+"End":"transitionend";if("onselectstart"in document)Pe=function(){W(window,"selectstart",Q)},Ae=function(){V(window,"selectstart",Q)};else{var An=_t(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Pe=function(){if(An){var t=document.documentElement.style;Ne=t[An],t[An]="none"}},Ae=function(){An&&(document.documentElement.style[An]=Ne,Ne=undefined)}}var Nn,Rn,In=(Object.freeze||Object)({TRANSFORM:Cn,TRANSITION:Ln,TRANSITION_END:Pn,get:at,getStyle:st,create:ct,remove:ut,empty:lt,toFront:ht,toBack:dt,hasClass:ft,addClass:pt,removeClass:mt,setClass:gt,getClass:vt,setOpacity:yt,testProp:_t,setTransform:xt,setPosition:wt,getPosition:St,disableTextSelection:Pe,enableTextSelection:Ae,disableImageDrag:kt,enableImageDrag:Et,preventOutline:Tt,restoreOutline:Ct}),Dn=ke.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=St(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=g(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),wt(this._el,n),this.fire("step")},_complete:function(){v(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),On=ke.extend({options:{crs:Re,center:undefined,zoom:undefined,minZoom:undefined,maxZoom:undefined,layers:[],maxBounds:undefined,renderer:undefined,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=l(this,e),this._initContainer(t),this._initLayout(),this._onResize=n(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==undefined&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==undefined&&this.setView(C(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=Ln&&Ye&&!on&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),W(this._proxy,Pn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,n,i){if(n=n===undefined?this._zoom:this._limitZoom(n),t=this._limitCenter(C(t),n,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i){i.animate!==undefined&&(i.zoom=e({animate:i.animate},i.zoom),i.pan=e({animate:i.animate,duration:i.duration},i.pan));if(this._zoom!==n?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,n,i.zoom):this._tryAnimatedPan(t,i.pan))return clearTimeout(this._sizeTimer),this}return this._resetView(t,n),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Ye?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Ye?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),r=this.getSize().divideBy(2),o=(t instanceof _?t:this.latLngToContainerPoint(t)).subtract(r).multiplyBy(1-1/i),a=this.containerPointToLatLng(r.add(o));return this.setView(a,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():E(t);var n=x(e.paddingTopLeft||e.padding||[0,0]),i=x(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,n.add(i));if((r="number"==typeof e.maxZoom?Math.min(e.maxZoom,r):r)===Infinity)return{center:t.getCenter(),zoom:r};var o=i.subtract(n).divideBy(2),a=this.project(t.getSouthWest(),r),s=this.project(t.getNorthEast(),r);return{center:this.unproject(a.add(s).divideBy(2).add(o),r),zoom:r}},fitBounds:function(t,e){if(!(t=E(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=x(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Dn,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){pt(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){function i(t){var e=(v*v-m*m+(t?-1:1)*_*_*y*y)/(2*(t?v:m)*_*y),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function r(t){return(Math.exp(t)-Math.exp(-t))/2}function o(t){return(Math.exp(t)+Math.exp(-t))/2}function a(t){return r(t)/o(t)}function s(t){return m*(o(x)/o(x+b*t))}function c(t){return m*(o(x)*a(x+b*t)-r(x))/_}function u(t){return 1-Math.pow(1-t,1.5)}function l(){var n=(Date.now()-w)/k,i=u(n)*S;n<=1?(this._flyToFrame=g(l,this),this._move(this.unproject(h.add(d.subtract(h).multiplyBy(c(i)/y)),p),this.getScaleZoom(m/s(i),p),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}if(!1===(n=n||{}).animate||!Ye)return this.setView(t,e,n);this._stop();var h=this.project(this.getCenter()),d=this.project(t),f=this.getSize(),p=this._zoom;t=C(t),e=e===undefined?p:e;var m=Math.max(f.x,f.y),v=m*this.getZoomScale(p,e),y=d.distanceTo(h)||1,b=1.42,_=b*b,x=i(0),w=Date.now(),S=(i(1)-x)/b,k=n.duration?1e3*n.duration:1e3*S*.8;return this._moveStart(!0),l.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return(t=E(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,E(t));return n.equals(i)||this.panTo(i,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=e({animate:!1,pan:!0},!0===t?{animate:!0}:t);var i=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var r=this.getSize(),o=i.divideBy(2).round(),a=r.divideBy(2).round(),s=o.subtract(a);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(n(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:i,newSize:r})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=e({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var i=n(this._handleGeolocationResponse,this),r=n(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(i,r,t):navigator.geolocation.getCurrentPosition(i,r,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=new T(t.coords.latitude,t.coords.longitude),n=e.toBounds(t.coords.accuracy),i=this._locateOptions;if(i.setView){var r=this.getBoundsZoom(n);this.setView(e,i.maxZoom?Math.min(r,i.maxZoom):r)}var o={latlng:e,bounds:n,timestamp:t.timestamp};for(var a in t.coords)"number"==typeof t.coords[a]&&(o[a]=t.coords[a]);this.fire("locationfound",o)},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(e){this._container._leaflet_id=undefined,this._containerId=undefined}ut(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ut(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=ct("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new k(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return this.options.minZoom===undefined?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===undefined?this._layersMaxZoom===undefined?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=E(t),n=x(n||[0,0]);var i=this.getZoom()||0,r=this.getMinZoom(),o=this.getMaxZoom(),a=t.getNorthWest(),s=t.getSouthEast(),c=this.getSize().subtract(n),u=S(this.project(s,i),this.project(a,i)).getSize(),l=Ye?this.options.zoomSnap:1,h=c.x/u.x,d=c.y/u.y,f=e?Math.max(h,d):Math.min(h,d);return i=this.getScaleZoom(f,i),l&&(i=Math.round(i/(l/100))*(l/100),i=e?Math.ceil(i/l)*l:Math.floor(i/l)*l),Math.max(r,Math.min(o,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new _(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new w(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===undefined?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=e===undefined?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=e===undefined?this._zoom:e;var i=n.zoom(t*n.scale(e));return isNaN(i)?Infinity:i},project:function(t,e){return e=e===undefined?this._zoom:e,this.options.crs.latLngToPoint(C(t),e)},unproject:function(t,e){return e=e===undefined?this._zoom:e,this.options.crs.pointToLatLng(x(t),e)},layerPointToLatLng:function(t){var e=x(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(C(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(C(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(E(t))},distance:function(t,e){return this.options.crs.distance(C(t),C(e))},containerPointToLayerPoint:function(t){return x(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return x(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(x(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(C(t)))},mouseEventToContainerPoint:function(t){return tt(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=at(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");W(e,"scroll",this._onScroll,this),this._containerId=i(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ye,pt(t,"leaflet-container"+(rn?" leaflet-touch":"")+(sn?" leaflet-retina":"")+(Be?" leaflet-oldie":"")+(qe?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=st(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),wt(this._mapPane,new _(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(pt(t.markerPane,"leaflet-zoom-hide"),pt(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){wt(this._mapPane,new _(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var i=this._zoom!==e;this._moveStart(i)._move(t,e)._moveEnd(i),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t){return t&&this.fire("zoomstart"),this.fire("movestart")},_move:function(t,e,n){e===undefined&&(e=this._zoom);var i=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(i||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return v(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){wt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[i(this._container)]=this;var e=t?V:W;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Ye&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){v(this._resizeRequest),this._resizeRequest=g(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,r=[],o="mouseout"===e||"mouseover"===e,a=t.target||t.srcElement,s=!1;a;){if((n=this._targets[i(a)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(n)){s=!0;break}if(n&&n.listens(e,!0)){if(o&&!rt(a,t))break;if(r.push(n),o)break}if(a===this._container)break;a=a.parentNode}return r.length||s||o||!rt(a,t)||(r=[this]),r},_handleDOMEvent:function(t){if(this._loaded&&!it(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e||Tt(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,n,i){if("click"===t.type){var r=e({},t);r.type="preclick",this._fireDOMEvent(r,r.type,i)}if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,n))).length){var o=i[0];"contextmenu"===n&&o.listens(n,!0)&&Q(t);var a={originalEvent:t};if("keypress"!==t.type){var s=o.options&&"icon"in o.options;a.containerPoint=s?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),a.layerPoint=this.containerPointToLayerPoint(a.containerPoint),a.latlng=s?o.getLatLng():this.layerPointToLatLng(a.layerPoint)}for(var c=0;c<i.length;c++)if(i[c].fire(n,a,!0),a.originalEvent._stopped||!1===i[c].options.bubblingMouseEvents&&-1!==f(this._mouseEvents,n))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return St(this._mapPane)||new _(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&e!==undefined?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(i)},_latLngBoundsToNewLayerBounds:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return S([this.project(t.getSouthWest(),e)._subtract(i),this.project(t.getNorthWest(),e)._subtract(i),this.project(t.getSouthEast(),e)._subtract(i),this.project(t.getNorthEast(),e)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),r=this.getSize().divideBy(2),o=new w(i.subtract(r),i.add(r)),a=this._getBoundsOffset(o,n,e);return a.round().equals([0,0])?t:this.unproject(i.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new w(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=S(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),r=i.min.subtract(t.min),o=i.max.subtract(t.max);return new _(this._rebound(r.x,-o.x),this._rebound(r.y,-o.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),i=Ye?this.options.zoomSnap:1;return i&&(t=Math.round(t/i)*i),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){
mt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._floor();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n))&&(this.panBy(n,e),!0)},_createAnimProxy:function(){var t=this._proxy=ct("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var e=Cn,n=this._proxy.style[e];xt(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var t=this.getCenter(),e=this.getZoom();xt(this._proxy,this.project(t,e),this.getZoomScale(e,1))},this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ut(this._proxy),delete this._proxy},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),r=this._getCenterOffset(t)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(r))&&(g(function(){this._moveStart(!0)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,i,r){i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,pt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:r}),setTimeout(n(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(mt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),g(function(){this._moveEnd(!0)},this))}}),Bn=y.extend({options:{position:"topright"},initialize:function(t){l(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return pt(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this},remove:function(){return this._map?(ut(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Mn=function(t){return new Bn(t)};On.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,r){var o=n+t+" "+n+r;e[t+r]=ct("div",o,i)}var e=this._controlCorners={},n="leaflet-",i=this._controlContainer=ct("div",n+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ut(this._controlCorners[t]);ut(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Fn=Bn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,i){return n<i?-1:i<n?1:0}},initialize:function(t,e,n){l(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var i in t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Bn.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(i(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){pt(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(pt(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):mt(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return mt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=ct("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Y(e),X(e);var i=this._form=ct("form",t+"-list");n&&(this._map.on("click",this.collapse,this),ze||W(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var r=this._layersLink=ct("a",t+"-toggle",e);r.href="#",r.title="Layers",rn?(W(r,"click",J),W(r,"click",this.expand,this)):W(r,"focus",this.expand,this),n||this.expand(),this._baseLayersList=ct("div",t+"-base",i),this._separator=ct("div",t+"-separator",i),this._overlaysList=ct("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&i(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(n(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;lt(this._baseLayersList),lt(this._overlaysList),this._layerControlInputs=[];var t,e,n,i,r=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),e=e||i.overlay,t=t||!i.overlay,r+=i.overlay?0:1;return this.options.hideSingleBase&&(t=t&&r>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(i(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e,n=document.createElement("label"),r=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=r):e=this._createRadioElement("leaflet-base-layers",r),this._layerControlInputs.push(e),e.layerId=i(t.layer),W(e,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var a=document.createElement("div");n.appendChild(a),a.appendChild(e),a.appendChild(o);return(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,n=this._layerControlInputs,i=[],r=[];this._handlingClick=!0;for(var o=n.length-1;o>=0;o--)t=n[o],e=this._getLayer(t.layerId).layer,t.checked?i.push(e):t.checked||r.push(e);for(o=0;o<r.length;o++)this._map.hasLayer(r[o])&&this._map.removeLayer(r[o]);for(o=0;o<i.length;o++)this._map.hasLayer(i[o])||this._map.addLayer(i[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,i=this._map.getZoom(),r=n.length-1;r>=0;r--)t=n[r],e=this._getLayer(t.layerId).layer,t.disabled=e.options.minZoom!==undefined&&i<e.options.minZoom||e.options.maxZoom!==undefined&&i>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),zn=function(t,e,n){return new Fn(t,e,n)},jn=Bn.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=ct("div",e+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,i,r){var o=ct("a",n,i);return o.innerHTML=t,o.href="#",o.title=e,o.setAttribute("role","button"),o.setAttribute("aria-label",e),Y(o),W(o,"click",J),W(o,"click",r,this),W(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";mt(this._zoomInButton,e),mt(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&pt(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&pt(this._zoomInButton,e)}});On.mergeOptions({zoomControl:!0}),On.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new jn,this.addControl(this.zoomControl))});var Hn=function(t){return new jn(t)},$n=Bn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=ct("div",e),i=this.options;return this._addScales(i,e+"-line",n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=ct("div",e,n)),t.imperial&&(this._iScale=ct("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e,n,i,r=3.2808399*t;r>5280?(e=r/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mi",n/e)):(i=this._getRoundNum(r),this._updateScale(this._iScale,i+" ft",i/r))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,e*n}}),Un=function(t){return new $n(t)},qn=Bn.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){l(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=ct("div","leaflet-control-attribution"),Y(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}}});On.mergeOptions({attributionControl:!0}),On.addInitHook(function(){this.options.attributionControl&&(new qn).addTo(this)});var Wn=function(t){return new qn(t)};Bn.Layers=Fn,Bn.Zoom=jn,Bn.Scale=$n,Bn.Attribution=qn,Mn.layers=zn,Mn.zoom=Hn,Mn.scale=Un,Mn.attribution=Wn;var Vn,Zn=y.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),Gn={Events:Se},Kn=rn?"touchstart mousedown":"mousedown",Xn={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Yn={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Qn=ke.extend({options:{clickTolerance:3},initialize:function(t,e,n,i){l(this,i),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(W(this._dragStartTarget,Kn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Qn._dragging===this&&this.finishDrag(),V(this._dragStartTarget,Kn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!ft(this._element,"leaflet-zoom-anim")&&!(Qn._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(Qn._dragging=this,this._preventOutline&&Tt(this._element),kt(),Pe(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new _(e.clientX,e.clientY),W(document,Yn[t.type],this._onMove,this),W(document,Xn[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new _(e.clientX,e.clientY).subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(Q(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=St(this._element).subtract(n),pt(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),pt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,v(this._animRequest),this._lastEvent=t,this._animRequest=g(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),wt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){mt(document.body,"leaflet-dragging"),this._lastTarget&&(mt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in Yn)V(document,Yn[t],this._onMove,this),V(document,Xn[t],this._onUp,this);Et(),Ae(),this._moved&&this._moving&&(v(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Qn._dragging=!1}}),Jn=(Object.freeze||Object)({simplify:Pt,pointToSegmentDistance:At,closestPointOnSegment:Nt,clipSegment:Ot,_getEdgeIntersection:Bt,_getBitCode:Mt,_sqClosestPointOnSegment:zt,isFlat:jt,_flat:Ht}),ti=(Object.freeze||Object)({clipPolygon:$t}),ei={project:function(t){return new _(t.lng,t.lat)},unproject:function(t){return new T(t.y,t.x)},bounds:new w([-180,-90],[180,90])},ni={R:6378137,R_MINOR:6356752.314245179,bounds:new w([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,i=t.lat*e,r=this.R_MINOR/n,o=Math.sqrt(1-r*r),a=o*Math.sin(i),s=Math.tan(Math.PI/4-i/2)/Math.pow((1-a)/(1+a),o/2);return i=-n*Math.log(Math.max(s,1e-10)),new _(t.lng*e*n,i)},unproject:function(t){for(var e,n=180/Math.PI,i=this.R,r=this.R_MINOR/i,o=Math.sqrt(1-r*r),a=Math.exp(-t.y/i),s=Math.PI/2-2*Math.atan(a),c=0,u=.1;c<15&&Math.abs(u)>1e-7;c++)e=o*Math.sin(s),e=Math.pow((1-e)/(1+e),o/2),s+=u=Math.PI/2-2*Math.atan(a*e)-s;return new T(s*n,t.x*n/i)}},ii=(Object.freeze||Object)({LonLat:ei,Mercator:ni,SphericalMercator:Ce}),ri=e({},Te,{code:"EPSG:3395",projection:ni,transformation:function(){var t=.5/(Math.PI*ni.R);return A(t,.5,-t,.5)}()}),oi=e({},Te,{code:"EPSG:4326",projection:ei,transformation:A(1/180,1,-1/180,.5)}),ai=e({},Ee,{projection:ei,transformation:A(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,i=e.lat-t.lat;return Math.sqrt(n*n+i*i)},infinite:!0});Ee.Earth=Te,Ee.EPSG3395=ri,Ee.EPSG3857=Re,Ee.EPSG900913=Ie,Ee.EPSG4326=oi,Ee.Simple=ai;var si=ke.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[i(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[i(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",function(){e.off(n,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});On.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=i(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=i(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&i(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?ve(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[i(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=i(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=Infinity,e=-Infinity,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var r=this._zoomBoundLayers[i].options;t=r.minZoom===undefined?t:Math.min(t,r.minZoom),e=r.maxZoom===undefined?e:Math.max(e,r.maxZoom)}this._layersMaxZoom=e===-Infinity?undefined:e,this._layersMinZoom=t===Infinity?undefined:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===undefined&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===undefined&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ci=si.extend({initialize:function(t){this._layers={};var e,n;if(t)for(e=0,n=t.length;e<n;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return i(t)}}),ui=function(t){return new ci(t)},li=ci.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),ci.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),ci.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new k;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),hi=function(t){return new li(t)},di=y.extend({initialize:function(t){l(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var n=this.options,i=n[e+"Size"];"number"==typeof i&&(i=[i,i]);var r=x(i),o=x("shadow"===e&&n.shadowAnchor||n.iconAnchor||r&&r.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return sn&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),fi=di.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return fi.imagePath||(fi.imagePath=this._detectIconPath()),(this.options.imagePath||fi.imagePath)+di.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=ct("div","leaflet-default-icon-path",document.body),e=st(t,"background-image")||st(t,"backgroundImage");return document.body.removeChild(t),e=null===e||0!==e.indexOf("url")?"":e.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,"")}}),pi=Zn.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Qn(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),pt(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&mt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var e=this._marker,n=e._shadow,i=St(e._icon),r=e._map.layerPointToLatLng(i);n&&wt(n,i),e._latlng=r,t.latlng=r,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),mi=si.extend({options:{icon:new fi,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},initialize:function(t,e){l(this,e),this._latlng=C(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=C(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,t.title&&(n.title=t.title),t.alt&&(n.alt=t.alt)),pt(n,e),t.keyboard&&(n.tabIndex="0"),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var r=t.icon.createShadow(this._shadow),o=!1;r!==this._shadow&&(this._removeShadow(),o=!0),r&&(pt(r,e),r.alt=""),this._shadow=r,t.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),r&&o&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),ut(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ut(this._shadow),this._shadow=null},_setPos:function(t){wt(this._icon,t),this._shadow&&wt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(pt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),pi)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new pi(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;yt(this._icon,t),this._shadow&&yt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),gi=si.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return l(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(rn?10:0)}}),vi=gi.extend({options:{fill:!0,radius:10},initialize:function(t,e){l(this,e),this._latlng=C(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=C(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return gi.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),i=[t+n,e+n];this._pxBounds=new w(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),yi=vi.extend({initialize:function(t,n,i){if("number"==typeof n&&(n=e({},i,{radius:n})),l(this,n),this._latlng=C(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new k(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:gi.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===Te.distance){var r=Math.PI/180,o=this._mRadius/Te.R/r,a=n.project([e+o,t]),s=n.project([e-o,t]),c=a.add(s).divideBy(2),u=n.unproject(c).lat,l=Math.acos((Math.cos(o*r)-Math.sin(e*r)*Math.sin(u*r))/(Math.cos(e*r)*Math.cos(u*r)))/r;(isNaN(l)||0===l)&&(l=o/Math.cos(Math.PI/180*e)),this._point=c.subtract(n.getPixelOrigin()),this._radius=isNaN(l)?0:Math.max(Math.round(c.x-n.project([u,t-l]).x),1),this._radiusY=Math.max(Math.round(c.y-a.y),1)}else{var h=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}}),bi=gi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){l(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,i=Infinity,r=null,o=zt,a=0,s=this._parts.length;a<s;a++)for(var c=this._parts[a],u=1,l=c.length;u<l;u++){var h=o(t,e=c[u-1],n=c[u],!0);h<i&&(i=h,r=o(t,e,n))}return r&&(r.distance=Math.sqrt(i)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,r,o,a,s=this._rings[0],c=s.length;if(!c)return null;for(t=0,e=0;t<c-1;t++)e+=s[t].distanceTo(s[t+1])/2;if(0===e)return this._map.layerPointToLatLng(s[0]);for(t=0,i=0;t<c-1;t++)if(r=s[t],o=s[t+1],n=r.distanceTo(o),(i+=n)>e)return a=(i-e)/n,this._map.layerPointToLatLng([o.x-a*(o.x-r.x),o.y-a*(o.y-r.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=C(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new k,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return jt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=jt(t),i=0,r=t.length;i<r;i++)n?(e[i]=C(t[i]),this._bounds.extend(e[i])):e[i]=this._convertLatLngs(t[i]);return e},_project:function(){var t=new w;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),n=new _(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(n),t.max._add(n),this._pxBounds=t)},_projectLatlngs:function(t,e,n){var i,r,o=t[0]instanceof T,a=t.length;if(o){for(r=[],i=0;i<a;i++)r[i]=this._map.latLngToLayerPoint(t[i]),n.extend(r[i]);e.push(r)}else for(i=0;i<a;i++)this._projectLatlngs(t[i],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],
this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,i,r,o,a,s,c=this._parts;for(e=0,i=0,r=this._rings.length;e<r;e++)for(n=0,o=(s=this._rings[e]).length;n<o-1;n++)(a=Ot(s[n],s[n+1],t,n,!0))&&(c[i]=c[i]||[],c[i].push(a[0]),a[1]===s[n+1]&&n!==o-2||(c[i].push(a[1]),i++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,i=t.length;n<i;n++)t[n]=Pt(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,i,r,o,a,s,c=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,o=this._parts.length;n<o;n++)for(i=0,r=(a=(s=this._parts[n]).length)-1;i<a;r=i++)if((e||0!==i)&&At(t,s[r],s[i])<=c)return!0;return!1}});bi._flat=Ht;var _i=bi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,r,o,a,s,c,u=this._rings[0],l=u.length;if(!l)return null;for(o=a=s=0,t=0,e=l-1;t<l;e=t++)n=u[t],i=u[e],r=n.y*i.x-i.y*n.x,a+=(n.x+i.x)*r,s+=(n.y+i.y)*r,o+=3*r;return c=0===o?u[0]:[a/o,s/o],this._map.layerPointToLatLng(c)},_convertLatLngs:function(t){var e=bi.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof T&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){bi.prototype._setLatLngs.call(this,t),jt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return jt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new _(e,e);if(t=new w(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var i,r=0,o=this._rings.length;r<o;r++)(i=$t(this._rings[r],t,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,i,r,o,a,s,c,u=!1;if(!this._pxBounds.contains(t))return!1;for(r=0,s=this._parts.length;r<s;r++)for(o=0,a=(c=(e=this._parts[r]).length)-1;o<c;a=o++)n=e[o],i=e[a],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(u=!u);return u||bi.prototype._containsPoint.call(this,t,!0)}}),xi=li.extend({initialize:function(t,e){l(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,r=ve(t)?t:t.features;if(r){for(e=0,n=r.length;e<n;e++)((i=r[e]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var o=this.options;if(o.filter&&!o.filter(t))return this;var a=Kt(t,o);return a?(a.feature=ee(t),a.defaultOptions=a.options,this.resetStyle(a),o.onEachFeature&&o.onEachFeature(t,a),this.addLayer(a)):this},resetStyle:function(t){return t.options=e({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),wi={toGeoJSON:function(t){return te(this,{type:"Point",coordinates:Qt(this.getLatLng(),t)})}};mi.include(wi),yi.include(wi),vi.include(wi),bi.include({toGeoJSON:function(t){var e=!jt(this._latlngs),n=Jt(this._latlngs,e?1:0,!1,t);return te(this,{type:(e?"Multi":"")+"LineString",coordinates:n})}}),_i.include({toGeoJSON:function(t){var e=!jt(this._latlngs),n=e&&!jt(this._latlngs[0]),i=Jt(this._latlngs,n?2:e?1:0,!0,t);return e||(i=[i]),te(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),ci.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(n){e.push(n.toGeoJSON(t).geometry.coordinates)}),te(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,i=[];return this.eachLayer(function(e){if(e.toGeoJSON){var r=e.toGeoJSON(t);if(n)i.push(r.geometry);else{var o=ee(r);"FeatureCollection"===o.type?i.push.apply(i,o.features):i.push(o)}}}),n?te(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var Si=ne,ki=si.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=E(e),l(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(pt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ut(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ht(this._image),this},bringToBack:function(){return this._map&&dt(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=E(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._image=ct("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":"")+(this.options.className||""));t.onselectstart=a,t.onmousemove=a,t.onload=n(this.fire,this,"load"),t.onerror=n(this._overlayOnError,this,"error"),this.options.crossOrigin&&(t.crossOrigin=""),this.options.zIndex&&this._updateZIndex(),t.src=this._url,t.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;xt(this._image,n,e)},_reset:function(){var t=this._image,e=new w(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();wt(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){yt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==undefined&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Ei=function(t,e,n){return new ki(t,e,n)},Ti=ki.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:ct("video");if(e["class"]=e["class"]||"",e["class"]+="leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""),e.onselectstart=a,e.onmousemove=a,e.onloadeddata=n(this.fire,this,"load"),!t){ve(this._url)||(this._url=[this._url]),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop;for(var i=0;i<this._url.length;i++){var r=ct("source");r.src=this._url[i],e.appendChild(r)}}}}),Ci=si.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){l(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&yt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&yt(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(yt(this._container,0),this._removeTimeout=setTimeout(n(ut,undefined,this._container),200)):ut(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=C(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ht(this._container),this},bringToBack:function(){return this._map&&dt(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=x(this.options.offset),n=this._getAnchor();this._zoomAnimated?wt(this._container,t.add(n)):e=e.add(t).add(n);var i=this._containerBottom=-e.y,r=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=r+"px"}},_getAnchor:function(){return[0,0]}}),Li=Ci.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Ci.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof gi||this._source.on("preclick",K))},onRemove:function(t){Ci.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof gi||this._source.off("preclick",K))},getEvents:function(){var t=Ci.prototype.getEvents.call(this);return(this.options.closeOnClick!==undefined?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=ct("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=ct("div",t+"-content-wrapper",e);if(this._contentNode=ct("div",t+"-content",n),Y(n),X(this._contentNode),W(n,"contextmenu",K),this._tipContainer=ct("div",t+"-tip-container",e),this._tip=ct("div",t+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=ct("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",W(i,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,r=this.options.maxHeight,o="leaflet-popup-scrolled";r&&i>r?(e.height=r+"px",pt(t,o)):mt(t,o),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();wt(this._container,e.add(n))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(st(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,i=this._containerWidth,r=new _(this._containerLeft,-n-this._containerBottom);r._add(St(this._container));var o=t.layerPointToContainerPoint(r),a=x(this.options.autoPanPadding),s=x(this.options.autoPanPaddingTopLeft||a),c=x(this.options.autoPanPaddingBottomRight||a),u=t.getSize(),l=0,h=0;o.x+i+c.x>u.x&&(l=o.x+i-u.x+c.x),o.x-l-s.x<0&&(l=o.x-s.x),o.y+n+c.y>u.y&&(h=o.y+n-u.y+c.y),o.y-h-s.y<0&&(h=o.y-s.y),(l||h)&&t.fire("autopanstart").panBy([l,h])}},_onCloseButtonClick:function(t){this._close(),J(t)},_getAnchor:function(){return x(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Pi=function(t,e){return new Li(t,e)};On.mergeOptions({closePopupOnClick:!0}),On.include({openPopup:function(t,e,n){return t instanceof Li||(t=new Li(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),si.include({bindPopup:function(t,e){return t instanceof Li?(l(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new Li(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof si||(e=t,t=this),t instanceof li)for(var n in this._layers){t=this._layers[n];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(J(t),e instanceof gi?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Ai=Ci.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Ci.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Ci.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Ci.prototype.getEvents.call(this);return rn&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip"+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ct("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,n=this._container,i=e.latLngToContainerPoint(e.getCenter()),r=e.layerPointToContainerPoint(t),o=this.options.direction,a=n.offsetWidth,s=n.offsetHeight,c=x(this.options.offset),u=this._getAnchor();"top"===o?t=t.add(x(-a/2+c.x,-s+c.y+u.y,!0)):"bottom"===o?t=t.subtract(x(a/2-c.x,-c.y,!0)):"center"===o?t=t.subtract(x(a/2+c.x,s/2-u.y+c.y,!0)):"right"===o||"auto"===o&&r.x<i.x?(o="right",t=t.add(x(c.x+u.x,u.y-s/2+c.y,!0))):(o="left",t=t.subtract(x(a+u.x-c.x,s/2-u.y-c.y,!0))),mt(n,"leaflet-tooltip-right"),mt(n,"leaflet-tooltip-left"),mt(n,"leaflet-tooltip-top"),mt(n,"leaflet-tooltip-bottom"),pt(n,"leaflet-tooltip-"+o),wt(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&yt(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return x(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ni=function(t,e){return new Ai(t,e)};On.include({openTooltip:function(t,e,n){return t instanceof Ai||(t=new Ai(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),si.include({bindTooltip:function(t,e){return t instanceof Ai?(l(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new Ai(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),rn&&(n.click=this._openTooltip)),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof si||(e=t,t=this),t instanceof li)for(var n in this._layers){t=this._layers[n];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(pt(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(mt(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:undefined)},_moveTooltip:function(t){var e,n,i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var Ri=di.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=x(n.bgPos);e.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});di.Default=fi;var Ii=si.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Qe,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:undefined,maxNativeZoom:undefined,minNativeZoom:undefined,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){l(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ut(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(ht(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(dt(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=r(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof _?t:new _(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==undefined&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,i=-t(-Infinity,Infinity),r=0,o=n.length;r<o;r++)e=n[r].style.zIndex,n[r]!==this._container&&e&&(i=t(i,+e));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Be){yt(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var i in this._tiles){var r=this._tiles[i];if(r.current&&r.loaded){var o=Math.min(1,(t-r.loaded)/200);yt(r.el,o),o<1?e=!0:(r.active?n=!0:this._onOpaqueTile(r),r.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(v(this._fadeFrame),this._fadeFrame=g(this._updateOpacity,this))}},_onOpaqueTile:a,_initContainer:function(){this._container||(this._container=ct("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t===undefined)return undefined;for(var n in this._levels)this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(ut(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[t],r=this._map;return i||((i=this._levels[t]={}).el=ct("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=e,i.origin=r.project(r.unproject(r.getPixelOrigin()),t).round(),i.zoom=t,this._setZoomTransform(i,r.getCenter(),r.getZoom()),a(i.el.offsetWidth),this._onCreateLevel(i)),this._level=i,i},_onUpdateLevel:a,_onRemoveLevel:a,_onCreateLevel:a,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ut(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(t,e,n,i){var r=Math.floor(t/2),o=Math.floor(e/2),a=n-1,s=new _(+r,+o);s.z=+a;var c=this._tileCoordsToKey(s),u=this._tiles[c];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),a>i&&this._retainParent(r,o,a,i))},_retainChildren:function(t,e,n,i){for(var r=2*t;r<2*t+2;r++)for(var o=2*e;o<2*e+2;o++){var a=new _(r,o);a.z=n+1;var s=this._tileCoordsToKey(a),c=this._tiles[s];c&&c.active?c.retain=!0:(c&&c.loaded&&(c.retain=!0),n+1<i&&this._retainChildren(r,o,n+1,i))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return undefined!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:undefined!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,i){var r=this._clampZoom(Math.round(e));(this.options.maxZoom!==undefined&&r>this.options.maxZoom||this.options.minZoom!==undefined&&r<this.options.minZoom)&&(r=undefined);var o=this.options.updateWhenZooming&&r!==this._tileZoom;i&&!o||(this._tileZoom=r,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),r!==undefined&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var i=this._map.getZoomScale(n,t.zoom),r=t.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(e,n)).round();Ye?xt(t.el,r,i):wt(t.el,r)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,r=this._map.getPixelWorldBounds(this._tileZoom);r&&(this._globalTileRange=this._pxBoundsToTileRange(r)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],i).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],i).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],i).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),i=e.getZoomScale(n,this._tileZoom),r=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*i);return new w(r.subtract(o),r.add(o))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(t===undefined&&(t=e.getCenter()),this._tileZoom!==undefined){var i=this._getTiledPixelBounds(t),r=this._pxBoundsToTileRange(i),o=r.getCenter(),a=[],s=this.options.keepBuffer,c=new w(r.getBottomLeft().subtract([s,-s]),r.getTopRight().add([s,-s]));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var u in this._tiles){var l=this._tiles[u].coords;l.z===this._tileZoom&&c.contains(new _(l.x,l.y))||(this._tiles[u].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(t,n);else{for(var h=r.min.y;h<=r.max.y;h++)for(var d=r.min.x;d<=r.max.x;d++){var f=new _(d,h);f.z=this._tileZoom,this._isValidTile(f)&&(this._tiles[this._tileCoordsToKey(f)]||a.push(f))}if(a.sort(function(t,e){return t.distanceTo(o)-e.distanceTo(o)}),0!==a.length){this._loading||(this._loading=!0,this.fire("loading"));var p=document.createDocumentFragment();for(d=0;d<a.length;d++)this._addTile(a[d],p);this._level.el.appendChild(p)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return E(this.options.bounds).overlaps(i)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToBounds:function(t){var e=this._map,n=this.getTileSize(),i=t.scaleBy(n),r=i.add(n),o=new k(e.unproject(i,t.z),e.unproject(r,t.z));return this.options.noWrap||e.wrapLatLngBounds(o),o},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new _(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(ut(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){pt(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=a,t.onmousemove=a,Be&&this.options.opacity<1&&yt(t,this.options.opacity),ze&&!je&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),r=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),n(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&g(n(this._tileReady,this,t,null,o)),wt(o,i),this._tiles[r]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,i){if(this._map){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var r=this._tileCoordsToKey(t);(i=this._tiles[r])&&(i.loaded=+new Date,this._map._fadeAnimated?(yt(i.el,0),v(this._fadeFrame),this._fadeFrame=g(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(pt(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Be||!this._map._fadeAnimated?g(this._pruneTiles,this):setTimeout(n(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new _(this._wrapX?o(t.x,this._wrapX):t.x,this._wrapY?o(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new w(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),Di=Ii.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=l(this,e)).detectRetina&&sn&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),ze||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return W(i,"load",n(this._tileOnLoad,this,e,i)),W(i,"error",n(this._tileOnError,this,e,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",i.setAttribute("role","presentation"),i.src=this.getTileUrl(t),i},getTileUrl:function(t){var n={r:sn?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(n.y=i),n["-y"]=i}return d(this._url,e(n,this.options))},_tileOnLoad:function(t,e){Be?setTimeout(n(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var i=this.options.errorTileUrl;i&&e.src!==i&&(e.src=i),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,n=this.options.zoomReverse,i=this.options.zoomOffset;return n&&(t=e-t),t+i},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=a,e.onerror=a,e.complete||(e.src=ye,ut(e)))}}),Oi=Di.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,n){this._url=t;var i=e({},this.defaultWmsParams);for(var r in n)r in this.options||(i[r]=n[r]);n=l(this,n),i.width=i.height=n.tileSize*(n.detectRetina&&sn?2:1),this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,Di.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToBounds(t),n=this._crs.project(e.getNorthWest()),i=this._crs.project(e.getSouthEast()),r=(this._wmsVersion>=1.3&&this._crs===oi?[i.y,n.x,n.y,i.x]:[n.x,i.y,i.x,n.y]).join(","),o=Di.prototype.getTileUrl.call(this,t);return o+h(this.wmsParams,o,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+r},setParams:function(t,n){return e(this.wmsParams,t),n||this.redraw(),this}});Di.WMS=Oi,ae.wms=se;var Bi=si.extend({options:{padding:.1},initialize:function(t){l(this,t),i(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&pt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){
var n=this._map.getZoomScale(e,this._zoom),i=St(this._container),r=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),a=this._map.project(t,e).subtract(o),s=r.multiplyBy(-n).add(i).add(r).subtract(a);Ye?xt(this._container,s,n):wt(this._container,s)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new w(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Mi=Bi.extend({getEvents:function(){var t=Bi.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Bi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");W(t,"mousemove",r(this._onMouseMove,32,this),this),W(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),W(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){delete this._ctx,ut(this._container),V(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){this._redrawBounds=null;for(var t in this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},Bi.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=sn?2:1;wt(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",sn&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){Bi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[i(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,i=e.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete t._order,delete this._layers[L.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,n=t.options.dashArray.split(","),i=[];for(e=0;e<n.length;e++)i.push(Number(n[e]));t.options._dashArray=i}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||g(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new w,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)t=i.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,i,r,o,a=t._parts,s=a.length,c=this._ctx;if(s){for(this._drawnLayers[t._leaflet_id]=t,c.beginPath(),n=0;n<s;n++){for(i=0,r=a[n].length;i<r;i++)o=a[n][i],c[i?"lineTo":"moveTo"](o.x,o.y);e&&c.closePath()}this._fillStroke(c,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,i=t._radius,r=(t._radiusY||i)/i;this._drawnLayers[t._leaflet_id]=t,1!==r&&(n.save(),n.scale(1,r)),n.beginPath(),n.arc(e.x,e.y/r,i,0,2*Math.PI,!1),1!==r&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,i=this._map.mouseEventToLayerPoint(t),r=this._drawFirst;r;r=r.next)(e=r.layer).options.interactive&&e._containsPoint(i)&&!this._map._draggableMoved(e)&&(n=e);n&&(nt(t),this._fireEvent([n],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(mt(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var n,i,r=this._drawFirst;r;r=r.next)(n=r.layer).options.interactive&&n._containsPoint(e)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(t),i&&(pt(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseover"),this._hoveredLayer=i)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order,n=e.next,i=e.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,n=e.next,i=e.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}),Fi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),zi={_initContainer:function(){this._container=ct("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Bi.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=Fi("shape");pt(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=Fi("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[i(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;ut(e),t.removeInteractiveTarget(e),delete this._layers[i(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,i=t.options,r=t._container;r.stroked=!!i.stroke,r.filled=!!i.fill,i.stroke?(e||(e=t._stroke=Fi("stroke")),r.appendChild(e),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray?e.dashStyle=ve(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=i.lineCap.replace("butt","flat"),e.joinstyle=i.lineJoin):e&&(r.removeChild(e),t._stroke=null),i.fill?(n||(n=t._fill=Fi("fill")),r.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(r.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),i=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+i+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ht(t._container)},_bringToBack:function(t){dt(t._container)}},ji=ln?Fi:N,Hi=Bi.extend({getEvents:function(){var t=Bi.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=ji("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ji("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ut(this._container),V(this._container),delete this._container,delete this._rootGroup},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){Bi.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),wt(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=ji("path");t.options.className&&pt(e,t.options.className),t.options.interactive&&pt(e,"leaflet-interactive"),this._updateStyle(t),this._layers[i(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ut(t._path),t.removeInteractiveTarget(t._path),delete this._layers[i(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,R(t._parts,e))},_updateCircle:function(t){var e=t._point,n=t._radius,i="a"+n+","+(t._radiusY||n)+" 0 1,0 ",r=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(t,r)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ht(t._path)},_bringToBack:function(t){dt(t._path)}});ln&&Hi.include(zi),On.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&ce()||ue()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||t===undefined)return!1;var e=this._paneRenderers[t];return e===undefined&&(e=Hi&&ue({pane:t})||Mi&&ce({pane:t}),this._paneRenderers[t]=e),e}});var $i=_i.extend({initialize:function(t,e){_i.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=E(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});Hi.create=ji,Hi.pointsToPath=R,xi.geometryToLayer=Kt,xi.coordsToLatLng=Xt,xi.coordsToLatLngs=Yt,xi.latLngToCoords=Qt,xi.latLngsToCoords=Jt,xi.getFeature=te,xi.asFeature=ee,On.mergeOptions({boxZoom:!0});var Ui=Zn.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){W(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){V(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ut(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Pe(),kt(),this._startPoint=this._map.mouseEventToContainerPoint(t),W(document,{contextmenu:J,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ct("div","leaflet-zoom-box",this._container),pt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new w(this._point,this._startPoint),n=e.getSize();wt(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(ut(this._box),mt(this._container,"leaflet-crosshair")),Ae(),Et(),V(document,{contextmenu:J,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(n(this._resetState,this),0);var e=new k(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});On.addInitHook("addHandler","boxZoom",Ui),On.mergeOptions({doubleClickZoom:!0});var qi=Zn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),i=e.options.zoomDelta,r=t.originalEvent.shiftKey?n-i:n+i;"center"===e.options.doubleClickZoom?e.setZoom(r):e.setZoomAround(t.containerPoint,r)}});On.addInitHook("addHandler","doubleClickZoom",qi),On.mergeOptions({dragging:!0,inertia:!je,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Wi=Zn.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new Qn(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}pt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){mt(this._map._container,"leaflet-grab"),mt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=E(this._map.options.maxBounds);this._offsetLimit=S(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),e-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",t).fire("drag",t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,r=(i-e+n)%t+e-n,o=(i+e+n)%t-e-n,a=Math.abs(r+n)<Math.abs(o+n)?r:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=a},_onDragEnd:function(t){var e=this._map,n=e.options,i=!n.inertia||this._times.length<2;if(e.fire("dragend",t),i)e.fire("moveend");else{var r=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,a=n.easeLinearity,s=r.multiplyBy(a/o),c=s.distanceTo([0,0]),u=Math.min(n.inertiaMaxSpeed,c),l=s.multiplyBy(u/c),h=u/(n.inertiaDeceleration*a),d=l.multiplyBy(-h/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),g(function(){e.panBy(d,{duration:h,easeLinearity:a,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}});On.addInitHook("addHandler","dragging",Wi),On.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Vi=Zn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),W(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),V(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,i=this._panKeys={},r=this.keyCodes;for(e=0,n=r.left.length;e<n;e++)i[r.left[e]]=[-1*t,0];for(e=0,n=r.right.length;e<n;e++)i[r.right[e]]=[t,0];for(e=0,n=r.down.length;e<n;e++)i[r.down[e]]=[0,t];for(e=0,n=r.up.length;e<n;e++)i[r.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,i=this._zoomKeys={},r=this.keyCodes;for(e=0,n=r.zoomIn.length;e<n;e++)i[r.zoomIn[e]]=t;for(e=0,n=r.zoomOut.length;e<n;e++)i[r.zoomOut[e]]=-t},_addHooks:function(){W(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){V(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,i=this._map;if(n in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;e=this._panKeys[n],t.shiftKey&&(e=x(e).multiplyBy(3)),i.panBy(e),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup)return;i.closePopup()}J(t)}}});On.addInitHook("addHandler","keyboard",Vi),On.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Zi=Zn.extend({addHooks:function(){W(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){V(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=et(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var r=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(n(this._performZoom,this),r),J(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),r=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,o=n?Math.ceil(r/n)*n:r,a=t._limitZoom(e+(this._delta>0?o:-o))-e;this._delta=0,this._startTime=null,a&&("center"===t.options.scrollWheelZoom?t.setZoom(e+a):t.setZoomAround(this._lastMousePos,e+a))}});On.addInitHook("addHandler","scrollWheelZoom",Zi),On.mergeOptions({tap:!0,tapTolerance:15});var Gi=Zn.extend({addHooks:function(){W(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){V(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(Q(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new _(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&pt(i,"leaflet-active"),this._holdTimeout=setTimeout(n(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),W(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),V(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&mt(n,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new _(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var n=document.createEvent("MouseEvents");n._simulated=!0,e.target._simulatedClick=!0,n.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}});rn&&!nn&&On.addInitHook("addHandler","tap",Gi),On.mergeOptions({touchZoom:rn&&!je,bounceAtZoomLimits:!0});var Ki=Zn.extend({addHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),W(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){mt(this._map._container,"leaflet-touch-zoom"),V(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),W(document,"touchmove",this._onTouchMove,this),W(document,"touchend",this._onTouchEnd,this),Q(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),r=e.mouseEventToContainerPoint(t.touches[1]),o=i.distanceTo(r)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var a=i._add(r)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===a.x&&0===a.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(a),this._zoom)}this._moved||(e._moveStart(!0),this._moved=!0),v(this._animRequest);var s=n(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=g(s,this,!0),Q(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,v(this._animRequest),V(document,"touchmove",this._onTouchMove),V(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});On.addInitHook("addHandler","touchZoom",Ki),On.BoxZoom=Ui,On.DoubleClickZoom=qi,On.Drag=Wi,On.Keyboard=Vi,On.ScrollWheelZoom=Zi,On.Tap=Gi,On.TouchZoom=Ki;var Xi=window.L;window.L=t,Object.freeze=fe,t.version=de,t.noConflict=he,t.Control=Bn,t.control=Mn,t.Browser=hn,t.Evented=ke,t.Mixin=Gn,t.Util=we,t.Class=y,t.Handler=Zn,t.extend=e,t.bind=n,t.stamp=i,t.setOptions=l,t.DomEvent=Tn,t.DomUtil=In,t.PosAnimation=Dn,t.Draggable=Qn,t.LineUtil=Jn,t.PolyUtil=ti,t.Point=_,t.point=x,t.Bounds=w,t.bounds=S,t.Transformation=P,t.transformation=A,t.Projection=ii,t.LatLng=T,t.latLng=C,t.LatLngBounds=k,t.latLngBounds=E,t.CRS=Ee,t.GeoJSON=xi,t.geoJSON=ne,t.geoJson=Si,t.Layer=si,t.LayerGroup=ci,t.layerGroup=ui,t.FeatureGroup=li,t.featureGroup=hi,t.ImageOverlay=ki,t.imageOverlay=Ei,t.VideoOverlay=Ti,t.videoOverlay=ie,t.DivOverlay=Ci,t.Popup=Li,t.popup=Pi,t.Tooltip=Ai,t.tooltip=Ni,t.Icon=di,t.icon=Ut,t.DivIcon=Ri,t.divIcon=re,t.Marker=mi,t.marker=qt,t.TileLayer=Di,t.tileLayer=ae,t.GridLayer=Ii,t.gridLayer=oe,t.SVG=Hi,t.svg=ue,t.Renderer=Bi,t.Canvas=Mi,t.canvas=ce,t.Path=gi,t.CircleMarker=vi,t.circleMarker=Wt,t.Circle=yi,t.circle=Vt,t.Polyline=bi,t.polyline=Zt,t.Polygon=_i,t.polygon=Gt,t.Rectangle=$i,t.rectangle=le,t.Map=On,t.map=Lt}),L.Icon.Default=L.Icon.Default.extend({_getIconUrl:function(t){return{"icon-2x.png":"/assets/marker-icon-2x-2d77a2e4c2f08bbac41808324ef946b9a2fe61b6150480d011b72b379c3b238d.png","shadow.png":"/assets/marker-shadow-264f5c640339f042dd729062cfc04c17f8ea0f29882b538e3848ed8f10edb4da.png","icon.png":"/assets/marker-icon-574c3a5cca85f4114085b6841596d62f00d7c892c7b03f28cbfa301deb1dc437.png"}[t+".png"]},_detectIconPath:function(){return""}}),L.Marker=L.Marker.extend({options:{icon:new L.Icon.Default}}),L.marker=function(t,e){return new L.Marker(t,e)},L.TileLayer.Iiif=L.TileLayer.extend({options:{continuousWorld:!0,tileSize:256,updateWhenIdle:!0,tileFormat:"jpg",fitBounds:!0},initialize:function(t,e){(e=void 0!==e?e:{}).maxZoom&&(this._customMaxZoom=!0),e.tileSize&&(this._explicitTileSize=!0),e=L.setOptions(this,e),this._infoDeferred=new $.Deferred,this._infoUrl=t,this._baseUrl=this._templateUrl(),this._getInfo()},getTileUrl:function(t){var e=this,n=t.x,i=t.y,r=e._getZoomForUrl(),o=Math.pow(2,e.maxNativeZoom-r),a=e.options.tileSize*o,s=n*a,c=i*a,u=Math.min(s+a,e.x)-s,l=Math.min(c+a,e.y)-c;return L.Util.template(this._baseUrl,L.extend({format:e.options.tileFormat,quality:e.quality,region:[s,c,u,l].join(","),rotation:0,size:Math.ceil(u/o)+","},this.options))},onAdd:function(t){var e=this;$.when(e._infoDeferred).done(function(){t._layersMaxZoom=e.maxZoom,L.TileLayer.prototype.onAdd.call(e,t),e.options.fitBounds&&e._fitBounds(),e.on("tileload",function(t){var e=t.tile.naturalHeight,n=t.tile.naturalWidth;256===e&&256===n||(t.tile.style.width=n+"px",t.tile.style.height=e+"px")})})},_fitBounds:function(){var t=this,e=t._getInitialZoom(t._map.getSize()),n=t._imageSizes[e],i=t._map.options.crs.pointToLatLng(L.point(0,n.y),e),r=t._map.options.crs.pointToLatLng(L.point(n.x,0),e),o=L.latLngBounds(i,r);t._map.fitBounds(o,!0)},_getInfo:function(){var t=this;$.getJSON(t._infoUrl).done(function(e){t.y=e.height,t.x=e.width;var n,i,r,o,a,s=[],c=[];e.profile instanceof Array?t.profile=e.profile[0]:t.profile=e.profile,t._setQuality(),t._explicitTileSize||(t.options.tileSize=256,e.tiles?t.options.tileSize=e.tiles[0].width:e.tile_width&&(t.options.tileSize=e.tile_width)),ceilLog2=function(t){return Math.ceil(Math.log(t)/Math.LN2)},t.maxNativeZoom=Math.max(ceilLog2(t.x/t.options.tileSize),ceilLog2(t.y/t.options.tileSize)),t._customMaxZoom&&t.options.maxZoom>t.maxNativeZoom?t.maxZoom=t.options.maxZoom:t.maxZoom=t.maxNativeZoom;for(var u=0;u<=t.maxZoom;u++)n=Math.pow(2,t.maxNativeZoom-u),i=Math.ceil(t.x/n),r=Math.ceil(t.y/n),o=Math.ceil(i/t.options.tileSize),a=Math.ceil(r/t.options.tileSize),s.push([o,a]),c.push(L.point(i,r));t._tierSizes=s,t._imageSizes=c,t._infoDeferred.resolve()})},_setQuality:function(){var t=this;if(!t.options.quality)switch(!0){case/^http:\/\/library.stanford.edu\/iiif\/image-api\/1.1\/compliance.html.*$/.test(t.profile):t.options.quality="native";break;case/^http:\/\/iiif.io\/api\/image\/2.*$/.test(t.profile):t.options.quality="default"}},_infoToBaseUrl:function(){return this._infoUrl.replace("info.json","")},_templateUrl:function(){return this._infoToBaseUrl()+"{region}/{size}/{rotation}/{quality}.{format}"},_isValidTile:function(t){var e=this,n=e._getZoomForUrl(),i=e._tierSizes[n],r=t.x,o=t.y;return!!i&&!(r<0||i[0]<=r||o<0||i[1]<=o)},_getInitialZoom:function(t){for(var e,n=.8,i=this.maxNativeZoom;i>=0;i--)if((e=this._imageSizes[i]).x*n<t.x&&e.y*n<t.y)return i;return 2}}),L.tileLayer.iiif=function(t,e){return new L.TileLayer.Iiif(t,e)},function(t,e){"function"==typeof define&&define.amd?define(["leaflet"],t):"object"==typeof exports&&(module.exports=t(require("leaflet"))),void 0!==e&&e.L&&t(e.L)}(function(t){t.Editable=t.Evented.extend({statics:{FORWARD:1,BACKWARD:-1},options:{zIndex:1e3,polygonClass:t.Polygon,polylineClass:t.Polyline,markerClass:t.Marker,rectangleClass:t.Rectangle,circleClass:t.Circle,drawingCSSClass:"leaflet-editable-drawing",drawingCursor:"crosshair",editLayer:undefined,featuresLayer:undefined,polylineEditorClass:undefined,polygonEditorClass:undefined,markerEditorClass:undefined,rectangleEditorClass:undefined,circleEditorClass:undefined,lineGuideOptions:{},skipMiddleMarkers:!1},initialize:function(e,n){t.setOptions(this,n),this._lastZIndex=this.options.zIndex,this.map=e,this.editLayer=this.createEditLayer(),this.featuresLayer=this.createFeaturesLayer(),this.forwardLineGuide=this.createLineGuide(),this.backwardLineGuide=this.createLineGuide()},fireAndForward:function(t,e){(e=e||{}).editTools=this,this.fire(t,e),this.map.fire(t,e)},createLineGuide:function(){var e=t.extend({dashArray:"5,10",weight:1,interactive:!1},this.options.lineGuideOptions);return t.polyline([],e)},createVertexIcon:function(e){return t.Browser.touch?new t.Editable.TouchVertexIcon(e):new t.Editable.VertexIcon(e)},createEditLayer:function(){return this.options.editLayer||(new t.LayerGroup).addTo(this.map)},createFeaturesLayer:function(){return this.options.featuresLayer||(new t.LayerGroup).addTo(this.map)},moveForwardLineGuide:function(t){this.forwardLineGuide._latlngs.length&&(this.forwardLineGuide._latlngs[1]=t,this.forwardLineGuide._bounds.extend(t),this.forwardLineGuide.redraw())},moveBackwardLineGuide:function(t){this.backwardLineGuide._latlngs.length&&(this.backwardLineGuide._latlngs[1]=t,this.backwardLineGuide._bounds.extend(t),this.backwardLineGuide.redraw())},anchorForwardLineGuide:function(t){this.forwardLineGuide._latlngs[0]=t,this.forwardLineGuide._bounds.extend(t),this.forwardLineGuide.redraw()},anchorBackwardLineGuide:function(t){this.backwardLineGuide._latlngs[0]=t,this.backwardLineGuide._bounds.extend(t),this.backwardLineGuide.redraw()},attachForwardLineGuide:function(){this.editLayer.addLayer(this.forwardLineGuide)},attachBackwardLineGuide:function(){this.editLayer.addLayer(this.backwardLineGuide)},detachForwardLineGuide:function(){this.forwardLineGuide.setLatLngs([]),this.editLayer.removeLayer(this.forwardLineGuide)},detachBackwardLineGuide:function(){this.backwardLineGuide.setLatLngs([]),this.editLayer.removeLayer(this.backwardLineGuide)},blockEvents:function(){this._oldTargets||(this._oldTargets=this.map._targets,this.map._targets={})},unblockEvents:function(){this._oldTargets&&(this.map._targets=t.extend(this.map._targets,this._oldTargets),delete this._oldTargets)},registerForDrawing:function(e){this._drawingEditor&&this.unregisterForDrawing(this._drawingEditor),this.blockEvents(),e.reset(),this._drawingEditor=e,this.map.on("mousemove touchmove",e.onDrawingMouseMove,e),this.map.on("mousedown",this.onMousedown,this),this.map.on("mouseup",this.onMouseup,this),t.DomUtil.addClass(this.map._container,this.options.drawingCSSClass),this.defaultMapCursor=this.map._container.style.cursor,this.map._container.style.cursor=this.options.drawingCursor},unregisterForDrawing:function(e){this.unblockEvents(),t.DomUtil.removeClass(this.map._container,this.options.drawingCSSClass),this.map._container.style.cursor=this.defaultMapCursor,(e=e||this._drawingEditor)&&(this.map.off("mousemove touchmove",e.onDrawingMouseMove,e),this.map.off("mousedown",this.onMousedown,this),this.map.off("mouseup",this.onMouseup,this),e===this._drawingEditor&&(delete this._drawingEditor,e._drawing&&e.cancelDrawing()))},onMousedown:function(t){this._mouseDown=t,this._drawingEditor.onDrawingMouseDown(t)},onMouseup:function(e){if(this._mouseDown){var n=this._drawingEditor,i=this._mouseDown;if(this._mouseDown=null,n.onDrawingMouseUp(e),this._drawingEditor!==n)return
;var r=t.point(i.originalEvent.clientX,i.originalEvent.clientY),o=t.point(e.originalEvent.clientX,e.originalEvent.clientY).distanceTo(r);Math.abs(o)<9*(window.devicePixelRatio||1)&&this._drawingEditor.onDrawingClick(e)}},drawing:function(){return this._drawingEditor&&this._drawingEditor.drawing()},stopDrawing:function(){this.unregisterForDrawing()},commitDrawing:function(t){this._drawingEditor&&this._drawingEditor.commitDrawing(t)},connectCreatedToMap:function(t){return this.featuresLayer.addLayer(t)},startPolyline:function(t,e){var n=this.createPolyline([],e);return n.enableEdit(this.map).newShape(t),n},startPolygon:function(t,e){var n=this.createPolygon([],e);return n.enableEdit(this.map).newShape(t),n},startMarker:function(t,e){t=t||this.map.getCenter().clone();var n=this.createMarker(t,e);return n.enableEdit(this.map).startDrawing(),n},startRectangle:function(e,n){var i=e||t.latLng([0,0]),r=new t.LatLngBounds(i,i),o=this.createRectangle(r,n);return o.enableEdit(this.map).startDrawing(),o},startCircle:function(t,e){t=t||this.map.getCenter().clone();var n=this.createCircle(t,e);return n.enableEdit(this.map).startDrawing(),n},startHole:function(t,e){t.newHole(e)},createLayer:function(e,n,i){var r=new e(n,i=t.Util.extend({editOptions:{editTools:this}},i));return this.fireAndForward("editable:created",{layer:r}),r},createPolyline:function(t,e){return this.createLayer(e&&e.polylineClass||this.options.polylineClass,t,e)},createPolygon:function(t,e){return this.createLayer(e&&e.polygonClass||this.options.polygonClass,t,e)},createMarker:function(t,e){return this.createLayer(e&&e.markerClass||this.options.markerClass,t,e)},createRectangle:function(t,e){return this.createLayer(e&&e.rectangleClass||this.options.rectangleClass,t,e)},createCircle:function(t,e){return this.createLayer(e&&e.circleClass||this.options.circleClass,t,e)}}),t.extend(t.Editable,{makeCancellable:function(t){t.cancel=function(){t._cancelled=!0}}}),t.Map.mergeOptions({editToolsClass:t.Editable,editable:!1,editOptions:{}}),t.Map.addInitHook(function(){this.whenReady(function(){this.options.editable&&(this.editTools=new this.options.editToolsClass(this,this.options.editOptions))})}),t.Editable.VertexIcon=t.DivIcon.extend({options:{iconSize:new t.Point(8,8)}}),t.Editable.TouchVertexIcon=t.Editable.VertexIcon.extend({options:{iconSize:new t.Point(20,20)}}),t.Editable.VertexMarker=t.Marker.extend({options:{draggable:!0,className:"leaflet-div-icon leaflet-vertex-icon"},initialize:function(e,n,i,r){this.latlng=e,this.latlngs=n,this.editor=i,t.Marker.prototype.initialize.call(this,e,r),this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.latlng.__vertex=this,this.editor.editLayer.addLayer(this),this.setZIndexOffset(i.tools._lastZIndex+1)},onAdd:function(e){t.Marker.prototype.onAdd.call(this,e),this.on("drag",this.onDrag),this.on("dragstart",this.onDragStart),this.on("dragend",this.onDragEnd),this.on("mouseup",this.onMouseup),this.on("click",this.onClick),this.on("contextmenu",this.onContextMenu),this.on("mousedown touchstart",this.onMouseDown),this.addMiddleMarkers()},onRemove:function(e){this.middleMarker&&this.middleMarker["delete"](),delete this.latlng.__vertex,this.off("drag",this.onDrag),this.off("dragstart",this.onDragStart),this.off("dragend",this.onDragEnd),this.off("mouseup",this.onMouseup),this.off("click",this.onClick),this.off("contextmenu",this.onContextMenu),this.off("mousedown touchstart",this.onMouseDown),t.Marker.prototype.onRemove.call(this,e)},onDrag:function(e){e.vertex=this,this.editor.onVertexMarkerDrag(e);var n=t.DomUtil.getPosition(this._icon),i=this._map.layerPointToLatLng(n);this.latlng.update(i),this._latlng=this.latlng,this.editor.refresh(),this.middleMarker&&this.middleMarker.updateLatLng();var r=this.getNext();r&&r.middleMarker&&r.middleMarker.updateLatLng()},onDragStart:function(t){t.vertex=this,this.editor.onVertexMarkerDragStart(t)},onDragEnd:function(t){t.vertex=this,this.editor.onVertexMarkerDragEnd(t)},onClick:function(t){t.vertex=this,this.editor.onVertexMarkerClick(t)},onMouseup:function(e){t.DomEvent.stop(e),e.vertex=this,this.editor.map.fire("mouseup",e)},onContextMenu:function(t){t.vertex=this,this.editor.onVertexMarkerContextMenu(t)},onMouseDown:function(t){t.vertex=this,this.editor.onVertexMarkerMouseDown(t)},"delete":function(){var t=this.getNext();this.latlngs.splice(this.getIndex(),1),this.editor.editLayer.removeLayer(this),this.editor.onVertexDeleted({latlng:this.latlng,vertex:this}),this.latlngs.length||this.editor.deleteShape(this.latlngs),t&&t.resetMiddleMarker(),this.editor.refresh()},getIndex:function(){return this.latlngs.indexOf(this.latlng)},getLastIndex:function(){return this.latlngs.length-1},getPrevious:function(){if(!(this.latlngs.length<2)){var t=this.getIndex(),e=t-1;0===t&&this.editor.CLOSED&&(e=this.getLastIndex());var n=this.latlngs[e];return n?n.__vertex:void 0}},getNext:function(){if(!(this.latlngs.length<2)){var t=this.getIndex(),e=t+1;t===this.getLastIndex()&&this.editor.CLOSED&&(e=0);var n=this.latlngs[e];return n?n.__vertex:void 0}},addMiddleMarker:function(t){this.editor.hasMiddleMarkers()&&(t=t||this.getPrevious())&&!this.middleMarker&&(this.middleMarker=this.editor.addMiddleMarker(t,this,this.latlngs,this.editor))},addMiddleMarkers:function(){if(this.editor.hasMiddleMarkers()){var t=this.getPrevious();t&&this.addMiddleMarker(t);var e=this.getNext();e&&e.resetMiddleMarker()}},resetMiddleMarker:function(){this.middleMarker&&this.middleMarker["delete"](),this.addMiddleMarker()},split:function(){this.editor.splitShape&&this.editor.splitShape(this.latlngs,this.getIndex())},"continue":function(){if(this.editor.continueBackward){var t=this.getIndex();0===t?this.editor.continueBackward(this.latlngs):t===this.getLastIndex()&&this.editor.continueForward(this.latlngs)}}}),t.Editable.mergeOptions({vertexMarkerClass:t.Editable.VertexMarker}),t.Editable.MiddleMarker=t.Marker.extend({options:{opacity:.5,className:"leaflet-div-icon leaflet-middle-icon",draggable:!0},initialize:function(e,n,i,r,o){this.left=e,this.right=n,this.editor=r,this.latlngs=i,t.Marker.prototype.initialize.call(this,this.computeLatLng(),o),this._opacity=this.options.opacity,this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.editor.editLayer.addLayer(this),this.setVisibility()},setVisibility:function(){var e=this._map.latLngToContainerPoint(this.left.latlng),n=this._map.latLngToContainerPoint(this.right.latlng),i=t.point(this.options.icon.options.iconSize);e.distanceTo(n)<3*i.x?this.hide():this.show()},show:function(){this.setOpacity(this._opacity)},hide:function(){this.setOpacity(0)},updateLatLng:function(){this.setLatLng(this.computeLatLng()),this.setVisibility()},computeLatLng:function(){var t=this.editor.map.latLngToContainerPoint(this.left.latlng),e=this.editor.map.latLngToContainerPoint(this.right.latlng),n=(t.y+e.y)/2,i=(t.x+e.x)/2;return this.editor.map.containerPointToLatLng([i,n])},onAdd:function(e){t.Marker.prototype.onAdd.call(this,e),t.DomEvent.on(this._icon,"mousedown touchstart",this.onMouseDown,this),e.on("zoomend",this.setVisibility,this)},onRemove:function(e){delete this.right.middleMarker,t.DomEvent.off(this._icon,"mousedown touchstart",this.onMouseDown,this),e.off("zoomend",this.setVisibility,this),t.Marker.prototype.onRemove.call(this,e)},onMouseDown:function(e){var n=t.DomUtil.getPosition(this._icon);if(e={originalEvent:e,latlng:this.editor.map.layerPointToLatLng(n)},0!==this.options.opacity&&(t.Editable.makeCancellable(e),this.editor.onMiddleMarkerMouseDown(e),!e._cancelled)){this.latlngs.splice(this.index(),0,e.latlng),this.editor.refresh();var i=this._icon,r=this.editor.addVertexMarker(e.latlng,this.latlngs),o=r._icon.parentNode;o.removeChild(r._icon),r._icon=i,o.appendChild(r._icon),r._initIcon(),r._initInteraction(),r.setOpacity(1),t.Draggable._dragging=!1,r.dragging._draggable._onDown(e.originalEvent),this["delete"]()}},"delete":function(){this.editor.editLayer.removeLayer(this)},index:function(){return this.latlngs.indexOf(this.right.latlng)}}),t.Editable.mergeOptions({middleMarkerClass:t.Editable.MiddleMarker}),t.Editable.BaseEditor=t.Handler.extend({initialize:function(e,n,i){t.setOptions(this,i),this.map=e,this.feature=n,this.feature.editor=this,this.editLayer=new t.LayerGroup,this.tools=this.options.editTools||e.editTools},addHooks:function(){this.isConnected()?this.onFeatureAdd():this.feature.once("add",this.onFeatureAdd,this),this.onEnable(),this.feature.on(this._getEvents(),this)},removeHooks:function(){this.feature.off(this._getEvents(),this),this.feature.dragging&&this.feature.dragging.disable(),this.editLayer.clearLayers(),this.tools.editLayer.removeLayer(this.editLayer),this.onDisable(),this._drawing&&this.cancelDrawing()},drawing:function(){return!!this._drawing},reset:function(){},onFeatureAdd:function(){this.tools.editLayer.addLayer(this.editLayer),this.feature.dragging&&this.feature.dragging.enable()},hasMiddleMarkers:function(){return!this.options.skipMiddleMarkers&&!this.tools.options.skipMiddleMarkers},fireAndForward:function(t,e){(e=e||{}).layer=this.feature,this.feature.fire(t,e),this.tools.fireAndForward(t,e)},onEnable:function(){this.fireAndForward("editable:enable")},onDisable:function(){this.fireAndForward("editable:disable")},onEditing:function(){this.fireAndForward("editable:editing")},onStartDrawing:function(){this.fireAndForward("editable:drawing:start")},onEndDrawing:function(){this.fireAndForward("editable:drawing:end")},onCancelDrawing:function(){this.fireAndForward("editable:drawing:cancel")},onCommitDrawing:function(t){this.fireAndForward("editable:drawing:commit",t)},onDrawingMouseDown:function(t){this.fireAndForward("editable:drawing:mousedown",t)},onDrawingMouseUp:function(t){this.fireAndForward("editable:drawing:mouseup",t)},startDrawing:function(){this._drawing||(this._drawing=t.Editable.FORWARD),this.tools.registerForDrawing(this),this.onStartDrawing()},commitDrawing:function(t){this.onCommitDrawing(t),this.endDrawing()},cancelDrawing:function(){t.Draggable._dragging=!1,this.onCancelDrawing(),this.endDrawing()},endDrawing:function(){this._drawing=!1,this.tools.unregisterForDrawing(this),this.onEndDrawing()},onDrawingClick:function(e){this.drawing()&&(t.Editable.makeCancellable(e),this.fireAndForward("editable:drawing:click",e),e._cancelled||(this.isConnected()||this.connect(e),this.processDrawingClick(e)))},isConnected:function(){return this.map.hasLayer(this.feature)},connect:function(){this.tools.connectCreatedToMap(this.feature),this.tools.editLayer.addLayer(this.editLayer)},onMove:function(t){this.fireAndForward("editable:drawing:move",t)},onDrawingMouseMove:function(t){this.onMove(t)},_getEvents:function(){return{dragstart:this.onDragStart,drag:this.onDrag,dragend:this.onDragEnd,remove:this.disable}},onDragStart:function(t){this.onEditing(),this.fireAndForward("editable:dragstart",t)},onDrag:function(t){this.onMove(t),this.fireAndForward("editable:drag",t)},onDragEnd:function(t){this.fireAndForward("editable:dragend",t)}}),t.Editable.MarkerEditor=t.Editable.BaseEditor.extend({onDrawingMouseMove:function(e){t.Editable.BaseEditor.prototype.onDrawingMouseMove.call(this,e),this._drawing&&this.feature.setLatLng(e.latlng)},processDrawingClick:function(t){this.fireAndForward("editable:drawing:clicked",t),this.commitDrawing(t)},connect:function(e){e&&(this.feature._latlng=e.latlng),t.Editable.BaseEditor.prototype.connect.call(this,e)}}),t.Editable.PathEditor=t.Editable.BaseEditor.extend({CLOSED:!1,MIN_VERTEX:2,addHooks:function(){return t.Editable.BaseEditor.prototype.addHooks.call(this),this.feature&&this.initVertexMarkers(),this},initVertexMarkers:function(e){if(this.enabled())if(e=e||this.getLatLngs(),t.Polyline._flat(e))this.addVertexMarkers(e);else for(var n=0;n<e.length;n++)this.initVertexMarkers(e[n])},getLatLngs:function(){return this.feature.getLatLngs()},reset:function(){this.editLayer.clearLayers(),this.initVertexMarkers()},addVertexMarker:function(t,e){return new this.tools.options.vertexMarkerClass(t,e,this)},addVertexMarkers:function(t){for(var e=0;e<t.length;e++)this.addVertexMarker(t[e],t)},refreshVertexMarkers:function(t){t=t||this.getDefaultLatLngs();for(var e=0;e<t.length;e++)t[e].__vertex.update()},addMiddleMarker:function(t,e,n){return new this.tools.options.middleMarkerClass(t,e,n,this)},onVertexMarkerClick:function(e){if(t.Editable.makeCancellable(e),this.fireAndForward("editable:vertex:click",e),!(e._cancelled||this.tools.drawing()&&this.tools._drawingEditor!==this)){var n,i=e.vertex.getIndex();e.originalEvent.ctrlKey?this.onVertexMarkerCtrlClick(e):e.originalEvent.altKey?this.onVertexMarkerAltClick(e):e.originalEvent.shiftKey?this.onVertexMarkerShiftClick(e):e.originalEvent.metaKey?this.onVertexMarkerMetaKeyClick(e):i===e.vertex.getLastIndex()&&this._drawing===t.Editable.FORWARD?i>=this.MIN_VERTEX-1&&(n=!0):0===i&&this._drawing===t.Editable.BACKWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX?n=!0:0===i&&this._drawing===t.Editable.FORWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX&&this.CLOSED?n=!0:this.onVertexRawMarkerClick(e),this.fireAndForward("editable:vertex:clicked",e),n&&this.commitDrawing(e)}},onVertexRawMarkerClick:function(t){this.fireAndForward("editable:vertex:rawclick",t),t._cancelled||this.vertexCanBeDeleted(t.vertex)&&t.vertex["delete"]()},vertexCanBeDeleted:function(t){return t.latlngs.length>this.MIN_VERTEX},onVertexDeleted:function(t){this.fireAndForward("editable:vertex:deleted",t)},onVertexMarkerCtrlClick:function(t){this.fireAndForward("editable:vertex:ctrlclick",t)},onVertexMarkerShiftClick:function(t){this.fireAndForward("editable:vertex:shiftclick",t)},onVertexMarkerMetaKeyClick:function(t){this.fireAndForward("editable:vertex:metakeyclick",t)},onVertexMarkerAltClick:function(t){this.fireAndForward("editable:vertex:altclick",t)},onVertexMarkerContextMenu:function(t){this.fireAndForward("editable:vertex:contextmenu",t)},onVertexMarkerMouseDown:function(t){this.fireAndForward("editable:vertex:mousedown",t)},onMiddleMarkerMouseDown:function(t){this.fireAndForward("editable:middlemarker:mousedown",t)},onVertexMarkerDrag:function(t){this.onMove(t),this.feature._bounds&&this.extendBounds(t),this.fireAndForward("editable:vertex:drag",t)},onVertexMarkerDragStart:function(t){this.fireAndForward("editable:vertex:dragstart",t)},onVertexMarkerDragEnd:function(t){this.fireAndForward("editable:vertex:dragend",t)},setDrawnLatLngs:function(t){this._drawnLatLngs=t||this.getDefaultLatLngs()},startDrawing:function(){this._drawnLatLngs||this.setDrawnLatLngs(),t.Editable.BaseEditor.prototype.startDrawing.call(this)},startDrawingForward:function(){this.startDrawing()},endDrawing:function(){this.tools.detachForwardLineGuide(),this.tools.detachBackwardLineGuide(),this._drawnLatLngs&&this._drawnLatLngs.length<this.MIN_VERTEX&&this.deleteShape(this._drawnLatLngs),t.Editable.BaseEditor.prototype.endDrawing.call(this),delete this._drawnLatLngs},addLatLng:function(e){this._drawing===t.Editable.FORWARD?this._drawnLatLngs.push(e):this._drawnLatLngs.unshift(e),this.feature._bounds.extend(e),this.addVertexMarker(e,this._drawnLatLngs),this.refresh()},newPointForward:function(t){this.addLatLng(t),this.tools.attachForwardLineGuide(),this.tools.anchorForwardLineGuide(t)},newPointBackward:function(t){this.addLatLng(t),this.tools.anchorBackwardLineGuide(t)},push:function(e){if(!e)return console.error("L.Editable.PathEditor.push expect a vaild latlng as parameter");this._drawing===t.Editable.FORWARD?this.newPointForward(e):this.newPointBackward(e)},removeLatLng:function(t){t.__vertex["delete"](),this.refresh()},pop:function(){if(!(this._drawnLatLngs.length<=1)){var e;return e=this._drawing===t.Editable.FORWARD?this._drawnLatLngs[this._drawnLatLngs.length-1]:this._drawnLatLngs[0],this.removeLatLng(e),this._drawing===t.Editable.FORWARD?this.tools.anchorForwardLineGuide(this._drawnLatLngs[this._drawnLatLngs.length-1]):this.tools.anchorForwardLineGuide(this._drawnLatLngs[0]),e}},processDrawingClick:function(e){e.vertex&&e.vertex.editor===this||(this._drawing===t.Editable.FORWARD?this.newPointForward(e.latlng):this.newPointBackward(e.latlng),this.fireAndForward("editable:drawing:clicked",e))},onDrawingMouseMove:function(e){t.Editable.BaseEditor.prototype.onDrawingMouseMove.call(this,e),this._drawing&&(this.tools.moveForwardLineGuide(e.latlng),this.tools.moveBackwardLineGuide(e.latlng))},refresh:function(){this.feature.redraw(),this.onEditing()},newShape:function(t){var e=this.addNewEmptyShape();e&&(this.setDrawnLatLngs(e[0]||e),this.startDrawingForward(),this.fireAndForward("editable:shape:new",{shape:e}),t&&this.newPointForward(t))},deleteShape:function(e,n){var i={shape:e};if(t.Editable.makeCancellable(i),this.fireAndForward("editable:shape:delete",i),!i._cancelled)return e=this._deleteShape(e,n),this.ensureNotFlat&&this.ensureNotFlat(),this.feature.setLatLngs(this.getLatLngs()),this.refresh(),this.reset(),this.fireAndForward("editable:shape:deleted",{shape:e}),e},_deleteShape:function(t,e){if((e=e||this.getLatLngs()).length){var n=this,i=function(t,e){return t.splice(t.indexOf(e),1),t.length||n._deleteShape(t),e};if(e===t)return function(t){return t.splice(0,Number.MAX_VALUE)}(e,t);for(var r=0;r<e.length;r++){if(e[r]===t)return i(e,t);if(-1!==e[r].indexOf(t))return i(e[r],t)}}},deleteShapeAt:function(t){var e=this.feature.shapeAt(t);if(e)return this.deleteShape(e)},appendShape:function(t){this.insertShape(t)},prependShape:function(t){this.insertShape(t,0)},insertShape:function(t,e){this.ensureMulti(),t=this.formatShape(t),void 0===e&&(e=this.feature._latlngs.length),this.feature._latlngs.splice(e,0,t),this.feature.redraw(),this._enabled&&this.reset()},extendBounds:function(t){this.feature._bounds.extend(t.vertex.latlng)},onDragStart:function(e){this.editLayer.clearLayers(),t.Editable.BaseEditor.prototype.onDragStart.call(this,e)},onDragEnd:function(e){this.initVertexMarkers(),t.Editable.BaseEditor.prototype.onDragEnd.call(this,e)}}),t.Editable.PolylineEditor=t.Editable.PathEditor.extend({startDrawingBackward:function(){this._drawing=t.Editable.BACKWARD,this.startDrawing()},continueBackward:function(t){this.drawing()||(t=t||this.getDefaultLatLngs(),this.setDrawnLatLngs(t),t.length>0&&(this.tools.attachBackwardLineGuide(),this.tools.anchorBackwardLineGuide(t[0])),this.startDrawingBackward())},continueForward:function(t){this.drawing()||(t=t||this.getDefaultLatLngs(),this.setDrawnLatLngs(t),t.length>0&&(this.tools.attachForwardLineGuide(),this.tools.anchorForwardLineGuide(t[t.length-1])),this.startDrawingForward())},getDefaultLatLngs:function(e){return!(e=e||this.feature._latlngs).length||e[0]instanceof t.LatLng?e:this.getDefaultLatLngs(e[0])},ensureMulti:function(){this.feature._latlngs.length&&t.Polyline._flat(this.feature._latlngs)&&(this.feature._latlngs=[this.feature._latlngs])},addNewEmptyShape:function(){if(this.feature._latlngs.length){var t=[];return this.appendShape(t),t}return this.feature._latlngs},formatShape:function(e){return t.Polyline._flat(e)?e:e[0]?this.formatShape(e[0]):void 0},splitShape:function(e,n){if(n&&!(n>=e.length-1)){this.ensureMulti();var i=this.feature._latlngs.indexOf(e);if(-1!==i){var r=e.slice(0,n+1),o=e.slice(n);o[0]=t.latLng(o[0].lat,o[0].lng,o[0].alt),this.feature._latlngs.splice(i,1,r,o),this.refresh(),this.reset()}}}}),t.Editable.PolygonEditor=t.Editable.PathEditor.extend({CLOSED:!0,MIN_VERTEX:3,newPointForward:function(e){t.Editable.PathEditor.prototype.newPointForward.call(this,e),this.tools.backwardLineGuide._latlngs.length||this.tools.anchorBackwardLineGuide(e),2===this._drawnLatLngs.length&&this.tools.attachBackwardLineGuide()},addNewEmptyHole:function(t){this.ensureNotFlat();var e=this.feature.shapeAt(t);if(e){var n=[];return e.push(n),n}},newHole:function(t){var e=this.addNewEmptyHole(t);e&&(this.setDrawnLatLngs(e),this.startDrawingForward(),t&&this.newPointForward(t))},addNewEmptyShape:function(){if(this.feature._latlngs.length&&this.feature._latlngs[0].length){var t=[];return this.appendShape(t),t}return this.feature._latlngs},ensureMulti:function(){this.feature._latlngs.length&&t.Polyline._flat(this.feature._latlngs[0])&&(this.feature._latlngs=[this.feature._latlngs])},ensureNotFlat:function(){this.feature._latlngs.length&&!t.Polyline._flat(this.feature._latlngs)||(this.feature._latlngs=[this.feature._latlngs])},vertexCanBeDeleted:function(e){var n=this.feature.parentShape(e.latlngs);return t.Util.indexOf(n,e.latlngs)>0||t.Editable.PathEditor.prototype.vertexCanBeDeleted.call(this,e)},getDefaultLatLngs:function(){return this.feature._latlngs.length||this.feature._latlngs.push([]),this.feature._latlngs[0]},formatShape:function(e){return!t.Polyline._flat(e)||e[0]&&0===e[0].length?e:[e]}}),t.Editable.RectangleEditor=t.Editable.PathEditor.extend({CLOSED:!0,MIN_VERTEX:4,options:{skipMiddleMarkers:!0},extendBounds:function(e){var n=e.vertex.getIndex(),i=e.vertex.getNext(),r=e.vertex.getPrevious(),o=(n+2)%4,a=e.vertex.latlngs[o],s=new t.LatLngBounds(e.latlng,a);r.latlng.update([e.latlng.lat,a.lng]),i.latlng.update([a.lat,e.latlng.lng]),this.updateBounds(s),this.refreshVertexMarkers()},onDrawingMouseDown:function(e){t.Editable.PathEditor.prototype.onDrawingMouseDown.call(this,e),this.connect();var n=this.getDefaultLatLngs();3===n.length&&n.push(e.latlng);var i=new t.LatLngBounds(e.latlng,e.latlng);this.updateBounds(i),this.updateLatLngs(i),this.refresh(),this.reset(),e.originalEvent._simulated=!1,this.map.dragging._draggable._onUp(e.originalEvent),n[3].__vertex.dragging._draggable._onDown(e.originalEvent)},onDrawingMouseUp:function(e){this.commitDrawing(e),e.originalEvent._simulated=!1,t.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,e)},onDrawingMouseMove:function(e){e.originalEvent._simulated=!1,t.Editable.PathEditor.prototype.onDrawingMouseMove.call(this,e)},getDefaultLatLngs:function(t){return t||this.feature._latlngs[0]},updateBounds:function(t){this.feature._bounds=t},updateLatLngs:function(t){for(var e=this.getDefaultLatLngs(),n=this.feature._boundsToLatLngs(t),i=0;i<e.length;i++)e[i].update(n[i])}}),t.Editable.CircleEditor=t.Editable.PathEditor.extend({MIN_VERTEX:2,options:{skipMiddleMarkers:!0},initialize:function(e,n,i){t.Editable.PathEditor.prototype.initialize.call(this,e,n,i),this._resizeLatLng=this.computeResizeLatLng()},computeResizeLatLng:function(){var t=(this.feature._radius||this.feature._mRadius)*Math.cos(Math.PI/4),e=this.map.project(this.feature._latlng);return this.map.unproject([e.x+t,e.y-t])},updateResizeLatLng:function(){this._resizeLatLng.update(this.computeResizeLatLng()),this._resizeLatLng.__vertex.update()},getLatLngs:function(){return[this.feature._latlng,this._resizeLatLng]},getDefaultLatLngs:function(){return this.getLatLngs()},onVertexMarkerDrag:function(e){1===e.vertex.getIndex()?this.resize(e):this.updateResizeLatLng(e),t.Editable.PathEditor.prototype.onVertexMarkerDrag.call(this,e)},resize:function(t){var e=this.feature._latlng.distanceTo(t.latlng);this.feature.setRadius(e)},onDrawingMouseDown:function(e){t.Editable.PathEditor.prototype.onDrawingMouseDown.call(this,e),this._resizeLatLng.update(e.latlng),this.feature._latlng.update(e.latlng),this.connect(),e.originalEvent._simulated=!1,this.map.dragging._draggable._onUp(e.originalEvent),this._resizeLatLng.__vertex.dragging._draggable._onDown(e.originalEvent)},onDrawingMouseUp:function(e){this.commitDrawing(e),e.originalEvent._simulated=!1,t.Editable.PathEditor.prototype.onDrawingMouseUp.call(this,e)},onDrawingMouseMove:function(e){e.originalEvent._simulated=!1,t.Editable.PathEditor.prototype.onDrawingMouseMove.call(this,e)},onDrag:function(e){t.Editable.PathEditor.prototype.onDrag.call(this,e),this.feature.dragging.updateLatLng(this._resizeLatLng)}});var e={createEditor:function(t){t=t||this._map;var e=(this.options.editOptions||{}).editTools||t.editTools;if(!e)throw Error("Unable to detect Editable instance.");return new(this.options.editorClass||this.getEditorClass(e))(t,this,this.options.editOptions)},enableEdit:function(t){return this.editor||this.createEditor(t),this.editor.enable(),this.editor},editEnabled:function(){return this.editor&&this.editor.enabled()},disableEdit:function(){this.editor&&(this.editor.disable(),delete this.editor)},toggleEdit:function(){this.editEnabled()?this.disableEdit():this.enableEdit()},_onEditableAdd:function(){this.editor&&this.enableEdit()}},n={getEditorClass:function(e){return e&&e.options.polylineEditorClass?e.options.polylineEditorClass:t.Editable.PolylineEditor},shapeAt:function(e,n){var i=null;if(!(n=n||this._latlngs).length)return i;if(t.Polyline._flat(n)&&this.isInLatLngs(e,n))i=n;else for(var r=0;r<n.length;r++)if(this.isInLatLngs(e,n[r]))return n[r];return i},isInLatLngs:function(e,n){if(!n)return!1;var i,r,o,a,s=[],c=this._clickTolerance();if(this._projectLatlngs(n,s,this._pxBounds),s=s[0],a=this._map.latLngToLayerPoint(e),!this._pxBounds.contains(a))return!1;for(i=1,o=s.length,r=0;i<o;r=i++)if(t.LineUtil.pointToSegmentDistance(a,s[r],s[i])<=c)return!0;return!1}},i={getEditorClass:function(e){return e&&e.options.polygonEditorClass?e.options.polygonEditorClass:t.Editable.PolygonEditor},shapeAt:function(e,n){var i=null;if(!(n=n||this._latlngs).length)return i;if(t.Polyline._flat(n)&&this.isInLatLngs(e,n))i=n;else if(t.Polyline._flat(n[0])&&this.isInLatLngs(e,n[0]))i=n;else for(var r=0;r<n.length;r++)if(this.isInLatLngs(e,n[r][0]))return n[r];return i},isInLatLngs:function(t,e){var n,i,r,o,a,s=!1;for(r=0,o=(a=e.length)-1;r<a;o=r++)n=e[r],i=e[o],n.lat>t.lat!=i.lat>t.lat&&t.lng<(i.lng-n.lng)*(t.lat-n.lat)/(i.lat-n.lat)+n.lng&&(s=!s);return s},parentShape:function(e,n){if(n=n||this._latlngs){var i=t.Util.indexOf(n,e);if(-1!==i)return n;for(var r=0;r<n.length;r++)if(-1!==(i=t.Util.indexOf(n[r],e)))return n[r]}}},r={getEditorClass:function(e){return e&&e.options.markerEditorClass?e.options.markerEditorClass:t.Editable.MarkerEditor}},o={getEditorClass:function(e){return e&&e.options.rectangleEditorClass?e.options.rectangleEditorClass:t.Editable.RectangleEditor}},a={getEditorClass:function(e){return e&&e.options.circleEditorClass?e.options.circleEditorClass:t.Editable.CircleEditor}},s=function(){this.on("add",this._onEditableAdd)};t.Polyline&&(t.Polyline.include(e),t.Polyline.include(n),t.Polyline.addInitHook(s)),t.Polygon&&(t.Polygon.include(e),t.Polygon.include(i)),t.Marker&&(t.Marker.include(e),t.Marker.include(r),t.Marker.addInitHook(s)),t.Rectangle&&(t.Rectangle.include(e),t.Rectangle.include(o)),t.Circle&&(t.Circle.include(e),t.Circle.include(a)),t.LatLng.prototype.update=function(e){e=t.latLng(e),this.lat=e.lat,this.lng=e.lng}},window),L.PathDraggable=L.Draggable.extend({initialize:function(t){this._path=t,this._canvas=t._map.getRenderer(t)instanceof L.Canvas;var e=this._canvas?this._path._map.getRenderer(this._path)._container:this._path._path;L.Draggable.prototype.initialize.call(this,e,e,!0)},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("drag",t)},_onDown:function(t){var e=t.touches?t.touches[0]:t;this._startPoint=new L.Point(e.clientX,e.clientY),this._canvas&&!this._path._containsPoint(this._path._map.mouseEventToLayerPoint(e))||L.Draggable.prototype._onDown.call(this,t)}}),L.Handler.PathDrag=L.Handler.extend({initialize:function(t){this._path=t},getEvents:function(){return{dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd}},addHooks:function(){this._draggable||(this._draggable=new L.PathDraggable(this._path)),this._draggable.on(this.getEvents(),this).enable(),L.DomUtil.addClass(this._draggable._element,"leaflet-path-draggable")},removeHooks:function(){this._draggable.off(this.getEvents(),this).disable(),L.DomUtil.removeClass(this._draggable._element,"leaflet-path-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._startPoint=this._draggable._startPoint,this._path.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var e=this._path,n=t.originalEvent.touches&&1===t.originalEvent.touches.length?t.originalEvent.touches[0]:t.originalEvent,i=L.point(n.clientX,n.clientY),r=e._map.layerPointToLatLng(i);this._offset=i.subtract(this._startPoint),this._startPoint=i,this._path.eachLatLng(this.updateLatLng,this),e.redraw(),t.latlng=r,t.offset=this._offset,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){this._path._bounds&&this.resetBounds(),this._path.fire("moveend").fire("dragend",t)},latLngToLayerPoint:function(t){return this._path._map.project(L.latLng(t))._subtract(this._path._map.getPixelOrigin())},updateLatLng:function(t){var e=this.latLngToLayerPoint(t);e._add(this._offset);var n=this._path._map.layerPointToLatLng(e);t.lat=n.lat,t.lng=n.lng},resetBounds:function(){this._path._bounds=new L.LatLngBounds,this._path.eachLatLng(function(t){this._bounds.extend(t)})}}),L.Path.include({eachLatLng:function(t,e){e=e||this;var n=function(i){for(var r=0;r<i.length;r++)L.Util.isArray(i[r])?n(i[r]):t.call(e,i[r])};n(this.getLatLngs?this.getLatLngs():[this.getLatLng()])}}),L.Path.addInitHook(function(){this.dragging=new L.Handler.PathDrag(this),this.options.draggable&&this.once("add",function(){this.dragging.enable()})});var requirejs,require,define;!function(t){function e(t,e){return y.call(t,e)}function n(t,e){var n,i,r,o,a,s,c,u,l,h,d,f=e&&e.split("/"),p=g.map,m=p&&p["*"]||{};if(t){for(a=(t=t.split("/")).length-1,g.nodeIdCompat&&_.test(t[a])&&(t[a]=t[a].replace(_,"")),"."===t[0].charAt(0)&&f&&(t=f.slice(0,f.length-1).concat(t)),l=0;l<t.length;l++)if("."===(d=t[l]))t.splice(l,1),l-=1;else if(".."===d){if(0===l||1===l&&".."===t[2]||".."===t[l-1])continue;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}if((f||m)&&p){for(l=(n=t.split("/")).length;l>0;l-=1){if(i=n.slice(0,l).join("/"),f)for(h=f.length;h>0;h-=1)if((r=p[f.slice(0,h).join("/")])&&(r=r[i])){o=r,s=l;break}if(o)break;!c&&m&&m[i]&&(c=m[i],u=l)}!o&&c&&(o=c,s=u),o&&(n.splice(0,s,o),t=n.join("/"))}return t}function i(e,n){return function(){var i=b.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),h.apply(t,i.concat([e,n]))}}function r(t){return function(e){return n(e,t)}}function o(t){return function(e){p[t]=e}}function a(n){if(e(m,n)){var i=m[n];delete m[n],v[n]=!0,l.apply(t,i)}if(!e(p,n)&&!e(v,n))throw new Error("No "+n);return p[n]}function s(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function c(t){return t?s(t):[]}function u(t){return function(){return g&&g.config&&g.config[t]||{}}}var l,h,d,f,p={},m={},g={},v={},y=Object.prototype.hasOwnProperty,b=[].slice,_=/\.js$/;d=function(t,e){var i,o=s(t),c=o[0],u=e[1];return t=o[1],c&&(i=a(c=n(c,u))),c?t=i&&i.normalize?i.normalize(t,r(u)):n(t,u):(c=(o=s(t=n(t,u)))[0],t=o[1],c&&(i=a(c))),{f:c?c+"!"+t:t,n:t,pr:c,p:i}},f={require:function(t){return i(t)},exports:function(t){var e=p[t];return void 0!==e?e:p[t]={}},module:function(t){return{id:t,uri:"",exports:p[t],config:u(t)}}},l=function(n,r,s,u){var l,h,g,y,b,_,x,w=[],S=typeof s;if(u=u||n,_=c(u),"undefined"===S||"function"===S){for(r=!r.length&&s.length?["require","exports","module"]:r,b=0;b<r.length;b+=1)if(y=d(r[b],_),"require"===(h=y.f))w[b]=f.require(n);else if("exports"===h)w[b]=f.exports(n),x=!0;else if("module"===h)l=w[b]=f.module(n);else if(e(p,h)||e(m,h)||e(v,h))w[b]=a(h);else{if(!y.p)throw new Error(n+" missing "+h);y.p.load(y.n,i(u,!0),o(h),{}),w[b]=p[h]}g=s?s.apply(p[n],w):undefined,n&&(l&&l.exports!==t&&l.exports!==p[n]?p[n]=l.exports:g===t&&x||(p[n]=g))}else n&&(p[n]=s)},requirejs=require=h=function(e,n,i,r,o){if("string"==typeof e)return f[e]?f[e](n):a(d(e,c(n)).f);if(!e.splice){if((g=e).deps&&h(g.deps,g.callback),!n)return;n.splice?(e=n,n=i,i=null):e=t}return n=n||function(){},"function"==typeof i&&(i=r,r=o),r?l(t,e,n,i):setTimeout(function(){l(t,e,n,i)},4),h},h.config=function(t){return h(t)},requirejs._defined=p,(define=function(t,n,i){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");n.splice||(i=n,n=[]),e(p,t)||e(m,t)||(m[t]=[t,n,i])}).amd={jQuery:!0}}(),function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return r(n||t)},l,l.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t){(function(e){"use strict";function n(t,e,n){t[e]||Object[i](t,e,{writable:!0,configurable:!0,value:n})}if(t(295),t(296),t(2),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed")
;e._babelPolyfill=!0;var i="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2,295:295,296:296}],2:[function(t,e){t(119),e.exports=t(23).RegExp.escape},{119:119,23:23}],3:[function(t,e){e.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},{}],4:[function(t,e){var n=t(18);e.exports=function(t,e){if("number"!=typeof t&&"Number"!=n(t))throw TypeError(e);return+t}},{18:18}],5:[function(t,e){var n=t(117)("unscopables"),i=Array.prototype;void 0==i[n]&&t(40)(i,n,{}),e.exports=function(t){i[n][t]=!0}},{117:117,40:40}],6:[function(t,e){e.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},{}],7:[function(t,e){var n=t(49);e.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},{49:49}],8:[function(t,e){"use strict";var n=t(109),i=t(105),r=t(108);e.exports=[].copyWithin||function(t,e){var o=n(this),a=r(o.length),s=i(t,a),c=i(e,a),u=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===u?a:i(u,a))-c,a-s),h=1;for(c<s&&s<c+l&&(h=-1,c+=l-1,s+=l-1);l-- >0;)c in o?o[s]=o[c]:delete o[s],s+=h,c+=h;return o}},{105:105,108:108,109:109}],9:[function(t,e){"use strict";var n=t(109),i=t(105),r=t(108);e.exports=function(t){for(var e=n(this),o=r(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,o),c=a>2?arguments[2]:void 0,u=void 0===c?o:i(c,o);u>s;)e[s++]=t;return e}},{105:105,108:108,109:109}],10:[function(t,e){var n=t(37);e.exports=function(t,e){var i=[];return n(t,!1,i.push,i,e),i}},{37:37}],11:[function(t,e){var n=t(107),i=t(108),r=t(105);e.exports=function(t){return function(e,o,a){var s,c=n(e),u=i(c.length),l=r(a,u);if(t&&o!=o){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((t||l in c)&&c[l]===o)return t||l||0;return!t&&-1}}},{105:105,107:107,108:108}],12:[function(t,e){var n=t(25),i=t(45),r=t(109),o=t(108),a=t(15);e.exports=function(t,e){var s=1==t,c=2==t,u=3==t,l=4==t,h=6==t,d=5==t||h,f=e||a;return function(e,a,p){for(var m,g,v=r(e),y=i(v),b=n(a,p,3),_=o(y.length),x=0,w=s?f(e,_):c?f(e,0):void 0;_>x;x++)if((d||x in y)&&(m=y[x],g=b(m,x,v),t))if(s)w[x]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return x;case 2:w.push(m)}else if(l)return!1;return h?-1:u||l?l:w}}},{108:108,109:109,15:15,25:25,45:45}],13:[function(t,e){var n=t(3),i=t(109),r=t(45),o=t(108);e.exports=function(t,e,a,s,c){n(e);var u=i(t),l=r(u),h=o(u.length),d=c?h-1:0,f=c?-1:1;if(a<2)for(;;){if(d in l){s=l[d],d+=f;break}if(d+=f,c?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;c?d>=0:h>d;d+=f)d in l&&(s=e(s,l[d],d,u));return s}},{108:108,109:109,3:3,45:45}],14:[function(t,e){var n=t(49),i=t(47),r=t(117)("species");e.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},{117:117,47:47,49:49}],15:[function(t,e){var n=t(14);e.exports=function(t,e){return new(n(t))(e)}},{14:14}],16:[function(t,e){"use strict";var n=t(3),i=t(49),r=t(44),o=[].slice,a={},s=function(t,e,n){if(!(e in a)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";a[e]=Function("F,a","return new F("+i.join(",")+")")}return a[e](t,n)};e.exports=Function.bind||function(t){var e=n(this),a=o.call(arguments,1),c=function(){var n=a.concat(o.call(arguments));return this instanceof c?s(e,n.length,n):r(e,n,t)};return i(e.prototype)&&(c.prototype=e.prototype),c}},{3:3,44:44,49:49}],17:[function(t,e){var n=t(18),i=t(117)("toStringTag"),r="Arguments"==n(function(){return arguments}()),o=function(t,e){try{return t[e]}catch(t){}};e.exports=function(t){var e,a,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(a=o(e=Object(t),i))?a:r?n(e):"Object"==(s=n(e))&&"function"==typeof e.callee?"Arguments":s}},{117:117,18:18}],18:[function(t,e){var n={}.toString;e.exports=function(t){return n.call(t).slice(8,-1)}},{}],19:[function(t,e){"use strict";var n=t(67).f,i=t(66),r=t(86),o=t(25),a=t(6),s=t(27),c=t(37),u=t(53),l=t(55),h=t(91),d=t(28),f=t(62).fastKey,p=d?"_s":"size",m=function(t,e){var n,i=f(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};e.exports={getConstructor:function(t,e,u,l){var h=t(function(t,n){a(t,h,e,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[p]=0,void 0!=n&&c(n,u,t[l],t)});return r(h.prototype,{clear:function(){for(var t=this,e=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete e[n.i];t._f=t._l=void 0,t[p]=0},"delete":function(t){var e=this,n=m(e,t);if(n){var i=n.n,r=n.p;delete e._i[n.i],n.r=!0,r&&(r.n=i),i&&(i.p=r),e._f==n&&(e._f=i),e._l==n&&(e._l=r),e[p]--}return!!n},forEach:function(t){a(this,h,"forEach");for(var e,n=o(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.n:this._f;)for(n(e.v,e.k,this);e&&e.r;)e=e.p},has:function(t){return!!m(this,t)}}),d&&n(h.prototype,"size",{get:function(){return s(this[p])}}),h},def:function(t,e,n){var i,r,o=m(t,e);return o?o.v=n:(t._l=o={i:r=f(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=o),i&&(i.n=o),t[p]++,"F"!==r&&(t._i[r]=o)),t},getEntry:m,setStrong:function(t,e,n){u(t,e,function(t,e){this._t=t,this._k=e,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?"keys"==e?l(0,n.k):"values"==e?l(0,n.v):l(0,[n.k,n.v]):(t._t=void 0,l(1))},n?"entries":"values",!n,!0),h(e)}}},{25:25,27:27,28:28,37:37,53:53,55:55,6:6,62:62,66:66,67:67,86:86,91:91}],20:[function(t,e){var n=t(17),i=t(10);e.exports=function(t){return function(){if(n(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},{10:10,17:17}],21:[function(t,e){"use strict";var n=t(86),i=t(62).getWeak,r=t(7),o=t(49),a=t(6),s=t(37),c=t(12),u=t(39),l=c(5),h=c(6),d=0,f=function(t){return t._l||(t._l=new p)},p=function(){this.a=[]},m=function(t,e){return l(t.a,function(t){return t[0]===e})};p.prototype={get:function(t){var e=m(this,t);if(e)return e[1]},has:function(t){return!!m(this,t)},set:function(t,e){var n=m(this,t);n?n[1]=e:this.a.push([t,e])},"delete":function(t){var e=h(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},e.exports={getConstructor:function(t,e,r,c){var l=t(function(t,n){a(t,l,e,"_i"),t._i=d++,t._l=void 0,void 0!=n&&s(n,r,t[c],t)});return n(l.prototype,{"delete":function(t){if(!o(t))return!1;var e=i(t);return!0===e?f(this)["delete"](t):e&&u(e,this._i)&&delete e[this._i]},has:function(t){if(!o(t))return!1;var e=i(t);return!0===e?f(this).has(t):e&&u(e,this._i)}}),l},def:function(t,e,n){var o=i(r(e),!0);return!0===o?f(t).set(e,n):o[t._i]=n,t},ufstore:f}},{12:12,37:37,39:39,49:49,6:6,62:62,7:7,86:86}],22:[function(t,e){"use strict";var n=t(38),i=t(32),r=t(87),o=t(86),a=t(62),s=t(37),c=t(6),u=t(49),l=t(34),h=t(54),d=t(92),f=t(43);e.exports=function(t,e,p,m,g,v){var y=n[t],b=y,_=g?"set":"add",x=b&&b.prototype,w={},S=function(t){var e=x[t];r(x,t,"delete"==t?function(t){return!(v&&!u(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof b&&(v||x.forEach&&!l(function(){(new b).entries().next()}))){var k=new b,E=k[_](v?{}:-0,1)!=k,T=l(function(){k.has(1)}),C=h(function(t){new b(t)}),L=!v&&l(function(){for(var t=new b,e=5;e--;)t[_](e,e);return!t.has(-0)});C||(b=e(function(e,n){c(e,b,t);var i=f(new y,e,b);return void 0!=n&&s(n,g,i[_],i),i}),b.prototype=x,x.constructor=b),(T||L)&&(S("delete"),S("has"),g&&S("get")),(L||E)&&S(_),v&&x.clear&&delete x.clear}else b=m.getConstructor(e,t,g,_),o(b.prototype,p),a.NEED=!0;return d(b,t),w[t]=b,i(i.G+i.W+i.F*(b!=y),w),v||m.setStrong(b,t,g),b}},{32:32,34:34,37:37,38:38,43:43,49:49,54:54,6:6,62:62,86:86,87:87,92:92}],23:[function(t,e){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},{}],24:[function(t,e){"use strict";var n=t(67),i=t(85);e.exports=function(t,e,r){e in t?n.f(t,e,i(0,r)):t[e]=r}},{67:67,85:85}],25:[function(t,e){var n=t(3);e.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},{3:3}],26:[function(t,e){"use strict";var n=t(7),i=t(110),r="number";e.exports=function(t){if("string"!==t&&t!==r&&"default"!==t)throw TypeError("Incorrect hint");return i(n(this),t!=r)}},{110:110,7:7}],27:[function(t,e){e.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},{}],28:[function(t,e){e.exports=!t(34)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{34:34}],29:[function(t,e){var n=t(49),i=t(38).document,r=n(i)&&n(i.createElement);e.exports=function(t){return r?i.createElement(t):{}}},{38:38,49:49}],30:[function(t,e){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],31:[function(t,e){var n=t(76),i=t(73),r=t(77);e.exports=function(t){var e=n(t),o=i.f;if(o)for(var a,s=o(t),c=r.f,u=0;s.length>u;)c.call(t,a=s[u++])&&e.push(a);return e}},{73:73,76:76,77:77}],32:[function(t,e){var n=t(38),i=t(23),r=t(40),o=t(87),a=t(25),s="prototype",c=function(t,e,u){var l,h,d,f,p=t&c.F,m=t&c.G,g=t&c.S,v=t&c.P,y=t&c.B,b=m?n:g?n[e]||(n[e]={}):(n[e]||{})[s],_=m?i:i[e]||(i[e]={}),x=_[s]||(_[s]={});m&&(u=e);for(l in u)h=!p&&b&&void 0!==b[l],d=(h?b:u)[l],f=y&&h?a(d,n):v&&"function"==typeof d?a(Function.call,d):d,b&&o(b,l,d,t&c.U),_[l]!=d&&r(_,l,f),v&&x[l]!=d&&(x[l]=d)};n.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},{23:23,25:25,38:38,40:40,87:87}],33:[function(t,e){var n=t(117)("match");e.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},{117:117}],34:[function(t,e){e.exports=function(t){try{return!!t()}catch(t){return!0}}},{}],35:[function(t,e){"use strict";var n=t(40),i=t(87),r=t(34),o=t(27),a=t(117);e.exports=function(t,e,s){var c=a(t),u=s(o,c,""[t]),l=u[0],h=u[1];r(function(){var e={};return e[c]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,l),n(RegExp.prototype,c,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)}))}},{117:117,27:27,34:34,40:40,87:87}],36:[function(t,e){"use strict";var n=t(7);e.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},{7:7}],37:[function(t,e,n){var i=t(25),r=t(51),o=t(46),a=t(7),s=t(108),c=t(118),u={},l={};(n=e.exports=function(t,e,n,h,d){var f,p,m,g,v=d?function(){return t}:c(t),y=i(n,h,e?2:1),b=0;if("function"!=typeof v)throw TypeError(t+" is not iterable!");if(o(v)){for(f=s(t.length);f>b;b++)if((g=e?y(a(p=t[b])[0],p[1]):y(t[b]))===u||g===l)return g}else for(m=v.call(t);!(p=m.next()).done;)if((g=r(m,y,p.value,e))===u||g===l)return g}).BREAK=u,n.RETURN=l},{108:108,118:118,25:25,46:46,51:51,7:7}],38:[function(t,e){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],39:[function(t,e){var n={}.hasOwnProperty;e.exports=function(t,e){return n.call(t,e)}},{}],40:[function(t,e){var n=t(67),i=t(85);e.exports=t(28)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,n){return t[e]=n,t}},{28:28,67:67,85:85}],41:[function(t,e){e.exports=t(38).document&&document.documentElement},{38:38}],42:[function(t,e){e.exports=!t(28)&&!t(34)(function(){return 7!=Object.defineProperty(t(29)("div"),"a",{get:function(){return 7}}).a})},{28:28,29:29,34:34}],43:[function(t,e){var n=t(49),i=t(90).set;e.exports=function(t,e,r){var o,a=e.constructor;return a!==r&&"function"==typeof a&&(o=a.prototype)!==r.prototype&&n(o)&&i&&i(t,o),t}},{49:49,90:90}],44:[function(t,e){e.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},{}],45:[function(t,e){var n=t(18);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},{18:18}],46:[function(t,e){var n=t(56),i=t(117)("iterator"),r=Array.prototype;e.exports=function(t){return void 0!==t&&(n.Array===t||r[i]===t)}},{117:117,56:56}],47:[function(t,e){var n=t(18);e.exports=Array.isArray||function(t){return"Array"==n(t)}},{18:18}],48:[function(t,e){var n=t(49),i=Math.floor;e.exports=function(t){return!n(t)&&isFinite(t)&&i(t)===t}},{49:49}],49:[function(t,e){e.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},{}],50:[function(t,e){var n=t(49),i=t(18),r=t(117)("match");e.exports=function(t){var e;return n(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==i(t))}},{117:117,18:18,49:49}],51:[function(t,e){var n=t(7);e.exports=function(t,e,i,r){try{return r?e(n(i)[0],i[1]):e(i)}catch(e){var o=t["return"];throw void 0!==o&&n(o.call(t)),e}}},{7:7}],52:[function(t,e){"use strict";var n=t(66),i=t(85),r=t(92),o={};t(40)(o,t(117)("iterator"),function(){return this}),e.exports=function(t,e,a){t.prototype=n(o,{next:i(1,a)}),r(t,e+" Iterator")}},{117:117,40:40,66:66,85:85,92:92}],53:[function(t,e){"use strict";var n=t(58),i=t(32),r=t(87),o=t(40),a=t(39),s=t(56),c=t(52),u=t(92),l=t(74),h=t(117)("iterator"),d=!([].keys&&"next"in[].keys()),f="@@iterator",p="keys",m="values",g=function(){return this};e.exports=function(t,e,v,y,b,_,x){c(v,e,y);var w,S,k,E=function(t){if(!d&&t in P)return P[t];switch(t){case p:case m:return function(){return new v(this,t)}}return function(){return new v(this,t)}},T=e+" Iterator",C=b==m,L=!1,P=t.prototype,A=P[h]||P[f]||b&&P[b],N=A||E(b),R=b?C?E("entries"):N:void 0,I="Array"==e?P.entries||A:A;if(I&&(k=l(I.call(new t)))!==Object.prototype&&(u(k,T,!0),n||a(k,h)||o(k,h,g)),C&&A&&A.name!==m&&(L=!0,N=function(){return A.call(this)}),n&&!x||!d&&!L&&P[h]||o(P,h,N),s[e]=N,s[T]=g,b)if(w={values:C?N:E(m),keys:_?N:E(p),entries:R},x)for(S in w)S in P||r(P,S,w[S]);else i(i.P+i.F*(d||L),e,w);return w}},{117:117,32:32,39:39,40:40,52:52,56:56,58:58,74:74,87:87,92:92}],54:[function(t,e){var n=t(117)("iterator"),i=!1;try{var r=[7][n]();r["return"]=function(){i=!0},Array.from(r,function(){throw 2})}catch(t){}e.exports=function(t,e){if(!e&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},t(o)}catch(t){}return r}},{117:117}],55:[function(t,e){e.exports=function(t,e){return{value:e,done:!!t}}},{}],56:[function(t,e){e.exports={}},{}],57:[function(t,e){var n=t(76),i=t(107);e.exports=function(t,e){for(var r,o=i(t),a=n(o),s=a.length,c=0;s>c;)if(o[r=a[c++]]===e)return r}},{107:107,76:76}],58:[function(t,e){e.exports=!1},{}],59:[function(t,e){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},{}],60:[function(t,e){e.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},{}],61:[function(t,e){e.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},{}],62:[function(t,e){var n=t(114)("meta"),i=t(49),r=t(39),o=t(67).f,a=0,s=Object.isExtensible||function(){return!0},c=!t(34)(function(){return s(Object.preventExtensions({}))}),u=function(t){o(t,n,{value:{i:"O"+ ++a,w:{}}})},l=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,n)){if(!s(t))return"F";if(!e)return"E";u(t)}return t[n].i},h=function(t,e){if(!r(t,n)){if(!s(t))return!0;if(!e)return!1;u(t)}return t[n].w},d=function(t){return c&&f.NEED&&s(t)&&!r(t,n)&&u(t),t},f=e.exports={KEY:n,NEED:!1,fastKey:l,getWeak:h,onFreeze:d}},{114:114,34:34,39:39,49:49,67:67}],63:[function(t,e){var n=t(149),i=t(32),r=t(94)("metadata"),o=r.store||(r.store=new(t(255))),a=function(t,e,i){var r=o.get(t);if(!r){if(!i)return;o.set(t,r=new n)}var a=r.get(e);if(!a){if(!i)return;r.set(e,a=new n)}return a},s=function(t,e,n){var i=a(e,n,!1);return void 0!==i&&i.has(t)},c=function(t,e,n){var i=a(e,n,!1);return void 0===i?void 0:i.get(t)},u=function(t,e,n,i){a(n,i,!0).set(t,e)},l=function(t,e){var n=a(t,e,!1),i=[];return n&&n.forEach(function(t,e){i.push(e)}),i},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},d=function(t){i(i.S,"Reflect",t)};e.exports={store:o,map:a,has:s,get:c,set:u,keys:l,key:h,exp:d}},{149:149,255:255,32:32,94:94}],64:[function(t,e){var n=t(38),i=t(104).set,r=n.MutationObserver||n.WebKitMutationObserver,o=n.process,a=n.Promise,s="process"==t(18)(o);e.exports=function(){var t,e,c,u=function(){var n,i;for(s&&(n=o.domain)&&n.exit();t;){i=t.fn,t=t.next;try{i()}catch(n){throw t?c():e=void 0,n}}e=void 0,n&&n.enter()};if(s)c=function(){o.nextTick(u)};else if(r){var l=!0,h=document.createTextNode("");new r(u).observe(h,{characterData:!0}),c=function(){h.data=l=!l}}else if(a&&a.resolve){var d=a.resolve();c=function(){d.then(u)}}else c=function(){i.call(n,u)};return function(n){var i={fn:n,next:void 0};e&&(e.next=i),t||(t=i,c()),e=i}}},{104:104,18:18,38:38}],65:[function(t,e){"use strict";var n=t(76),i=t(73),r=t(77),o=t(109),a=t(45),s=Object.assign;e.exports=!s||t(34)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=s({},t)[n]||Object.keys(s({},e)).join("")!=i})?function(t){for(var e=o(t),s=arguments.length,c=1,u=i.f,l=r.f;s>c;)for(var h,d=a(arguments[c++]),f=u?n(d).concat(u(d)):n(d),p=f.length,m=0;p>m;)l.call(d,h=f[m++])&&(e[h]=d[h]);return e}:s},{109:109,34:34,45:45,73:73,76:76,77:77}],66:[function(t,e){var n=t(7),i=t(68),r=t(30),o=t(93)("IE_PROTO"),a=function(){},s="prototype",c=function(){var e,n=t(29)("iframe"),i=r.length,o="<",a=">";for(n.style.display="none",t(41).appendChild(n),n.src="javascript:",(e=n.contentWindow.document).open(),e.write(o+"script"+a+"document.F=Object"+o+"/script"+a),e.close(),c=e.F;i--;)delete c[s][r[i]];return c()};e.exports=Object.create||function(t,e){var r;return null!==t?(a[s]=n(t),r=new a,a[s]=null,r[o]=t):r=c(),void 0===e?r:i(r,e)}},{29:29,30:30,41:41,68:68,7:7,93:93}],67:[function(t,e,n){var i=t(7),r=t(42),o=t(110),a=Object.defineProperty;n.f=t(28)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},{110:110,28:28,42:42,7:7}],68:[function(t,e){var n=t(67),i=t(7),r=t(76);e.exports=t(28)?Object.defineProperties:function(t,e){i(t);for(var o,a=r(e),s=a.length,c=0;s>c;)n.f(t,o=a[c++],e[o]);return t}},{28:28,67:67,7:7,76:76}],69:[function(t,e){e.exports=t(58)||!t(34)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete t(38)[e]})},{34:34,38:38,58:58}],70:[function(t,e,n){var i=t(77),r=t(85),o=t(107),a=t(110),s=t(39),c=t(42),u=Object.getOwnPropertyDescriptor;n.f=t(28)?u:function(t,e){if(t=o(t),e=a(e,!0),c)try{return u(t,e)}catch(t){}if(s(t,e))return r(!i.f.call(t,e),t[e])}},{107:107,110:110,28:28,39:39,42:42,77:77,85:85}],71:[function(t,e){var n=t(107),i=t(72).f,r={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return i(t)}catch(t){return o.slice()}};e.exports.f=function(t){return o&&"[object Window]"==r.call(t)?a(t):i(n(t))}},{107:107,72:72}],72:[function(t,e,n){var i=t(75),r=t(30).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},{30:30,75:75}],73:[function(t,e,n){n.f=Object.getOwnPropertySymbols},{}],74:[function(t,e){var n=t(39),i=t(109),r=t(93)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},{109:109,39:39,93:93}],75:[function(t,e){var n=t(39),i=t(107),r=t(11)(!1),o=t(93)("IE_PROTO");e.exports=function(t,e){var a,s=i(t),c=0,u=[];for(a in s)a!=o&&n(s,a)&&u.push(a);for(;e.length>c;)n(s,a=e[c++])&&(~r(u,a)||u.push(a));return u}},{107:107,11:11,39:39,93:93}],76:[function(t,e){var n=t(75),i=t(30);e.exports=Object.keys||function(t){return n(t,i)}},{30:30,75:75}],77:[function(t,e,n){n.f={}.propertyIsEnumerable},{}],78:[function(t,e){var n=t(32),i=t(23),r=t(34);e.exports=function(t,e){var o=(i.Object||{})[t]||Object[t],a={};a[t]=e(o),n(n.S+n.F*r(function(){o(1)}),"Object",a)}},{23:23,32:32,34:34}],79:[function(t,e){var n=t(76),i=t(107),r=t(77).f;e.exports=function(t){return function(e){for(var o,a=i(e),s=n(a),c=s.length,u=0,l=[];c>u;)r.call(a,o=s[u++])&&l.push(t?[o,a[o]]:a[o]);return l}}},{107:107,76:76,77:77}],80:[function(t,e){var n=t(72),i=t(73),r=t(7),o=t(38).Reflect;e.exports=o&&o.ownKeys||function(t){var e=n.f(r(t)),o=i.f;return o?e.concat(o(t)):e}},{38:38,7:7,72:72,73:73}],81:[function(t,e){var n=t(38).parseFloat,i=t(102).trim;e.exports=1/n(t(103)+"-0")!=-1/0?function(t){var e=i(String(t),3),r=n(e);return 0===r&&"-"==e.charAt(0)?-0:r}:n},{102:102,103:103,38:38}],82:[function(t,e){var n=t(38).parseInt,i=t(102).trim,r=t(103),o=/^[\-+]?0[xX]/;e.exports=8!==n(r+"08")||22!==n(r+"0x16")?function(t,e){var r=i(String(t),3);return n(r,e>>>0||(o.test(r)?16:10))}:n},{102:102,103:103,38:38}],83:[function(t,e){"use strict";var n=t(84),i=t(44),r=t(3);e.exports=function(){for(var t=r(this),e=arguments.length,o=Array(e),a=0,s=n._,c=!1;e>a;)(o[a]=arguments[a++])===s&&(c=!0);return function(){var n,r=this,a=arguments.length,u=0,l=0;if(!c&&!a)return i(t,o,r);if(n=o.slice(),c)for(;e>u;u++)n[u]===s&&(n[u]=arguments[l++]);for(;a>l;)n.push(arguments[l++]);return i(t,n,r)}}},{3:3,44:44,84:84}],84:[function(t,e){e.exports=t(38)},{38:38}],85:[function(t,e){e.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},{}],86:[function(t,e){var n=t(87);e.exports=function(t,e,i){for(var r in e)n(t,r,e[r],i);return t}},{87:87}],87:[function(t,e){var n=t(38),i=t(40),r=t(39),o=t(114)("src"),a="toString",s=Function[a],c=(""+s).split(a);t(23).inspectSource=function(t){return s.call(t)},(e.exports=function(t,e,a,s){var u="function"==typeof a;u&&(r(a,"name")||i(a,"name",e)),t[e]!==a&&(u&&(r(a,o)||i(a,o,t[e]?""+t[e]:c.join(String(e)))),t===n?t[e]=a:s?t[e]?t[e]=a:i(t,e,a):(delete t[e],i(t,e,a)))})(Function.prototype,a,function(){return"function"==typeof this&&this[o]||s.call(this)})},{114:114,23:23,38:38,39:39,40:40}],88:[function(t,e){e.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},{}],89:[function(t,e){e.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},{}],90:[function(t,e){var n=t(49),i=t(7),r=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,i){try{(i=t(25)(Function.call,t(70).f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(t){n=!0}return function(t,e){return r(t,e),n?t.__proto__=e:i(t,e),t}}({},!1):void 0),check:r}},{25:25,49:49,7:7,70:70}],91:[function(t,e){"use strict";var n=t(38),i=t(67),r=t(28),o=t(117)("species");e.exports=function(t){var e=n[t];r&&e&&!e[o]&&i.f(e,o,{configurable:!0,get:function(){return this}})}},{117:117,28:28,38:38,67:67}],92:[function(t,e){var n=t(67).f,i=t(39),r=t(117)("toStringTag");e.exports=function(t,e,o){t&&!i(t=o?t:t.prototype,r)&&n(t,r,{configurable:!0,value:e})}},{117:117,39:39,67:67}],93:[function(t,e){var n=t(94)("keys"),i=t(114);e.exports=function(t){return n[t]||(n[t]=i(t))}},{114:114,94:94}],94:[function(t,e){var n=t(38),i="__core-js_shared__",r=n[i]||(n[i]={});e.exports=function(t){return r[t]||(r[t]={})}},{38:38}],95:[function(t,e){var n=t(7),i=t(3),r=t(117)("species");e.exports=function(t,e){var o,a=n(t).constructor;return void 0===a||void 0==(o=n(a)[r])?e:i(o)}},{117:117,3:3,7:7}],96:[function(t,e){var n=t(34);e.exports=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}},{34:34}],97:[function(t,e){var n=t(106),i=t(27);e.exports=function(t){return function(e,r){var o,a,s=String(i(e)),c=n(r),u=s.length;return c<0||c>=u?t?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):o:t?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},{106:106,27:27}],98:[function(t,e){var n=t(50),i=t(27);e.exports=function(t,e,r){if(n(e))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},{27:27,50:50}],99:[function(t,e){var n=t(32),i=t(34),r=t(27),o=/"/g,a=function(t,e,n,i){var a=String(r(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(i).replace(o,"&quot;")+'"'),s+">"+a+"</"+e+">"};e.exports=function(t,e){var r={};r[t]=e(a),n(n.P+n.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",r)}},{27:27,32:32,34:34}],100:[function(t,e){var n=t(108),i=t(101),r=t(27);e.exports=function(t,e,o,a){var s=String(r(t)),c=s.length,u=void 0===o?" ":String(o),l=n(e);if(l<=c||""==u)return s;var h=l-c,d=i.call(u,Math.ceil(h/u.length));return d.length>h&&(d=d.slice(0,h)),a?d+s:s+d}},{101:101,108:108,27:27}],101:[function(t,e){"use strict";var n=t(106),i=t(27);e.exports=function(t){var e=String(i(this)),r="",o=n(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(r+=e);return r}},{106:106,27:27}],102:[function(t,e){var n=t(32),i=t(27),r=t(34),o=t(103),a="["+o+"]",s="\u200b\x85",c=RegExp("^"+a+a+"*"),u=RegExp(a+a+"*$"),l=function(t,e,i){var a={},c=r(function(){return!!o[t]()||s[t]()!=s}),u=a[t]=c?e(h):o[t];i&&(a[i]=u),n(n.P+n.F*c,"String",a)},h=l.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};e.exports=l},{103:103,27:27,32:32,34:34}],103:[function(t,e){e.exports="\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff"},{}],104:[function(t,e){var n,i,r,o=t(25),a=t(44),s=t(41),c=t(29),u=t(38),l=u.process,h=u.setImmediate,d=u.clearImmediate,f=u.MessageChannel,p=0,m={},g="onreadystatechange",v=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},y=function(t){v.call(t.data)};h&&d||(h=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return m[++p]=function(){a("function"==typeof t?t:Function(t),e)},n(p),p},d=function(t){delete m[t]},"process"==t(18)(l)?n=function(t){l.nextTick(o(v,t,1))}:f?(i=new f,r=i.port2,i.port1.onmessage=y,n=o(r.postMessage,r,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(n=function(t){u.postMessage(t+"","*")},u.addEventListener("message",y,!1)):n=g in c("script")?function(t){s.appendChild(c("script"))[g]=function(){s.removeChild(this),v.call(t)}}:function(t){setTimeout(o(v,t,1),0)}),e.exports={set:h,clear:d}},{18:18,25:25,29:29,38:38,41:41,44:44}],105:[function(t,e){var n=t(106),i=Math.max,r=Math.min;e.exports=function(t,e){return(t=n(t))<0?i(t+e,0):r(t,e)}},{106:106}],106:[function(t,e){var n=Math.ceil,i=Math.floor;e.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},{}],107:[function(t,e){var n=t(45),i=t(27);e.exports=function(t){return n(i(t))}},{27:27,45:45}],108:[function(t,e){var n=t(106),i=Math.min;e.exports=function(t){return t>0?i(n(t),9007199254740991):0}},{106:106}],109:[function(t,e){var n=t(27);e.exports=function(t){return Object(n(t))}},{27:27}],110:[function(t,e){var n=t(49);e.exports=function(t,e){if(!n(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!n(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},{49:49}],111:[function(t,e){"use strict";if(t(28)){var n=t(58),i=t(38),r=t(34),o=t(32),a=t(113),s=t(112),c=t(25),u=t(6),l=t(85),h=t(40),d=t(86),f=t(106),p=t(108),m=t(105),g=t(110),v=t(39),y=t(89),b=t(17),_=t(49),x=t(109),w=t(46),S=t(66),k=t(74),E=t(72).f,T=t(118),C=t(114),L=t(117),P=t(12),A=t(11),N=t(95),R=t(130),I=t(56),D=t(54),O=t(91),B=t(9),M=t(8),F=t(67),z=t(70),j=F.f,H=z.f,$=i.RangeError,U=i.TypeError,q=i.Uint8Array,W="ArrayBuffer",V="Shared"+W,Z="BYTES_PER_ELEMENT",G="prototype",K=Array[G],X=s.ArrayBuffer,Y=s.DataView,Q=P(0),J=P(2),tt=P(3),et=P(4),nt=P(5),it=P(6),rt=A(!0),ot=A(!1),at=R.values,st=R.keys,ct=R.entries,ut=K.lastIndexOf,lt=K.reduce,ht=K.reduceRight,dt=K.join,ft=K.sort,pt=K.slice,mt=K.toString,gt=K.toLocaleString,vt=L("iterator"),yt=L("toStringTag"),bt=C("typed_constructor"),_t=C("def_constructor"),xt=a.CONSTR,wt=a.TYPED,St=a.VIEW,kt="Wrong length!",Et=P(1,function(t,e){return Nt(N(t,t[_t]),e)}),Tt=r(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ct=!!q&&!!q[G].set&&r(function(){new q(1).set({})}),Lt=function(t,e){if(void 0===t)throw U(kt);var n=+t,i=p(t);if(e&&!y(n,i))throw $(kt);return i},Pt=function(t,e){var n=f(t);if(n<0||n%e)throw $("Wrong offset!");return n},At=function(t){if(_(t)&&wt in t)return t;throw U(t+" is not a typed array!")},Nt=function(t,e){if(!(_(t)&&bt in t))throw U("It is not a typed array constructor!");return new t(e)},Rt=function(t,e){return It(N(t,t[_t]),e)},It=function(t,e){for(var n=0,i=e.length,r=Nt(t,i);i>n;)r[n]=e[n++];return r},Dt=function(t,e,n){j(t,e,{get:function(){return this._d[n]}})},Ot=function(t){var e,n,i,r,o,a,s=x(t),u=arguments.length,l=u>1?arguments[1]:void 0,h=void 0!==l,d=T(s);if(void 0!=d&&!w(d)){for(a=d.call(s),i=[],e=0;!(o=a.next()).done;e++)i.push(o.value);s=i}for(h&&u>2&&(l=c(l,arguments[2],2)),e=0,n=p(s.length),r=Nt(this,n);n>e;e++)r[e]=h?l(s[e],e):s[e];return r},Bt=function(){for(var t=0,e=arguments.length,n=Nt(this,e);e>t;)n[t]=arguments[t++];return n},Mt=!!q&&r(function(){gt.call(new q(1))}),Ft=function(){return gt.apply(Mt?pt.call(At(this)):At(this),arguments)},zt={copyWithin:function(t,e){return M.call(At(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return et(At(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(){return B.apply(At(this),arguments)},filter:function(t){return Rt(this,J(At(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return nt(At(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(At(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Q(At(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ot(At(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return rt(At(this),t,arguments.length>1?arguments[1]:void 0)},join:function(){return dt.apply(At(this),arguments)},lastIndexOf:function(){return ut.apply(At(this),arguments)},map:function(t){return Et(At(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(){return lt.apply(At(this),arguments)},reduceRight:function(){return ht.apply(At(this),arguments)},reverse:function(){for(var t,e=this,n=At(e).length,i=Math.floor(n/2),r=0;r<i;)t=e[r],e[r++]=e[--n],e[n]=t;return e},some:function(t){return tt(At(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ft.call(At(this),t)},subarray:function(t,e){var n=At(this),i=n.length,r=m(t,i);return new(N(n,n[_t]))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,p((void 0===e?i:m(e,i))-r))}},jt=function(t,e){return Rt(this,pt.call(At(this),t,e))},Ht=function(t){At(this);var e=Pt(arguments[1],1),n=this.length,i=x(t),r=p(i.length),o=0;if(r+e>n)throw $(kt);for(;o<r;)this[e+o]=i[o++]},$t={entries:function(){return ct.call(At(this))},keys:function(){return st.call(At(this))},values:function(){return at.call(At(this))}},Ut=function(t,e){return _(t)&&t[wt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},qt=function(t,e){return Ut(t,e=g(e,!0))?l(2,t[e]):H(t,e)},Wt=function(t,e,n){return!(Ut(t,e=g(e,!0))&&_(n)&&v(n,"value"))||v(n,"get")||v(n,"set")||n.configurable||v(n,"writable")&&!n.writable||v(n,"enumerable")&&!n.enumerable?j(t,e,n):(t[e]=n.value,t)};xt||(z.f=qt,F.f=Wt),o(o.S+o.F*!xt,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Wt}),r(function(){mt.call({})})&&(mt=gt=function(){return dt.call(this)});var Vt=d({},zt);d(Vt,$t),h(Vt,vt,$t.values),d(Vt,{slice:jt,set:Ht,constructor:function(){},toString:mt,toLocaleString:Ft}),Dt(Vt,"buffer","b"),
Dt(Vt,"byteOffset","o"),Dt(Vt,"byteLength","l"),Dt(Vt,"length","e"),j(Vt,yt,{get:function(){return this[wt]}}),e.exports=function(t,e,s,c){var l=t+((c=!!c)?"Clamped":"")+"Array",d="Uint8Array"!=l,f="get"+t,m="set"+t,g=i[l],v=g||{},y=g&&k(g),x=!g||!a.ABV,w={},T=g&&g[G],C=function(t,n){var i=t._d;return i.v[f](n*e+i.o,Tt)},L=function(t,n,i){var r=t._d;c&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),r.v[m](n*e+r.o,i,Tt)},P=function(t,e){j(t,e,{get:function(){return C(this,e)},set:function(t){return L(this,e,t)},enumerable:!0})};x?(g=s(function(t,n,i,r){u(t,g,l,"_d");var o,a,s,c,d=0,f=0;if(_(n)){if(!(n instanceof X||(c=b(n))==W||c==V))return wt in n?It(g,n):Ot.call(g,n);o=n,f=Pt(i,e);var m=n.byteLength;if(void 0===r){if(m%e)throw $(kt);if((a=m-f)<0)throw $(kt)}else if((a=p(r)*e)+f>m)throw $(kt);s=a/e}else s=Lt(n,!0),a=s*e,o=new X(a);for(h(t,"_d",{b:o,o:f,l:a,e:s,v:new Y(o)});d<s;)P(t,d++)}),T=g[G]=S(Vt),h(T,"constructor",g)):D(function(t){new g(null),new g(t)},!0)||(g=s(function(t,n,i,r){u(t,g,l);var o;return _(n)?n instanceof X||(o=b(n))==W||o==V?void 0!==r?new v(n,Pt(i,e),r):void 0!==i?new v(n,Pt(i,e)):new v(n):wt in n?It(g,n):Ot.call(g,n):new v(Lt(n,d))}),Q(y!==Function.prototype?E(v).concat(E(y)):E(v),function(t){t in g||h(g,t,v[t])}),g[G]=T,n||(T.constructor=g));var A=T[vt],N=!!A&&("values"==A.name||void 0==A.name),R=$t.values;h(g,bt,!0),h(T,wt,l),h(T,St,!0),h(T,_t,g),(c?new g(1)[yt]==l:yt in T)||j(T,yt,{get:function(){return l}}),w[l]=g,o(o.G+o.W+o.F*(g!=v),w),o(o.S,l,{BYTES_PER_ELEMENT:e,from:Ot,of:Bt}),Z in T||h(T,Z,e),o(o.P,l,zt),O(l),o(o.P+o.F*Ct,l,{set:Ht}),o(o.P+o.F*!N,l,$t),o(o.P+o.F*(T.toString!=mt),l,{toString:mt}),o(o.P+o.F*r(function(){new g(1).slice()}),l,{slice:jt}),o(o.P+o.F*(r(function(){return[1,2].toLocaleString()!=new g([1,2]).toLocaleString()})||!r(function(){T.toLocaleString.call([1,2])})),l,{toLocaleString:Ft}),I[l]=N?A:R,n||N||h(T,vt,R)}}else e.exports=function(){}},{105:105,106:106,108:108,109:109,11:11,110:110,112:112,113:113,114:114,117:117,118:118,12:12,130:130,17:17,25:25,28:28,32:32,34:34,38:38,39:39,40:40,46:46,49:49,54:54,56:56,58:58,6:6,66:66,67:67,70:70,72:72,74:74,8:8,85:85,86:86,89:89,9:9,91:91,95:95}],112:[function(t,e,n){"use strict";var i=t(38),r=t(28),o=t(58),a=t(113),s=t(40),c=t(86),u=t(34),l=t(6),h=t(106),d=t(108),f=t(72).f,p=t(67).f,m=t(9),g=t(92),v="ArrayBuffer",y="DataView",b="prototype",_="Wrong length!",x="Wrong index!",w=i[v],S=i[y],k=i.Math,E=i.RangeError,T=i.Infinity,C=w,L=k.abs,P=k.pow,A=k.floor,N=k.log,R=k.LN2,I="buffer",D="byteLength",O="byteOffset",B=r?"_b":I,M=r?"_l":D,F=r?"_o":O,z=function(t,e,n){var i,r,o,a=Array(n),s=8*n-e-1,c=(1<<s)-1,u=c>>1,l=23===e?P(2,-24)-P(2,-77):0,h=0,d=t<0||0===t&&1/t<0?1:0;for((t=L(t))!=t||t===T?(r=t!=t?1:0,i=c):(i=A(N(t)/R),t*(o=P(2,-i))<1&&(i--,o*=2),(t+=i+u>=1?l/o:l*P(2,1-u))*o>=2&&(i++,o/=2),i+u>=c?(r=0,i=c):i+u>=1?(r=(t*o-1)*P(2,e),i+=u):(r=t*P(2,u-1)*P(2,e),i=0));e>=8;a[h++]=255&r,r/=256,e-=8);for(i=i<<e|r,s+=e;s>0;a[h++]=255&i,i/=256,s-=8);return a[--h]|=128*d,a},j=function(t,e,n){var i,r=8*n-e-1,o=(1<<r)-1,a=o>>1,s=r-7,c=n-1,u=t[c--],l=127&u;for(u>>=7;s>0;l=256*l+t[c],c--,s-=8);for(i=l&(1<<-s)-1,l>>=-s,s+=e;s>0;i=256*i+t[c],c--,s-=8);if(0===l)l=1-a;else{if(l===o)return i?NaN:u?-T:T;i+=P(2,e),l-=a}return(u?-1:1)*i*P(2,l-e)},H=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},$=function(t){return[255&t]},U=function(t){return[255&t,t>>8&255]},q=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},W=function(t){return z(t,52,8)},V=function(t){return z(t,23,4)},Z=function(t,e,n){p(t[b],e,{get:function(){return this[n]}})},G=function(t,e,n,i){var r=+n,o=h(r);if(r!=o||o<0||o+e>t[M])throw E(x);var a=t[B]._b,s=o+t[F],c=a.slice(s,s+e);return i?c:c.reverse()},K=function(t,e,n,i,r,o){var a=+n,s=h(a);if(a!=s||s<0||s+e>t[M])throw E(x);for(var c=t[B]._b,u=s+t[F],l=i(+r),d=0;d<e;d++)c[u+d]=l[o?d:e-d-1]},X=function(t,e){l(t,w,v);var n=+e,i=d(n);if(n!=i)throw E(_);return i};if(a.ABV){if(!u(function(){new w})||!u(function(){new w(.5)})){for(var Y,Q=(w=function(t){return new C(X(this,t))})[b]=C[b],J=f(C),tt=0;J.length>tt;)(Y=J[tt++])in w||s(w,Y,C[Y]);o||(Q.constructor=w)}var et=new S(new w(2)),nt=S[b].setInt8;et.setInt8(0,2147483648),et.setInt8(1,2147483649),!et.getInt8(0)&&et.getInt8(1)||c(S[b],{setInt8:function(t,e){nt.call(this,t,e<<24>>24)},setUint8:function(t,e){nt.call(this,t,e<<24>>24)}},!0)}else w=function(t){var e=X(this,t);this._b=m.call(Array(e),0),this[M]=e},S=function(t,e,n){l(this,S,y),l(t,w,y);var i=t[M],r=h(e);if(r<0||r>i)throw E("Wrong offset!");if(n=void 0===n?i-r:d(n),r+n>i)throw E(_);this[B]=t,this[F]=r,this[M]=n},r&&(Z(w,D,"_l"),Z(S,I,"_b"),Z(S,D,"_l"),Z(S,O,"_o")),c(S[b],{getInt8:function(t){return G(this,1,t)[0]<<24>>24},getUint8:function(t){return G(this,1,t)[0]},getInt16:function(t){var e=G(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=G(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return H(G(this,4,t,arguments[1]))},getUint32:function(t){return H(G(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return j(G(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return j(G(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){K(this,1,t,$,e)},setUint8:function(t,e){K(this,1,t,$,e)},setInt16:function(t,e){K(this,2,t,U,e,arguments[2])},setUint16:function(t,e){K(this,2,t,U,e,arguments[2])},setInt32:function(t,e){K(this,4,t,q,e,arguments[2])},setUint32:function(t,e){K(this,4,t,q,e,arguments[2])},setFloat32:function(t,e){K(this,4,t,V,e,arguments[2])},setFloat64:function(t,e){K(this,8,t,W,e,arguments[2])}});g(w,v),g(S,y),s(S[b],a.VIEW,!0),n[v]=w,n[y]=S},{106:106,108:108,113:113,28:28,34:34,38:38,40:40,58:58,6:6,67:67,72:72,86:86,9:9,92:92}],113:[function(t,e){for(var n,i=t(38),r=t(40),o=t(114),a=o("typed_array"),s=o("view"),c=!(!i.ArrayBuffer||!i.DataView),u=c,l=0,h=9,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<h;)(n=i[d[l++]])?(r(n.prototype,a,!0),r(n.prototype,s,!0)):u=!1;e.exports={ABV:c,CONSTR:u,TYPED:a,VIEW:s}},{114:114,38:38,40:40}],114:[function(t,e){var n=0,i=Math.random();e.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},{}],115:[function(t,e){var n=t(38),i=t(23),r=t(58),o=t(116),a=t(67).f;e.exports=function(t){var e=i.Symbol||(i.Symbol=r?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:o.f(t)})}},{116:116,23:23,38:38,58:58,67:67}],116:[function(t,e,n){n.f=t(117)},{117:117}],117:[function(t,e){var n=t(94)("wks"),i=t(114),r=t(38).Symbol,o="function"==typeof r;(e.exports=function(t){return n[t]||(n[t]=o&&r[t]||(o?r:i)("Symbol."+t))}).store=n},{114:114,38:38,94:94}],118:[function(t,e){var n=t(17),i=t(117)("iterator"),r=t(56);e.exports=t(23).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||r[n(t)]}},{117:117,17:17,23:23,56:56}],119:[function(t){var e=t(32),n=t(88)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return n(t)}})},{32:32,88:88}],120:[function(t){var e=t(32);e(e.P,"Array",{copyWithin:t(8)}),t(5)("copyWithin")},{32:32,5:5,8:8}],121:[function(t){"use strict";var e=t(32),n=t(12)(4);e(e.P+e.F*!t(96)([].every,!0),"Array",{every:function(t){return n(this,t,arguments[1])}})},{12:12,32:32,96:96}],122:[function(t){var e=t(32);e(e.P,"Array",{fill:t(9)}),t(5)("fill")},{32:32,5:5,9:9}],123:[function(t){"use strict";var e=t(32),n=t(12)(2);e(e.P+e.F*!t(96)([].filter,!0),"Array",{filter:function(t){return n(this,t,arguments[1])}})},{12:12,32:32,96:96}],124:[function(t){"use strict";var e=t(32),n=t(12)(6),i="findIndex",r=!0;i in[]&&Array(1)[i](function(){r=!1}),e(e.P+e.F*r,"Array",{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)(i)},{12:12,32:32,5:5}],125:[function(t){"use strict";var e=t(32),n=t(12)(5),i="find",r=!0;i in[]&&Array(1)[i](function(){r=!1}),e(e.P+e.F*r,"Array",{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)(i)},{12:12,32:32,5:5}],126:[function(t){"use strict";var e=t(32),n=t(12)(0),i=t(96)([].forEach,!0);e(e.P+e.F*!i,"Array",{forEach:function(t){return n(this,t,arguments[1])}})},{12:12,32:32,96:96}],127:[function(t){"use strict";var e=t(25),n=t(32),i=t(109),r=t(51),o=t(46),a=t(108),s=t(24),c=t(118);n(n.S+n.F*!t(54)(function(t){Array.from(t)}),"Array",{from:function(t){var n,u,l,h,d=i(t),f="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m,v=0,y=c(d);if(g&&(m=e(m,p>2?arguments[2]:void 0,2)),void 0==y||f==Array&&o(y))for(n=a(d.length),u=new f(n);n>v;v++)s(u,v,g?m(d[v],v):d[v]);else for(h=y.call(d),u=new f;!(l=h.next()).done;v++)s(u,v,g?r(h,m,[l.value,v],!0):l.value);return u.length=v,u}})},{108:108,109:109,118:118,24:24,25:25,32:32,46:46,51:51,54:54}],128:[function(t){"use strict";var e=t(32),n=t(11)(!1),i=[].indexOf,r=!!i&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(r||!t(96)(i)),"Array",{indexOf:function(t){return r?i.apply(this,arguments)||0:n(this,t,arguments[1])}})},{11:11,32:32,96:96}],129:[function(t){var e=t(32);e(e.S,"Array",{isArray:t(47)})},{32:32,47:47}],130:[function(t,e){"use strict";var n=t(5),i=t(55),r=t(56),o=t(107);e.exports=t(53)(Array,"Array",function(t,e){this._t=o(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):"keys"==e?i(0,n):"values"==e?i(0,t[n]):i(0,[n,t[n]])},"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},{107:107,5:5,53:53,55:55,56:56}],131:[function(t){"use strict";var e=t(32),n=t(107),i=[].join;e(e.P+e.F*(t(45)!=Object||!t(96)(i)),"Array",{join:function(t){return i.call(n(this),void 0===t?",":t)}})},{107:107,32:32,45:45,96:96}],132:[function(t){"use strict";var e=t(32),n=t(107),i=t(106),r=t(108),o=[].lastIndexOf,a=!!o&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(a||!t(96)(o)),"Array",{lastIndexOf:function(t){if(a)return o.apply(this,arguments)||0;var e=n(this),s=r(e.length),c=s-1;for(arguments.length>1&&(c=Math.min(c,i(arguments[1]))),c<0&&(c=s+c);c>=0;c--)if(c in e&&e[c]===t)return c||0;return-1}})},{106:106,107:107,108:108,32:32,96:96}],133:[function(t){"use strict";var e=t(32),n=t(12)(1);e(e.P+e.F*!t(96)([].map,!0),"Array",{map:function(t){return n(this,t,arguments[1])}})},{12:12,32:32,96:96}],134:[function(t){"use strict";var e=t(32),n=t(24);e(e.S+e.F*t(34)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,i=new("function"==typeof this?this:Array)(e);e>t;)n(i,t,arguments[t++]);return i.length=e,i}})},{24:24,32:32,34:34}],135:[function(t){"use strict";var e=t(32),n=t(13);e(e.P+e.F*!t(96)([].reduceRight,!0),"Array",{reduceRight:function(t){return n(this,t,arguments.length,arguments[1],!0)}})},{13:13,32:32,96:96}],136:[function(t){"use strict";var e=t(32),n=t(13);e(e.P+e.F*!t(96)([].reduce,!0),"Array",{reduce:function(t){return n(this,t,arguments.length,arguments[1],!1)}})},{13:13,32:32,96:96}],137:[function(t){"use strict";var e=t(32),n=t(41),i=t(18),r=t(105),o=t(108),a=[].slice;e(e.P+e.F*t(34)(function(){n&&a.call(n)}),"Array",{slice:function(t,e){var n=o(this.length),s=i(this);if(e=void 0===e?n:e,"Array"==s)return a.call(this,t,e);for(var c=r(t,n),u=r(e,n),l=o(u-c),h=Array(l),d=0;d<l;d++)h[d]="String"==s?this.charAt(c+d):this[c+d];return h}})},{105:105,108:108,18:18,32:32,34:34,41:41}],138:[function(t){"use strict";var e=t(32),n=t(12)(3);e(e.P+e.F*!t(96)([].some,!0),"Array",{some:function(t){return n(this,t,arguments[1])}})},{12:12,32:32,96:96}],139:[function(t){"use strict";var e=t(32),n=t(3),i=t(109),r=t(34),o=[].sort,a=[1,2,3];e(e.P+e.F*(r(function(){a.sort(void 0)})||!r(function(){a.sort(null)})||!t(96)(o)),"Array",{sort:function(t){return void 0===t?o.call(i(this)):o.call(i(this),n(t))}})},{109:109,3:3,32:32,34:34,96:96}],140:[function(t){t(91)("Array")},{91:91}],141:[function(t){var e=t(32);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},{32:32}],142:[function(t){"use strict";var e=t(32),n=t(34),i=Date.prototype.getTime,r=function(t){return t>9?t:"0"+t};e(e.P+e.F*(n(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!n(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),o=e<0?"-":e>9999?"+":"";return o+("00000"+Math.abs(e)).slice(o?-6:-4)+"-"+r(t.getUTCMonth()+1)+"-"+r(t.getUTCDate())+"T"+r(t.getUTCHours())+":"+r(t.getUTCMinutes())+":"+r(t.getUTCSeconds())+"."+(n>99?n:"0"+r(n))+"Z"}})},{32:32,34:34}],143:[function(t){"use strict";var e=t(32),n=t(109),i=t(110);e(e.P+e.F*t(34)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(){var t=n(this),e=i(t);return"number"!=typeof e||isFinite(e)?t.toISOString():null}})},{109:109,110:110,32:32,34:34}],144:[function(t){var e=t(117)("toPrimitive"),n=Date.prototype;e in n||t(40)(n,e,t(26))},{117:117,26:26,40:40}],145:[function(t){var e=Date.prototype,n="Invalid Date",i="toString",r=e[i],o=e.getTime;new Date(NaN)+""!=n&&t(87)(e,i,function(){var t=o.call(this);return t==t?r.call(this):n})},{87:87}],146:[function(t){var e=t(32);e(e.P,"Function",{bind:t(16)})},{16:16,32:32}],147:[function(t){"use strict";var e=t(49),n=t(74),i=t(117)("hasInstance"),r=Function.prototype;i in r||t(67).f(r,i,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=n(t);)if(this.prototype===t)return!0;return!1}})},{117:117,49:49,67:67,74:74}],148:[function(t){var e=t(67).f,n=t(85),i=t(39),r=Function.prototype,o=/^\s*function ([^ (]*)/,a="name",s=Object.isExtensible||function(){return!0};a in r||t(28)&&e(r,a,{configurable:!0,get:function(){try{var t=this,r=(""+t).match(o)[1];return i(t,a)||!s(t)||e(t,a,n(5,r)),r}catch(t){return""}}})},{28:28,39:39,67:67,85:85}],149:[function(t,e){"use strict";var n=t(19);e.exports=t(22)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(this,t);return e&&e.v},set:function(t,e){return n.def(this,0===t?0:t,e)}},n,!0)},{19:19,22:22}],150:[function(t){var e=t(32),n=t(60),i=Math.sqrt,r=Math.acosh;e(e.S+e.F*!(r&&710==Math.floor(r(Number.MAX_VALUE))&&r(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:n(t-1+i(t-1)*i(t+1))}})},{32:32,60:60}],151:[function(t){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var n=t(32),i=Math.asinh;n(n.S+n.F*!(i&&1/i(0)>0),"Math",{asinh:e})},{32:32}],152:[function(t){var e=t(32),n=Math.atanh;e(e.S+e.F*!(n&&1/n(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},{32:32}],153:[function(t){var e=t(32),n=t(61);e(e.S,"Math",{cbrt:function(t){return n(t=+t)*Math.pow(Math.abs(t),1/3)}})},{32:32,61:61}],154:[function(t){var e=t(32);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},{32:32}],155:[function(t){var e=t(32),n=Math.exp;e(e.S,"Math",{cosh:function(t){return(n(t=+t)+n(-t))/2}})},{32:32}],156:[function(t){var e=t(32),n=t(59);e(e.S+e.F*(n!=Math.expm1),"Math",{expm1:n})},{32:32,59:59}],157:[function(t){var e=t(32),n=t(61),i=Math.pow,r=i(2,-52),o=i(2,-23),a=i(2,127)*(2-o),s=i(2,-126),c=function(t){return t+1/r-1/r};e(e.S,"Math",{fround:function(t){var e,i,u=Math.abs(t),l=n(t);return u<s?l*c(u/s/o)*s*o:(e=(1+o/r)*u,(i=e-(e-u))>a||i!=i?l*(1/0):l*i)}})},{32:32,61:61}],158:[function(t){var e=t(32),n=Math.abs;e(e.S,"Math",{hypot:function(){for(var t,e,i=0,r=0,o=arguments.length,a=0;r<o;)t=n(arguments[r++]),a<t?(e=a/t,i=i*e*e+1,a=t):t>0?(e=t/a,i+=e*e):i+=t;return a===1/0?1/0:a*Math.sqrt(i)}})},{32:32}],159:[function(t){var e=t(32),n=Math.imul;e(e.S+e.F*t(34)(function(){return-5!=n(4294967295,5)||2!=n.length}),"Math",{imul:function(t,e){var n=65535,i=+t,r=+e,o=n&i,a=n&r;return 0|o*a+((n&i>>>16)*a+o*(n&r>>>16)<<16>>>0)}})},{32:32,34:34}],160:[function(t){var e=t(32);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},{32:32}],161:[function(t){var e=t(32);e(e.S,"Math",{log1p:t(60)})},{32:32,60:60}],162:[function(t){var e=t(32);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},{32:32}],163:[function(t){var e=t(32);e(e.S,"Math",{sign:t(61)})},{32:32,61:61}],164:[function(t){var e=t(32),n=t(59),i=Math.exp;e(e.S+e.F*t(34)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(n(t)-n(-t))/2:(i(t-1)-i(-t-1))*(Math.E/2)}})},{32:32,34:34,59:59}],165:[function(t){var e=t(32),n=t(59),i=Math.exp;e(e.S,"Math",{tanh:function(t){var e=n(t=+t),r=n(-t);return e==1/0?1:r==1/0?-1:(e-r)/(i(t)+i(-t))}})},{32:32,59:59}],166:[function(t){var e=t(32);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},{32:32}],167:[function(t){"use strict";var e=t(38),n=t(39),i=t(18),r=t(43),o=t(110),a=t(34),s=t(72).f,c=t(70).f,u=t(67).f,l=t(102).trim,h="Number",d=e[h],f=d,p=d.prototype,m=i(t(66)(p))==h,g="trim"in String.prototype,v=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){var n,i,r,a=(e=g?e.trim():l(e,3)).charCodeAt(0);if(43===a||45===a){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var s,c=e.slice(2),u=0,h=c.length;u<h;u++)if((s=c.charCodeAt(u))<48||s>r)return NaN;return parseInt(c,i)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof d&&(m?a(function(){p.valueOf.call(n)}):i(n)!=h)?r(new f(v(e)),n,d):v(e)};for(var y,b=t(28)?s(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;b.length>_;_++)n(f,y=b[_])&&!n(d,y)&&u(d,y,c(f,y));d.prototype=p,p.constructor=d,t(87)(e,h,d)}},{102:102,110:110,18:18,28:28,34:34,38:38,39:39,43:43,66:66,67:67,70:70,72:72,87:87}],168:[function(t){var e=t(32);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},{32:32}],169:[function(t){var e=t(32),n=t(38).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&n(t)}})},{32:32,38:38}],170:[function(t){var e=t(32);e(e.S,"Number",{isInteger:t(48)})},{32:32,48:48}],171:[function(t){var e=t(32);e(e.S,"Number",{isNaN:function(t){return t!=t}})},{32:32}],172:[function(t){var e=t(32),n=t(48),i=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return n(t)&&i(t)<=9007199254740991}})},{32:32,48:48}],173:[function(t){var e=t(32);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{32:32}],174:[function(t){var e=t(32);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{32:32}],175:[function(t){var e=t(32),n=t(81);e(e.S+e.F*(Number.parseFloat!=n),"Number",{parseFloat:n})},{32:32,81:81}],176:[function(t){var e=t(32),n=t(82);e(e.S+e.F*(Number.parseInt!=n),"Number",{parseInt:n})},{32:32,82:82}],177:[function(t){"use strict";var e=t(32),n=t(106),i=t(4),r=t(101),o=1..toFixed,a=Math.floor,s=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",u="0",l=function(t,e){for(var n=-1,i=e;++n<6;)i+=t*s[n],s[n]=i%1e7,i=a(i/1e7)},h=function(t){for(var e=6,n=0;--e>=0;)n+=s[e],s[e]=a(n/t),n=n%t*1e7},d=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==s[t]){var n=String(s[t]);e=""===e?n:e+r.call(u,7-n.length)+n}return e},f=function(t,e,n){return 0===e?n:e%2==1?f(t,e-1,n*t):f(t*t,e/2,n)},p=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e};e(e.P+e.F*(!!o&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!t(34)(function(){o.call({})})),"Number",{toFixed:function(t){var e,o,a,s,m=i(this,c),g=n(t),v="",y=u;if(g<0||g>20)throw RangeError(c);if(m!=m)return"NaN";if(m<=-1e21||m>=1e21)return String(m);if(m<0&&(v="-",m=-m),m>1e-21)if(e=p(m*f(2,69,1))-69,o=e<0?m*f(2,-e,1):m/f(2,e,1),o*=4503599627370496,(e=52-e)>0){for(l(0,o),a=g;a>=7;)l(1e7,0),a-=7;for(l(f(10,a,1),0),a=e-1;a>=23;)h(1<<23),a-=23;h(1<<a),l(1,1),h(2),y=d()}else l(0,o),l(1<<-e,0),y=d()+r.call(u,g);return g>0?(s=y.length,y=v+(s<=g?"0."+r.call(u,g-s)+y:y.slice(0,s-g)+"."+y.slice(s-g))):y=v+y,y}})},{101:101,106:106,32:32,34:34,4:4}],178:[function(t){"use strict";var e=t(32),n=t(34),i=t(4),r=1..toPrecision;e(e.P+e.F*(n(function(){return"1"!==r.call(1,void 0)})||!n(function(){r.call({})})),"Number",{toPrecision:function(t){var e=i(this,"Number#toPrecision: incorrect invocation!");return void 0===t?r.call(e):r.call(e,t)}})},{32:32,34:34,4:4}],179:[function(t){var e=t(32);e(e.S+e.F,"Object",{assign:t(65)})},{32:32,65:65}],180:[function(t){var e=t(32);e(e.S,"Object",{create:t(66)})},{32:32,66:66}],181:[function(t){var e=t(32);e(e.S+e.F*!t(28),"Object",{defineProperties:t(68)})},{28:28,32:32,68:68}],182:[function(t){var e=t(32);e(e.S+e.F*!t(28),"Object",{defineProperty:t(67).f})},{28:28,32:32,67:67}],183:[function(t){var e=t(49),n=t(62).onFreeze;t(78)("freeze",function(t){return function(i){return t&&e(i)?t(n(i)):i}})},{49:49,62:62,78:78}],184:[function(t){var e=t(107),n=t(70).f;t(78)("getOwnPropertyDescriptor",function(){return function(t,i){return n(e(t),i)}})},{107:107,70:70,78:78}],185:[function(t){t(78)("getOwnPropertyNames",function(){return t(71).f})},{71:71,78:78}],186:[function(t){var e=t(109),n=t(74);t(78)("getPrototypeOf",function(){return function(t){return n(e(t))}})},{109:109,74:74,78:78}],187:[function(t){var e=t(49);t(78)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},{49:49,78:78}],188:[function(t){var e=t(49);t(78)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},{49:49,78:78}],189:[function(t){var e=t(49);t(78)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},{49:49,78:78}],190:[function(t){var e=t(32);e(e.S,"Object",{is:t(89)})},{32:32,89:89}],191:[function(t){var e=t(109),n=t(76);t(78)("keys",function(){return function(t){return n(e(t))}})},{109:109,76:76,78:78}],192:[function(t){var e=t(49),n=t(62).onFreeze;t(78)("preventExtensions",function(t){return function(i){return t&&e(i)?t(n(i)):i}})},{49:49,62:62,78:78}],193:[function(t){var e=t(49),n=t(62).onFreeze;t(78)("seal",function(t){return function(i){return t&&e(i)?t(n(i)):i}})},{49:49,62:62,78:78}],194:[function(t){var e=t(32);e(e.S,"Object",{setPrototypeOf:t(90).set})},{32:32,90:90}],195:[function(t){"use strict";var e=t(17),n={};n[t(117)("toStringTag")]="z",n+""!="[object z]"&&t(87)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},{117:117,17:17,87:87}],196:[function(t){var e=t(32),n=t(81);e(e.G+e.F*(parseFloat!=n),{parseFloat:n})},{32:32,81:81}],197:[function(t){var e=t(32),n=t(82);e(e.G+e.F*(parseInt!=n),{parseInt:n})},{32:32,82:82}],198:[function(t){"use strict";var e,n,i,r=t(58),o=t(38),a=t(25),s=t(17),c=t(32),u=t(49),l=t(3),h=t(6),d=t(37),f=t(95),p=t(104).set,m=t(64)(),g="Promise",v=o.TypeError,y=o.process,b=o[g],_="process"==s(y=o.process),x=function(){},w=!!function(){try{var e=b.resolve(1),n=(e.constructor={})[t(117)("species")]=function(t){t(x,x)};return(_||"function"==typeof PromiseRejectionEvent)&&e.then(x)instanceof n}catch(t){}}(),S=function(t,e){return t===e||t===b&&e===i},k=function(t){var e;return!(!u(t)||"function"!=typeof(e=t.then))&&e},E=function(t){return S(b,t)?new T(t):new n(t)},T=n=function(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw v("Bad Promise constructor");e=t,n=i}),this.resolve=l(e),this.reject=l(n)},C=function(t){try{t()}catch(t){return{error:t}}},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;m(function(){for(var i=t._v,r=1==t._s,o=0,a=function(e){var n,o,a=r?e.ok:e.fail,s=e.resolve,c=e.reject,u=e.domain;try{a?(r||(2==t._h&&N(t),t._h=1),!0===a?n=i:(u&&u.enter(),n=a(i),u&&u.exit()),n===e.promise?c(v("Promise-chain cycle")):(o=k(n))?o.call(n,s,c):s(n)):c(i)}catch(t){c(t)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&P(t)})}},P=function(t){p.call(o,function(){var e,n,i,r=t._v;if(A(t)&&(e=C(function(){_?y.emit("unhandledRejection",r,t):(n=o.onunhandledrejection)?n({promise:t,reason:r}):(i=o.console)&&i.error&&i.error("Unhandled promise rejection",r)}),t._h=_||A(t)?2:1),t._a=void 0,e)throw e.error})},A=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,i=0;n.length>i;)if((e=n[i++]).fail||!A(e.promise))return!1;return!0},N=function(t){p.call(o,function(){var e;_?y.emit("rejectionHandled",t):(e=o.onrejectionhandled)&&e({promise:t,reason:t._v})})},R=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},I=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw v("Promise can't be resolved itself");(e=k(t))?m(function(){var i={_w:n,_d:!1};try{e.call(t,a(I,i,1),a(R,i,1))}catch(t){R.call(i,t)}}):(n._v=t,n._s=1,L(n,!1))}catch(t){R.call({_w:n,_d:!1},t)}}};w||(b=function(t){h(this,b,g,"_h"),l(t),e.call(this);try{t(a(I,this,1),a(R,this,1))}catch(t){R.call(this,t)}},e=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=t(86)(b.prototype,{then:function(t,e){var n=E(f(this,b));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=_?y.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},"catch":function(t){return this.then(void 0,t)}}),T=function(){var t=new e;this.promise=t,this.resolve=a(I,t,1),this.reject=a(R,t,1)}),c(c.G+c.W+c.F*!w,{Promise:b}),t(92)(b,g),t(91)(g),i=t(23)[g],c(c.S+c.F*!w,g,{reject:function(t){var e=E(this);return(0,e.reject)(t),e.promise}}),c(c.S+c.F*(r||!w),g,{resolve:function(t){if(t instanceof b&&S(t.constructor,this))return t;var e=E(this);return(0,e.resolve)(t),e.promise}}),c(c.S+c.F*!(w&&t(54)(function(t){b.all(t)["catch"](x)})),g,{all:function(t){var e=this,n=E(e),i=n.resolve,r=n.reject,o=C(function(){var n=[],o=0,a=1;d(t,!1,function(t){var s=o++,c=!1;n.push(void 0),a++,e.resolve(t).then(function(t){c||(c=!0,n[s]=t,--a||i(n))},r)}),--a||i(n)});return o&&r(o.error),n.promise},race:function(t){var e=this,n=E(e),i=n.reject,r=C(function(){d(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r&&i(r.error),n.promise}})},{104:104,117:117,17:17,23:23,25:25,3:3,32:32,37:37,38:38,49:49,54:54,58:58,6:6,64:64,86:86,91:91,92:92,95:95}],199:[function(t){var e=t(32),n=t(3),i=t(7),r=(t(38).Reflect||{}).apply,o=Function.apply;e(e.S+e.F*!t(34)(function(){r(function(){})}),"Reflect",{apply:function(t,e,a){var s=n(t),c=i(a);return r?r(s,e,c):o.call(s,e,c)}})},{3:3,32:32,34:34,38:38,7:7}],200:[function(t){var e=t(32),n=t(66),i=t(3),r=t(7),o=t(49),a=t(34),s=t(16),c=(t(38).Reflect||{}).construct,u=a(function(){function t(){}return!(c(function(){},[],t)instanceof t)}),l=!a(function(){c(function(){})});e(e.S+e.F*(u||l),"Reflect",{construct:function(t,e){i(t),r(e);var a=arguments.length<3?t:i(arguments[2]);if(l&&!u)return c(t,e,a);if(t==a){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var h=[null];return h.push.apply(h,e),new(s.apply(t,h))}var d=a.prototype,f=n(o(d)?d:Object.prototype),p=Function.apply.call(t,f,e);return o(p)?p:f}})},{16:16,3:3,32:32,34:34,38:38,49:49,66:66,7:7}],201:[function(t){var e=t(67),n=t(32),i=t(7),r=t(110);n(n.S+n.F*t(34)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,o){i(t),n=r(n,!0),i(o);try{return e.f(t,n,o),!0}catch(t){return!1}}})},{110:110,32:32,34:34,67:67,7:7}],202:[function(t){var e=t(32),n=t(70).f,i=t(7);e(e.S,"Reflect",{deleteProperty:function(t,e){var r=n(i(t),e);return!(r&&!r.configurable)&&delete t[e]}})},{32:32,7:7,70:70}],203:[function(t){"use strict";var e=t(32),n=t(7),i=function(t){this._t=n(t),this._i=0;var e,i=this._k=[];for(e in t)i.push(e)};t(52)(i,"Object",function(){var t,e=this,n=e._k;do{if(e._i>=n.length)return{value:void 0,done:!0}}while(!((t=n[e._i++])in e._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new i(t)}})},{32:32,52:52,7:7}],204:[function(t){var e=t(70),n=t(32),i=t(7);n(n.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(i(t),n)}})},{32:32,7:7,70:70}],205:[function(t){var e=t(32),n=t(74),i=t(7);e(e.S,"Reflect",{getPrototypeOf:function(t){return n(i(t))}})},{32:32,7:7,74:74}],206:[function(t){function e(t,o){var c,u,l=arguments.length<3?t:arguments[2];return s(t)===l?t[o]:(c=n.f(t,o))?r(c,"value")?c.value:void 0!==c.get?c.get.call(l):void 0:a(u=i(t))?e(u,o,l):void 0}var n=t(70),i=t(74),r=t(39),o=t(32),a=t(49),s=t(7);o(o.S,"Reflect",{get:e})},{32:32,39:39,49:49,7:7,70:70,74:74}],207:[function(t){var e=t(32);e(e.S,"Reflect",{has:function(t,e){return e in t}})},{32:32}],208:[function(t){var e=t(32),n=t(7),i=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return n(t),!i||i(t)}})},{32:32,7:7}],209:[function(t){var e=t(32);e(e.S,"Reflect",{ownKeys:t(80)})},{32:32,80:80}],210:[function(t){var e=t(32),n=t(7),i=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){n(t);try{return i&&i(t),!0}catch(t){return!1}}})},{32:32,7:7}],211:[function(t){var e=t(32),n=t(90);n&&e(e.S,"Reflect",{setPrototypeOf:function(t,e){n.check(t,e);try{return n.set(t,e),!0}catch(t){return!1}}})},{32:32,90:90}],212:[function(t){function e(t,a,l){var h,d,f=arguments.length<4?t:arguments[3],p=i.f(c(t),a);if(!p){if(u(d=r(t)))return e(d,a,l,f);p=s(0)}return o(p,"value")?!(!1===p.writable||!u(f)||(h=i.f(f,a)||s(0),h.value=l,n.f(f,a,h),0)):void 0!==p.set&&(p.set.call(f,l),!0)}var n=t(67),i=t(70),r=t(74),o=t(39),a=t(32),s=t(85),c=t(7),u=t(49);a(a.S,"Reflect",{set:e})},{32:32,39:39,49:49,67:67,7:7,70:70,74:74,85:85}],213:[function(t){var e=t(38),n=t(43),i=t(67).f,r=t(72).f,o=t(50),a=t(36),s=e.RegExp,c=s,u=s.prototype,l=/a/g,h=/a/g,d=new s(l)!==l;if(t(28)&&(!d||t(34)(function(){return h[t(117)("match")]=!1,s(l)!=l||s(h)==h||"/a/i"!=s(l,"i")}))){s=function(t,e){var i=this instanceof s,r=o(t),l=void 0===e;return!i&&r&&t.constructor===s&&l?t:n(d?new c(r&&!l?t.source:t,e):c((r=t instanceof s)?t.source:t,r&&l?a.call(t):e),i?this:u,s)};for(var f=function(t){t in s||i(s,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})},p=r(c),m=0;p.length>m;)f(p[m++]);u.constructor=s,s.prototype=u,t(87)(e,"RegExp",s)}t(91)("RegExp")},{117:117,28:28,34:34,36:36,38:38,43:43,50:50,67:67,72:72,87:87,91:91}],214:[function(t){t(28)&&"g"!=/./g.flags&&t(67).f(RegExp.prototype,"flags",{configurable:!0,get:t(36)})},{28:28,36:36,67:67}],215:[function(t){t(35)("match",1,function(t,e,n){return[function(n){"use strict";var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},n]})},{35:35}],216:[function(t){t(35)("replace",2,function(t,e,n){return[function(i,r){"use strict";var o=t(this),a=void 0==i?void 0:i[e];return void 0!==a?a.call(i,o,r):n.call(String(o),i,r)},n]})},{35:35}],217:[function(t){t(35)("search",1,function(t,e,n){return[function(n){"use strict";var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},n]})},{35:35}],218:[function(t){t(35)("split",2,function(e,n,i){"use strict";var r=t(50),o=i,a=[].push,s="split",c="length",u="lastIndex";if("c"=="abbc"[s](/(b)*/)[1]||4!="test"[s](/(?:)/,-1)[c]||2!="ab"[s](/(?:ab)*/)[c]||4!="."[s](/(.?)(.?)/)[c]||"."[s](/()()/)[c]>1||""[s](/.?/)[c]){var l=void 0===/()??/.exec("")[1];i=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!r(t))return o.call(n,t,e);var i,s,h,d,f,p=[],m=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),g=0,v=void 0===e?4294967295:e>>>0,y=new RegExp(t.source,m+"g");for(l||(i=new RegExp("^"+y.source+"$(?!\\s)",m));(s=y.exec(n))&&!((h=s.index+s[0][c])>g&&(p.push(n.slice(g,s.index)),!l&&s[c]>1&&s[0].replace(i,function(){for(f=1;f<arguments[c]-2;f++)void 0===arguments[f]&&(s[f]=void 0)}),s[c]>1&&s.index<n[c]&&a.apply(p,s.slice(1)),d=s[0][c],g=h,p[c]>=v));)y[u]===s.index&&y[u]++;return g===n[c]?!d&&y.test("")||p.push(""):p.push(n.slice(g)),p[c]>v?p.slice(0,v):p}}else"0"[s](void 0,0)[c]&&(i=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(t,r){var o=e(this),a=void 0==t?void 0:t[n];return void 0!==a?a.call(t,o,r):i.call(String(o),t,r)},i]})},{35:35,50:50}],219:[function(t){"use strict";t(214);var e=t(7),n=t(36),i=t(28),r="toString",o=/./[r],a=function(e){t(87)(RegExp.prototype,r,e,!0)};t(34)(function(){return"/a/b"!=o.call({source:"a",flags:"b"})})?a(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!i&&t instanceof RegExp?n.call(t):void 0)}):o.name!=r&&a(function(){return o.call(this)})},{214:214,28:28,34:34,36:36,7:7,87:87}],220:[function(t,e){"use strict";var n=t(19);e.exports=t(22)("Set",function(t){
return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(this,t=0===t?0:t,t)}},n)},{19:19,22:22}],221:[function(t){"use strict";t(99)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},{99:99}],222:[function(t){"use strict";t(99)("big",function(t){return function(){return t(this,"big","","")}})},{99:99}],223:[function(t){"use strict";t(99)("blink",function(t){return function(){return t(this,"blink","","")}})},{99:99}],224:[function(t){"use strict";t(99)("bold",function(t){return function(){return t(this,"b","","")}})},{99:99}],225:[function(t){"use strict";var e=t(32),n=t(97)(!1);e(e.P,"String",{codePointAt:function(t){return n(this,t)}})},{32:32,97:97}],226:[function(t){"use strict";var e=t(32),n=t(108),i=t(98),r="endsWith",o=""[r];e(e.P+e.F*t(33)(r),"String",{endsWith:function(t){var e=i(this,t,r),a=arguments.length>1?arguments[1]:void 0,s=n(e.length),c=void 0===a?s:Math.min(n(a),s),u=String(t);return o?o.call(e,u,c):e.slice(c-u.length,c)===u}})},{108:108,32:32,33:33,98:98}],227:[function(t){"use strict";t(99)("fixed",function(t){return function(){return t(this,"tt","","")}})},{99:99}],228:[function(t){"use strict";t(99)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},{99:99}],229:[function(t){"use strict";t(99)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},{99:99}],230:[function(t){var e=t(32),n=t(105),i=String.fromCharCode,r=String.fromCodePoint;e(e.S+e.F*(!!r&&1!=r.length),"String",{fromCodePoint:function(){for(var t,e=[],r=arguments.length,o=0;r>o;){if(t=+arguments[o++],n(t,1114111)!==t)throw RangeError(t+" is not a valid code point");e.push(t<65536?i(t):i(55296+((t-=65536)>>10),t%1024+56320))}return e.join("")}})},{105:105,32:32}],231:[function(t){"use strict";var e=t(32),n=t(98),i="includes";e(e.P+e.F*t(33)(i),"String",{includes:function(t){return!!~n(this,t,i).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},{32:32,33:33,98:98}],232:[function(t){"use strict";t(99)("italics",function(t){return function(){return t(this,"i","","")}})},{99:99}],233:[function(t){"use strict";var e=t(97)(!0);t(53)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,i=this._i;return i>=n.length?{value:void 0,done:!0}:(t=e(n,i),this._i+=t.length,{value:t,done:!1})})},{53:53,97:97}],234:[function(t){"use strict";t(99)("link",function(t){return function(e){return t(this,"a","href",e)}})},{99:99}],235:[function(t){var e=t(32),n=t(107),i=t(108);e(e.S,"String",{raw:function(t){for(var e=n(t.raw),r=i(e.length),o=arguments.length,a=[],s=0;r>s;)a.push(String(e[s++])),s<o&&a.push(String(arguments[s]));return a.join("")}})},{107:107,108:108,32:32}],236:[function(t){var e=t(32);e(e.P,"String",{repeat:t(101)})},{101:101,32:32}],237:[function(t){"use strict";t(99)("small",function(t){return function(){return t(this,"small","","")}})},{99:99}],238:[function(t){"use strict";var e=t(32),n=t(108),i=t(98),r="startsWith",o=""[r];e(e.P+e.F*t(33)(r),"String",{startsWith:function(t){var e=i(this,t,r),a=n(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),s=String(t);return o?o.call(e,s,a):e.slice(a,a+s.length)===s}})},{108:108,32:32,33:33,98:98}],239:[function(t){"use strict";t(99)("strike",function(t){return function(){return t(this,"strike","","")}})},{99:99}],240:[function(t){"use strict";t(99)("sub",function(t){return function(){return t(this,"sub","","")}})},{99:99}],241:[function(t){"use strict";t(99)("sup",function(t){return function(){return t(this,"sup","","")}})},{99:99}],242:[function(t){"use strict";t(102)("trim",function(t){return function(){return t(this,3)}})},{102:102}],243:[function(t){"use strict";var e=t(38),n=t(39),i=t(28),r=t(32),o=t(87),a=t(62).KEY,s=t(34),c=t(94),u=t(92),l=t(114),h=t(117),d=t(116),f=t(115),p=t(57),m=t(31),g=t(47),v=t(7),y=t(107),b=t(110),_=t(85),x=t(66),w=t(71),S=t(70),k=t(67),E=t(76),T=S.f,C=k.f,L=w.f,P=e.Symbol,A=e.JSON,N=A&&A.stringify,R="prototype",I=h("_hidden"),D=h("toPrimitive"),O={}.propertyIsEnumerable,B=c("symbol-registry"),M=c("symbols"),F=c("op-symbols"),z=Object[R],j="function"==typeof P,H=e.QObject,$=!H||!H[R]||!H[R].findChild,U=i&&s(function(){return 7!=x(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=T(z,e);i&&delete z[e],C(t,e,n),i&&t!==z&&C(z,e,i)}:C,q=function(t){var e=M[t]=x(P[R]);return e._k=t,e},W=j&&"symbol"==typeof P.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof P},V=function(t,e,i){return t===z&&V(F,e,i),v(t),e=b(e,!0),v(i),n(M,e)?(i.enumerable?(n(t,I)&&t[I][e]&&(t[I][e]=!1),i=x(i,{enumerable:_(0,!1)})):(n(t,I)||C(t,I,_(1,{})),t[I][e]=!0),U(t,e,i)):C(t,e,i)},Z=function(t,e){v(t);for(var n,i=m(e=y(e)),r=0,o=i.length;o>r;)V(t,n=i[r++],e[n]);return t},G=function(t,e){return void 0===e?x(t):Z(x(t),e)},K=function(t){var e=O.call(this,t=b(t,!0));return!(this===z&&n(M,t)&&!n(F,t))&&(!(e||!n(this,t)||!n(M,t)||n(this,I)&&this[I][t])||e)},X=function(t,e){if(t=y(t),e=b(e,!0),t!==z||!n(M,e)||n(F,e)){var i=T(t,e);return!i||!n(M,e)||n(t,I)&&t[I][e]||(i.enumerable=!0),i}},Y=function(t){for(var e,i=L(y(t)),r=[],o=0;i.length>o;)n(M,e=i[o++])||e==I||e==a||r.push(e);return r},Q=function(t){for(var e,i=t===z,r=L(i?F:y(t)),o=[],a=0;r.length>a;)!n(M,e=r[a++])||i&&!n(z,e)||o.push(M[e]);return o};j||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var t=l(arguments.length>0?arguments[0]:void 0),e=function(i){this===z&&e.call(F,i),n(this,I)&&n(this[I],t)&&(this[I][t]=!1),U(this,t,_(1,i))};return i&&$&&U(z,t,{configurable:!0,set:e}),q(t)},o(P[R],"toString",function(){return this._k}),S.f=X,k.f=V,t(72).f=w.f=Y,t(77).f=K,t(73).f=Q,i&&!t(58)&&o(z,"propertyIsEnumerable",K,!0),d.f=function(t){return q(h(t))}),r(r.G+r.W+r.F*!j,{Symbol:P});for(var J="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;J.length>tt;)h(J[tt++]);for(J=E(h.store),tt=0;J.length>tt;)f(J[tt++]);r(r.S+r.F*!j,"Symbol",{"for":function(t){return n(B,t+="")?B[t]:B[t]=P(t)},keyFor:function(t){if(W(t))return p(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){$=!0},useSimple:function(){$=!1}}),r(r.S+r.F*!j,"Object",{create:G,defineProperty:V,defineProperties:Z,getOwnPropertyDescriptor:X,getOwnPropertyNames:Y,getOwnPropertySymbols:Q}),A&&r(r.S+r.F*(!j||s(function(){var t=P();return"[null]"!=N([t])||"{}"!=N({a:t})||"{}"!=N(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!W(t)){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);return"function"==typeof(e=i[1])&&(n=e),!n&&g(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!W(e))return e}),i[1]=e,N.apply(A,i)}}}),P[R][D]||t(40)(P[R],D,P[R].valueOf),u(P,"Symbol"),u(Math,"Math",!0),u(e.JSON,"JSON",!0)},{107:107,110:110,114:114,115:115,116:116,117:117,28:28,31:31,32:32,34:34,38:38,39:39,40:40,47:47,57:57,58:58,62:62,66:66,67:67,7:7,70:70,71:71,72:72,73:73,76:76,77:77,85:85,87:87,92:92,94:94}],244:[function(t){"use strict";var e=t(32),n=t(113),i=t(112),r=t(7),o=t(105),a=t(108),s=t(49),c=t(38).ArrayBuffer,u=t(95),l=i.ArrayBuffer,h=i.DataView,d=n.ABV&&c.isView,f=l.prototype.slice,p=n.VIEW,m="ArrayBuffer";e(e.G+e.W+e.F*(c!==l),{ArrayBuffer:l}),e(e.S+e.F*!n.CONSTR,m,{isView:function(t){return d&&d(t)||s(t)&&p in t}}),e(e.P+e.U+e.F*t(34)(function(){return!new l(2).slice(1,void 0).byteLength}),m,{slice:function(t,e){if(void 0!==f&&void 0===e)return f.call(r(this),t);for(var n=r(this).byteLength,i=o(t,n),s=o(void 0===e?n:e,n),c=new(u(this,l))(a(s-i)),d=new h(this),p=new h(c),m=0;i<s;)p.setUint8(m++,d.getUint8(i++));return c}}),t(91)(m)},{105:105,108:108,112:112,113:113,32:32,34:34,38:38,49:49,7:7,91:91,95:95}],245:[function(t){var e=t(32);e(e.G+e.W+e.F*!t(113).ABV,{DataView:t(112).DataView})},{112:112,113:113,32:32}],246:[function(t){t(111)("Float32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},{111:111}],247:[function(t){t(111)("Float64",8,function(t){return function(e,n,i){return t(this,e,n,i)}})},{111:111}],248:[function(t){t(111)("Int16",2,function(t){return function(e,n,i){return t(this,e,n,i)}})},{111:111}],249:[function(t){t(111)("Int32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},{111:111}],250:[function(t){t(111)("Int8",1,function(t){return function(e,n,i){return t(this,e,n,i)}})},{111:111}],251:[function(t){t(111)("Uint16",2,function(t){return function(e,n,i){return t(this,e,n,i)}})},{111:111}],252:[function(t){t(111)("Uint32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},{111:111}],253:[function(t){t(111)("Uint8",1,function(t){return function(e,n,i){return t(this,e,n,i)}})},{111:111}],254:[function(t){t(111)("Uint8",1,function(t){return function(e,n,i){return t(this,e,n,i)}},!0)},{111:111}],255:[function(t,e){"use strict";var n,i=t(12)(0),r=t(87),o=t(62),a=t(65),s=t(21),c=t(49),u=o.getWeak,l=Object.isExtensible,h=s.ufstore,d={},f=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},p={get:function(t){if(c(t)){var e=u(t);return!0===e?h(this).get(t):e?e[this._i]:void 0}},set:function(t,e){return s.def(this,t,e)}},m=e.exports=t(22)("WeakMap",f,p,s,!0,!0);7!=(new m).set((Object.freeze||Object)(d),7).get(d)&&(n=s.getConstructor(f),a(n.prototype,p),o.NEED=!0,i(["delete","has","get","set"],function(t){var e=m.prototype,i=e[t];r(e,t,function(e,r){if(c(e)&&!l(e)){this._f||(this._f=new n);var o=this._f[t](e,r);return"set"==t?this:o}return i.call(this,e,r)})}))},{12:12,21:21,22:22,49:49,62:62,65:65,87:87}],256:[function(t){"use strict";var e=t(21);t(22)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},{21:21,22:22}],257:[function(t){"use strict";var e=t(32),n=t(11)(!0);e(e.P,"Array",{includes:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)("includes")},{11:11,32:32,5:5}],258:[function(t){var e=t(32),n=t(64)(),i=t(38).process,r="process"==t(18)(i);e(e.G,{asap:function(t){var e=r&&i.domain;n(e?e.bind(t):t)}})},{18:18,32:32,38:38,64:64}],259:[function(t){var e=t(32),n=t(18);e(e.S,"Error",{isError:function(t){return"Error"===n(t)}})},{18:18,32:32}],260:[function(t){var e=t(32);e(e.P+e.R,"Map",{toJSON:t(20)("Map")})},{20:20,32:32}],261:[function(t){var e=t(32);e(e.S,"Math",{iaddh:function(t,e,n,i){var r=t>>>0,o=n>>>0;return(e>>>0)+(i>>>0)+((r&o|(r|o)&~(r+o>>>0))>>>31)|0}})},{32:32}],262:[function(t){var e=t(32);e(e.S,"Math",{imulh:function(t,e){var n=65535,i=+t,r=+e,o=i&n,a=r&n,s=i>>16,c=r>>16,u=(s*a>>>0)+(o*a>>>16);return s*c+(u>>16)+((o*c>>>0)+(u&n)>>16)}})},{32:32}],263:[function(t){var e=t(32);e(e.S,"Math",{isubh:function(t,e,n,i){var r=t>>>0,o=n>>>0;return(e>>>0)-(i>>>0)-((~r&o|~(r^o)&r-o>>>0)>>>31)|0}})},{32:32}],264:[function(t){var e=t(32);e(e.S,"Math",{umulh:function(t,e){var n=65535,i=+t,r=+e,o=i&n,a=r&n,s=i>>>16,c=r>>>16,u=(s*a>>>0)+(o*a>>>16);return s*c+(u>>>16)+((o*c>>>0)+(u&n)>>>16)}})},{32:32}],265:[function(t){"use strict";var e=t(32),n=t(109),i=t(3),r=t(67);t(28)&&e(e.P+t(69),"Object",{__defineGetter__:function(t,e){r.f(n(this),t,{get:i(e),enumerable:!0,configurable:!0})}})},{109:109,28:28,3:3,32:32,67:67,69:69}],266:[function(t){"use strict";var e=t(32),n=t(109),i=t(3),r=t(67);t(28)&&e(e.P+t(69),"Object",{__defineSetter__:function(t,e){r.f(n(this),t,{set:i(e),enumerable:!0,configurable:!0})}})},{109:109,28:28,3:3,32:32,67:67,69:69}],267:[function(t){var e=t(32),n=t(79)(!0);e(e.S,"Object",{entries:function(t){return n(t)}})},{32:32,79:79}],268:[function(t){var e=t(32),n=t(80),i=t(107),r=t(70),o=t(24);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,a=i(t),s=r.f,c=n(a),u={},l=0;c.length>l;)o(u,e=c[l++],s(a,e));return u}})},{107:107,24:24,32:32,70:70,80:80}],269:[function(t){"use strict";var e=t(32),n=t(109),i=t(110),r=t(74),o=t(70).f;t(28)&&e(e.P+t(69),"Object",{__lookupGetter__:function(t){var e,a=n(this),s=i(t,!0);do{if(e=o(a,s))return e.get}while(a=r(a))}})},{109:109,110:110,28:28,32:32,69:69,70:70,74:74}],270:[function(t){"use strict";var e=t(32),n=t(109),i=t(110),r=t(74),o=t(70).f;t(28)&&e(e.P+t(69),"Object",{__lookupSetter__:function(t){var e,a=n(this),s=i(t,!0);do{if(e=o(a,s))return e.set}while(a=r(a))}})},{109:109,110:110,28:28,32:32,69:69,70:70,74:74}],271:[function(t){var e=t(32),n=t(79)(!1);e(e.S,"Object",{values:function(t){return n(t)}})},{32:32,79:79}],272:[function(t){"use strict";var e=t(32),n=t(38),i=t(23),r=t(64)(),o=t(117)("observable"),a=t(3),s=t(7),c=t(6),u=t(86),l=t(40),h=t(37),d=h.RETURN,f=function(t){return null==t?void 0:a(t)},p=function(t){var e=t._c;e&&(t._c=void 0,e())},m=function(t){return void 0===t._o},g=function(t){m(t)||(t._o=void 0,p(t))},v=function(t,e){s(t),this._c=void 0,this._o=t,t=new y(this);try{var n=e(t),i=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){i.unsubscribe()}:a(n),this._c=n)}catch(e){return void t.error(e)}m(this)&&p(this)};v.prototype=u({},{unsubscribe:function(){g(this)}});var y=function(t){this._s=t};y.prototype=u({},{next:function(t){var e=this._s;if(!m(e)){var n=e._o;try{var i=f(n.next);if(i)return i.call(n,t)}catch(t){try{g(e)}finally{throw t}}}},error:function(t){var e=this._s;if(m(e))throw t;var n=e._o;e._o=void 0;try{var i=f(n.error);if(!i)throw t;t=i.call(n,t)}catch(t){try{p(e)}finally{throw t}}return p(e),t},complete:function(t){var e=this._s;if(!m(e)){var n=e._o;e._o=void 0;try{var i=f(n.complete);t=i?i.call(n,t):void 0}catch(t){try{p(e)}finally{throw t}}return p(e),t}}});var b=function(t){c(this,b,"Observable","_f")._f=a(t)};u(b.prototype,{subscribe:function(t){return new v(t,this._f)},forEach:function(t){var e=this;return new(i.Promise||n.Promise)(function(n,i){a(t);var r=e.subscribe({next:function(e){try{return t(e)}catch(t){i(t),r.unsubscribe()}},error:i,complete:n})})}}),u(b,{from:function(t){var e="function"==typeof this?this:b,n=f(s(t)[o]);if(n){var i=s(n.call(t));return i.constructor===e?i:new e(function(t){return i.subscribe(t)})}return new e(function(e){var n=!1;return r(function(){if(!n){try{if(h(t,!1,function(t){if(e.next(t),n)return d})===d)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:b)(function(t){var e=!1;return r(function(){if(!e){for(var i=0;i<n.length;++i)if(t.next(n[i]),e)return;t.complete()}}),function(){e=!0}})}}),l(b.prototype,o,function(){return this}),e(e.G,{Observable:b}),t(91)("Observable")},{117:117,23:23,3:3,32:32,37:37,38:38,40:40,6:6,64:64,7:7,86:86,91:91}],273:[function(t){var e=t(63),n=t(7),i=e.key,r=e.set;e.exp({defineMetadata:function(t,e,o,a){r(t,e,n(o),i(a))}})},{63:63,7:7}],274:[function(t){var e=t(63),n=t(7),i=e.key,r=e.map,o=e.store;e.exp({deleteMetadata:function(t,e){var a=arguments.length<3?void 0:i(arguments[2]),s=r(n(e),a,!1);if(void 0===s||!s["delete"](t))return!1;if(s.size)return!0;var c=o.get(e);return c["delete"](a),!!c.size||o["delete"](e)}})},{63:63,7:7}],275:[function(t){var e=t(220),n=t(10),i=t(63),r=t(7),o=t(74),a=i.keys,s=i.key,c=function(t,i){var r=a(t,i),s=o(t);if(null===s)return r;var u=c(s,i);return u.length?r.length?n(new e(r.concat(u))):u:r};i.exp({getMetadataKeys:function(t){return c(r(t),arguments.length<2?void 0:s(arguments[1]))}})},{10:10,220:220,63:63,7:7,74:74}],276:[function(t){var e=t(63),n=t(7),i=t(74),r=e.has,o=e.get,a=e.key,s=function(t,e,n){if(r(t,e,n))return o(t,e,n);var a=i(e);return null!==a?s(t,a,n):void 0};e.exp({getMetadata:function(t,e){return s(t,n(e),arguments.length<3?void 0:a(arguments[2]))}})},{63:63,7:7,74:74}],277:[function(t){var e=t(63),n=t(7),i=e.keys,r=e.key;e.exp({getOwnMetadataKeys:function(t){return i(n(t),arguments.length<2?void 0:r(arguments[1]))}})},{63:63,7:7}],278:[function(t){var e=t(63),n=t(7),i=e.get,r=e.key;e.exp({getOwnMetadata:function(t,e){return i(t,n(e),arguments.length<3?void 0:r(arguments[2]))}})},{63:63,7:7}],279:[function(t){var e=t(63),n=t(7),i=t(74),r=e.has,o=e.key,a=function(t,e,n){if(r(t,e,n))return!0;var o=i(e);return null!==o&&a(t,o,n)};e.exp({hasMetadata:function(t,e){return a(t,n(e),arguments.length<3?void 0:o(arguments[2]))}})},{63:63,7:7,74:74}],280:[function(t){var e=t(63),n=t(7),i=e.has,r=e.key;e.exp({hasOwnMetadata:function(t,e){return i(t,n(e),arguments.length<3?void 0:r(arguments[2]))}})},{63:63,7:7}],281:[function(t){var e=t(63),n=t(7),i=t(3),r=e.key,o=e.set;e.exp({metadata:function(t,e){return function(a,s){o(t,e,(void 0!==s?n:i)(a),r(s))}}})},{3:3,63:63,7:7}],282:[function(t){var e=t(32);e(e.P+e.R,"Set",{toJSON:t(20)("Set")})},{20:20,32:32}],283:[function(t){"use strict";var e=t(32),n=t(97)(!0);e(e.P,"String",{at:function(t){return n(this,t)}})},{32:32,97:97}],284:[function(t){"use strict";var e=t(32),n=t(27),i=t(108),r=t(50),o=t(36),a=RegExp.prototype,s=function(t,e){this._r=t,this._s=e};t(52)(s,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(n(this),!r(t))throw TypeError(t+" is not a regexp!");var e=String(this),c="flags"in a?String(t.flags):o.call(t),u=new RegExp(t.source,~c.indexOf("g")?c:"g"+c);return u.lastIndex=i(t.lastIndex),new s(u,e)}})},{108:108,27:27,32:32,36:36,50:50,52:52}],285:[function(t){"use strict";var e=t(32),n=t(100);e(e.P,"String",{padEnd:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},{100:100,32:32}],286:[function(t){"use strict";var e=t(32),n=t(100);e(e.P,"String",{padStart:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},{100:100,32:32}],287:[function(t){"use strict";t(102)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},{102:102}],288:[function(t){"use strict";t(102)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},{102:102}],289:[function(t){t(115)("asyncIterator")},{115:115}],290:[function(t){t(115)("observable")},{115:115}],291:[function(t){var e=t(32);e(e.S,"System",{global:t(38)})},{32:32,38:38}],292:[function(t){for(var e=t(130),n=t(87),i=t(38),r=t(40),o=t(56),a=t(117),s=a("iterator"),c=a("toStringTag"),u=o.Array,l=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],h=0;h<5;h++){var d,f=l[h],p=i[f],m=p&&p.prototype;if(m){m[s]||r(m,s,u),m[c]||r(m,c,f),o[f]=u;for(d in e)m[d]||n(m,d,e[d],!0)}}},{117:117,130:130,38:38,40:40,56:56,87:87}],293:[function(t){var e=t(32),n=t(104);e(e.G+e.B,{setImmediate:n.set,clearImmediate:n.clear})},{104:104,32:32}],294:[function(t){var e=t(38),n=t(32),i=t(44),r=t(83),o=e.navigator,a=!!o&&/MSIE .\./.test(o.userAgent),s=function(t){return a?function(e,n){return t(i(r,[].slice.call(arguments,2),"function"==typeof e?e:Function(e)),n)}:t};n(n.G+n.B+n.F*a,{setTimeout:s(e.setTimeout),setInterval:s(e.setInterval)})},{32:32,38:38,44:44,83:83}],295:[function(t,e){t(243),t(180),t(182),t(181),t(184),t(186),t(191),t(185),t(183),t(193),t(192),t(188),t(189),t(187),t(179),t(190),t(194),t(195),t(146),t(148),t(147),t(197),t(196),t(167),t(177),t(178),t(168),t(169),t(170),t(171),t(172),t(173),t(174),t(175),t(176),t(150),t(151),t(152),t(153),t(154),t(155),t(156),t(157),t(158),t(159),t(160),t(161),t(162),t(163),t(164),t(165),t(166),t(230),t(235),t(242),t(233),t(225),t(226),t(231),t(236),t(238),t(221),t(222),t(223),t(224),t(227),t(228),t(229),t(232),t(234),t(237),t(239),t(240),t(241),t(141),t(143),t(142),t(145),t(144),t(129),t(127),t(134),t(131),t(137),t(139),t(126),t(133),t(123),t(138),t(121),t(136),t(135),t(128),t(132),t(120),t(122),t(125),t(124),t(140),t(130),t(213),t(219),t(214),t(215),t(216),t(217),t(218),t(198),t(149),t(220),t(255),t(256),t(244),t(245),t(250),t(253),t(254),t(248),t(251),t(249),t(252),t(246),t(247),t(199),t(200),t(201),t(202),t(203),t(206),t(204),t(205),t(207),t(208),t(209),t(210),t(212),t(211),t(257),t(283),t(286),t(285),t(287),t(288),t(284),t(289),t(290),t(268),t(271),t(267),t(265),t(266),t(269),t(270),t(260),t(282),t(291),t(259),t(261),t(263),t(262),t(264),t(273),t(274),t(276),t(275),t(278),t(277),t(279),t(280),t(281),t(258),t(272),t(294),t(293),t(292),e.exports=t(23)},{120:120,121:121,122:122,123:123,124:124,125:125,126:126,127:127,128:128,129:129,130:130,131:131,132:132,133:133,134:134,135:135,136:136,137:137,138:138,139:139,140:140,141:141,142:142,143:143,144:144,145:145,146:146,147:147,148:148,149:149,150:150,151:151,152:152,153:153,154:154,155:155,156:156,157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,23:23,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:256,257:257,258:258,259:259,260:260,261:261,262:262,263:263,264:264,265:265,266:266,267:267,268:268,269:269,270:270,271:271,272:272,273:273,274:274,275:275,276:276,277:277,278:278,279:279,280:280,281:281,282:282,283:283,284:284,285:285,286:286,287:287,288:288,289:289,290:290,291:291,292:292,293:293,294:294}],296:[function(t,e){(function(t){!function(t){"use strict";function n(t,e,n,i){var o=e&&e.prototype instanceof r?e:r,a=Object.create(o.prototype),s=new d(i||[]);return a._invoke=u(t,n,s),a}function i(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function r(){}function o(){}function a(){}function s(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function c(t){function e(n,r,o,a){var s=i(t[n],t,r);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&v.call(u,"__await")?Promise.resolve(u.__await).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(u).then(function(t){c.value=t,o(c)},a)}a(s.arg)}function n(t,n){function i(){return new Promise(function(i,r){e(t,n,i,r)})}return r=r?r.then(i,i):i()}"object"==typeof process&&process.domain&&(e=process.domain.bind(e));var r;this._invoke=n}function u(t,e,n){var r=S;return function(o,a){if(r===E)throw new Error("Generator is already running");if(r===T){if("throw"===o)throw a;return p()}for(;;){var s=n.delegate;if(s){if("return"===o||"throw"===o&&s.iterator[o]===m){n.delegate=null;var c=s.iterator["return"];if(c){if("throw"===(u=i(c,s.iterator,a)).type){o="throw",a=u.arg;continue}}if("return"===o)continue}if("throw"===(u=i(s.iterator[o],s.iterator,a)).type){n.delegate=null,o="throw",a=u.arg;continue}o="next",a=m;if(!(l=u.arg).done)return r=k,l;n[s.resultName]=l.value,n.next=s.nextLoc,n.delegate=null}if("next"===o)n.sent=n._sent=a;else if("throw"===o){if(r===S)throw r=T,a;n.dispatchException(a)&&(o="next",a=m)}else"return"===o&&n.abrupt("return",a);r=E;var u;if("normal"===(u=i(t,e,n)).type){r=n.done?T:k;var l={value:u.arg,done:n.done};if(u.arg!==C)return l;n.delegate&&"next"===o&&(a=m)}else"throw"===u.type&&(r=T,o="throw",a=u.arg)}}}function l(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function h(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(l,this),this.reset(!0)}function f(t){if(t){var e=t[b];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(v.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=m,r.done=!0,r};return i.next=i}}return{next:p}}function p(){return{value:m,done:!0}}var m,g=Object.prototype,v=g.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},b=y.iterator||"@@iterator",_=y.toStringTag||"@@toStringTag",x="object"==typeof e,w=t.regeneratorRuntime;if(w)x&&(e.exports=w);else{(w=t.regeneratorRuntime=x?e.exports:{}).wrap=n;var S="suspendedStart",k="suspendedYield",E="executing",T="completed",C={},L={};L[b]=function(){return this};var P=Object.getPrototypeOf,A=P&&P(P(f([])));A&&A!==g&&v.call(A,b)&&(L=A);var N=a.prototype=r.prototype=Object.create(L);o.prototype=N.constructor=a,a.constructor=o,a[_]=o.displayName="GeneratorFunction",w.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},w.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(N),t},w.awrap=function(t){return{__await:t}},s(c.prototype),w.AsyncIterator=c,w.async=function(t,e,i,r){var o=new c(n(t,e,i,r));return w.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},s(N),N[_]="Generator",N.toString=function(){return"[object Generator]"},w.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},w.values=f,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.tryEntries.forEach(h),!t)for(var e in this)"t"===e.charAt(0)&&v.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=m)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){function e(e,i){return o.type="throw",o.arg=t,n.next=e,!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var a=v.call(r,"catchLoc"),s=v.call(r,"finallyLoc");if(a&&s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&v.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?this.next=r.finallyLoc:this.complete(o),C},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),h(n),C}},"catch":function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;h(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:f(t),resultName:e,nextLoc:n},C}}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),function(t){t.fn.addNewPageButton=function(e){function n(n){function i(){n.outerWidth()<=h+5&&n.animate({width:a.animate_width+"px"},a.speed,function(){s.show(0,function(){l.focus(),n.width("auto"),n.width(n.width())})})}function r(){s.hide(),n.animate({width:h+"px"},a.speed)}function o(){return""==t.trim(l.val())}var a=t.extend({speed:n.data("speed")||450,animate_width:n.data("animate_width")||425},e),s=t(n.data("field-target")),c=t("input[data-behavior='save']",s),u=t("input[data-behavior='cancel']",s),l=t("input[type='text']",s),h=n.outerWidth();n.on("mouseenter focus",function(){i()}),c.on("click",function(){if(o())return!1}),u.on("click",function(t){t.preventDefault(),l.val(""),r()}),l.on("blur",function(){o()&&r()})}t.each(this,function(){n(t(this))})}}(jQuery),Spotlight.onLoad(function(){$("[data-expanded-add-button]").addNewPageButton()}),jQuery,Spotlight.onLoad(function(){return null!=window._gaq?_gaq.push(["_trackPageview"]):null!=window.pageTracker?pageTracker._trackPageview():void 0}),Spotlight.onLoad(function(){addRestoreDefaultBehavior()}),Spotlight.onLoad(function(){addCheckboxToggleBehavior(),addEnableToggleBehavior()}),function(t){SirTrevor.BlockMixins.Autocompleteable={mixinName:"Autocompleteable",preload:!0,initializeAutocompleteable:function(){this.on("onRender",this.addAutocompletetoSirTrevorForm),_.isUndefined(this.autocomplete_url)&&(this.autocomplete_url=function(){return t("form[data-autocomplete-url]").data("autocomplete-url").replace("%25QUERY","%QUERY")}),_.isUndefined(this.autocomplete_template)&&(this.autocomplete_url=function(){return'<div class="autocomplete-item{{#if private}} blacklight-private{{/if}}">{{#if thumbnail}}<div class="document-thumbnail thumbnail"><img src="{{thumbnail}}" /></div>{{/if}}<span class="autocomplete-title">{{title}}</span><br/><small>&nbsp;&nbsp;{{description}}</small></div>'}),_.isUndefined(this.transform_autocomplete_results)&&(this.transform_autocomplete_results=_.identity),_.isUndefined(this.bloodhoundOptions)&&(this.bloodhoundOptions=function(){return{remote:{url:this.autocomplete_url(),filter:this.transform_autocomplete_results}}})},autocomplete_control:function(){return'<input type="text" class="st-input-string form-control item-input-field" data-twitter-typeahead="true" placeholder="<%= i18n.t("blocks:autocompleteable:placeholder")%>"/>'},addAutocompletetoSirTrevorForm:function(){t("[data-twitter-typeahead]",this.inner).spotlightSearchTypeAhead({bloodhound:this.bloodhound(),template:this.autocomplete_template()}).on("typeahead:selected typeahead:autocompleted",this.autocompletedHandler()).on("focus",function(){""===t(this).val()&&t(this).data().ttTypeahead.input.trigger("queryChanged","")})},autocompletedHandler:function(){var e=this;return function(n,i){t(this).typeahead("val",""),t(this).val(""),e.createItemPanel(t.extend(i,{display:"true"}))}},bloodhound:function(){var t=this,e=new Bloodhound(_.extend({datumTokenizer:function(t){return Bloodhound.tokenizers.whitespace(t.title)},queryTokenizer:Bloodhound.tokenizers.whitespace,limit:100},t.bloodhoundOptions()));return e.initialize(),e}},SirTrevor.Block.prototype.availableMixins.push("autocompleteable")}(jQuery),function(t){SirTrevor.BlockMixins.Formable={mixinName:"Formable",preload:!0,initializeFormable:function(){_.isUndefined(this.afterLoadData)&&(this.afterLoadData=function(){})},formId:function(t){return this.blockID+"_"+t},_serializeData:function(){var e=t(":input,textarea,select",this.inner).not(":input:radio").serializeJSON();return t(":input:radio:checked",this.inner).each(function(n,i){var r=t(i).data("key")||i.getAttribute("name");r.match("\\[")||(e[r]=t(i).val())}),this.hasTextBlock()&&(e.text=this.getTextBlockHTML(),e.text.length>0&&this.options.convertToMarkdown&&(e.text=stToMarkdown(e.text,this.type))),e},loadData:function(e){this.hasTextBlock()&&t(this.getTextBlock()).html(SirTrevor.toHTML(e.text,this.type)),this.loadFormDataByKey(e),this.afterLoadData(e)},loadFormDataByKey:function(e){t(":input",this.inner).not("button,:input[type=hidden]").each(function(n,i){var r=t(i).data("key")||i.getAttribute("name");if(r){r.match("\\[\\]$")&&(r=r.replace("[]",""));var o=e[r];o instanceof Array||(o=[o]),t(this).val(o)}})}},SirTrevor.Block.prototype.availableMixins.push("formable")}(jQuery),jQuery,SirTrevor.BlockMixins.Plustextable={mixinName:"Textable",preload:!0,initializeTextable:function(){_.isUndefined(this.formId)&&this.withMixin(SirTrevor.BlockMixins.Formable),_.isUndefined(this.show_heading)&&(this.show_heading=!0)},align_key:"text-align",text_key:"item-text",heading_key:"title",text_area:function(){
return _.template(['<div class="row">','<div class="col-md-8">','<div class="form-group">',this.heading(),'<div class="field">','<label for="<%= formId(text_key) %>" class="control-label"><%= i18n.t("blocks:textable:text") %></label>','<div id="<%= formId(text_key) %>" class="st-text-block form-control" contenteditable="true"></div>',"</div>","</div>","</div>",'<div class="col-md-4">','<div class="text-align">','<p><%= i18n.t("blocks:textable:align:title") %></p>','<input data-key="<%= align_key %>" type="radio" name="<%= formId(align_key) %>" id="<%= formId(align_key + "-left") %>" value="left" checked="true">','<label for="<%= formId(align_key + "-left") %>"><%= i18n.t("blocks:textable:align:left") %></label>','<input data-key="<%= align_key %>" type="radio" name="<%= formId(align_key) %>" id="<%= formId(align_key + "-right") %>" value="right">','<label for="<%= formId(align_key + "-right") %>"><%= i18n.t("blocks:textable:align:right") %></label>',"</div>","</div>","</div>"].join("\n"))(this)},heading:function(){return this.show_heading?['<div class="field">','<label for="<%= formId(heading_key) %>" class="control-label"><%= i18n.t("blocks:textable:heading") %></label>','<input type="text" class="form-control" id="<%= formId(heading_key) %>" name="<%= heading_key %>" />',"</div>"].join("\n"):""}},SirTrevor.Block.prototype.availableMixins.push("plustextable"),function(t){Spotlight.Block=SirTrevor.Block.extend({formable:!0,editorHTML:function(){return _.template(this.template)(this)},beforeBlockRender:function(){this.availableMixins.forEach(function(t){this[t]&&SirTrevor.BlockMixins[this.capitalize(t)].preload&&this.withMixin(SirTrevor.BlockMixins[this.capitalize(t)])},this)},$instance:function(){return t("#"+this.instanceID)},capitalize:function(t){return t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()}})}(jQuery),Spotlight.Block.Resources=Spotlight.Block.extend({type:"resources",formable:!0,autocompleteable:!0,show_heading:!0,title:function(){return i18n.t("blocks:"+this.type+":title")},description:function(){return i18n.t("blocks:"+this.type+":description")},icon_name:"resources",blockGroup:function(){return i18n.t("blocks:group:items")},primary_field_key:"primary-caption-field",show_primary_field_key:"show-primary-caption",secondary_field_key:"secondary-caption-field",show_secondary_field_key:"show-secondary-caption",display_checkbox:"display-checkbox",globalIndex:0,_itemPanelIiifFields:function(){return[]},_itemPanel:function(t){var e,n="item_"+this.globalIndex++;e="true"==t.display?"checked='checked'":"";var i=['<li class="field form-inline dd-item dd3-item" data-id="'+n+'" id="'+this.formId("item_"+t.id)+'">','<input type="hidden" name="item['+n+'][id]" value="'+(t.slug||t.id)+'" />','<input type="hidden" name="item['+n+'][title]" value="'+t.title+'" />',this._itemPanelIiifFields(n,t),'<input data-property="weight" type="hidden" name="item['+n+'][weight]" value="'+t.weight+'" />','<div class="dd-handle dd3-handle"><%= i18n.t("blocks:resources:panel:drag") %></div>','<div class="dd3-content panel panel-default">','<div class="panel-heading item-grid">','<div class="checkbox">','<input name="item['+n+'][display]" type="hidden" value="false" />','<input name="item['+n+'][display]" id="'+this.formId(this.display_checkbox+"_"+t.id)+'" type="checkbox" '+e+' class="item-grid-checkbox" value="true"  />','<label class="sr-only" for="'+this.formId(this.display_checkbox+"_"+t.id)+'"><%= i18n.t("blocks:resources:panel:display") %></label>',"</div>",'<div class="pic thumbnail">','<img src="'+(t.thumbnail_image_url||(t.iiif_tilesource||"").replace("/info.json","/full/!100,100/0/default.jpg"))+'" />',"</div>",'<div class="main">','<div class="title panel-title">'+t.title+"</div>","<div>"+(t.slug||t.id)+"</div>","</div>",'<div class="remove pull-right">','<a data-item-grid-panel-remove="true" href="#"><%= i18n.t("blocks:resources:panel:remove") %></a>',"</div>",'<div class="h5" data-panel-image-pagination="true"></div>',"</div>","</div>","</li>"].join("\n"),r=$(_.template(i)(this)),o=this;return $(".remove a",r).on("click",function(t){t.preventDefault(),$(this).closest(".field").remove(),o.afterPanelDelete()}),this.afterPanelRender(t,r),r},afterPanelRender:function(){},afterPanelDelete:function(){},createItemPanel:function(t){var e=this._itemPanel(t);$(e).appendTo($(".panels > ol",this.inner)),$('[data-behavior="nestable"]',this.inner).trigger("change")},item_options:function(){return""},content:function(){var t=[this.items_selector()];return this.plustextable&&t.push(this.text_area()),_.template(t.join("<hr />\n"))(this)},items_selector:function(){return['<div class="row">','<div class="col-md-8">','<div class="form-group">','<div class="panels dd nestable-item-grid" data-behavior="nestable" data-max-depth="1"><ol class="dd-list"></ol></div>',this.autocomplete_control(),"</div>","</div>",'<div class="col-md-4">',this.item_options(),"</div>","</div>"].join("\n")},template:['<div class="form resources-admin clearfix">','<div class="widget-header">',"<%= description() %>","</div>","<%= content() %>","</div>"].join("\n"),onBlockRender:function(){SpotlightNestable.init($('[data-behavior="nestable"]',this.inner)),$("[data-input-select-target]",this.inner).selectRelatedInput()},afterLoadData:function(t){var e=this;$.each(Object.keys(t.item||{}).map(function(e){return t.item[e]}).sort(function(t,e){return t.weight-e.weight}),function(t,n){e.createItemPanel(n)})}}),SirTrevor.Blocks.Browse=Spotlight.Block.Resources.extend({type:"browse",icon_name:"browse",autocomplete_url:function(){return $(this.inner).closest("form[data-autocomplete-exhibit-searches-path]").data("autocomplete-exhibit-searches-path").replace("%25QUERY","%QUERY")},autocomplete_template:function(){return'<div class="autocomplete-item{{#unless published}} blacklight-private{{/unless}}">{{#if thumbnail_image_url}}<div class="document-thumbnail thumbnail"><img src="{{thumbnail_image_url}}" /></div>{{/if}}<span class="autocomplete-title">{{title}}</span><br/><small>&nbsp;&nbsp;{{description}}</small></div>'},bloodhoundOptions:function(){return{prefetch:{url:this.autocomplete_url(),ttl:0}}},item_options:function(){return["<label>",'<input type="hidden" name="display-item-counts" value="false" />','<input type="checkbox" name="display-item-counts" value="true" checked />','<%= i18n.t("blocks:browse:item_counts") %>',"</label>"].join("\n")}}),SirTrevor.Blocks.Iframe=SirTrevor.Block.extend({type:"Iframe",formable:!0,title:function(){return i18n.t("blocks:iframe:title")},description:function(){return i18n.t("blocks:iframe:description")},icon_name:"iframe",editorHTML:function(){return _.template(this.template,this)(this)},template:['<div class="clearfix">','<div class="widget-header">',"<%= description() %>","</div>",'<textarea name="code" class="form-control" rows="5" placeholder="<%= i18n.t("blocks:iframe:placeholder") %>"></textarea>',"</div>"].join("\n")}),SirTrevor.Blocks.LinkToSearch=SirTrevor.Blocks.Browse.extend({type:"link_to_search",icon_name:"search_results",searches_key:"slug",view_key:"view",plustextable:!1}),SirTrevor.Blocks.Oembed=Spotlight.Block.extend({plustextable:!0,id_key:"url",type:"oembed",title:function(){return i18n.t("blocks:oembed:title")},description:function(){return i18n.t("blocks:oembed:description")},icon_name:"oembed",show_heading:!1,template:['<div class="form oembed-text-admin clearfix">','<div class="widget-header">',"<%= description() %>","</div>",'<div class="row">','<div class="form-group col-md-8">','<label for="<%= formId(id_key) %>"><%= i18n.t("blocks:oembed:url") %></label>','<input name="<%= id_key %>" class="form-control col-md-6" type="text" id="<%= formId(id_key) %>" />',"</div>","</div>","<%= text_area() %>","</div>"].join("\n")}),SirTrevor.Blocks.FeaturedPages=Spotlight.Block.Resources.extend({type:"featured_pages",icon_name:"pages",autocomplete_url:function(){return $(this.inner).closest("form[data-autocomplete-exhibit-pages-path]").data("autocomplete-exhibit-pages-path").replace("%25QUERY","%QUERY")},autocomplete_template:function(){return'<div class="autocomplete-item{{#unless published}} blacklight-private{{/unless}}">{{log "Look at me"}}{{log thumbnail_image_url}}{{#if thumbnail_image_url}}<div class="document-thumbnail thumbnail"><img src="{{thumbnail_image_url}}" /></div>{{/if}}<span class="autocomplete-title">{{title}}</span><br/><small>&nbsp;&nbsp;{{description}}</small></div>'},bloodhoundOptions:function(){return{prefetch:{url:this.autocomplete_url(),ttl:0}}}}),SirTrevor.Blocks.Rule=SirTrevor.Block.extend({type:"rule",title:function(){return i18n.t("blocks:rule:title")},icon_name:"rule",editorHTML:function(){return _.template(this.template,this)(this)},template:"<hr />"}),SirTrevor.Blocks.SearchResults=SirTrevor.Blocks.Browse.extend({type:"search_results",icon_name:"search_results",searches_key:"slug",view_key:"view",plustextable:!1,content:function(){return _.template([this.items_selector()].join("<hr />\n"))(this)},item_options:function(){var t=this,e=$("[data-blacklight-configuration-search-views]").data("blacklight-configuration-search-views");return $.map(e,function(e){return checkbox="",checkbox+="<div>",checkbox+="<label for='"+t.formId(t.view_key+e.key)+"'>",checkbox+="<input id='"+t.formId(t.view_key+e.key)+"' name='"+t.view_key+"[]' type='checkbox' value='"+e.key+"' /> ",checkbox+=e.label,checkbox+="</label>",checkbox+="</div>",checkbox}).join("\n")},afterPanelRender:function(){$(this.inner).find(".item-input-field").attr("disabled","disabled")},afterPanelDelete:function(){$(this.inner).find(".item-input-field").removeAttr("disabled")}}),SirTrevor.Blocks.SolrDocumentsBase=Spotlight.Block.Resources.extend({plustextable:!0,autocomplete_url:function(){return this.$instance().closest("form[data-autocomplete-exhibit-catalog-path]").data("autocomplete-exhibit-catalog-path").replace("%25QUERY","%QUERY")},autocomplete_template:function(){return'<div class="autocomplete-item{{#if private}} blacklight-private{{/if}}">{{#if thumbnail}}<div class="document-thumbnail thumbnail"><img src="{{thumbnail}}" /></div>{{/if}}<span class="autocomplete-title">{{title}}</span><br/><small>&nbsp;&nbsp;{{description}}</small></div>'},transform_autocomplete_results:function(t){return $.map(t.docs,function(t){return t})},caption_option_values:function(){var t=$("[data-blacklight-configuration-index-fields]").data("blacklight-configuration-index-fields");return $.map(t,function(t){return $("<option />").val(t.key).text(t.label)[0].outerHTML}).join("\n")},item_options:function(){return this.caption_options()},caption_options:function(){return['<div class="field-select primary-caption" data-behavior="item-caption-admin">','<input name="<%= show_primary_field_key %>" type="hidden" value="false" />','<input data-input-select-target="#<%= formId(primary_field_key) %>" name="<%= show_primary_field_key %>" id="<%= formId(show_primary_field_key) %>" type="checkbox" value="true" />','<label for="<%= formId(show_primary_field_key) %>"><%= i18n.t("blocks:solr_documents:caption:primary") %></label>','<select data-input-select-target="#<%= formId(show_primary_field_key) %>" name="<%= primary_field_key %>" id="<%= formId(primary_field_key) %>">','<option value=""><%= i18n.t("blocks:solr_documents:caption:placeholder") %></option>',"<%= caption_option_values() %>","</select>","</div>",'<div class="field-select secondary-caption" data-behavior="item-caption-admin">','<input name="<%= show_secondary_field_key %>" type="hidden" value="false" />','<input data-input-select-target="#<%= formId(secondary_field_key) %>" name="<%= show_secondary_field_key %>" id="<%= formId(show_secondary_field_key) %>" type="checkbox" value="true" />','<label for="<%= formId(show_secondary_field_key) %>"><%= i18n.t("blocks:solr_documents:caption:secondary") %></label>','<select data-input-select-target="#<%= formId(show_secondary_field_key) %>" name="<%= secondary_field_key %>" id="<%= formId(secondary_field_key) %>">','<option value=""><%= i18n.t("blocks:solr_documents:caption:placeholder") %></option>',"<%= caption_option_values() %>","</select>","</div>"].join("\n")},_itemPanelIiifFields:function(t,e){return['<input type="hidden" name="item['+t+'][thumbnail_image_url]" value="'+(e.thumbnail_image_url||e.thumbnail||"")+'"/>','<input type="hidden" name="item['+t+'][full_image_url]" value="'+(e.full_image_url||e.thumbnail_image_url||e.thumbnail||"")+'"/>','<input type="hidden" name="item['+t+'][iiif_tilesource]" value="'+e.iiif_tilesource+'"/>','<input type="hidden" name="item['+t+'][iiif_manifest_url]" value="'+e.iiif_manifest_url+'"/>','<input type="hidden" name="item['+t+'][iiif_canvas_id]" value="'+e.iiif_canvas_id+'"/>','<input type="hidden" name="item['+t+'][iiif_image_id]" value="'+e.iiif_image_id+'"/>'].join("\n")},setIiifFields:function(t,e,n){var i=$(t).find('[name$="[thumbnail_image_url]"]'),r=$(t).find('[name$="[full_image_url]"]');n&&i.val().length>0||(i.val(""),r.val(""),$(t).find('[name$="[iiif_image_id]"]').val(e.imageId),$(t).find('[name$="[iiif_tilesource]"]').val(e.tilesource),$(t).find('[name$="[iiif_manifest_url]"]').val(e.manifest),$(t).find('[name$="[iiif_canvas_id]"]').val(e.canvasId),$(t).find(".thumbnail img").attr("src",e.thumbnail_image_url||e.tilesource.replace("/info.json","/full/100,100/0/default.jpg")))},afterPanelRender:function(t,e){var n=this,i=t.iiif_manifest||t.iiif_manifest_url;if(!i)return $(e).find('[name$="[thumbnail_image_url]"]').val(t.thumbnail),void $(e).find('[name$="[full_image_url]"]').val(t.full_image_url);$.ajax(i).success(function(r){var o=new(require("spotlight/iiif"))(i,r).imagesArray();t.iiif_image_id||n.setIiifFields(e,o[0],!!t.iiif_manifest_url),o.length>1&&e.multiImageSelector(o,function(t){n.setIiifFields(e,t,!1)},t.iiif_image_id)})}}),SirTrevor.Blocks.SolrDocuments=SirTrevor.Blocks.SolrDocumentsBase.extend({type:"solr_documents",icon_name:"items",item_options:function(){return this.caption_options()+this.zpr_option()},zpr_option:function(){return["<div>",'<input name="<%= zpr_key %>" type="hidden" value="false" />','<input name="<%= zpr_key %>" id="<%= formId(zpr_key) %>" data-key="<%= zpr_key %>" type="checkbox" value="true" />','<label for="<%= formId(zpr_key) %>"><%= i18n.t("blocks:solr_documents:zpr:title") %></label>',"</div>"].join("\n")},zpr_key:"zpr_link"}),SirTrevor.Blocks.SolrDocumentsCarousel=SirTrevor.Blocks.SolrDocumentsBase.extend({plustextable:!1,type:"solr_documents_carousel",icon_name:"item_carousel",auto_play_images_key:"auto-play-images",auto_play_images_interval_key:"auto-play-images-interval",max_height_key:"max-height",item_options:function(){return""},carouselCycleTimesInSeconds:{values:[3,5,8,12,20],selected:5},carouselMaxHeights:{values:{Small:"small",Medium:"medium",Large:"large"},selected:"Medium"},item_options:function(){return[this.caption_options(),'<div class="field-select auto-cycle-images" data-behavior="auto-cycle-images">','<input name="<%= auto_play_images_key %>" type="hidden" value="false" />','<input name="<%= auto_play_images_key %>" id="<%= formId(auto_play_images_key) %>" data-key="<%= auto_play_images_key %>" type="checkbox" value="true" checked/>','<label for="<%= formId(auto_play_images_key) %>"><%= i18n.t("blocks:solr_documents_carousel:interval:title") %></label>','<select name="<%= auto_play_images_interval_key %>" id="<%= formId(auto_play_images_interval_key) %>" data=key="<%= auto_play_images_interval_key %>">','<option value=""><%= i18n.t("blocks:solr_documents_carousel:interval:placeholder") %></option>',"<%= addCarouselCycleOptions(carouselCycleTimesInSeconds) %>","</select>","</div>",'<div class="field-select max-heights" data-behavior="max-heights">','<label for="<%= formId(max_height_key) %>"><%= i18n.t("blocks:solr_documents_carousel:height:title") %></label><br/>',"<%= addCarouselMaxHeightOptions(carouselMaxHeights) %>","</div>"].join("\n")},addCarouselCycleOptions:function(t){var e="";return $.each(t.values,function(n,i){var r=i===t.selected?"selected":"",o=1e3*parseInt(i,10);e+='<option value="'+o+'" '+r+">"+i+" seconds</option>"}),e},addCarouselMaxHeightOptions:function(t){var e="",n=this;return $.each(t.values,function(i,r){var o=i===t.selected?"checked":"",a=n.formId(n.max_height_key);e+='<input data-key="'+n.max_height_key+'" type="radio" name="'+a+'" value="'+r+'" id="'+a+'" '+o+">",e+='<label class="carousel-size" for="'+a+'">'+i+"</label>"}),e},afterPreviewLoad:function(){$(this.inner).find(".carousel").carousel();var t=function(t){var e,n=$(this),i=$(n.attr("data-target")||(e=n.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,""));if(i.hasClass("carousel")){var r=$.extend({},i.data(),n.data()),o=n.attr("data-slide-to");o&&(r.interval=!1),$.fn.carousel.call(i,r),o&&i.data("bs.carousel").to(o),t.preventDefault()}};$(this.inner).find(".carousel").on("click.bs.carousel.data-api","[data-slide]",t).on("click.bs.carousel.data-api","[data-slide-to]",t)}}),SirTrevor.Blocks.SolrDocumentsEmbed=SirTrevor.Blocks.SolrDocumentsBase.extend({type:"solr_documents_embed",icon_name:"item_embed",item_options:function(){return""},afterPreviewLoad:function(){$(this.inner).find("picture[data-openseadragon]").openseadragon()}}),SirTrevor.Blocks.SolrDocumentsFeatures=SirTrevor.Blocks.SolrDocumentsBase.extend({plustextable:!1,type:"solr_documents_features",icon_name:"item_features",afterPreviewLoad:function(){$(this.inner).find(".carousel").carousel();var t=function(t){var e,n=$(this),i=$(n.attr("data-target")||(e=n.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,""));if(i.hasClass("carousel")){var r=$.extend({},i.data(),n.data()),o=n.attr("data-slide-to");o&&(r.interval=!1),$.fn.carousel.call(i,r),o&&i.data("bs.carousel").to(o),t.preventDefault()}};$(this.inner).find(".carousel").on("click.bs.carousel.data-api","[data-slide]",t).on("click.bs.carousel.data-api","[data-slide-to]",t)}}),SirTrevor.Blocks.SolrDocumentsGrid=SirTrevor.Blocks.SolrDocumentsBase.extend({type:"solr_documents_grid",icon_name:"item_grid",item_options:function(){return""}}),SirTrevor.Blocks.UploadedItems=Spotlight.Block.Resources.extend({plustextable:!0,uploadable:!0,autocompleteable:!1,id_key:"file",type:"uploaded_items",icon_name:"items",blockGroup:"undefined",upload_options:{html:""},fileInput:function(){return $(this.inner).find('input[type="file"]')},onBlockRender:function(){SpotlightNestable.init($(this.inner).find('[data-behavior="nestable"]')),this.fileInput().on("change",function(t){this.onDrop(t.currentTarget)}.bind(this))},onDrop:function(t){var e=t.files[0];"undefined"!=typeof URL?URL:"undefined"!=typeof webkitURL&&webkitURL;/image/.test(e.type)&&(this.loading(),this.uploader(e,function(t){this.createItemPanel(t),this.fileInput().val(""),this.ready()},function(){this.addMessage(i18n.t("blocks:image:upload_error")),this.ready()}))},title:function(){return i18n.t("blocks:uploaded_items:title")},description:function(){return i18n.t("blocks:uploaded_items:description")},globalIndex:0,_itemPanel:function(t){var e="file_"+this.globalIndex++,n='checked="checked"';"false"==t.display&&(n="");var i=t.id||t.uid,r=t.title||t.name,o=t.url||t.file.url,a=['<li class="field form-inline dd-item dd3-item" data-id="'+e+'" id="'+this.formId("item_"+i)+'">','<input type="hidden" name="item['+e+'][id]" value="'+i+'" />','<input type="hidden" name="item['+e+'][title]" value="'+r+'" />','<input type="hidden" name="item['+e+'][url]" data-item-grid-thumbnail="true"  value="'+o+'"/>','<input data-property="weight" type="hidden" name="item['+e+'][weight]" value="'+t.weight+'" />','<div class="dd-handle dd3-handle"><%= i18n.t("blocks:resources:panel:drag") %></div>','<div class="dd3-content panel panel-default">','<div class="panel-heading item-grid">','<div class="checkbox">','<input name="item['+e+'][display]" type="hidden" value="false" />','<input name="item['+e+'][display]" id="'+this.formId(this.display_checkbox+"_"+i)+'" type="checkbox" '+n+' class="item-grid-checkbox" value="true"  />','<label class="sr-only" for="'+this.formId(this.display_checkbox+"_"+i)+'"><%= i18n.t("blocks:resources:panel:display") %></label>',"</div>",'<div class="pic thumbnail">','<img src="'+o+'" />',"</div>",'<div class="main form-horizontal">','<div class="title panel-title">'+r+"</div>",'<div class="field">','<label for="'+this.formId("caption_"+i)+'" class="control-label col-md-3"><%= i18n.t("blocks:uploaded_items:caption") %></label>','<input type="text" class="form-control" id="'+this.formId("caption_"+i)+'" name="item['+e+'][caption]" data-field="caption"/>',"</div>","</div>",'<div class="remove pull-right">','<a data-item-grid-panel-remove="true" href="#"><%= i18n.t("blocks:resources:panel:remove") %></a>',"</div>","</div>","</div>","</li>"].join("\n"),s=$(_.template(a)(this));s.find('[data-field="caption"]').val(t.caption);var c=this;return $(".remove a",s).on("click",function(t){t.preventDefault(),$(this).closest(".field").remove(),c.afterPanelDelete()}),this.afterPanelRender(t,s),s},template:['<div class="form oembed-text-admin clearfix">','<div class="widget-header">',"<%= description() %>","</div>",'<div class="row">','<div class="form-group col-md-8">','<div class="panels dd nestable-item-grid" data-behavior="nestable" data-max-depth="1">','<ol class="dd-list">',"</ol>","</div>",'<input type="file" id="uploaded_item_url" name="file[file_0][file_data]" />',"</div>","</div>","<%= text_area() %>","</div>"].join("\n")}),Spotlight.onLoad(function(){if($("#solr_document_exhibit_tag_list").length>0){$("#solr_document_exhibit_tag_list").tagsinput();var t=new Bloodhound({datumTokenizer:function(t){return Bloodhound.tokenizers.whitespace(t.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,limit:100,prefetch:{url:$("#solr_document_exhibit_tag_list").data("autocomplete_url"),ttl:1,filter:function(t){return $.map(t,function(t){return{name:t}})}}});t.initialize(),$("#solr_document_exhibit_tag_list").tagsinput("input").typeahead({highlight:!0,hint:!1},{name:"tags",displayKey:"name",source:t.ttAdapter()}).bind("typeahead:selected",$.proxy(function(t,e){$("#solr_document_exhibit_tag_list").tagsinput("add",e.name),$("#solr_document_exhibit_tag_list").tagsinput("input").typeahead("val","")})).bind("blur",function(){$("#solr_document_exhibit_tag_list").tagsinput("add",$("#solr_document_exhibit_tag_list").tagsinput("input").typeahead("val")),$("#solr_document_exhibit_tag_list").tagsinput("input").typeahead("val","")})}$(".visiblity_toggle").bl_checkbox_submit({css_class:"toggle_visibility",success:function(t){var e=$($(this).data("label-toggle-target"));t?e.removeClass("blacklight-private"):e.addClass("blacklight-private")}})}),Function.prototype.bind||(Function.prototype.bind=function(t){var e=this,n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice();return i.push.apply(i,arguments),e.apply(t,i)}}),function(t){function e(t){_.push(t),b||(b=!0,m(i))}function n(t){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(t)||t}function i(){b=!1;var t=_;_=[],t.sort(function(t,e){return t.uid_-e.uid_});var e=!1;t.forEach(function(t){var n=t.takeRecords();r(t),n.length&&(t.callback_(n,t),e=!0)}),e&&i()}function r(t){t.nodes_.forEach(function(e){var n=g.get(e);n&&n.forEach(function(e){e.observer===t&&e.removeTransientObservers()})})}function o(t,e){for(var n=t;n;n=n.parentNode){var i=g.get(n);if(i)for(var r=0;r<i.length;r++){var o=i[r],a=o.options;if(n===t||a.subtree){var s=e(a);s&&o.enqueue(s)}}}}function a(t){this.callback_=t,this.nodes_=[],this.records_=[],this.uid_=++x}function s(t,e){this.type=t,this.target=e,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function c(t){var e=new s(t.type,t.target);return e.addedNodes=t.addedNodes.slice(),e.removedNodes=t.removedNodes.slice(),e.previousSibling=t.previousSibling,e.nextSibling=t.nextSibling,e.attributeName=t.attributeName,e.attributeNamespace=t.attributeNamespace,e.oldValue=t.oldValue,e}function u(t,e){return w=new s(t,e)}function l(t){return S||(S=c(w),S.oldValue=t,S)}function h(){w=S=undefined}function d(t){return t===S||t===w}function f(t,e){return t===e?t:S&&d(t)?S:null}function p(t,e,n){this.observer=t,this.target=e,this.options=n,this.transientObservedNodes=[]}"undefined"==typeof WeakMap&&function(){var t=Object.defineProperty,e=Date.now()%1e9,n=function(){this.name="__st"+(1e9*Math.random()>>>0)+e+++"__"};n.prototype={set:function(e,n){var i=e[this.name];return i&&i[0]===e?i[1]=n:t(e,this.name,{value:[e,n],writable:!0}),this},get:function(t){var e;return(e=t[this.name])&&e[0]===t?e[1]:undefined},"delete":function(t){var e=t[this.name];return!(!e||e[0]!==t)&&(e[0]=e[1]=undefined,!0)},has:function(t){var e=t[this.name];return!!e&&e[0]===t}},window.WeakMap=n}();var m,g=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))m=setTimeout;else if(window.setImmediate)m=window.setImmediate;else{var v=[],y=String(Math.random());window.addEventListener("message",function(t){if(t.data===y){var e=v;v=[],e.forEach(function(t){t()})}}),m=function(t){v.push(t),window.postMessage(y,"*")}}var b=!1,_=[],x=0;a.prototype={observe:function(t,e){if(t=n(t),!e.childList&&!e.attributes&&!e.characterData||e.attributeOldValue&&!e.attributes||e.attributeFilter&&e.attributeFilter.length&&!e.attributes||e.characterDataOldValue&&!e.characterData)throw new SyntaxError;var i=g.get(t);i||g.set(t,i=[]);for(var r,o=0;o<i.length;o++)if(i[o].observer===this){(r=i[o]).removeListeners(),r.options=e;break}r||(r=new p(this,t,e),i.push(r),this.nodes_.push(t)),r.addListeners()},disconnect:function(){this.nodes_.forEach(function(t){for(var e=g.get(t),n=0;n<e.length;n++){var i=e[n];if(i.observer===this){i.removeListeners(),e.splice(n,1);break}}},this),this.records_=[]},takeRecords:function(){var t=this.records_;return this.records_=[],t}};var w,S;p.prototype={enqueue:function(t){var n=this.observer.records_,i=n.length;if(n.length>0){var r=f(n[i-1],t);if(r)return void(n[i-1]=r)}else e(this.observer);n[i]=t},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(t){var e=this.options;e.attributes&&t.addEventListener("DOMAttrModified",this,!0),e.characterData&&t.addEventListener("DOMCharacterDataModified",this,!0),e.childList&&t.addEventListener("DOMNodeInserted",this,!0),(e.childList||e.subtree)&&t.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(t){var e=this.options;e.attributes&&t.removeEventListener("DOMAttrModified",this,!0),e.characterData&&t.removeEventListener("DOMCharacterDataModified",this,!0),e.childList&&t.removeEventListener("DOMNodeInserted",this,!0),(e.childList||e.subtree)&&t.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(t){if(t!==this.target){this.addListeners_(t),this.transientObservedNodes.push(t);var e=g.get(t);e||g.set(t,e=[]),e.push(this)}},removeTransientObservers:function(){var t=this.transientObservedNodes;this.transientObservedNodes=[],t.forEach(function(t){this.removeListeners_(t);for(var e=g.get(t),n=0;n<e.length;n++)if(e[n]===this){e.splice(n,1);break}},this)},handleEvent:function(t){switch(t.stopImmediatePropagation(),t.type){case"DOMAttrModified":var e=t.attrName,n=t.relatedNode.namespaceURI,i=t.target;(a=new u("attributes",i)).attributeName=e,a.attributeNamespace=n;var r=t.attrChange===MutationEvent.ADDITION?null:t.prevValue;o(i,function(t){if(t.attributes&&(!t.attributeFilter||!t.attributeFilter.length||-1!==t.attributeFilter.indexOf(e)||-1!==t.attributeFilter.indexOf(n)))return t.attributeOldValue?l(r):a});break;case"DOMCharacterDataModified":var a=u("characterData",i=t.target);r=t.prevValue;o(i,function(t){if(t.characterData)return t.characterDataOldValue?l(r):a});break;case"DOMNodeRemoved":this.addTransientObserver(t.target);case"DOMNodeInserted":i=t.relatedNode;var s,c,d=t.target;"DOMNodeInserted"===t.type?(s=[d],c=[]):(s=[],c=[d]);var f=d.previousSibling,p=d.nextSibling;(a=u("childList",i)).addedNodes=s,a.removedNodes=c,a.previousSibling=f,a.nextSibling=p,o(i,function(t){if(t.childList)return a})}h()}},t.JsMutationObserver=a,t.MutationObserver||(t.MutationObserver=a)}(this),jQuery.fn.copyEmailAddresses=function(){new Clipboard(".copy-email-addresses")},Spotlight.onLoad(function(){$(".copy-email-addresses").copyEmailAddresses()}),define("spotlight/crop",["exports","module"],function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.cropArea=e,this.cropArea.data("iiifCropper",this),this.cropSelector='[data-cropper="'+e.data("cropperKey")+'"]',this.cropTool=$(this.cropSelector),this.formPrefix=this.cropTool.data("form-prefix"),this.iiifUrlField=$("#"+this.formPrefix+"_iiif_tilesource"),this.iiifRegionField=$("#"+this.formPrefix+"_iiif_region"),this.iiifManifestField=$("#"+this.formPrefix+"_iiif_manifest_url"),this.iiifCanvasField=$("#"+this.formPrefix+"_iiif_canvas_id"),this.iiifImageField=$("#"+this.formPrefix+"_iiif_image_id"),this.form=e.closest("form"),this.tileSource=null}return i(t,[{key:"render",value:function(){this.setupAutoCompletes(),this.setupAjaxFileUpload(),this.setupExistingIiifCropper()}},{key:"setupExistingIiifCropper",value:function(){""!==this.iiifUrlField.val()&&(this.addImageSelectorToExistingCropTool(),this.setTileSource(this.iiifUrlField.val()))}},{key:"setupIiifCropper",value:function(){this.loaded=!1,this.renderCropperMap(),this.imageLayer&&this.cropperMap.removeLayer(this.imageLayer),this.imageLayer=L.tileLayer.iiif(this.tileSource).addTo(this.cropperMap);var t=this;this.imageLayer.on("load",function(){if(!t.loaded){var e=t.getCropRegion();t.positionIiifCropBox(e),t.loaded=!0}}),this.cropArea.data("initiallyVisible",this.cropArea.is(":visible"))}},{key:"getCropRegion",value:function(){var t=this.iiifRegionField.val();if(t&&""!==t)return t.split(",");var e=this.defaultCropRegion();return this.iiifRegionField.val(e),e}},{key:"defaultCropRegion",value:function(){var t=this.imageLayer.x,e=this.imageLayer.y,n=Math.floor(t/2),i=Math.floor(n/this.aspectRatio());return[Math.floor((t-n)/2),Math.floor((e-i)/2),n,i]}},{key:"aspectRatio",value:function(){return parseInt(this.cropArea.data("crop-width"))/parseInt(this.cropArea.data("crop-height"))}},{key:"positionIiifCropBox",value:function(t){var e=this.unprojectIIIFRegionToBounds(t);this.cropBox||this.renderCropBox(e),this.cropBox.setBounds(e),this.cropperMap.invalidateSize(),this.cropperMap.fitBounds(e),this.cropBox.editor.editLayer.clearLayers(),this.cropBox.editor.refresh(),this.cropBox.editor.initVertexMarkers()}},{key:"setIiifFields",value:function(t){this.setTileSource(t.tilesource),this.iiifManifestField.val(t.manifest),this.iiifCanvasField.val(t.canvasId),this.iiifImageField.val(t.imageId)}},{key:"setTileSource",value:function(t){t!=this.tileSource&&(null!==t&&t!==undefined?(this.cropBox&&this.iiifRegionField.val(""),this.tileSource=t,this.iiifUrlField.val(t),this.setupIiifCropper()):console.error("No tilesource provided when setting up IIIF Cropper"))}},{key:"renderCropperMap",value:function(){this.cropperMap||(this.cropperMap=L.map(this.cropArea.attr("id"),{editable:!0,center:[0,0],crs:L.CRS.Simple,zoom:0,editOptions:{rectangleEditorClass:this.aspectRatioPreservingRectangleEditor(this.aspectRatio())}}),this.invalidateMapSizeOnTabToggle())}},{key:"renderCropBox",value:function(t){this.cropBox=L.rectangle(t),this.cropBox.addTo(this.cropperMap),this.cropBox.enableEdit(),this.cropBox.on("dblclick",L.DomEvent.stop).on("dblclick",this.cropBox.toggleEdit);var e=this;this.cropperMap.on("editable:dragend editable:vertex:dragend",function(t){var n=t.layer.getBounds(),i=e.projectBoundsToIIIFRegion(n);e.iiifRegionField.val(i.join(","))})}},{key:"maxZoom",value:function(){if(this.imageLayer)return this.imageLayer.maxZoom}},{key:"projectBoundsToIIIFRegion",value:function(t){var e=this.cropperMap.project(t.getNorthWest(),this.maxZoom()),n=this.cropperMap.project(t.getSouthEast(),this.maxZoom());return[Math.max(Math.floor(e.x),0),Math.max(Math.floor(e.y),0),Math.floor(n.x-e.x),Math.floor(n.y-e.y)]}},{key:"unprojectIIIFRegionToBounds",value:function(t){var e=L.point(parseInt(t[0]),parseInt(t[1])),n=L.point(parseInt(t[0])+parseInt(t[2]),parseInt(t[1])+parseInt(t[3])),i=this.cropperMap.unproject(e,this.maxZoom()),r=this.cropperMap.unproject(n,this.maxZoom());return L.latLngBounds(i,r)}},{key:"setupAutoCompletes",value:function(){
$('[data-behavior="autocomplete"]',this.cropTool).data("iiifCropper",this)}},{key:"setupAjaxFileUpload",value:function(){var t=this;this.fileInput=$('input[type="file"]',this.cropTool),this.fileInput.change(function(){return t.uploadFile()})}},{key:"addImageSelectorToExistingCropTool",value:function(){if(""!==this.iiifManifestField.val()){var t=$('[data-behavior="autocomplete"]',this.cropTool);addImageSelector(t,$(t.data("target-panel")),this.iiifManifestField.val(),!this.iiifImageField.val())}}},{key:"invalidateMapSizeOnTabToggle",value:function(){var t=this;$('[role="tablist"]',this.form).on("shown.bs.tab",function(){!1===t.cropArea.data("initiallyVisible")&&t.cropArea.is(":visible")&&(t.cropperMap.invalidateSize(),t.cropArea.data("initiallyVisible",null))})}},{key:"getData",value:function(){var t=new FormData(this.form[0]);return t.append("_method",null),t}},{key:"uploadFile",value:function(){var t=this,e=this.fileInput.data("endpoint");$.ajax({url:e,type:"POST",success:function(e,n,i){return t.successHandler(e,n,i)},data:this.getData(),cache:!1,contentType:!1,processData:!1})}},{key:"successHandler",value:function(t){this.setIiifFields({tilesource:t.tilesource})}},{key:"aspectRatioPreservingRectangleEditor",value:function(t){return L.Editable.RectangleEditor.extend({extendBounds:function(e){var n=e.vertex.getIndex(),i=e.vertex.getNext(),r=e.vertex.getPrevious(),o=(n+2)%4,a=e.vertex.latlngs[o];n%2==1?e.latlng.update([a.lat+1/t*(a.lng-e.latlng.lng),e.latlng.lng]):e.latlng.update([e.latlng.lat,a.lng-t*(a.lat-e.latlng.lat)]);var s=new L.LatLngBounds(e.latlng,a);r.latlng.update([e.latlng.lat,a.lng]),i.latlng.update([a.lat,e.latlng.lng]),this.updateBounds(s),this.refreshVertexMarkers()}})}}]),t}();e.exports=r}),Spotlight.onLoad(function(){$('[data-behavior="iiif-cropper"]').croppable()}),function(t){t.fn.croppable=function(){var e=this,n=require("spotlight/crop");return t(e).each(function(){var e=t(this);new n(e).render()}),this}}(jQuery),Spotlight.onLoad(function(){$("[data-in-place-edit-target]").spotlightEditInPlace()}),function(t){t.fn.spotlightEditInPlace=function(){return t(this).each(function(){t(this).on("click.inplaceedit",function(){var e=t(this).find(t(this).data("in-place-edit-target")),n=t(this).find(t(this).data("in-place-edit-field-target"));return t(this).addClass("hide-edit-icon"),e.hide(),n.val(e.text()),n.attr("type","text"),n.select(),n.focus(),n.on("keypress",function(t){if(13==t.which)return n.trigger("blur.inplaceedit"),!1}),n.on("blur.inplaceedit",function(){return e.text(n.val()),e.show(),n.attr("type","hidden"),t("[data-in-place-edit-target]").removeClass("hide-edit-icon"),!1}),!1})}),this}}(jQuery),Spotlight.onLoad(function(){$("#new_exhibit").each(function(){$("#exhibit_title").on("change keyup",function(){$("#exhibit_slug").attr("placeholder",URLify($(this).val(),$(this).val().length))}),$("#exhibit_slug").on("focus",function(){""===$(this).val()&&$(this).val($(this).attr("placeholder"))})}),$("#another-email").on("click",function(){var t=$(this).closest(".form-group").find(".contact"),e=t.first().clone();e.find("input").each(function(){$(this).val(""),$(this).attr("id",$(this).attr("id").replace("0",t.length)),$(this).attr("name",$(this).attr("name").replace("0",t.length))}),e.find(".contact-email-delete-wrapper").remove(),e.find(".confirmation-status").remove(),e.find(".input-group input:only-child").closest(".input-group").removeClass("input-group"),$(e).insertAfter(t.last())}),$(".contact-email-delete").on("ajax:success",function(){$(this).closest(".contact").fadeOut(250,function(){$(this).remove()})}),$(".contact-email-delete").on("ajax:error",function(t,e,n,i){var r=$(this).closest(".contact").find(".contact-email-delete-error");r.show(),r.find(".error-msg").first().text(i||t.detail[1])}),$(".btn-with-tooltip").tooltip(),$("#save-modal").on("shown.bs.modal",function(){$("#search_title").focus()})}),Spotlight.onLoad(function(){serializeObservedForms(observedForms())}),$(window).on("beforeunload page:before-change turbolinks:before-cache",function(t){if(observedFormsStatusHasChanged()){var e="You have unsaved changes. Are you sure you want to leave this page?";return"beforeunload"==t.type?e:confirm(e)}}),define("spotlight/iiif",["exports","module"],function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,i){n(this,t),this.manifestUrl=e,this.manifest=i}return i(t,[{key:"sequences",value:function(){var t={},e=this;return t[Symbol.iterator]=regeneratorRuntime.mark(function n(){var t,i,r,o,a,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t=!0,i=!1,r=undefined,n.prev=3,o=e.manifest.sequences[Symbol.iterator]();case 5:if(t=(a=o.next()).done){n.next=12;break}return s=a.value,n.next=9,s;case 9:t=!0,n.next=5;break;case 12:n.next=18;break;case 14:n.prev=14,n.t0=n["catch"](3),i=!0,r=n.t0;case 18:n.prev=18,n.prev=19,!t&&o["return"]&&o["return"]();case 21:if(n.prev=21,!i){n.next=24;break}throw r;case 24:return n.finish(21);case 25:return n.finish(18);case 26:case 27:case"end":return n.stop()}},n,this,[[3,14,18,26],[19,,21,25]])}),t}},{key:"canvases",value:function(){var t={},e=this;return t[Symbol.iterator]=regeneratorRuntime.mark(function n(){var t,i,r,o,a,s,c,u,l,h,d,f;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t=!0,i=!1,r=undefined,n.prev=3,o=e.sequences()[Symbol.iterator]();case 5:if(t=(a=o.next()).done){n.next=36;break}s=a.value,c=!0,u=!1,l=undefined,n.prev=10,h=s.canvases[Symbol.iterator]();case 12:if(c=(d=h.next()).done){n.next=19;break}return f=d.value,n.next=16,f;case 16:c=!0,n.next=12;break;case 19:n.next=25;break;case 21:n.prev=21,n.t0=n["catch"](10),u=!0,l=n.t0;case 25:n.prev=25,n.prev=26,!c&&h["return"]&&h["return"]();case 28:if(n.prev=28,!u){n.next=31;break}throw l;case 31:return n.finish(28);case 32:return n.finish(25);case 33:t=!0,n.next=5;break;case 36:n.next=42;break;case 38:n.prev=38,n.t1=n["catch"](3),i=!0,r=n.t1;case 42:n.prev=42,n.prev=43,!t&&o["return"]&&o["return"]();case 45:if(n.prev=45,!i){n.next=48;break}throw r;case 48:return n.finish(45);case 49:return n.finish(42);case 50:case"end":return n.stop()}},n,this,[[3,38,42,50],[10,21,25,33],[26,,28,32],[43,,45,49]])}),t}},{key:"images",value:function(){var t={},e=this;return t[Symbol.iterator]=regeneratorRuntime.mark(function n(){var t,i,r,o,a,s,c,u,l,h,d,f,p;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t=!0,i=!1,r=undefined,n.prev=3,o=e.canvases()[Symbol.iterator]();case 5:if(t=(a=o.next()).done){n.next=37;break}s=a.value,c=!0,u=!1,l=undefined,n.prev=10,h=s.images[Symbol.iterator]();case 12:if(c=(d=h.next()).done){n.next=20;break}return f=d.value,p=f.resource.service["@id"],n.next=17,{thumb:p+"/full/!100,100/0/default.jpg",tilesource:p+"/info.json",manifest:e.manifestUrl,canvasId:s["@id"],imageId:f["@id"]};case 17:c=!0,n.next=12;break;case 20:n.next=26;break;case 22:n.prev=22,n.t0=n["catch"](10),u=!0,l=n.t0;case 26:n.prev=26,n.prev=27,!c&&h["return"]&&h["return"]();case 29:if(n.prev=29,!u){n.next=32;break}throw l;case 32:return n.finish(29);case 33:return n.finish(26);case 34:t=!0,n.next=5;break;case 37:n.next=43;break;case 39:n.prev=39,n.t1=n["catch"](3),i=!0,r=n.t1;case 43:n.prev=43,n.prev=44,!t&&o["return"]&&o["return"]();case 46:if(n.prev=46,!i){n.next=49;break}throw r;case 49:return n.finish(46);case 50:return n.finish(43);case 51:case"end":return n.stop()}},n,this,[[3,39,43,51],[10,22,26,34],[27,,29,33],[44,,46,50]])}),t}},{key:"imagesArray",value:function(){return Array.from(this.images())}}]),t}();e.exports=r}),Spotlight.onLoad(function(){function t(t){$.ajax({url:$(t).data("lock"),type:"POST",data:{_method:"delete"},async:!1}),$(t).removeAttr("data-lock")}$("[data-lock]").on("click",function(){t(this)})}),jQuery,$.fn.multiImageSelector=function(t,e,n){function i(e){g=e,o(),t&&t.length>1&&(r(),d())}function r(){$("[data-panel-image-pagination]",g).html("Image <span data-current-image='true'>"+a(n)+"</span> of "+t.length).show().append(" ").append(v),s()}function o(){var t=$("[data-panel-image-pagination]",g);t.html(""),t.next("."+y.attr("class")).remove()}function a(t){return(index=_.indexOf(t))>-1?index+1:1}function s(){v.on("click",function(){y.slideToggle(),c(),l(),h(),u(),p($(this))})}function c(){var t=0;$("li",b).each(function(){t+=$(this).outerWidth()}),b.width(t+5)}function u(){var t=y.width(),e=0;$("li",b).each(function(){var n=$(this),i=$("img",n),r=e+=n.width();position=b.position().left+r-n.width(),position>=0&&position<t&&i.prop("src",i.data("src"))})}function l(){y.scrollStop(function(){u()})}function h(){var t=y.width()/2,e=($(".active",b).position()||$("li",b).first().position()).left,n=$(".active",b).width()/2;y.scrollLeft(e-t+n)}function d(){m(),f(),$(".panel-heading",g).append(y.append(b))}function f(){$("li",b).each(function(){var t=$(this);$("img",t).data("image-id")==n&&t.addClass("active")})}function p(t){t.text("Change"==t.text()?"Close":"Change")}function m(){$.each(t,function(n){var i=$('<li><a href="javascript:;"><img src="'+t[n].thumb+'" data-image-id="'+t[n].imageId+'" /></a></li>');i.on("click",function(){$("img",$(this)).data("image-id");var i=$("img",$(this)).attr("src");$("li.active",b).removeClass("active"),$(this).addClass("active"),$(".pic.thumbnail img",g).attr("src",i),$("[data-panel-image-pagination] [data-current-image]",g).text($("li",b).index($(this))+1),h(),"function"==typeof e&&e(t[n])}),$("img",i).on("load",function(){c()}),b.append(i)})}var g,v=$("<a href='javascript:;'>Change</a>"),y=$("<div class='thumbs-list' style='display:none'></div>"),b=$("<ul class='pagination'></ul>"),_=$.map(t,function(t){return t.imageId});return i(this)},jQuery.fn.scrollStop=function(t){$(this).scroll(function(){var e=this,n=$(e);n.data("scrollTimeout")&&clearTimeout(n.data("scrollTimeout")),n.data("scrollTimeout",setTimeout(t,250,e))})},Spotlight.onLoad(function(){var t="undefined"==typeof Rails?$.rails:Rails;SirTrevor.setDefaults({iconUrl:"/assets/spotlight/blocks/sir-trevor-icons-c6b5285b61a032e4fa071f5eaa24be067ec95c12d49f9c259643f18f6ada094a.svg",uploadUrl:$("[data-attachment-endpoint]").data("attachment-endpoint"),ajaxOptions:{headers:{"X-CSRF-Token":t.csrfToken()||""},credentials:"same-origin"}}),SirTrevor.Blocks.Heading.prototype.toolbarEnabled=!0,SirTrevor.Blocks.Quote.prototype.toolbarEnabled=!0,SirTrevor.Blocks.Text.prototype.toolbarEnabled=!0;var e=$(".js-st-instance").first();if(e.length){var n=new SirTrevor.Editor({el:e[0],blockTypes:e.data("blockTypes"),defaultType:["Text"],onEditorRender:function(){serializeObservedForms(observedForms())},blockTypeLimits:{SearchResults:1}});n.blockControls=Spotlight.BlockControls.create(n),new Spotlight.BlockLimits(n).enforceLimits(n)}$(".carousel").carousel()}),Spotlight.onLoad(function(){$("input[type='checkbox'][data-readonly]").on("click",function(t){t.preventDefault()})}),Spotlight.onLoad(function(){$('[data-behavior="reindex-monitor"]').reindexMonitor()}),function(t){t.fn.reindexMonitor=function(){function e(e){t.ajax(e).success(n).fail(i)}function n(t){t.recently_in_progress?(r(t),u().show()):u().hide()}function i(){u().hide()}function r(t){l().text(t.started_at),h().text(t.updated_at),f().text(t.completed),s(t),a(t),o(t)}function o(t){var e=c(t);p().attr("aria-valuemax",t.total).attr("aria-valuenow",e).css("width",e+"%").text(e+"%"),t.finished&&p().removeClass("active").removeClass("progress-bar-striped")}function a(t){t.errored?m().show():m().hide()}function s(e){d().each(function(){t(this).text(e.total)})}function c(t){return Math.floor(t.completed/t.total*100)}function u(){return g.find(".index-status")}function l(){return u().find('[data-behavior="monitor-start"]').find('[data-behavior="date"]')}function h(){return u().find('[data-behavior="monitor-current"]').find('[data-behavior="date"]')}function d(){return u().find('[data-behavior="total"]')}function f(){return u().find('[data-behavior="monitor-current"]').find('[data-behavior="completed"]')}function p(){return u().find(".progress-bar")}function m(){return u().find('[data-behavior="monitor-error"]')}var g,v=3e3;return t(this).each(function(){var n=(g=t(this)).data("monitorUrl"),i=g.data("refreshRate")||v;setInterval(function(){e(n)},i)}),this}}(jQuery),function(t){t.fn.reportProblem=function(e){function n(){target_val=o.attr("data-target"),target_val&&(a=t("#"+target_val),o.on("click",i),a.find('[data-behavior="cancel-link"]').on("click",r))}function i(t){t.preventDefault(),a.slideToggle("slow")}function r(t){t.preventDefault(),a.slideUp("fast")}var o,a;t.extend({},e);return this.each(function(){o=t(this),n()})}}(jQuery),Spotlight.onLoad(function(){$('[data-behavior="contact-link"]').reportProblem()}),function(t){var e={isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return void 0===t},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return!!(i=n.call(null,r,t,e))&&void 0}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return!(i=n.call(null,r,t,e))&&void 0}),!!i):i},mixin:t.extend,getUniqueId:function(){var t=0;return function(){return t++}}(),templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var o,a,s=this,c=arguments;return o=function(){i=null,n||(r=t.apply(s,c))},a=n&&!i,clearTimeout(i),i=setTimeout(o,e),a&&(r=t.apply(s,c)),r}},throttle:function(t,e){var n,i,r,o,a,s;return a=0,s=function(){a=new Date,r=null,o=t.apply(n,i)},function(){var c=new Date,u=e-(c-a);return n=this,i=arguments,0>=u?(clearTimeout(r),r=null,a=c,o=t.apply(n,i)):r||(r=setTimeout(s,u)),o}},noop:function(){}},n="0.10.2",i=function(){function t(t){return t.split(/\s+/)}function e(t){return t.split(/\W+/)}function n(t){return function(e){return function(n){return t(n[e])}}}return{nonword:e,whitespace:t,obj:{nonword:n(e),whitespace:n(t)}}}(),r=function(){function t(t){this.maxSize=t||100,this.size=0,this.hash={},this.list=new n}function n(){this.head=this.tail=null}function i(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(t.prototype,{set:function(t,e){var n,r=this.list.tail;this.size>=this.maxSize&&(this.list.remove(r),delete this.hash[r.key]),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new i(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];return e?(this.list.moveToFront(e),e.val):void 0}}),e.mixin(n.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),t}(),o=function(){function t(t){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+this.prefix)}function n(){return(new Date).getTime()}function i(t){return JSON.stringify(e.isUndefined(t)?null:t)}function r(t){return JSON.parse(t)}var o,a;try{(o=window.localStorage).setItem("~~~","!"),o.removeItem("~~~")}catch(s){o=null}return a=o&&window.JSON?{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},get:function(t){return this.isExpired(t)&&this.remove(t),r(o.getItem(this._prefix(t)))},set:function(t,r,a){return e.isNumber(a)?o.setItem(this._ttlKey(t),i(n()+a)):o.removeItem(this._ttlKey(t)),o.setItem(this._prefix(t),i(r))},remove:function(t){return o.removeItem(this._ttlKey(t)),o.removeItem(this._prefix(t)),this},clear:function(){var t,e,n=[],i=o.length;for(t=0;i>t;t++)(e=o.key(t)).match(this.keyMatcher)&&n.push(e.replace(this.keyMatcher,""));for(t=n.length;t--;)this.remove(n[t]);return this},isExpired:function(t){var i=r(o.getItem(this._ttlKey(t)));return!!(e.isNumber(i)&&n()>i)}}:{get:e.noop,set:e.noop,remove:e.noop,clear:e.noop,isExpired:e.noop},e.mixin(t.prototype,a),t}(),a=function(){function n(e){e=e||{},this._send=e.transport?i(e.transport):t.ajax,this._get=e.rateLimiter?e.rateLimiter(this._get):this._get}function i(n){return function(i,r){function o(t){e.defer(function(){s.resolve(t)})}function a(t){e.defer(function(){s.reject(t)})}var s=t.Deferred();return n(i,r,o,a),s}}var o=0,a={},s=6,c=new r(10);return n.setMaxPendingRequests=function(t){s=t},n.resetCache=function(){c=new r(10)},e.mixin(n.prototype,{_get:function(t,e,n){function i(e){n&&n(null,e),c.set(t,e)}function r(){n&&n(!0)}function u(){o--,delete a[t],h.onDeckRequestArgs&&(h._get.apply(h,h.onDeckRequestArgs),h.onDeckRequestArgs=null)}var l,h=this;(l=a[t])?l.done(i).fail(r):s>o?(o++,a[t]=this._send(t,e).done(i).fail(r).always(u)):this.onDeckRequestArgs=[].slice.call(arguments,0)},get:function(t,n,i){var r;return e.isFunction(n)&&(i=n,n={}),(r=c.get(t))?e.defer(function(){i&&i(null,r)}):this._get(t,n,i),!!r}}),n}(),s=function(){function n(e){(e=e||{}).datumTokenizer&&e.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=e.datumTokenizer,this.queryTokenizer=e.queryTokenizer,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){return{ids:[],children:{}}}function o(t){for(var e={},n=[],i=0;i<t.length;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function a(t,e){function n(t,e){return t-e}var i=0,r=0,o=[];for(t=t.sort(n),e=e.sort(n);i<t.length&&r<e.length;)t[i]<e[r]?i++:t[i]>e[r]?r++:(o.push(t[i]),i++,r++);return o}return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var o,a;o=n.datums.push(t)-1,a=i(n.datumTokenizer(t)),e.each(a,function(t){var e,i,a;for(e=n.trie,i=t.split("");a=i.shift();)(e=e.children[a]||(e.children[a]=r())).ids.push(o)})})},get:function(t){var n,r,s=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,o;if(r&&0===r.length)return!1;for(e=s.trie,n=t.split("");e&&(i=n.shift());)e=e.children[i];return e&&0===n.length?(o=e.ids.slice(0),void(r=r?a(r,o):o)):(r=[],!1)}),r?e.map(o(r),function(t){return s.datums[t]}):[]},reset:function(){this.datums=[],this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),c=function(){function i(t){return t.local||null}function r(i){var r,o;return o={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(r=i.prefetch||null)&&(r=e.isString(r)?{url:r}:r,r=e.mixin(o,r),r.thumbprint=n+r.thumbprint,r.ajax.type=r.ajax.type||"GET",r.ajax.dataType=r.ajax.dataType||"json",!r.url&&t.error("prefetch requires url to be set")),r}function o(n){function i(t){return function(n){return e.debounce(n,t)}}function r(t){return function(n){return e.throttle(n,t)}}var o,a;return a={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(o=n.remote||null)&&(o=e.isString(o)?{url:o}:o,o=e.mixin(a,o),o.rateLimiter=/^throttle$/i.test(o.rateLimitBy)?r(o.rateLimitWait):i(o.rateLimitWait),o.ajax.type=o.ajax.type||"GET",o.ajax.dataType=o.ajax.dataType||"json",delete o.rateLimitBy,delete o.rateLimitWait,!o.url&&t.error("remote requires url to be set")),o}return{local:i,prefetch:r,remote:o}}();!function(n){function r(e){e&&(e.local||e.prefetch||e.remote)||t.error("one of local, prefetch, or remote is required"),this.limit=e.limit||5,this.sorter=u(e.sorter),this.dupDetector=e.dupDetector||l,this.local=c.local(e),this.prefetch=c.prefetch(e),this.remote=c.remote(e),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new s({datumTokenizer:e.datumTokenizer,queryTokenizer:e.queryTokenizer}),this.storage=this.cacheKey?new o(this.cacheKey):null}function u(t){function n(e){return e.sort(t)}function i(t){return t}return e.isFunction(t)?n:i}function l(){return!1}var h,d;h=n.Bloodhound,d={data:"data",protocol:"protocol",thumbprint:"thumbprint"},n.Bloodhound=r,r.noConflict=function(){return n.Bloodhound=h,r},r.tokenizers=i,e.mixin(r.prototype,{_loadPrefetch:function(e){function n(t){o.clear(),o.add(e.filter?e.filter(t):t),o._saveToStorage(o.index.serialize(),e.thumbprint,e.ttl)}var i,r,o=this;return(i=this._readFromStorage(e.thumbprint))?(this.index.bootstrap(i),r=t.Deferred().resolve()):r=t.ajax(e.url,e.ajax).done(n),r},_getFromRemote:function(t,e){function n(t,n){e(t?[]:o.remote.filter?o.remote.filter(n):n)}var i,r,o=this;return t=t||"",r=encodeURIComponent(t),i=this.remote.replace?this.remote.replace(this.remote.url,t):this.remote.url.replace(this.remote.wildcard,r),this.transport.get(i,this.remote.ajax,n)},_saveToStorage:function(t,e,n){this.storage&&(this.storage.set(d.data,t,n),this.storage.set(d.protocol,location.protocol,n),this.storage.set(d.thumbprint,e,n))},_readFromStorage:function(t){var e,n={};return this.storage&&(n.data=this.storage.get(d.data),n.protocol=this.storage.get(d.protocol),n.thumbprint=this.storage.get(d.thumbprint)),e=n.thumbprint!==t||n.protocol!==location.protocol,n.data&&!e?n.data:null},_initialize:function(){function n(){r.add(e.isFunction(o)?o():o)}var i,r=this,o=this.local;return i=this.prefetch?this._loadPrefetch(this.prefetch):t.Deferred().resolve(),o&&i.done(n),this.transport=this.remote?new a(this.remote):null,this.initPromise=i.promise()},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){this.index.add(t)},get:function(t,n){function i(t){var i=o.slice(0);e.each(t,function(t){return!e.some(i,function(e){return r.dupDetector(t,e)})&&i.push(t),i.length<r.limit}),n&&n(r.sorter(i))}var r=this,o=[],a=!1;o=this.index.get(t),(o=this.sorter(o).slice(0,this.limit)).length<this.limit&&this.transport&&(a=this._getFromRemote(t,i)),a||(o.length>0||!this.transport)&&n&&n(o)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&a.resetCache()},ttAdapter:function(){return e.bind(this.get,this)}})}(this);var u={wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'},l={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};e.isMsie()&&e.mixin(l.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),e.isMsie()&&e.isMsie()<=7&&e.mixin(l.input,{marginTop:"-1px"});var h=function(){function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var i="typeahead:";return e.mixin(n.prototype,{trigger:function(t){var e=[].slice.call(arguments,1);this.$el.trigger(i+t,e)}}),n}(),d=function(){function t(t,e,n,i){var r;if(!n)return this;for(e=e.split(c),n=i?s(n,i):n,this._callbacks=this._callbacks||{};r=e.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][t].push(n);return this}function e(e,n,i){return t.call(this,"async",e,n,i)}function n(e,n,i){return t.call(this,"sync",e,n,i)}function i(t){var e;if(!this._callbacks)return this;for(t=t.split(c);e=t.shift();)delete this._callbacks[e];return this}function r(t){var e,n,i,r,a;if(!this._callbacks)return this;for(t=t.split(c),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)r=o(n.sync,this,[e].concat(i)),a=o(n.async,this,[e].concat(i)),r()&&u(a);return this}function o(t,e,n){function i(){for(var i,r=0;!i&&r<t.length;r+=1)i=!1===t[r].apply(e,n);return!i}return i}function a(){return window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)}}function s(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var c=/\s+/,u=a();return{onSync:n,onAsync:e,off:i,trigger:r}}(),f=function(t){function n(t,n,i){for(var r,o=[],a=0;a<t.length;a++)o.push(e.escapeRegExChars(t[a]));return r=i?"\\b("+o.join("|")+")\\b":"("+o.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function o(e){var n,i;return(n=s.exec(e.data))&&(wrapperNode=t.createElement(r.tagName),r.className&&(wrapperNode.className=r.className),(i=e.splitText(n.index)).splitText(n[0].length),wrapperNode.appendChild(i.cloneNode(!0)),e.parentNode.replaceChild(wrapperNode,i)),!!n}function a(t,e){for(var n,i=3,r=0;r<t.childNodes.length;r++)(n=t.childNodes[r]).nodeType===i?r+=e(n)?1:0:a(n,e)}var s;(r=e.mixin({},i,r)).node&&r.pattern&&(r.pattern=e.isArray(r.pattern)?r.pattern:[r.pattern],s=n(r.pattern,r.caseSensitive,r.wordsOnly),a(r.node,o))}}(window.document),p=function(){function n(n){var r,o,s,c,u=this;(n=n||{}).input||t.error("input is missing"),r=e.bind(this._onBlur,this),o=e.bind(this._onFocus,this),s=e.bind(this._onKeydown,this),c=e.bind(this._onInput,this),this.$hint=t(n.hint),this.$input=t(n.input).on("blur.tt",r).on("focus.tt",o).on("keydown.tt",s),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop),e.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){a[t.which||t.keyCode]||e.defer(e.bind(u._onInput,u,t))}):this.$input.on("input.tt",c),this.query=this.$input.val(),this.$overflowHelper=i(this.$input)}function i(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function r(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function o(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var a;return a={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return(t||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,d,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(t){var e=a[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(t,e){var n,i,r;switch(t){case"tab":i=this.getHint(),r=this.getInputValue(),n=i&&i!==r&&!o(e);break;case"up":case"down":n=!o(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!o(e);break;default:n=!0}return n},_checkInputValue:function(){var t,e,n;n=!!(e=r(t=this.getInputValue(),this.query))&&this.query.length!==t.length,e?n&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query=t)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(t){this.query=t},getInputValue:function(){return this.$input.val()},setInputValue:function(t,e){this.$input.val(t),e?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n;n=(t=this.getInputValue())!==(e=this.getHint())&&0===e.indexOf(t),(""===t||!n||this.hasOverflow())&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,i;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:!document.selection||((i=document.selection.createRange()).moveStart("character",-t),t===i.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),n}(),m=function(){function n(n){(n=n||{}).templates=n.templates||{},n.source||t.error("missing source"),n.name&&!o(n.name)&&t.error("invalid dataset name: "+n.name),this.query=null,this.highlight=!!n.highlight,this.name=n.name||e.getUniqueId(),this.source=n.source,this.displayFn=i(n.display||n.displayKey),this.templates=r(n.templates,this.displayFn),this.$el=t(u.dataset.replace("%CLASS%",this.name))}function i(t){function n(e){return e[t]}return t=t||"value",e.isFunction(t)?t:n}function r(t,n){function i(t){return"<p>"+n(t)+"</p>"}return{empty:t.empty&&e.templatify(t.empty),header:t.header&&e.templatify(t.header),footer:t.footer&&e.templatify(t.footer),suggestion:t.suggestion||i}}function o(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var a="ttDataset",s="ttValue",c="ttDatum";return n.extractDatasetName=function(e){return t(e).data(a)},n.extractValue=function(e){return t(e).data(s)},n.extractDatum=function(e){return t(e).data(c)},e.mixin(n.prototype,d,{_render:function(n,i){function r(){return m.templates.empty({query:n,isEmpty:!0})}function o(){function r(e){var n;return(n=t(u.suggestion).append(m.templates.suggestion(e)).data(a,m.name).data(s,m.displayFn(e)).data(c,e)).children().each(function(){t(this).css(l.suggestionChild)}),n}var o,h;return o=t(u.suggestions).css(l.suggestions),h=e.map(i,r),o.append.apply(o,h),m.highlight&&f({node:o[0],pattern:n}),o}function h(){return m.templates.header({query:n,isEmpty:!p})}function d(){return m.templates.footer({query:n,isEmpty:!p})}if(this.$el){var p,m=this;this.$el.empty(),!(p=i&&i.length)&&this.templates.empty?this.$el.html(r()).prepend(m.templates.header?h():null).append(m.templates.footer?d():null):p&&this.$el.html(o()).prepend(m.templates.header?h():null).append(m.templates.footer?d():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(t){function e(e){n.canceled||t!==n.query||n._render(t,e)}var n=this;this.query=t,this.canceled=!1,this.source(t,e)},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),n}(),g=function(){function n(n){var r,o,a,s=this;(n=n||{}).menu||t.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=e.map(n.datasets,i),r=e.bind(this._onSuggestionClick,this),o=e.bind(this._onSuggestionMouseEnter,this),a=e.bind(this._onSuggestionMouseLeave,this),this.$menu=t(n.menu).on("click.tt",".tt-suggestion",r).on("mouseenter.tt",".tt-suggestion",o).on("mouseleave.tt",".tt-suggestion",a),e.each(this.datasets,function(t){s.$menu.append(t.getRoot()),t.onSync("rendered",s._onRendered,s)})}function i(t){return new m(t)}return e.mixin(n.prototype,d,{_onSuggestionClick:function(e){this.trigger("suggestionClicked",t(e.currentTarget))},_onSuggestionMouseEnter:function(e){this._removeCursor(),this._setCursor(t(e.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function t(t){return t.isEmpty()}this.isEmpty=e.every(this.datasets,t),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(t,e){t.first().addClass("tt-cursor"),!e&&this.trigger("cursorMoved")
},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(t){var e,n,i,r;if(this.isOpen){if(n=this._getCursor(),e=this._getSuggestions(),this._removeCursor(),i=e.index(n)+t,-1===(i=(i+1)%(e.length+1)-1))return void this.trigger("cursorRemoved");-1>i&&(i=e.length-1),this._setCursor(r=e.eq(i)),this._ensureVisible(r)}},_ensureVisible:function(t){var e,n,i,r;n=(e=t.position().top)+t.outerHeight(!0),i=this.$menu.scrollTop(),r=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),0>e?this.$menu.scrollTop(i+e):n>r&&this.$menu.scrollTop(i+(n-r))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(t){this.$menu.css("ltr"===t?l.ltr:l.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(t){var e=null;return t.length&&(e={raw:m.extractDatum(t),value:m.extractValue(t),datasetName:m.extractDatasetName(t)}),e},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(t){function n(e){e.update(t)}e.each(this.datasets,n)},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function t(t){t.destroy()}this.$menu.off(".tt"),this.$menu=null,e.each(this.datasets,t)}}),n}(),v=function(){function n(n){var r,o,a;(n=n||{}).input||t.error("missing input"),this.isActivated=!1,this.autoselect=!!n.autoselect,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.$node=i(n.input,n.withHint),r=this.$node.find(".tt-dropdown-menu"),o=this.$node.find(".tt-input"),a=this.$node.find(".tt-hint"),o.on("blur.tt",function(t){var n,i,a;n=document.activeElement,i=r.is(n),a=r.has(n).length>0,e.isMsie()&&(i||a)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){o.focus()}))}),r.on("mousedown.tt",function(t){t.preventDefault()}),this.eventBus=n.eventBus||new h({el:o}),this.dropdown=new g({menu:r,datasets:n.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new p({input:o,hint:a}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}function i(e,n){var i,o,s,c;i=t(e),o=t(u.wrapper).css(l.wrapper),s=t(u.dropdown).css(l.dropdown),(c=i.clone().css(l.hint).css(r(i))).val("").removeData().addClass("tt-hint").removeAttr("id name placeholder").prop("disabled",!0).attr({autocomplete:"off",spellcheck:"false"}),i.data(a,{dir:i.attr("dir"),autocomplete:i.attr("autocomplete"),spellcheck:i.attr("spellcheck"),style:i.attr("style")}),i.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(n?l.input:l.inputWithNoHint);try{!i.attr("dir")&&i.attr("dir","auto")}catch(h){}return i.wrap(o).parent().prepend(n?c:null).append(s)}function r(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function o(t){var n=t.find(".tt-input");e.each(n.data(a),function(t,i){e.isUndefined(t)?n.removeAttr(i):n.attr(i,t)}),n.detach().removeData(a).removeClass("tt-input").insertAfter(t),t.remove()}var a="ttAttrs";return e.mixin(n.prototype,{_onSuggestionClicked:function(t,e){var n;(n=this.dropdown.getDatumForSuggestion(e))&&this._select(n)},_onCursorMoved:function(){var t=this.dropdown.getDatumForCursor();this.input.setInputValue(t.value,!0),this.eventBus.trigger("cursorchanged",t.raw,t.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(t,e){var n,i;n=this.dropdown.getDatumForCursor(),i=this.dropdown.getDatumForTopSuggestion(),n?(this._select(n),e.preventDefault()):this.autoselect&&i&&(this._select(i),e.preventDefault())},_onTabKeyed:function(t,e){var n;(n=this.dropdown.getDatumForCursor())?(this._select(n),e.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(t,e){this.input.clearHintIfInvalid(),e.length>=this.minLength?this.dropdown.update(e):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var t;this.dir!==(t=this.input.getLanguageDirection())&&(this.dir=t,this.$node.css("direction",t),this.dropdown.setLanguageDirection(t))},_updateHint:function(){var t,n,i,r,o,a;(t=this.dropdown.getDatumForTopSuggestion())&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(n=this.input.getInputValue(),i=p.normalizeQuery(n),r=e.escapeRegExChars(i),o=new RegExp("^(?:"+r+")(.+$)","i"),(a=o.exec(t.value))?this.input.setHint(n+a[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(t){var e,n,i,r;e=this.input.getHint(),n=this.input.getQuery(),i=t||this.input.isCursorAtEnd(),e&&n!==e&&i&&((r=this.dropdown.getDatumForTopSuggestion())&&this.input.setInputValue(r.value),this.eventBus.trigger("autocompleted",r.raw,r.datasetName))},_select:function(t){this.input.setQuery(t.value),this.input.setInputValue(t.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",t.raw,t.datasetName),this.dropdown.close(),e.defer(e.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(t){this.isActivated?this.input.setInputValue(t):(this.input.setQuery(t),this.input.setInputValue(t,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),o(this.$node),this.$node=null}}),n}();!function(){var n,i,r;n=t.fn.typeahead,i="ttTypeahead",r={initialize:function(n,r){function o(){var o,a=t(this);e.each(r,function(t){t.highlight=!!n.highlight}),o=new v({input:a,eventBus:new h({el:a}),withHint:!!e.isUndefined(n.hint)||!!n.hint,minLength:n.minLength,autoselect:n.autoselect,datasets:r}),a.data(i,o)}return r=e.isArray(r)?r:[].slice.call(arguments,1),n=n||{},this.each(o)},open:function(){function e(){var e;(e=t(this).data(i))&&e.open()}return this.each(e)},close:function(){function e(){var e;(e=t(this).data(i))&&e.close()}return this.each(e)},val:function(e){function n(){var n;(n=t(this).data(i))&&n.setVal(e)}function r(t){var e,n;return(e=t.data(i))&&(n=e.getVal()),n}return arguments.length?this.each(n):r(this.first())},destroy:function(){function e(){var e,n=t(this);(e=n.data(i))&&(e.destroy(),n.removeData(i))}return this.each(e)}},t.fn.typeahead=function(t){return r[t]?r[t].apply(this,[].slice.call(arguments,1)):r.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=n,this}}()}(window.jQuery);var Handlebars=function(){var t=function(){"use strict";function t(t){this.string=t}return t.prototype.toString=function(){return""+this.string},t}(),e=function(){"use strict";function e(t){return s[t]||"&amp;"}function n(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function i(t){return t instanceof a?t.toString():t||0===t?(t=""+t,u.test(t)?t.replace(c,e):t):""}function r(t){return!t&&0!==t||!(!d(t)||0!==t.length)}var o={},a=t,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/[&<>"'`]/g,u=/[&<>"'`]/;o.extend=n;var l=Object.prototype.toString;o.toString=l;(h=function(t){return"function"==typeof t})(/x/)&&(h=function(t){return"function"==typeof t&&"[object Function]"===l.call(t)});var h;o.isFunction=h;var d=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===l.call(t)};return o.isArray=d,o.escapeExpression=i,o.isEmpty=r,o}(),n=function(){"use strict";function t(t,n){var i;n&&n.firstLine&&(t+=" - "+(i=n.firstLine)+":"+n.firstColumn);for(var r=Error.prototype.constructor.call(this,t),o=0;o<e.length;o++)this[e[o]]=r[e[o]];i&&(this.lineNumber=i,this.column=n.firstColumn)}var e=["description","fileName","lineNumber","message","name","number","stack"];return t.prototype=new Error,t}(),i=function(){"use strict";function t(t,e){this.helpers=t||{},this.partials=e||{},i(this)}function i(t){t.registerHelper("helperMissing",function(t){if(2===arguments.length)return undefined;throw new s("Missing helper: '"+t+"'")}),t.registerHelper("blockHelperMissing",function(e,n){var i=n.inverse||function(){},r=n.fn;return d(e)&&(e=e.call(this)),!0===e?r(this):!1===e||null==e?i(this):h(e)?e.length>0?t.helpers.each(e,n):i(this):r(e)}),t.registerHelper("each",function(t,e){var n,i=e.fn,r=e.inverse,o=0,a="";if(d(t)&&(t=t.call(this)),e.data&&(n=g(e.data)),t&&"object"==typeof t)if(h(t))for(var s=t.length;o<s;o++)n&&(n.index=o,n.first=0===o,n.last=o===t.length-1),a+=i(t[o],{data:n});else for(var c in t)t.hasOwnProperty(c)&&(n&&(n.key=c,n.index=o,n.first=0===o),a+=i(t[c],{data:n}),o++);return 0===o&&(a=r(this)),a}),t.registerHelper("if",function(t,e){return d(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||a.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers["if"].call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),t.registerHelper("with",function(t,e){if(d(t)&&(t=t.call(this)),!a.isEmpty(t))return e.fn(t)}),t.registerHelper("log",function(e,n){var i=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;t.log(i,e)})}function r(t,e){m.log(t,e)}var o={},a=e,s=n,c="1.3.0";o.VERSION=c;var u=4;o.COMPILER_REVISION=u;var l={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};o.REVISION_CHANGES=l;var h=a.isArray,d=a.isFunction,f=a.toString,p="[object Object]";o.HandlebarsEnvironment=t,t.prototype={constructor:t,logger:m,log:r,registerHelper:function(t,e,n){if(f.call(t)===p){if(n||e)throw new s("Arg not supported with multiple helpers");a.extend(this.helpers,t)}else n&&(e.not=n),this.helpers[t]=e},registerPartial:function(t,e){f.call(t)===p?a.extend(this.partials,t):this.partials[t]=e}};var m={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(t,e){if(m.level<=t){var n=m.methodMap[t];"undefined"!=typeof console&&console[n]&&console[n].call(console,e)}}};o.logger=m,o.log=r;var g=function(t){var e={};return a.extend(e,t),e};return o.createFrame=g,o}(),r=function(t,i,r){"use strict";function o(t){var e=t&&t[0]||1;if(e!==p){if(e<p){var n=m[p],i=m[e];throw new f("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+i+").")}throw new f("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function a(t,e){if(!e)throw new f("No environment passed to template");var n=function(t,n,i,r,o,a){var s=e.VM.invokePartial.apply(this,arguments);if(null!=s)return s;if(e.compile){var c={helpers:r,partials:o,data:a};return o[n]=e.compile(t,{data:a!==undefined},e),o[n](i,c)}throw new f("The partial "+n+" could not be compiled when running in runtime-only mode")},i={escapeExpression:d.escapeExpression,invokePartial:n,programs:[],program:function(t,e,n){var i=this.programs[t];return n?i=c(t,e,n):i||(i=this.programs[t]=c(t,e)),i},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n={},d.extend(n,e),d.extend(n,t)),n},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(n,r){var o,a,s=(r=r||{}).partial?r:e;r.partial||(o=r.helpers,a=r.partials);var c=t.call(i,s,n,o,a,r.data);return r.partial||e.VM.checkRevision(i.compilerInfo),c}}function s(t,e,n){var i=Array.prototype.slice.call(arguments,3),r=function(t,r){return r=r||{},e.apply(this,[t,r.data||n].concat(i))};return r.program=t,r.depth=i.length,r}function c(t,e,n){var i=function(t,i){return i=i||{},e(t,i.data||n)};return i.program=t,i.depth=0,i}function u(t,e,n,i,r,o){var a={partial:!0,helpers:i,partials:r,data:o};if(t===undefined)throw new f("The partial "+e+" could not be found");if(t instanceof Function)return t(n,a)}function l(){return""}var h={},d=e,f=n,p=r.COMPILER_REVISION,m=r.REVISION_CHANGES;return h.checkRevision=o,h.template=a,h.programWithDepth=s,h.program=c,h.invokePartial=u,h.noop=l,h}(0,0,i),o=function(){"use strict";var o=i,a=t,s=n,c=e,u=r,l=function(){var t=new o.HandlebarsEnvironment;return c.extend(t,o),t.SafeString=a,t.Exception=s,t.Utils=c,t.VM=u,t.template=function(e){return u.template(e,t)},t},h=l();return h.create=l,h}(),a=function(){"use strict";function t(t){t=t||{},this.firstLine=t.first_line,this.firstColumn=t.first_column,this.lastColumn=t.last_column,this.lastLine=t.last_line}var e=n,i={ProgramNode:function(e,n,r,o){var a,s;3===arguments.length?(o=r,r=null):2===arguments.length&&(o=n,n=null),t.call(this,o),this.type="program",this.statements=e,this.strip={},r?((s=r[0])?(a={first_line:s.firstLine,last_line:s.lastLine,last_column:s.lastColumn,first_column:s.firstColumn},this.inverse=new i.ProgramNode(r,n,a)):this.inverse=new i.ProgramNode(r,n),this.strip.right=n.left):n&&(this.strip.left=n.right)},MustacheNode:function(e,n,r,o,a){if(t.call(this,a),this.type="mustache",this.strip=o,null!=r&&r.charAt){var s=r.charAt(3)||r.charAt(2);this.escaped="{"!==s&&"&"!==s}else this.escaped=!!r;e instanceof i.SexprNode?this.sexpr=e:this.sexpr=new i.SexprNode(e,n),this.sexpr.isRoot=!0,this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(e,n,i){t.call(this,i),this.type="sexpr",this.hash=n;var r=this.id=e[0],o=this.params=e.slice(1),a=this.eligibleHelper=r.isSimple;this.isHelper=a&&(o.length||n)},PartialNode:function(e,n,i,r){t.call(this,r),this.type="partial",this.partialName=e,this.context=n,this.strip=i},BlockNode:function(n,i,r,o,a){if(t.call(this,a),n.sexpr.id.original!==o.path.original)throw new e(n.sexpr.id.original+" doesn't match "+o.path.original,this);this.type="block",this.mustache=n,this.program=i,this.inverse=r,this.strip={left:n.strip.left,right:o.strip.right},(i||r).strip.left=n.strip.right,(r||i).strip.right=o.strip.left,r&&!i&&(this.isInverse=!0)},ContentNode:function(e,n){t.call(this,n),this.type="content",this.string=e},HashNode:function(e,n){t.call(this,n),this.type="hash",this.pairs=e},IdNode:function(n,i){t.call(this,i),this.type="ID";for(var r="",o=[],a=0,s=0,c=n.length;s<c;s++){var u=n[s].part;if(r+=(n[s].separator||"")+u,".."===u||"."===u||"this"===u){if(o.length>0)throw new e("Invalid path: "+r,this);".."===u?a++:this.isScoped=!0}else o.push(u)}this.original=r,this.parts=o,this.string=o.join("."),this.depth=a,this.isSimple=1===n.length&&!this.isScoped&&0===a,this.stringModeValue=this.string},PartialNameNode:function(e,n){t.call(this,n),this.type="PARTIAL_NAME",this.name=e.original},DataNode:function(e,n){t.call(this,n),this.type="DATA",this.id=e},StringNode:function(e,n){t.call(this,n),this.type="STRING",this.original=this.string=this.stringModeValue=e},IntegerNode:function(e,n){t.call(this,n),this.type="INTEGER",this.original=this.integer=e,this.stringModeValue=Number(e)},BooleanNode:function(e,n){t.call(this,n),this.type="BOOLEAN",this.bool=e,this.stringModeValue="true"===e},CommentNode:function(e,n){t.call(this,n),this.type="comment",this.comment=e}};return i}(),s=function(){"use strict";return function(){function t(t,e){return{left:"~"===t.charAt(2),right:"~"===e.charAt(0)||"~"===e.charAt(1)}}function e(){this.yy={}}var n={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,sexpr:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,sexpr_repetition0:28,sexpr_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,OPEN_SEXPR:35,CLOSE_SEXPR:36,hash:37,hash_repetition_plus0:38,hashSegment:39,ID:40,EQUALS:41,DATA:42,pathSegments:43,SEP:44,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],performAction:function(e,n,i,r,o,a){var s=a.length-1;switch(o){case 1:return new r.ProgramNode(a[s-1],this._$);case 2:return new r.ProgramNode([],this._$);case 3:this.$=new r.ProgramNode([],a[s-1],a[s],this._$);break;case 4:this.$=new r.ProgramNode(a[s-2],a[s-1],a[s],this._$);break;case 5:this.$=new r.ProgramNode(a[s-1],a[s],[],this._$);break;case 6:this.$=new r.ProgramNode(a[s],this._$);break;case 7:case 8:this.$=new r.ProgramNode([],this._$);break;case 9:this.$=[a[s]];break;case 10:a[s-1].push(a[s]),this.$=a[s-1];break;case 11:this.$=new r.BlockNode(a[s-2],a[s-1].inverse,a[s-1],a[s],this._$);break;case 12:this.$=new r.BlockNode(a[s-2],a[s-1],a[s-1].inverse,a[s],this._$);break;case 13:case 14:this.$=a[s];break;case 15:this.$=new r.ContentNode(a[s],this._$);break;case 16:this.$=new r.CommentNode(a[s],this._$);break;case 17:case 18:this.$=new r.MustacheNode(a[s-1],null,a[s-2],t(a[s-2],a[s]),this._$);break;case 19:this.$={path:a[s-1],strip:t(a[s-2],a[s])};break;case 20:case 21:this.$=new r.MustacheNode(a[s-1],null,a[s-2],t(a[s-2],a[s]),this._$);break;case 22:this.$=new r.PartialNode(a[s-2],a[s-1],t(a[s-3],a[s]),this._$);break;case 23:this.$=t(a[s-1],a[s]);break;case 24:this.$=new r.SexprNode([a[s-2]].concat(a[s-1]),a[s],this._$);break;case 25:this.$=new r.SexprNode([a[s]],null,this._$);break;case 26:this.$=a[s];break;case 27:this.$=new r.StringNode(a[s],this._$);break;case 28:this.$=new r.IntegerNode(a[s],this._$);break;case 29:this.$=new r.BooleanNode(a[s],this._$);break;case 30:this.$=a[s];break;case 31:a[s-1].isHelper=!0,this.$=a[s-1];break;case 32:this.$=new r.HashNode(a[s],this._$);break;case 33:this.$=[a[s-2],a[s]];break;case 34:this.$=new r.PartialNameNode(a[s],this._$);break;case 35:this.$=new r.PartialNameNode(new r.StringNode(a[s],this._$),this._$);break;case 36:this.$=new r.PartialNameNode(new r.IntegerNode(a[s],this._$));break;case 37:this.$=new r.DataNode(a[s],this._$);break;case 38:this.$=new r.IdNode(a[s],this._$);break;case 39:a[s-2].push({part:a[s],separator:a[s-1]}),this.$=a[s-2];break;case 40:this.$=[{part:a[s]}];break;case 43:this.$=[];break;case 44:a[s-1].push(a[s]);break;case 47:this.$=[a[s]];break;case 48:a[s-1].push(a[s])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],defaultActions:{3:[2,2],16:[2,1],50:[2,42]},parseError:function(t){throw new Error(t)},parse:function(t){function e(){var t;return"number"!=typeof(t=n.lexer.lex()||1)&&(t=n.symbols_[t]||t),t}var n=this,i=[0],r=[null],o=[],a=this.table,s="",c=0,u=0,l=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;o.push(h);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var f,p,m,g,v,y,b,_,x,w={};;){if(m=i[i.length-1],this.defaultActions[m]?g=this.defaultActions[m]:(null!==f&&void 0!==f||(f=e()),g=a[m]&&a[m][f]),void 0===g||!g.length||!g[0]){var S="";if(!l){x=[];for(y in a[m])this.terminals_[y]&&y>2&&x.push("'"+this.terminals_[y]+"'");S=this.lexer.showPosition?"Parse error on line "+(c+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[f]||f)+"'":"Parse error on line "+(c+1)+": Unexpected "+(1==f?"end of input":"'"+(this.terminals_[f]||f)+"'"),this.parseError(S,{text:this.lexer.match,token:this.terminals_[f]||f,line:this.lexer.yylineno,loc:h,expected:x})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+f);switch(g[0]){case 1:i.push(f),r.push(this.lexer.yytext),o.push(this.lexer.yylloc),i.push(g[1]),f=null,p?(f=p,p=null):(u=this.lexer.yyleng,s=this.lexer.yytext,c=this.lexer.yylineno,h=this.lexer.yylloc,l>0&&l--);break;case 2:if(b=this.productions_[g[1]][1],w.$=r[r.length-b],w._$={first_line:o[o.length-(b||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(b||1)].first_column,last_column:o[o.length-1].last_column},d&&(w._$.range=[o[o.length-(b||1)].range[0],o[o.length-1].range[1]]),void 0!==(v=this.performAction.call(w,s,u,c,this.yy,g[1],r,o)))return v;b&&(i=i.slice(0,-1*b*2),r=r.slice(0,-1*b),o=o.slice(0,-1*b)),i.push(this.productions_[g[1]][0]),r.push(w.$),o.push(w._$),_=a[i[i.length-2]][i[i.length-1]],i.push(_);break;case 3:return!0}}return!0}},i=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;return t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,i,r;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),a=0;a<o.length&&(!(n=this._input.match(this.rules[o[a]]))||e&&!(n[0].length>e[0].length)||(e=n,i=a,this.options.flex));a++);return e?((r=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,o[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,n){function i(t,n){return e.yytext=e.yytext.substr(t,e.yyleng-n)}switch(n){case 0:if("\\\\"===e.yytext.slice(-2)?(i(0,1),this.begin("mu")):"\\"===e.yytext.slice(-1)?(i(0,1),this.begin("emu")):this.begin("mu"),e.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return i(0,4),this.popState(),15;case 4:return 35;case 5:return 36;case 6:return 25;case 7:return 16;case 8:return 20;case 9:case 10:return 19;case 11:return 23;case 12:return 22;case 13:this.popState(),this.begin("com");break;case 14:return i(3,5),this.popState(),15;case 15:return 22;case 16:return 41;case 17:case 18:return 40;case 19:return 44;case 20:break;case 21:return this.popState(),24;case 22:return this.popState(),18;case 23:return e.yytext=i(1,2).replace(/\\"/g,'"'),32;case 24:return e.yytext=i(1,2).replace(/\\'/g,"'"),32;case 25:return 42;case 26:case 27:return 34;case 28:return 33;case 29:return 40;case 30:return e.yytext=i(1,2),40;case 31:return"INVALID";case 32:return 5}},
t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],t.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,32],inclusive:!0}},t}();return n.lexer=i,e.prototype=n,n.Parser=e,new e}()}();return function(t,e,n,i,r){"use strict";var s=o,c=a,u=n.parser,l=n.parse,h=i.Compiler,d=i.compile,f=i.precompile,p=r,m=s.create,g=function(){var t=m();return t.compile=function(e,n){return d(e,n,t)},t.precompile=function(e,n){return f(e,n,t)},t.AST=c,t.Compiler=h,t.JavaScriptCompiler=p,t.Parser=u,t.parse=l,t};return s=g(),s.create=g,s}(0,0,function(){"use strict";function t(t){return t.constructor===i.ProgramNode?t:(n.yy=i,n.parse(t))}var e={},n=s,i=a;return e.parser=n,e.parse=t,e}(),function(){"use strict";function t(){}function e(t,e,n){if(null==t||"string"!=typeof t&&t.constructor!==n.AST.ProgramNode)throw new o("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);"data"in(e=e||{})||(e.data=!0);var i=n.parse(t),r=(new n.Compiler).compile(i,e);return(new n.JavaScriptCompiler).compile(r,e)}function i(t,e,n){function i(){var i=n.parse(t),r=(new n.Compiler).compile(i,e),o=(new n.JavaScriptCompiler).compile(r,e,undefined,!0);return n.template(o)}if(null==t||"string"!=typeof t&&t.constructor!==n.AST.ProgramNode)throw new o("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t);"data"in(e=e||{})||(e.data=!0);var r;return function(t,e){return r||(r=i()),r.call(this,t,e)}}var r={},o=n;return r.Compiler=t,t.prototype={compiler:t,disassemble:function(){for(var t,e,n,i=this.opcodes,r=[],o=0,a=i.length;o<a;o++)if("DECLARE"===(t=i[o]).opcode)r.push("DECLARE "+t.name+"="+t.value);else{e=[];for(var s=0;s<t.args.length;s++)"string"==typeof(n=t.args[s])&&(n='"'+n.replace("\n","\\n")+'"'),e.push(n);r.push(t.opcode+" "+e.join(" "))}return r.join("\n")},equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e)return!1;for(var n=0;n<e;n++){var i=this.opcodes[n],r=t.opcodes[n];if(i.opcode!==r.opcode||i.args.length!==r.args.length)return!1;for(var o=0;o<i.args.length;o++)if(i.args[o]!==r.args[o])return!1}if(e=this.children.length,t.children.length!==e)return!1;for(n=0;n<e;n++)if(!this.children[n].equals(t.children[n]))return!1;return!0},guid:0,compile:function(t,e){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=e;var n=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},n)for(var i in n)this.options.knownHelpers[i]=n[i];return this.accept(t)},accept:function(t){var e,n=t.strip||{};return n.left&&this.opcode("strip"),e=this[t.type](t),n.right&&this.opcode("strip"),e},program:function(t){for(var e=t.statements,n=0,i=e.length;n<i;n++)this.accept(e[n]);return this.isSimple=1===i,this.depths.list=this.depths.list.sort(function(t,e){return t-e}),this},compileProgram:function(t){var e,n=(new this.compiler).compile(t,this.options),i=this.guid++;this.usePartial=this.usePartial||n.usePartial,this.children[i]=n;for(var r=0,o=n.depths.list.length;r<o;r++)(e=n.depths.list[r])<2||this.addDepth(e-1);return i},block:function(t){var e=t.mustache,n=t.program,i=t.inverse;n&&(n=this.compileProgram(n)),i&&(i=this.compileProgram(i));var r=e.sexpr,o=this.classifySexpr(r);"helper"===o?this.helperSexpr(r,n,i):"simple"===o?(this.simpleSexpr(r),this.opcode("pushProgram",n),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousSexpr(r,n,i),this.opcode("pushProgram",n),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(t){var e,n,i=t.pairs;this.opcode("pushHash");for(var r=0,o=i.length;r<o;r++)n=(e=i[r])[1],this.options.stringParams?(n.depth&&this.addDepth(n.depth),this.opcode("getContext",n.depth||0),this.opcode("pushStringParam",n.stringModeValue,n.type),"sexpr"===n.type&&this.sexpr(n)):this.accept(n),this.opcode("assignToHash",e[0]);this.opcode("popHash")},partial:function(t){var e=t.partialName;this.usePartial=!0,t.context?this.ID(t.context):this.opcode("push","depth0"),this.opcode("invokePartial",e.name),this.opcode("append")},content:function(t){this.opcode("appendContent",t.string)},mustache:function(t){this.sexpr(t.sexpr),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousSexpr:function(t,e,n){var i=t.id,r=i.parts[0],o=null!=e||null!=n;this.opcode("getContext",i.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",n),this.opcode("invokeAmbiguous",r,o)},simpleSexpr:function(t){var e=t.id;"DATA"===e.type?this.DATA(e):e.parts.length?this.ID(e):(this.addDepth(e.depth),this.opcode("getContext",e.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,e,n){var i=this.setupFullMustacheParams(t,e,n),r=t.id.parts[0];if(this.options.knownHelpers[r])this.opcode("invokeKnownHelper",i.length,r);else{if(this.options.knownHelpersOnly)throw new o("You specified knownHelpersOnly, but used the unknown helper "+r,t);this.opcode("invokeHelper",i.length,r,t.isRoot)}},sexpr:function(t){var e=this.classifySexpr(t);"simple"===e?this.simpleSexpr(t):"helper"===e?this.helperSexpr(t):this.ambiguousSexpr(t)},ID:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);t.parts[0]?this.opcode("lookupOnContext",t.parts[0]):this.opcode("pushContext");for(var e=1,n=t.parts.length;e<n;e++)this.opcode("lookup",t.parts[e])},DATA:function(t){if(this.options.data=!0,t.id.isScoped||t.id.depth)throw new o("Scoped data references are not supported: "+t.original,t);this.opcode("lookupData");for(var e=t.id.parts,n=0,i=e.length;n<i;n++)this.opcode("lookup",e[n])},STRING:function(t){this.opcode("pushString",t.string)},INTEGER:function(t){this.opcode("pushLiteral",t.integer)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:[].slice.call(arguments,1)})},declare:function(t,e){this.opcodes.push({opcode:"DECLARE",name:t,value:e})},addDepth:function(t){0!==t&&(this.depths[t]||(this.depths[t]=!0,this.depths.list.push(t)))},classifySexpr:function(t){var e=t.isHelper,n=t.eligibleHelper,i=this.options;if(n&&!e){var r=t.id.parts[0];i.knownHelpers[r]?e=!0:i.knownHelpersOnly&&(n=!1)}return e?"helper":n?"ambiguous":"simple"},pushParams:function(t){for(var e,n=t.length;n--;)e=t[n],this.options.stringParams?(e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",e.stringModeValue,e.type),"sexpr"===e.type&&this.sexpr(e)):this[e.type](e)},setupFullMustacheParams:function(t,e,n){var i=t.params;return this.pushParams(i),this.opcode("pushProgram",e),this.opcode("pushProgram",n),t.hash?this.hash(t.hash):this.opcode("emptyHash"),i}},r.precompile=e,r.compile=i,r}(),function(t,e){"use strict";function n(t){this.value=t}function i(){}var r=t.COMPILER_REVISION,o=t.REVISION_CHANGES,a=t.log,s=e;i.prototype={nameLookup:function(t,e){var n,r;return 0===t.indexOf("depth")&&(n=!0),r=/^[0-9]+$/.test(e)?t+"["+e+"]":i.isValidJavaScriptVariableName(e)?t+"."+e:t+"['"+e+"']",n?"("+t+" && "+r+")":r},compilerInfo:function(){return"this.compilerInfo = ["+r+",'"+o[r]+"'];\n"},appendToBuffer:function(t){return this.environment.isSimple?"return "+t+";":{appendToBuffer:!0,content:t,toString:function(){return"buffer += "+t+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,e,n,i){this.environment=t,this.options=e||{},a("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(t,e);var r,o=t.opcodes;this.i=0;for(var c=o.length;this.i<c;this.i++)"DECLARE"===(r=o[this.i]).opcode?this[r.name]=r.value:this[r.opcode].apply(this,r.args),r.opcode!==this.stripNext&&(this.stripNext=!1);if(this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new s("Compile completed with content left on stack");return this.createFunctionContext(i)},preamble:function(){var t=[];if(this.isChild)t.push("");else{var e=this.namespace,n="helpers = this.merge(helpers, "+e+".helpers);";this.environment.usePartial&&(n=n+" partials = this.merge(partials, "+e+".partials);"),this.options.data&&(n+=" data = data || {};"),t.push(n)}this.environment.isSimple?t.push(""):t.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=t},createFunctionContext:function(t){var e=this.stackVars.concat(this.registers.list);if(e.length>0&&(this.source[1]=this.source[1]+", "+e.join(", ")),!this.isChild)for(var n in this.context.aliases)this.context.aliases.hasOwnProperty(n)&&(this.source[1]=this.source[1]+", "+n+"="+this.context.aliases[n]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");for(var i=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],r=0,o=this.environment.depths.list.length;r<o;r++)i.push("depth"+this.environment.depths.list[r]);var s=this.mergeSource();if(this.isChild||(s=this.compilerInfo()+s),t)return i.push(s),Function.apply(this,i);var c="function "+(this.name||"")+"("+i.join(",")+") {\n  "+s+"}";return a("debug",c+"\n\n"),c},mergeSource:function(){for(var t,e="",n=0,i=this.source.length;n<i;n++){var r=this.source[n];r.appendToBuffer?t=t?t+"\n    + "+r.content:r.content:(t&&(e+="buffer += "+t+";\n  ",t=undefined),e+=r+"\n  ")}return e},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t),this.replaceStack(function(e){return t.splice(1,0,e),"blockHelperMissing.call("+t.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t);var e=this.topStack();t.splice(1,0,e),this.pushSource("if (!"+this.lastHelper+") { "+e+" = blockHelperMissing.call("+t.join(", ")+"); }")},appendContent:function(t){this.pendingContent&&(t=this.pendingContent+t),this.stripNext&&(t=t.replace(/^\s+/,"")),this.pendingContent=t},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var t=this.popStack();this.pushSource("if("+t+" || "+t+" === 0) { "+this.appendToBuffer(t)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(t){this.lastContext!==t&&(this.lastContext=t)},lookupOnContext:function(t){this.push(this.nameLookup("depth"+this.lastContext,t,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(t){return"typeof "+t+" === functionType ? "+t+".apply(depth0) : "+t})},lookup:function(t){this.replaceStack(function(e){return e+" == null || "+e+" === false ? "+e+" : "+this.nameLookup(e,t,"context")})},lookupData:function(){this.pushStackLiteral("data")},pushStringParam:function(t,e){this.pushStackLiteral("depth"+this.lastContext),this.pushString(e),"sexpr"!==e&&("string"==typeof t?this.pushString(t):this.pushStackLiteral(t))},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[]}},popHash:function(){var t=this.hash;this.hash=this.hashes.pop(),this.options.stringParams&&(this.push("{"+t.contexts.join(",")+"}"),this.push("{"+t.types.join(",")+"}")),this.push("{\n    "+t.values.join(",\n    ")+"\n  }")},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){return this.inlineStack.push(t),t},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},invokeHelper:function(t,e,n){this.context.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var i=this.lastHelper=this.setupHelper(t,e,!0),r=this.nameLookup("depth"+this.lastContext,e,"context"),o="helper = "+i.name+" || "+r;i.paramsInit&&(o+=","+i.paramsInit),this.push("("+o+",helper ? helper.call("+i.callParams+") : helperMissing.call("+i.helperMissingParams+"))"),n||this.flushInline()},invokeKnownHelper:function(t,e){var n=this.setupHelper(t,e);this.push(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(t,e){this.context.aliases.functionType='"function"',this.useRegister("helper"),this.emptyHash();var n=this.setupHelper(0,t,e),i=this.lastHelper=this.nameLookup("helpers",t,"helper"),r=this.nameLookup("depth"+this.lastContext,t,"context"),o=this.nextStack();n.paramsInit&&this.pushSource(n.paramsInit),this.pushSource("if (helper = "+i+") { "+o+" = helper.call("+n.callParams+"); }"),this.pushSource("else { helper = "+r+"; "+o+" = typeof helper === functionType ? helper.call("+n.callParams+") : helper; }")},invokePartial:function(t){var e=[this.nameLookup("partials",t,"partial"),"'"+t+"'",this.popStack(),"helpers","partials"];this.options.data&&e.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+e.join(", ")+")")},assignToHash:function(t){var e,n,i=this.popStack();this.options.stringParams&&(n=this.popStack(),e=this.popStack());var r=this.hash;e&&r.contexts.push("'"+t+"': "+e),n&&r.types.push("'"+t+"': "+n),r.values.push("'"+t+"': ("+i+")")},compiler:i,compileChildren:function(t,e){for(var n,i,r=t.children,o=0,a=r.length;o<a;o++){n=r[o],i=new this.compiler;var s=this.matchExistingProgram(n);null==s?(this.context.programs.push(""),s=this.context.programs.length,n.index=s,n.name="program"+s,this.context.programs[s]=i.compile(n,e,this.context),this.context.environments[s]=n):(n.index=s,n.name="program"+s)}},matchExistingProgram:function(t){for(var e=0,n=this.context.environments.length;e<n;e++){var i=this.context.environments[e];if(i&&i.equals(t))return e}},programExpression:function(t){if(this.context.aliases.self="this",null==t)return"self.noop";for(var e,n=this.environment.children[t],i=n.depths.list,r=[n.index,n.name,"data"],o=0,a=i.length;o<a;o++)1===(e=i[o])?r.push("depth0"):r.push("depth"+(e-1));return(0===i.length?"self.program(":"self.programWithDepth(")+r.join(", ")+")"},register:function(t,e){this.useRegister(t),this.pushSource(t+" = "+e+";")},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},pushStackLiteral:function(t){return this.push(new n(t))},pushSource:function(t){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=undefined),t&&this.source.push(t)},pushStack:function(t){this.flushInline();var e=this.incrStack();return t&&this.pushSource(e+" = "+t+";"),this.compileStack.push(e),e},replaceStack:function(t){var e,i,r,o="",a=this.isInline();if(a){var s=this.popStack(!0);if(s instanceof n)e=s.value,r=!0;else{var c=(i=!this.stackSlot)?this.incrStack():this.topStackName();o="("+this.push(c)+" = "+s+"),",e=this.topStack()}}else e=this.topStack();var u=t.call(this,e);return a?(r||this.popStack(),i&&this.stackSlot--,this.push("("+o+u+")")):(/^stack/.test(e)||(e=this.nextStack()),this.pushSource(e+" = ("+o+u+");")),e},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;if(t.length){this.inlineStack=[];for(var e=0,i=t.length;e<i;e++){var r=t[e];r instanceof n?this.compileStack.push(r):this.pushStack(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),i=(e?this.inlineStack:this.compileStack).pop();if(!t&&i instanceof n)return i.value;if(!e){if(!this.stackSlot)throw new s("Invalid stack pop");this.stackSlot--}return i},topStack:function(t){var e=this.isInline()?this.inlineStack:this.compileStack,i=e[e.length-1];return!t&&i instanceof n?i.value:i},quotedString:function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(t,e,n){var i=[];return{params:i,paramsInit:this.setupParams(t,i,n),name:this.nameLookup("helpers",e,"helper"),callParams:["depth0"].concat(i).join(", "),helperMissingParams:n&&["depth0",this.quotedString(e)].concat(i).join(", ")}},setupOptions:function(t,e){var n,i,r,o=[],a=[],s=[];o.push("hash:"+this.popStack()),this.options.stringParams&&(o.push("hashTypes:"+this.popStack()),o.push("hashContexts:"+this.popStack())),i=this.popStack(),((r=this.popStack())||i)&&(r||(this.context.aliases.self="this",r="self.noop"),i||(this.context.aliases.self="this",i="self.noop"),o.push("inverse:"+i),o.push("fn:"+r));for(var c=0;c<t;c++)n=this.popStack(),e.push(n),this.options.stringParams&&(s.push(this.popStack()),a.push(this.popStack()));return this.options.stringParams&&(o.push("contexts:["+a.join(",")+"]"),o.push("types:["+s.join(",")+"]")),this.options.data&&o.push("data:data"),o},setupParams:function(t,e,n){var i="{"+this.setupOptions(t,e).join(",")+"}";return n?(this.useRegister("options"),e.push("options"),"options="+i):(e.push(i),"")}};for(var c="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),u=i.RESERVED_WORDS={},l=0,h=c.length;l<h;l++)u[c[l]]=!0;return i.isValidJavaScriptVariableName=function(t){return!(i.RESERVED_WORDS[t]||!/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t))},i}(i,n))}();!function(t){t.fn.spotlightSearchTypeAhead=function(e){function n(n,i){i=t.extend({displayKey:"title",minLength:0,highlight:n.data("autocomplete-highlight")||!0,hint:n.data("autocomplete-hint")||!1,autoselect:n.data("autocomplete-autoselect")||!0},e);n.typeahead(i,{displayKey:i.displayKey,source:i.bloodhound.ttAdapter(),templates:{suggestion:Handlebars.compile(i.template)}})}return t.each(this,function(){n(t(this))}),this}}(jQuery),Spotlight.onLoad(function(){addAutocompletetoFeaturedImage()}),Spotlight.onLoad(function(){$("[data-input-select-target]").selectRelatedInput()}),function(t){t.fn.selectRelatedInput=function(){return t(this).each(function(){var e,n=t(t(this).data("input-select-target"));e=t(this).is("select")?"change":"click",t(this).on(e,function(){n.is(":checkbox")||n.is(":radio")?n.prop("checked",!0):n.focus()})}),this}}(jQuery),function(t){function e(t,e){var n={};for(var r in e){var o=e[r];if(t.hasOwnProperty(o)&&t[o].prototype.toolbarEnabled){var a;"undefined"!=(a=$.isFunction(t[o].prototype.blockGroup)?t[o].prototype.blockGroup():t[o].prototype.blockGroup)&&a!==undefined||(a=i18n.t("blocks:group:undefined")),n[a]=n[a]||[],n[a].push(i(t[o].prototype))}}return Object.keys(n).reduce(function(t,e){var i=n[e],r=$("<div class='st-controls-group'><div class='st-group-control-label'>"+e+"</div></div>"),o=i.reduce(function(t,e){return t+=e},"");return r.append(o),0===t.length?t+=r[0].outerHTML:t+="<hr />"+r[0].outerHTML},"")}function n(){var t=document.createElement("div");t.className="st-block-controls__buttons",t.innerHTML=e.apply(null,arguments);var n=document.createElement("div");return n.className="spotlight-block-controls",n.appendChild(t),n}var i=function(t){var e=document.createElement("button");e.className="st-block-controls__button",e.setAttribute("data-type",t.type),e.type="button";var n=document.createElement("svg");n.className="st-icon",n.setAttribute("role","img");var i=document.createElement("use");return i.setAttributeNS("https://www.w3.org/1999/xlink","href",SirTrevor.config.defaults.iconUrl+"#"+t.icon_name),n.appendChild(i),e.appendChild(n),e.appendChild(document.createTextNode(t.title())),e.outerHTML};t.Spotlight.BlockControls=function(){},t.Spotlight.BlockControls.create=function(t){function e(){var t=o.parentNode;if(t)return t.removeChild(o),t.classList.remove("st-block--controls-active"),t}function i(){SirTrevor=null,o=null}function r(t){t.stopPropagation();var n=this.parentNode;n&&e()!==n&&($(".st-block__inner",n).after(o),n.classList.add("st-block--controls-active"))}var o=n(SirTrevor.Blocks,t.blockManager.blockTypes);return $(t.wrapper).delegate(".st-block-replacer","click",r),$(t.wrapper).delegate(".st-block-controls__button","click",r),{el:o,hide:e,destroy:i}}}(this),Spotlight.BlockLimits=function(t){this.editor=t},Spotlight.BlockLimits.prototype.enforceLimits=function(t){this.addEditorCallbacks(t),this.checkGlobalBlockTypeLimit()()},Spotlight.BlockLimits.prototype.addEditorCallbacks=function(){SirTrevor.EventBus.on("block:create:new",this.checkBlockTypeLimitOnAdd()),SirTrevor.EventBus.on("block:remove",this.checkGlobalBlockTypeLimit())},Spotlight.BlockLimits.prototype.checkBlockTypeLimitOnAdd=function(){var t=this.editor;return function(e){$(".st-block-controls__button[data-type='"+e.type+"']",t.blockControls.el).prop("disabled",!t.blockManager.canCreateBlock(e["class"]()))}},Spotlight.BlockLimits.prototype.checkGlobalBlockTypeLimit=function(){var t=this.editor;return function(){$.each(t.blockManager.blockTypes,function(e,n){var i=SirTrevor.Blocks[n].prototype;$(t.blockControls.el).find(".st-block-controls__button[data-type='"+i.type+"']").prop("disabled",!t.blockManager.canCreateBlock(n))})}},SirTrevor.Locales.en.blocks=$.extend(SirTrevor.Locales.en.blocks,{autocompleteable:{placeholder:"Enter a title..."},browse:{title:"Browse Categories",description:"This widget highlights browse categories. Each highlighted category links to the corresponding browse category results page.",item_counts:"Include item counts?"},link_to_search:{title:"Saved Searches",description:"This widget highlights saved searches. Each highlighted saved search links to the search results page generated by the saved search parameters. Any saved search listed on the Curation > Browse Categories page, whether published or not, can be highlighted as a saved search.",item_counts:"Include item counts?"},iframe:{title:"IFrame",description:"This widget embeds iframe-based embed code into pages",placeholder:"Enter embed code here. It should begin with e.g. '<iframe'"},oembed:{title:"Embed + Text",description:"This widget embeds a web resource and a text block to the left or right of it.",url:"URL"},uploaded_items:{title:"Uploaded Item Row",description:"This widget displays uploaded items in a horizontal row. Optionally, you can add a heading and/or text to be displayed adjacent to the items.",caption:"Caption"},featured_pages:{title:"Pages",description:"This widget highlights pages from this exhibit. Each highlighted item links to the corresponding page."},resources:{panel:{drag:"Drag",display:"Display?",remove:"Remove"}},rule:{title:"Horizontal Rule"},search_results:{title:"Search Results",description:"This widget displays a set of search results on a page. Specify a search result set by selecting an existing browse category. You can also select the view types that are available to the user when viewing the result set."},solr_documents:{title:"Item Row",description:"This widget displays exhibit items in a horizontal row. Optionally, you can add a heading and/or text to be displayed adjacent to the items.",caption:{placeholder:"Select...",primary:"Primary caption",secondary:"Secondary caption"},zpr:{title:"Display ZPR link"}},solr_documents_carousel:{title:"Item Carousel",description:"This widget displays exhibit items in a carousel. You can configure the item captions, how the images are cycled, and the size of the carousel.",interval:{title:"Automatically cycle images",placeholder:"Select..."},height:{title:"Maximum carousel height"}},solr_documents_embed:{title:"Item Embed",description:"This widget embeds exhibit items on a page. Optionally, you can add a heading and/or text to be displayed adjacent to the items."},solr_documents_features:{title:"Item Slideshow",description:"This widget displays exhibit items in a static slideshow. The user will move between items in the slideshow using the field you select as the primary caption."},solr_documents_grid:{title:"Item Grid",description:"This widget displays exhibit items in a multi-row grid. Optionally, you can add a heading and/or text to be displayed adjacent to the items."},textable:{heading:"Heading",text:"Text",align:{title:"Display text on:",left:"Left",right:"Right"}},group:{undefined:"Standard widgets",items:"Exhibit item widgets"}}),function(t){var e=function(){function t(t){t.on("change",function(t){var r=$(t.currentTarget),o=$(this).nestable("serialize"),a=0;for(var s in o){var c=o[s].id;if(parent_node=e(c,r),n(parent_node,a++),o[s].children){var u=o[s].children;for(var l in u){var h=u[l].id;child_node=e(h,r),n(child_node,a++),i(child_node,c)}}else i(parent_node,"")}})}function e(t,e){return e.find("[data-id="+t+"]")}function n(t,e){r(t).val(e)}function i(t,e){o(t).val(e)}function r(t){return a(t,"weight")}function o(t){return a(t,"parent_page")}function a(t,e){return t.find("input[data-property="+e+"]")}var s='[data-behavior="nestable"]';return{init:function(e){$(e||s).each(function(){$(this).nestable($(this).data()),t($(this))})}}}();t.SpotlightNestable=e}(this),Spotlight.onLoad(function(){if($("[role=tabpanel]").length>0&&window.location.hash){var t=$(window.location.hash).closest("[role=tabpanel]");$("a[role=tab][href=#"+t.attr("id")+"]").tab("show")}}),function(t){t.fn.spotlight_users=function(e){function n(e){e.preventDefault(),t(this).closest("tr").hide(),id=t(this).attr("data-target"),edit_view=t("[data-edit-for='"+id+"']",u).show(),t.each(edit_view.find('input[type="text"], select'),function(){t(this).data("orig",t(this).val())})}function i(e){e.preventDefault(),id=t(this).closest("tr").attr("data-edit-for"),edit_view=t("[data-edit-for='"+id+"']",u).hide(),r(edit_view),o(edit_view),t("[data-show-for='"+id+"']",u).show()}function r(t){t.find(".has-error").removeClass("has-error").find(".help-block").remove()}function o(e){t.each(e.find('input[type="text"], select'),function(){t(this).val(t(this).data("orig")).trigger("change")})}function a(){id=t(this).attr("data-target"),t("[data-destroy-for='"+id+"']",u).val("1")}function s(e){e.preventDefault(),edit_view=t("[data-edit-for='new']",u).show(),t.each(edit_view.find('input[type="text"], select'),function(){t(this).data("orig",t(this).val())})}function c(){edit_row=u.find(".has-error").closest("[data-edit-for]"),edit_row.show(),edit_row.next().show()}var u;t.extend({},e);return this.each(function(){u=t(this),t("[data-edit-for]",u).hide(),c(),t("[data-behavior='edit-user']",u).on("click",n),t("[data-behavior='cancel-edit']",u).on("click",i),t("[data-behavior='destroy-user']",u).on("click",a),t("[data-behavior='new-user']",u).on("click",s)})}}(jQuery),Spotlight.onLoad(function(){$(".edit_exhibit, .admin-users").spotlight_users()}),Spotlight.onLoad(function(){$(".zpr-link").on("click",function(){$("#ajax-modal .modal-content").html('<div id="osd-modal-container"></div>');var t=['<div class="controls">','  <a id="osd-zoom-in"><span class="glyphicon glyphicon-plus-sign"></span></a>','  <a id="osd-zoom-out"><span class="glyphicon glyphicon-minus-sign"></span></a>','  <a id="osd-home"><span class="glyphicon glyphicon-resize-small"></span></a>','  <a id="osd-full-page"><span class="glyphicon glyphicon-fullscreen"></span></a>',"</div>"].join("\n");$("#osd-modal-container").append(t),$("#osd-modal-container").append('<div id="osd-div"></div>'),$("#osd-div").css("height","400px"),$("#ajax-modal").modal("show"),OpenSeadragon({id:"osd-div",zoomInButton:"osd-zoom-in",zoomOutButton:"osd-zoom-out",homeButton:"osd-home",fullPageButton:"osd-full-page",nextButton:"osd-next",previousButton:"osd-previous",tileSources:[$(this).data("iiif-tilesource")]})})}),SirTrevor.Blocks.Wysiwyg=SirTrevor.Block.extend({type:"wysiwyg",icon_name:"text",title:function(){return i18n.t("blocks:wysiwyg:title")},description:function(){return i18n.t("blocks:wysiwyg:description")},blockGroup:function(){return i18n.t("blocks:group:tamu")},formattable:!0,toolbarEnabled:!0,editorHTML:function(){return"<div class='tmce-"+this.blockID+" tinymce'></div>"},loadData:function(t){this.$("div.tmce-"+this.blockID)[0].innerHTML=t.text},onBlockRender:function(){var t=this;tinyMCE.init({selector:"div.tmce-"+t.blockID,inline:!1,inline_styles:!0,menubar:!1,plugins:["advlist autolink lists link charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code","insertdatetime nonbreaking table contextmenu directionality","paste textcolor colorpicker textpattern codesample"],toolbar:"undo redo | insert | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link | forecolor backcolor | table codesample",setup:function(e){e.on("change",function(){t.blockStorage.data.text=e.getContent()})}})}}),function(t){function e(t,e){var n={};for(var r in e){var o=e[r];if(t.hasOwnProperty(o)&&t[o].prototype.toolbarEnabled){var a;"undefined"!=(a=$.isFunction(t[o].prototype.blockGroup)?t[o].prototype.blockGroup():t[o].prototype.blockGroup)&&a!==undefined||(a=i18n.t("blocks:group:undefined")),n[a]=n[a]||[],n[a].push(i(t[o].prototype))}}return Object.keys(n).reduce(function(t,e){var i=n[e],r=$("<div class='st-controls-group'><div class='st-group-control-label'>"+e+"</div></div>"),o=i.reduce(function(t,e){return t+=e},"");return r.append(o),0===t.length?t+=r[0].outerHTML:t+="<hr />"+r[0].outerHTML},"")}function n(){var t=document.createElement("div");t.className="st-block-controls__buttons",t.innerHTML=e.apply(null,arguments);var n=document.createElement("div");return n.className="spotlight-block-controls",n.appendChild(t),n}var i=function(t){var e=document.createElement("button");e.className="st-block-controls__button",e.setAttribute("data-type",t.type),e.type="button";var n=document.createElement("svg");n.className="st-icon",n.setAttribute("role","img");var i=document.createElement("use");return i.setAttributeNS("https://www.w3.org/1999/xlink","href",SirTrevor.config.defaults.iconUrl+"#"+t.icon_name),n.appendChild(i),e.appendChild(n),e.appendChild(document.createTextNode(t.title())),e.outerHTML};t.Spotlight.BlockControls=function(){},t.Spotlight.BlockControls.create=function(t){function e(){var t=o.parentNode;if(t)return t.removeChild(o),t.classList.remove("st-block--controls-active"),t}function i(){SirTrevor=null,o=null}function r(t){t.stopPropagation();var n=this.parentNode;n&&e()!==n&&($(".st-block__inner",n).after(o),n.classList.add("st-block--controls-active"))}t.blockManager.blockTypes.push("Wysiwyg"),t.reinitialize();var o=n(SirTrevor.Blocks,t.blockManager.blockTypes);return $(t.wrapper).delegate(".st-block-replacer","click",r),$(t.wrapper).delegate(".st-block-controls__button","click",r),{el:o,hide:e,destroy:i}}}(this),SirTrevor.Locales.en.blocks=$.extend(SirTrevor.Locales.en.blocks,{autocompleteable:{placeholder:"Enter a title..."},browse:{title:"Browse Categories",description:"This widget highlights browse categories. Each highlighted category links to the corresponding browse category results page.",item_counts:"Include item counts?"},link_to_search:{title:"Saved Searches",
description:"This widget highlights saved searches. Each highlighted saved search links to the search results page generated by the saved search parameters. Any saved search listed on the Curation > Browse Categories page, whether published or not, can be highlighted as a saved search.",item_counts:"Include item counts?"},iframe:{title:"IFrame",description:"This widget embeds iframe-based embed code into pages",placeholder:"Enter embed code here. It should begin with e.g. '<iframe'"},oembed:{title:"Embed + Text",description:"This widget embeds a web resource and a text block to the left or right of it.",url:"URL"},uploaded_items:{title:"Uploaded Item Row",description:"This widget displays uploaded items in a horizontal row. Optionally, you can add a heading and/or text to be displayed adjacent to the items.",caption:"Caption"},featured_pages:{title:"Pages",description:"This widget highlights pages from this exhibit. Each highlighted item links to the corresponding page."},resources:{panel:{drag:"Drag",display:"Display?",remove:"Remove"}},rule:{title:"Horizontal Rule"},search_results:{title:"Search Results",description:"This widget displays a set of search results on a page. Specify a search result set by selecting an existing browse category. You can also select the view types that are available to the user when viewing the result set."},solr_documents:{title:"Item Row",description:"This widget displays exhibit items in a horizontal row. Optionally, you can add a heading and/or text to be displayed adjacent to the items.",caption:{placeholder:"Select...",primary:"Primary caption",secondary:"Secondary caption"},zpr:{title:"Display ZPR link"}},solr_documents_carousel:{title:"Item Carousel",description:"This widget displays exhibit items in a carousel. You can configure the item captions, how the images are cycled, and the size of the carousel.",interval:{title:"Automatically cycle images",placeholder:"Select..."},height:{title:"Maximum carousel height"}},solr_documents_embed:{title:"Item Embed",description:"This widget embeds exhibit items on a page. Optionally, you can add a heading and/or text to be displayed adjacent to the items."},solr_documents_features:{title:"Item Slideshow",description:"This widget displays exhibit items in a static slideshow. The user will move between items in the slideshow using the field you select as the primary caption."},solr_documents_grid:{title:"Item Grid",description:"This widget displays exhibit items in a multi-row grid. Optionally, you can add a heading and/or text to be displayed adjacent to the items."},textable:{heading:"Heading",text:"Text",align:{title:"Display text on:",left:"Left",right:"Right"}},wysiwyg:{title:"Wysiwyg",description:"This widget allows for rendering content from a Wysiwyg editor."},group:{undefined:"Standard widgets",items:"Exhibit item widgets",tamu:"Texas A&M University widgets"}});